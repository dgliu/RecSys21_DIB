nohup: ignoring input
/home/huawei/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:458: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/huawei/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:459: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/huawei/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:460: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/huawei/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:461: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/huawei/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:462: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/huawei/.local/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:465: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/huawei/DugangLiu/_DIB_NCF/utils/io.py:115: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  return yaml.load(stream)[key]
==================================================
|          DIB-NCF: Set the random seed          |
==================================================

==================================================
|               DIB-NCF: Training                |
==================================================

[32m[I 2021-05-12 23:25:41,300][0m A new study created in memory with name: no-name-f644277a-218a-4a78-ab88-42f7de7d7a61[0m
2021-05-12 23:25:41.979879: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2021-05-12 23:25:41.979918: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2021-05-12 23:25:41.979926: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2021-05-12 23:25:41.979931: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2021-05-12 23:25:41.979936: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2021-05-12 23:25:52.850133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB
major: 6 minor: 0 memoryClockRate (GHz) 1.3285
pciBusID 0000:b1:00.0
Total memory: 15.89GiB
Free memory: 15.60GiB
2021-05-12 23:25:52.850169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2021-05-12 23:25:52.850176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2021-05-12 23:25:52.850189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
/home/huawei/.local/lib/python3.6/site-packages/scipy/sparse/_index.py:125: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
  self._set_arrayXarray(i, j, x)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5005002065105554, 0.0)
Epoch 0 Test AUC:(0.4982716306100295, 0.0)
Epoch 0 a 0.5077961047670241 b 0.5077941560487522 c 0.5077941445114026
  0%|          | 1/1000 [02:58<49:36:56, 178.80s/it]Epoch 1 Valid AUC:(0.49991677343692315, 0.0)
Epoch 1 Test AUC:(0.5137938181723858, 0.0)
Epoch 1 a 0.5036774573312925 b 0.5036764724312145 c 0.503676472970623
  0%|          | 2/1000 [05:56<49:20:39, 178.00s/it]Epoch 2 Valid AUC:(0.496660823155462, 0.0)
Epoch 2 Test AUC:(0.5061802897315452, 0.0)
Epoch 2 a 0.503753653448871 b 0.5037534859774998 c 0.5037534854980256
  0%|          | 3/1000 [08:52<49:04:31, 177.20s/it]Epoch 3 Valid AUC:(0.4868111119247225, 0.0)
Epoch 3 Test AUC:(0.4946333173486736, 0.0)
Epoch 3 a 0.5035866287978467 b 0.5035865995199492 c 0.5035865999694563
  0%|          | 4/1000 [11:49<48:57:16, 176.94s/it]Epoch 4 Valid AUC:(0.49014500220362, 0.0)
Epoch 4 Test AUC:(0.4998031343383647, 0.0)
Epoch 4 a 0.5038451651732127 b 0.503845163240332 c 0.5038451634351184
  0%|          | 5/1000 [14:46<48:55:30, 177.02s/it]Epoch 5 Valid AUC:(0.48659357070981085, 0.0)
Epoch 5 Test AUC:(0.4927824282590006, 0.0)
Epoch 5 a 0.5034121100839027 b 0.5034121088102992 c 0.5034121085405949
  1%|          | 6/1000 [17:43<48:53:09, 177.05s/it]  1%|          | 6/1000 [20:39<57:02:35, 206.59s/it]
[32m[I 2021-05-12 23:48:42,991][0m Trial 0 finished with value: 0.5005002065105554 and parameters: {'rank': 55.0, 'lambda': 1, 'batch_size': 128, 'learning_rate': 0.005, 'alpha': 0.18579456176227568, 'gamma': 0.004389006955136502}. Best is trial 0 with value: 0.5005002065105554.[0m
2021-05-12 23:48:43.723117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5158494646935131, 0.0)
Epoch 0 Test AUC:(0.5049846361583487, 0.0)
Epoch 0 a 0.6889000188919806 b 0.6885735921321376 c 0.6880978514109889
  0%|          | 1/1000 [00:20<5:36:09, 20.19s/it]Epoch 1 Valid AUC:(0.5328443788558864, 0.0)
Epoch 1 Test AUC:(0.5164475444602769, 0.0)
Epoch 1 a 0.6581996732181118 b 0.6335473512449572 c 0.6293105511896072
  0%|          | 2/1000 [00:40<5:36:55, 20.26s/it]Epoch 2 Valid AUC:(0.5657973085262571, 0.0)
Epoch 2 Test AUC:(0.5427902226350948, 0.0)
Epoch 2 a 0.5972194892744864 b 0.5187349043065502 c 0.5091991929277297
  0%|          | 3/1000 [01:01<5:38:49, 20.39s/it]Epoch 3 Valid AUC:(0.5920731737887723, 0.0)
Epoch 3 Test AUC:(0.5747375063586234, 0.0)
Epoch 3 a 0.5308683134855763 b 0.46656566834257496 c 0.4533087200214786
  0%|          | 4/1000 [01:21<5:38:25, 20.39s/it]2021-05-12 23:50:34.822835: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 1189592 get requests, put_count=1189592 evicted_count=1000 eviction_rate=0.000840624 and unsatisfied allocation rate=0.000924687
Epoch 4 Valid AUC:(0.6035392450949334, 0.0)
Epoch 4 Test AUC:(0.6008030877401337, 0.0)
Epoch 4 a 0.4856534922315228 b 0.45214113352760193 c 0.4310534555585154
  0%|          | 5/1000 [01:41<5:39:04, 20.45s/it]Epoch 5 Valid AUC:(0.608289160884108, 0.0)
Epoch 5 Test AUC:(0.6164217937964017, 0.0)
Epoch 5 a 0.4644744809596769 b 0.44516158127977 c 0.41512319253337
  1%|          | 6/1000 [02:02<5:39:43, 20.51s/it]Epoch 6 Valid AUC:(0.6114037592938721, 0.0)
Epoch 6 Test AUC:(0.6243218848974612, 0.0)
Epoch 6 a 0.4551053157737178 b 0.4389907818648123 c 0.40266930720498484
  1%|          | 7/1000 [02:22<5:38:41, 20.46s/it]Epoch 7 Valid AUC:(0.6157684055582692, 0.0)
Epoch 7 Test AUC:(0.6298368981963415, 0.0)
Epoch 7 a 0.45051702977188174 b 0.4334045290466278 c 0.3940309819675261
  1%|          | 8/1000 [02:43<5:39:02, 20.51s/it]Epoch 8 Valid AUC:(0.6209362253225167, 0.0)
Epoch 8 Test AUC:(0.6345775146523304, 0.0)
Epoch 8 a 0.44714254477331716 b 0.42821300486403124 c 0.38733516176862104
  1%|          | 9/1000 [03:03<5:37:43, 20.45s/it]Epoch 9 Valid AUC:(0.6286422437979832, 0.0)
Epoch 9 Test AUC:(0.6403867265817563, 0.0)
Epoch 9 a 0.44384197097632194 b 0.42437847174944415 c 0.38226428387626527
  1%|          | 10/1000 [03:23<5:35:07, 20.31s/it]Epoch 10 Valid AUC:(0.6388823778336069, 0.0)
Epoch 10 Test AUC:(0.6471423541839317, 0.0)
Epoch 10 a 0.439594125074725 b 0.4212503005420008 c 0.37766060665730505
  1%|          | 11/1000 [03:43<5:32:54, 20.20s/it]Epoch 11 Valid AUC:(0.6516204327174319, 0.0)
Epoch 11 Test AUC:(0.6557619067512149, 0.0)
Epoch 11 a 0.4349421262741089 b 0.4192019662549419 c 0.3746006262879218
  1%|          | 12/1000 [04:04<5:34:01, 20.29s/it]Epoch 12 Valid AUC:(0.6671237407823569, 0.0)
Epoch 12 Test AUC:(0.6653678377094134, 0.0)
Epoch 12 a 0.4291409467977862 b 0.4184854407944987 c 0.3720962337909206
  1%|▏         | 13/1000 [04:24<5:33:08, 20.25s/it]Epoch 13 Valid AUC:(0.6828940454031635, 0.0)
Epoch 13 Test AUC:(0.6758371164414374, 0.0)
Epoch 13 a 0.4222289374278438 b 0.4190368734059795 c 0.3699232645092472
  1%|▏         | 14/1000 [04:45<5:34:06, 20.33s/it]Epoch 14 Valid AUC:(0.6991163545902093, 0.0)
Epoch 14 Test AUC:(0.6859950519510847, 0.0)
Epoch 14 a 0.4148327030481831 b 0.4203249970751424 c 0.367829839548757
  2%|▏         | 15/1000 [05:05<5:33:29, 20.31s/it]Epoch 15 Valid AUC:(0.7147874499182171, 0.0)
Epoch 15 Test AUC:(0.6953365927810434, 0.0)
Epoch 15 a 0.40750910269637264 b 0.4229545730256265 c 0.3664134502891571
  2%|▏         | 16/1000 [05:25<5:33:55, 20.36s/it]Epoch 16 Valid AUC:(0.7285050752978168, 0.0)
Epoch 16 Test AUC:(0.703304804775281, 0.0)
Epoch 16 a 0.4004447592362281 b 0.4275015308972328 c 0.365321893845835
  2%|▏         | 17/1000 [05:45<5:32:46, 20.31s/it]Epoch 17 Valid AUC:(0.7407416395162326, 0.0)
Epoch 17 Test AUC:(0.7102405061726538, 0.0)
Epoch 17 a 0.39400511859886106 b 0.43242846164972554 c 0.36411725705669773
  2%|▏         | 18/1000 [06:06<5:33:11, 20.36s/it]Epoch 18 Valid AUC:(0.7497062386836737, 0.0)
Epoch 18 Test AUC:(0.7149635120117469, 0.0)
Epoch 18 a 0.38855273468840507 b 0.4384104333096935 c 0.3633027845813382
  2%|▏         | 19/1000 [06:26<5:32:12, 20.32s/it]Epoch 19 Valid AUC:(0.757126956911022, 0.0)
Epoch 19 Test AUC:(0.7189990239938734, 0.0)
Epoch 19 a 0.3839103971277514 b 0.4446525304548202 c 0.3623125440170688
  2%|▏         | 20/1000 [06:46<5:31:47, 20.31s/it]Epoch 20 Valid AUC:(0.7627600469968893, 0.0)
Epoch 20 Test AUC:(0.722119737324844, 0.0)
Epoch 20 a 0.3804017045805531 b 0.4508616905058584 c 0.36188435482402004
  2%|▏         | 21/1000 [07:06<5:30:07, 20.23s/it]Epoch 21 Valid AUC:(0.7675782331743469, 0.0)
Epoch 21 Test AUC:(0.7245589125136661, 0.0)
Epoch 21 a 0.3771296746788486 b 0.45646826129767204 c 0.36083973151060844
  2%|▏         | 22/1000 [07:27<5:30:14, 20.26s/it]Epoch 22 Valid AUC:(0.7708754673682872, 0.0)
Epoch 22 Test AUC:(0.7262167432382189, 0.0)
Epoch 22 a 0.37487453823128053 b 0.46200241436881406 c 0.3603965373289201
  2%|▏         | 23/1000 [07:47<5:28:21, 20.17s/it]Epoch 23 Valid AUC:(0.774351396452017, 0.0)
Epoch 23 Test AUC:(0.7273507831673064, 0.0)
Epoch 23 a 0.37275237926552374 b 0.4674975876846621 c 0.35989842828243007
  2%|▏         | 24/1000 [08:08<5:31:35, 20.39s/it]Epoch 24 Valid AUC:(0.7759038281717349, 0.0)
Epoch 24 Test AUC:(0.7286174264668777, 0.0)
Epoch 24 a 0.371189066479283 b 0.472131050161777 c 0.3595683267039637
  2%|▎         | 25/1000 [08:28<5:31:00, 20.37s/it]Epoch 25 Valid AUC:(0.7770985356164476, 0.0)
Epoch 25 Test AUC:(0.7292437940820965, 0.0)
Epoch 25 a 0.3698494369464536 b 0.47684258438887134 c 0.35927512304436776
  3%|▎         | 26/1000 [08:48<5:30:33, 20.36s/it]Epoch 26 Valid AUC:(0.778858367316189, 0.0)
Epoch 26 Test AUC:(0.7301327048271333, 0.0)
Epoch 26 a 0.36886946929077946 b 0.4805578094336294 c 0.3590065459570577
  3%|▎         | 27/1000 [09:09<5:30:07, 20.36s/it]Epoch 27 Valid AUC:(0.7798690702368215, 0.0)
Epoch 27 Test AUC:(0.7305413532279348, 0.0)
Epoch 27 a 0.3678779402567494 b 0.484872046257219 c 0.35867341752013854
  3%|▎         | 28/1000 [09:29<5:29:16, 20.33s/it]Epoch 28 Valid AUC:(0.7815027279550187, 0.0)
Epoch 28 Test AUC:(0.7312223783149662, 0.0)
Epoch 28 a 0.3675075279128167 b 0.48785092657612217 c 0.35894631690556006
  3%|▎         | 29/1000 [09:49<5:29:09, 20.34s/it]Epoch 29 Valid AUC:(0.7822678535613576, 0.0)
Epoch 29 Test AUC:(0.7309476586770346, 0.0)
Epoch 29 a 0.366618606352037 b 0.491134796892443 c 0.35852131968544376
  3%|▎         | 30/1000 [10:10<5:28:29, 20.32s/it]Epoch 30 Valid AUC:(0.7835660815732483, 0.0)
Epoch 30 Test AUC:(0.7310981334674322, 0.0)
Epoch 30 a 0.3656456975206252 b 0.4937257800371416 c 0.3579319117050017
  3%|▎         | 31/1000 [10:30<5:29:07, 20.38s/it]Epoch 31 Valid AUC:(0.784033549824583, 0.0)
Epoch 31 Test AUC:(0.7309299882037085, 0.0)
Epoch 31 a 0.3655592734294553 b 0.4970944211367638 c 0.35824158258976474
  3%|▎         | 32/1000 [10:51<5:28:54, 20.39s/it]Epoch 32 Valid AUC:(0.7838459453095006, 0.0)
Epoch 32 Test AUC:(0.7312185902580179, 0.0)
Epoch 32 a 0.36501060089757364 b 0.49960633968153306 c 0.3580641751327822
  3%|▎         | 33/1000 [11:11<5:28:32, 20.39s/it]Epoch 33 Valid AUC:(0.7848839704829548, 0.0)
Epoch 33 Test AUC:(0.731450243194325, 0.0)
Epoch 33 a 0.36485786760045635 b 0.5026587151711986 c 0.358287671640996
  3%|▎         | 34/1000 [11:31<5:27:14, 20.33s/it]Epoch 34 Valid AUC:(0.7849954048786976, 0.0)
Epoch 34 Test AUC:(0.7316019151133293, 0.0)
Epoch 34 a 0.3645985138512427 b 0.5048906406567942 c 0.3581347153071434
  4%|▎         | 35/1000 [11:52<5:28:38, 20.43s/it]Epoch 35 Valid AUC:(0.784963299725762, 0.0)
Epoch 35 Test AUC:(0.7316056646911436, 0.0)
Epoch 35 a 0.3639528229832649 b 0.5063007399439812 c 0.3576789008032891
  4%|▎         | 36/1000 [12:12<5:27:19, 20.37s/it]Epoch 36 Valid AUC:(0.7852803373100063, 0.0)
Epoch 36 Test AUC:(0.7317364467159617, 0.0)
Epoch 36 a 0.3639610575572137 b 0.5086744454118514 c 0.35800255762953914
  4%|▎         | 37/1000 [12:32<5:25:31, 20.28s/it]Epoch 37 Valid AUC:(0.7873742594527587, 0.0)
Epoch 37 Test AUC:(0.732016660319106, 0.0)
Epoch 37 a 0.36368884626896153 b 0.5112059774898714 c 0.3579547765754884
  4%|▍         | 38/1000 [12:52<5:25:34, 20.31s/it]Epoch 38 Valid AUC:(0.7859383833690986, 0.0)
Epoch 38 Test AUC:(0.7321020583433538, 0.0)
Epoch 38 a 0.36376344845179587 b 0.5128031036546153 c 0.35821610376719504
  4%|▍         | 39/1000 [13:13<5:25:36, 20.33s/it]Epoch 39 Valid AUC:(0.7868497257691155, 0.0)
Epoch 39 Test AUC:(0.7323661235366861, 0.0)
Epoch 39 a 0.3633352953099435 b 0.5142666570121243 c 0.35789084891157763
  4%|▍         | 40/1000 [13:33<5:24:16, 20.27s/it]Epoch 40 Valid AUC:(0.786855708239033, 0.0)
Epoch 40 Test AUC:(0.7325206429115906, 0.0)
Epoch 40 a 0.363327365248434 b 0.5165187336744801 c 0.3580901596334673
  4%|▍         | 41/1000 [13:54<5:25:36, 20.37s/it]Epoch 41 Valid AUC:(0.7873286629843086, 0.0)
Epoch 41 Test AUC:(0.7323520829283138, 0.0)
Epoch 41 a 0.3629693218296574 b 0.5174286894259914 c 0.3578057087236835
  4%|▍         | 42/1000 [14:14<5:25:50, 20.41s/it]Epoch 42 Valid AUC:(0.7876738955853022, 0.0)
Epoch 42 Test AUC:(0.7325075642815628, 0.0)
Epoch 42 a 0.3622077227600159 b 0.5186848049202273 c 0.3571860528280658
  4%|▍         | 43/1000 [14:34<5:24:37, 20.35s/it]Epoch 43 Valid AUC:(0.7869034718789978, 0.0)
Epoch 43 Test AUC:(0.7325347904064456, 0.0)
Epoch 43 a 0.36255121711761723 b 0.52074771734976 c 0.35765437397264666
  4%|▍         | 44/1000 [14:55<5:25:03, 20.40s/it]Epoch 44 Valid AUC:(0.7873478099638647, 0.0)
Epoch 44 Test AUC:(0.7325503488028728, 0.0)
Epoch 44 a 0.36272603321459984 b 0.5222263550085406 c 0.3579791380513099
  4%|▍         | 45/1000 [15:15<5:25:52, 20.47s/it]Epoch 45 Valid AUC:(0.7872835099465765, 0.0)
Epoch 45 Test AUC:(0.7328243758163963, 0.0)
Epoch 45 a 0.3622822021284411 b 0.522866549751451 c 0.35753899620425317
  5%|▍         | 46/1000 [15:35<5:23:26, 20.34s/it]Epoch 46 Valid AUC:(0.7883446024885066, 0.0)
Epoch 46 Test AUC:(0.7327462118693001, 0.0)
Epoch 46 a 0.36204165556738455 b 0.5241359823173092 c 0.3574070425764207
  5%|▍         | 47/1000 [15:56<5:21:52, 20.26s/it]Epoch 47 Valid AUC:(0.7877797396781786, 0.0)
Epoch 47 Test AUC:(0.7325945998067261, 0.0)
Epoch 47 a 0.36202744250336 b 0.5256878442821964 c 0.3575552067449016
  5%|▍         | 48/1000 [16:16<5:21:19, 20.25s/it]Epoch 48 Valid AUC:(0.7880754374795189, 0.0)
Epoch 48 Test AUC:(0.732086615384328, 0.0)
Epoch 48 a 0.36199502887264373 b 0.5259622969935017 c 0.35747567275839465
  5%|▍         | 49/1000 [16:36<5:20:09, 20.20s/it]Epoch 49 Valid AUC:(0.7882466183973448, 0.0)
Epoch 49 Test AUC:(0.7324961659070437, 0.0)
Epoch 49 a 0.36222422675740334 b 0.527213542692123 c 0.35792322024222345
  5%|▌         | 50/1000 [16:56<5:19:36, 20.19s/it]Epoch 50 Valid AUC:(0.7886877563478107, 0.0)
Epoch 50 Test AUC:(0.7323998782879345, 0.0)
Epoch 50 a 0.3618226577678034 b 0.5284682315203452 c 0.35755387837848357
  5%|▌         | 51/1000 [17:16<5:20:03, 20.24s/it]Epoch 51 Valid AUC:(0.7889114094733984, 0.0)
Epoch 51 Test AUC:(0.732414376370453, 0.0)
Epoch 51 a 0.3615240401798679 b 0.5289748849407319 c 0.3572955710753318
  5%|▌         | 52/1000 [17:37<5:20:49, 20.31s/it]Epoch 52 Valid AUC:(0.7891034316349688, 0.0)
Epoch 52 Test AUC:(0.7325195056394141, 0.0)
Epoch 52 a 0.36156861363880094 b 0.5297647820365045 c 0.3574098956681067
  5%|▌         | 53/1000 [17:57<5:22:02, 20.40s/it]Epoch 53 Valid AUC:(0.7888624501084053, 0.0)
Epoch 53 Test AUC:(0.7325169018846948, 0.0)
Epoch 53 a 0.36133527058747505 b 0.5306713946403996 c 0.35720863746058557
  5%|▌         | 54/1000 [18:18<5:22:03, 20.43s/it]Epoch 54 Valid AUC:(0.789050697982506, 0.0)
Epoch 54 Test AUC:(0.7324219610352681, 0.0)
Epoch 54 a 0.3614900066487251 b 0.5318708304435976 c 0.357413514487205
  6%|▌         | 55/1000 [18:38<5:19:02, 20.26s/it]Epoch 55 Valid AUC:(0.7884750826180633, 0.0)
Epoch 55 Test AUC:(0.7319277478673057, 0.0)
Epoch 55 a 0.36139599474207046 b 0.5321539476994546 c 0.3573968290321289
  6%|▌         | 56/1000 [18:58<5:18:20, 20.23s/it]Epoch 56 Valid AUC:(0.7894406427536972, 0.0)
Epoch 56 Test AUC:(0.7321090059647317, 0.0)
Epoch 56 a 0.3611228146379994 b 0.5327040596354392 c 0.35709852845438067
  6%|▌         | 57/1000 [19:18<5:18:20, 20.25s/it]Epoch 57 Valid AUC:(0.7891620247245485, 0.0)
Epoch 57 Test AUC:(0.7317903431560172, 0.0)
Epoch 57 a 0.36091627853531993 b 0.5330652825294002 c 0.3569855699616094
  6%|▌         | 58/1000 [19:38<5:17:44, 20.24s/it]Epoch 58 Valid AUC:(0.789656444848712, 0.0)
Epoch 58 Test AUC:(0.7320522962724506, 0.0)
Epoch 58 a 0.36105297121309465 b 0.5342234108717211 c 0.3571591148934057
  6%|▌         | 59/1000 [19:59<5:16:34, 20.19s/it]Epoch 59 Valid AUC:(0.7889938273521313, 0.0)
Epoch 59 Test AUC:(0.7320652680159956, 0.0)
Epoch 59 a 0.3612229018922775 b 0.5343290065084735 c 0.35731258147185846
  6%|▌         | 60/1000 [20:19<5:17:19, 20.25s/it]Epoch 60 Valid AUC:(0.7890547939494847, 0.0)
Epoch 60 Test AUC:(0.7316964241413656, 0.0)
Epoch 60 a 0.36105278590994494 b 0.5347379650319776 c 0.3572316306733316
  6%|▌         | 61/1000 [20:39<5:16:43, 20.24s/it]Epoch 61 Valid AUC:(0.7890310819403987, 0.0)
Epoch 61 Test AUC:(0.7315575871512084, 0.0)
Epoch 61 a 0.36067406857205975 b 0.534412520547067 c 0.35673970993488063
  6%|▌         | 62/1000 [21:00<5:17:13, 20.29s/it]Epoch 62 Valid AUC:(0.789726060908249, 0.0)
Epoch 62 Test AUC:(0.7322906574044142, 0.0)
Epoch 62 a 0.3610364148213017 b 0.5359566120370742 c 0.3572238419325121
  6%|▋         | 63/1000 [21:20<5:19:44, 20.47s/it]Epoch 63 Valid AUC:(0.7889423586306474, 0.0)
Epoch 63 Test AUC:(0.7326167808896238, 0.0)
Epoch 63 a 0.36094229283832735 b 0.535816746854013 c 0.3571826063336865
  6%|▋         | 64/1000 [21:41<5:18:26, 20.41s/it]Epoch 64 Valid AUC:(0.7890761555194472, 0.0)
Epoch 64 Test AUC:(0.7324733050261159, 0.0)
Epoch 64 a 0.36084966121181367 b 0.5360172434199241 c 0.35700699326492125
  6%|▋         | 65/1000 [22:01<5:17:12, 20.36s/it]Epoch 65 Valid AUC:(0.7895350409513651, 0.0)
Epoch 65 Test AUC:(0.7319185214261159, 0.0)
Epoch 65 a 0.36085126765312686 b 0.5361765281807992 c 0.35706841729341016
  7%|▋         | 66/1000 [22:22<5:17:49, 20.42s/it]Epoch 66 Valid AUC:(0.789421243300582, 0.0)
Epoch 66 Test AUC:(0.7318775582504716, 0.0)
Epoch 66 a 0.36097823011298336 b 0.5368136335765162 c 0.3572604442315717
  7%|▋         | 67/1000 [22:42<5:17:24, 20.41s/it]Epoch 67 Valid AUC:(0.7891946066295855, 0.0)
Epoch 67 Test AUC:(0.7320725662250369, 0.0)
Epoch 67 a 0.3605131865028412 b 0.5366533735106068 c 0.35670477368177905
  7%|▋         | 68/1000 [23:02<5:17:22, 20.43s/it]  7%|▋         | 68/1000 [23:23<5:20:35, 20.64s/it]
[32m[I 2021-05-13 00:12:26,269][0m Trial 1 finished with value: 0.789726060908249 and parameters: {'rank': 65.0, 'lambda': 0.001, 'batch_size': 2048, 'learning_rate': 0.0001, 'alpha': 0.19636627605010293, 'gamma': 0.0025337660753031108}. Best is trial 1 with value: 0.789726060908249.[0m
2021-05-13 00:12:26.928037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7418504713478856, 0.0)
Epoch 0 Test AUC:(0.6864684094285353, 0.0)
Epoch 0 a 0.43376803320178564 b 0.4580702836244879 c 0.4337889584497187
  0%|          | 1/1000 [01:34<26:10:22, 94.32s/it]Epoch 1 Valid AUC:(0.7663266230594677, 0.0)
Epoch 1 Test AUC:(0.7062095603810699, 0.0)
Epoch 1 a 0.4125558464699828 b 0.42318243906651465 c 0.40453687969827556
  0%|          | 2/1000 [03:08<26:03:13, 93.98s/it]Epoch 2 Valid AUC:(0.7418875260078523, 0.0)
Epoch 2 Test AUC:(0.690148797484956, 0.0)
Epoch 2 a 0.407724591358087 b 0.4098194044840408 c 0.3968364716595567
  0%|          | 3/1000 [04:42<26:04:56, 94.18s/it]Epoch 3 Valid AUC:(0.7613513752596172, 0.0)
Epoch 3 Test AUC:(0.7056363110723122, 0.0)
Epoch 3 a 0.4037860123444371 b 0.40281055516880043 c 0.3921045499968097
  0%|          | 4/1000 [06:16<26:02:49, 94.15s/it]Epoch 4 Valid AUC:(0.7557901350475685, 0.0)
Epoch 4 Test AUC:(0.7127357369084827, 0.0)
Epoch 4 a 0.40402484593736815 b 0.39859548028206204 c 0.3906574537396671
  0%|          | 5/1000 [07:50<26:01:59, 94.19s/it]Epoch 5 Valid AUC:(0.7718017236505726, 0.0)
Epoch 5 Test AUC:(0.7104872771330791, 0.0)
Epoch 5 a 0.4021930261037239 b 0.3950606417548009 c 0.3877318126394955
  1%|          | 6/1000 [09:25<26:02:56, 94.34s/it]Epoch 6 Valid AUC:(0.7332548283248491, 0.0)
Epoch 6 Test AUC:(0.6876185550128415, 0.0)
Epoch 6 a 0.40111997507707453 b 0.3906607469262731 c 0.38450909242543657
  1%|          | 7/1000 [10:59<25:59:08, 94.21s/it]Epoch 7 Valid AUC:(0.765419966158598, 0.0)
Epoch 7 Test AUC:(0.7063380379333201, 0.0)
Epoch 7 a 0.4020100396943524 b 0.3891081869662168 c 0.3842257865717713
  1%|          | 8/1000 [12:33<25:58:05, 94.24s/it]Epoch 8 Valid AUC:(0.7198139229371342, 0.0)
Epoch 8 Test AUC:(0.6904876148088553, 0.0)
Epoch 8 a 0.4002670890068864 b 0.38776963346560955 c 0.3830108863547055
  1%|          | 9/1000 [14:08<25:58:36, 94.37s/it]Epoch 9 Valid AUC:(0.7602951040655512, 0.0)
Epoch 9 Test AUC:(0.706012128221076, 0.0)
Epoch 9 a 0.4013191460363822 b 0.3863112484545295 c 0.3820975501712419
  1%|          | 10/1000 [15:43<25:58:43, 94.47s/it]Epoch 10 Valid AUC:(0.7759168106953561, 0.0)
Epoch 10 Test AUC:(0.7155293348476839, 0.0)
Epoch 10 a 0.4008157628043077 b 0.38329737224209476 c 0.3798963634420928
  1%|          | 11/1000 [17:16<25:54:13, 94.29s/it]Epoch 11 Valid AUC:(0.7559440080698854, 0.0)
Epoch 11 Test AUC:(0.7022175554728767, 0.0)
Epoch 11 a 0.40185363683662184 b 0.38229848873207506 c 0.3789715204440372
  1%|          | 12/1000 [18:51<25:53:05, 94.32s/it]Epoch 12 Valid AUC:(0.7680101090618107, 0.0)
Epoch 12 Test AUC:(0.7109867020859397, 0.0)
Epoch 12 a 0.401555983263482 b 0.3826642157865962 c 0.3797579729700952
  1%|▏         | 13/1000 [20:25<25:48:21, 94.13s/it]Epoch 13 Valid AUC:(0.7575487248849813, 0.0)
Epoch 13 Test AUC:(0.713105842043609, 0.0)
Epoch 13 a 0.40143903766119743 b 0.3801785066453984 c 0.37747402129398744
  1%|▏         | 14/1000 [21:59<25:46:12, 94.09s/it]Epoch 14 Valid AUC:(0.7337824147598514, 0.0)
Epoch 14 Test AUC:(0.6919679455647153, 0.0)
Epoch 14 a 0.4000525606470089 b 0.3801017951677503 c 0.3778378018131199
  2%|▏         | 15/1000 [23:33<25:46:34, 94.21s/it]Epoch 15 Valid AUC:(0.7664795823069237, 0.0)
Epoch 15 Test AUC:(0.7059076317200926, 0.0)
Epoch 15 a 0.40122338149029485 b 0.3796194571424538 c 0.3777445066622805
  2%|▏         | 16/1000 [25:07<25:46:20, 94.29s/it]  2%|▏         | 16/1000 [26:41<27:21:55, 100.12s/it]
[32m[I 2021-05-13 00:39:28,164][0m Trial 2 finished with value: 0.7759168106953561 and parameters: {'rank': 80.0, 'lambda': 1e-05, 'batch_size': 256, 'learning_rate': 0.05, 'alpha': 0.18360787635373776, 'gamma': 0.002349584641669074}. Best is trial 1 with value: 0.789726060908249.[0m
2021-05-13 00:39:28.873889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7644246948832688, 0.0)
Epoch 0 Test AUC:(0.7111832278485599, 0.0)
Epoch 0 a 0.4186417325850456 b 0.46776088543476596 c 0.423366661634176
  0%|          | 1/1000 [00:30<8:30:40, 30.67s/it]Epoch 1 Valid AUC:(0.7756509624456116, 0.0)
Epoch 1 Test AUC:(0.7167307346381924, 0.0)
Epoch 1 a 0.3909486287063168 b 0.42502563398691917 c 0.38903852660329113
  0%|          | 2/1000 [01:01<8:29:04, 30.61s/it]Epoch 2 Valid AUC:(0.7638254597843404, 0.0)
Epoch 2 Test AUC:(0.7134286392214758, 0.0)
Epoch 2 a 0.38404380974750363 b 0.4001098823162817 c 0.3805026862650148
  0%|          | 3/1000 [01:32<8:33:05, 30.88s/it]Epoch 3 Valid AUC:(0.7816725247538406, 0.0)
Epoch 3 Test AUC:(0.717445082655082, 0.0)
Epoch 3 a 0.37934209142000447 b 0.3883372048937505 c 0.37489998484811476
  0%|          | 4/1000 [02:03<8:35:44, 31.07s/it]Epoch 4 Valid AUC:(0.7919961596131586, 0.0)
Epoch 4 Test AUC:(0.7251270996786013, 0.0)
Epoch 4 a 0.378664804081763 b 0.3807298462958105 c 0.3691746426686164
  0%|          | 5/1000 [02:34<8:33:45, 30.98s/it]Epoch 5 Valid AUC:(0.7773778674921566, 0.0)
Epoch 5 Test AUC:(0.7151049484811642, 0.0)
Epoch 5 a 0.37660823029375845 b 0.37617577540297664 c 0.3664429794636465
  1%|          | 6/1000 [03:05<8:35:29, 31.12s/it]Epoch 6 Valid AUC:(0.7866848310584329, 0.0)
Epoch 6 Test AUC:(0.7167665544362873, 0.0)
Epoch 6 a 0.37467377620839304 b 0.37248489513031896 c 0.36394781907719953
  1%|          | 7/1000 [03:36<8:33:38, 31.04s/it]Epoch 7 Valid AUC:(0.7770775495528445, 0.0)
Epoch 7 Test AUC:(0.7140572600037507, 0.0)
Epoch 7 a 0.37438800246004134 b 0.371646482737795 c 0.3637391876789831
  1%|          | 8/1000 [04:07<8:32:27, 31.00s/it]Epoch 8 Valid AUC:(0.7773190693479095, 0.0)
Epoch 8 Test AUC:(0.7168383992545241, 0.0)
Epoch 8 a 0.3744724541902542 b 0.3701197197360377 c 0.36245424648927105
  1%|          | 9/1000 [04:38<8:32:52, 31.05s/it]Epoch 9 Valid AUC:(0.774820236006439, 0.0)
Epoch 9 Test AUC:(0.7164215932773601, 0.0)
Epoch 9 a 0.3731692498249392 b 0.36696319810805783 c 0.36021255016807585
  1%|          | 10/1000 [05:09<8:30:48, 30.96s/it]  1%|          | 10/1000 [05:39<9:20:54, 33.99s/it]
[32m[I 2021-05-13 00:45:28,397][0m Trial 3 finished with value: 0.7919961596131586 and parameters: {'rank': 65.0, 'lambda': 1e-05, 'batch_size': 1024, 'learning_rate': 0.05, 'alpha': 0.17781567509498505, 'gamma': 0.004480048592987277}. Best is trial 3 with value: 0.7919961596131586.[0m
2021-05-13 00:45:29.057578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7863742027141323, 0.0)
Epoch 0 Test AUC:(0.7244154152728616, 0.0)
Epoch 0 a 0.40820100819560845 b 0.5210668818811536 c 0.41121510786549664
  0%|          | 1/1000 [01:34<26:19:22, 94.86s/it]Epoch 1 Valid AUC:(0.7926214494707468, 0.0)
Epoch 1 Test AUC:(0.7247048211135212, 0.0)
Epoch 1 a 0.37988594390257024 b 0.5122626264930011 c 0.3830380495825044
  0%|          | 2/1000 [03:09<26:19:13, 94.94s/it]Epoch 2 Valid AUC:(0.7839852966166, 0.0)
Epoch 2 Test AUC:(0.7224780079886016, 0.0)
Epoch 2 a 0.37083863528441613 b 0.5213259663620226 c 0.3731778220571503
  0%|          | 3/1000 [04:43<26:09:55, 94.48s/it]Epoch 3 Valid AUC:(0.7860249138755019, 0.0)
Epoch 3 Test AUC:(0.7209204624376123, 0.0)
Epoch 3 a 0.36120019361406747 b 0.5391083597777115 c 0.36325129896582253
  0%|          | 4/1000 [06:18<26:11:47, 94.69s/it]Epoch 4 Valid AUC:(0.7923849266016046, 0.0)
Epoch 4 Test AUC:(0.716849228992955, 0.0)
Epoch 4 a 0.35298330851004156 b 0.6011996305804377 c 0.35551010590923626
  0%|          | 5/1000 [07:52<26:03:35, 94.29s/it]Epoch 5 Valid AUC:(0.794749968180642, 0.0)
Epoch 5 Test AUC:(0.7201475791073165, 0.0)
Epoch 5 a 0.34448447712590274 b 0.7962498525138832 c 0.3487516675496725
  1%|          | 6/1000 [09:26<26:01:41, 94.27s/it]Epoch 6 Valid AUC:(0.791641198449795, 0.0)
Epoch 6 Test AUC:(0.7162019928608466, 0.0)
Epoch 6 a 0.33434123697295276 b 1.1766622929985615 c 0.3412338287477762
  1%|          | 7/1000 [11:00<26:00:29, 94.29s/it]Epoch 7 Valid AUC:(0.7908085509047084, 0.0)
Epoch 7 Test AUC:(0.7175205701646504, 0.0)
Epoch 7 a 0.32259628323602 b 1.908563301596843 c 0.3337166267381588
  1%|          | 8/1000 [12:34<25:53:08, 93.94s/it]Epoch 8 Valid AUC:(0.7816294684000813, 0.0)
Epoch 8 Test AUC:(0.7160696631197585, 0.0)
Epoch 8 a 0.30760884878621014 b 3.720929038356727 c 0.3253617403013126
  1%|          | 9/1000 [14:07<25:50:17, 93.86s/it]Epoch 9 Valid AUC:(0.781617734146747, 0.0)
Epoch 9 Test AUC:(0.7169155199895487, 0.0)
Epoch 9 a 0.29510367381380836 b 9.142141785420163 c 0.32015496796705356
  1%|          | 10/1000 [15:41<25:49:24, 93.90s/it]Epoch 10 Valid AUC:(0.783580081680656, 0.0)
Epoch 10 Test AUC:(0.7148484080962166, 0.0)
Epoch 10 a 0.28266943418523915 b 21.32862708074466 c 0.30752012908638604
  1%|          | 11/1000 [17:16<25:52:27, 94.18s/it]  1%|          | 11/1000 [18:51<28:15:28, 102.86s/it]
[32m[I 2021-05-13 01:04:39,794][0m Trial 4 finished with value: 0.794749968180642 and parameters: {'rank': 100.0, 'lambda': 1e-05, 'batch_size': 256, 'learning_rate': 0.005, 'alpha': 0.1520477479551205, 'gamma': 0.0037155181204758412}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 01:04:40.452372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7771955726113648, 0.0)
Epoch 0 Test AUC:(0.7222537772496559, 0.0)
Epoch 0 a 0.42956655075252653 b 0.5242283508271519 c 0.42526663770857953
  0%|          | 1/1000 [01:34<26:05:57, 94.05s/it]Epoch 1 Valid AUC:(0.7864756381316624, 0.0)
Epoch 1 Test AUC:(0.7269063106929506, 0.0)
Epoch 1 a 0.3729192668823169 b 0.527704061426867 c 0.3728157122670045
  0%|          | 2/1000 [03:08<26:10:41, 94.43s/it]Epoch 2 Valid AUC:(0.7871610128515347, 0.0)
Epoch 2 Test AUC:(0.7280520482787088, 0.0)
Epoch 2 a 0.3684535154874176 b 0.5240308173765359 c 0.3687734504940524
  0%|          | 3/1000 [04:44<26:20:23, 95.11s/it]Epoch 3 Valid AUC:(0.7879721924545501, 0.0)
Epoch 3 Test AUC:(0.7274430133755307, 0.0)
Epoch 3 a 0.36696614930687294 b 0.5172377126497522 c 0.3673977032753543
  0%|          | 4/1000 [06:18<26:09:32, 94.55s/it]Epoch 4 Valid AUC:(0.7884659448694533, 0.0)
Epoch 4 Test AUC:(0.7290931953033789, 0.0)
Epoch 4 a 0.3664411876642968 b 0.5117146656127043 c 0.36694655586896047
  0%|          | 5/1000 [07:52<26:05:16, 94.39s/it]Epoch 5 Valid AUC:(0.7859540905566113, 0.0)
Epoch 5 Test AUC:(0.7270578885518502, 0.0)
Epoch 5 a 0.36585347672223567 b 0.5072849503225484 c 0.36636917673845887
  1%|          | 6/1000 [09:26<26:03:47, 94.39s/it]Epoch 6 Valid AUC:(0.7877093226238475, 0.0)
Epoch 6 Test AUC:(0.7272037458461935, 0.0)
Epoch 6 a 0.36528036199225267 b 0.5033259201097776 c 0.3657781298251699
  1%|          | 7/1000 [11:00<25:58:40, 94.18s/it]Epoch 7 Valid AUC:(0.7889712392989402, 0.0)
Epoch 7 Test AUC:(0.7277003190676947, 0.0)
Epoch 7 a 0.3652655883454221 b 0.5001079698563582 c 0.36572001523654946
  1%|          | 8/1000 [12:34<25:54:55, 94.05s/it]Epoch 8 Valid AUC:(0.7920689001931882, 0.0)
Epoch 8 Test AUC:(0.7291396481687765, 0.0)
Epoch 8 a 0.3647731419360374 b 0.49773611137324897 c 0.3652297587581803
  1%|          | 9/1000 [14:08<25:54:31, 94.12s/it]Epoch 9 Valid AUC:(0.7893073700358905, 0.0)
Epoch 9 Test AUC:(0.7290367763423308, 0.0)
Epoch 9 a 0.36485396157687816 b 0.49636180986700884 c 0.36535411839274096
  1%|          | 10/1000 [15:42<25:53:42, 94.16s/it]Epoch 10 Valid AUC:(0.7920601930593794, 0.0)
Epoch 10 Test AUC:(0.7289807635499171, 0.0)
Epoch 10 a 0.3638650050285597 b 0.4948811003979543 c 0.36433813761417533
  1%|          | 11/1000 [17:17<25:53:54, 94.27s/it]Epoch 11 Valid AUC:(0.7923856045635983, 0.0)
Epoch 11 Test AUC:(0.7288907309277778, 0.0)
Epoch 11 a 0.3640300351489238 b 0.49371933880106544 c 0.36446511139812127
  1%|          | 12/1000 [18:52<25:54:40, 94.41s/it]Epoch 12 Valid AUC:(0.7918304036728736, 0.0)
Epoch 12 Test AUC:(0.7301853827612856, 0.0)
Epoch 12 a 0.36412528579983433 b 0.49356228143156655 c 0.3646098077896855
  1%|▏         | 13/1000 [20:26<25:54:24, 94.49s/it]Epoch 13 Valid AUC:(0.7917004387431683, 0.0)
Epoch 13 Test AUC:(0.7295573092378024, 0.0)
Epoch 13 a 0.3637841174180359 b 0.492839331718038 c 0.36427175186169697
  1%|▏         | 14/1000 [22:00<25:49:54, 94.32s/it]Epoch 14 Valid AUC:(0.790220296483212, 0.0)
Epoch 14 Test AUC:(0.7290657938846643, 0.0)
Epoch 14 a 0.3633234547957088 b 0.4916411575297235 c 0.363754026067089
  2%|▏         | 15/1000 [23:34<25:44:18, 94.07s/it]Epoch 15 Valid AUC:(0.7903416824382755, 0.0)
Epoch 15 Test AUC:(0.7289913153834929, 0.0)
Epoch 15 a 0.3631355771176532 b 0.49230406353891015 c 0.36362526543303514
  2%|▏         | 16/1000 [25:08<25:42:31, 94.06s/it]Epoch 16 Valid AUC:(0.786874431011746, 0.0)
Epoch 16 Test AUC:(0.7277613512493377, 0.0)
Epoch 16 a 0.36274586728880825 b 0.49184640426511017 c 0.36327204444039035
  2%|▏         | 17/1000 [26:41<25:37:14, 93.83s/it]  2%|▏         | 17/1000 [28:16<27:14:34, 99.77s/it]
[32m[I 2021-05-13 01:33:15,544][0m Trial 5 finished with value: 0.7923856045635983 and parameters: {'rank': 75.0, 'lambda': 0.0001, 'batch_size': 256, 'learning_rate': 0.0005, 'alpha': 0.1944668917049584, 'gamma': 0.0030873932870002867}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 01:33:16.252495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5565050012423237, 0.0)
Epoch 0 Test AUC:(0.5600592688112054, 0.0)
Epoch 0 a 0.5412578818298155 b 0.5186176034471681 c 0.5168750250051098
  0%|          | 1/1000 [00:30<8:24:05, 30.28s/it]Epoch 1 Valid AUC:(0.5380283902492978, 0.0)
Epoch 1 Test AUC:(0.5320909840486504, 0.0)
Epoch 1 a 0.5002177114928922 b 0.4200579043357603 c 0.4196452278523676
  0%|          | 2/1000 [01:00<8:19:51, 30.05s/it]Epoch 2 Valid AUC:(0.5221572051401545, 0.0)
Epoch 2 Test AUC:(0.5182322793680542, 0.0)
Epoch 2 a 0.501188971703091 b 0.39499126302619136 c 0.39495715126395226
  0%|          | 3/1000 [01:30<8:19:59, 30.09s/it]Epoch 3 Valid AUC:(0.5137144175556487, 0.0)
Epoch 3 Test AUC:(0.5276487989279235, 0.0)
Epoch 3 a 0.501270127152243 b 0.38483636369628293 c 0.3848310652519426
  0%|          | 4/1000 [02:00<8:17:49, 29.99s/it]Epoch 4 Valid AUC:(0.5112132248039128, 0.0)
Epoch 4 Test AUC:(0.5109093025909681, 0.0)
Epoch 4 a 0.5013092691379208 b 0.37955017760396004 c 0.37954939421146144
  0%|          | 5/1000 [02:30<8:19:29, 30.12s/it]Epoch 5 Valid AUC:(0.506614449683614, 0.0)
Epoch 5 Test AUC:(0.509165210199387, 0.0)
Epoch 5 a 0.5013364123240593 b 0.3759120003350319 c 0.3759116416256274
  1%|          | 6/1000 [03:00<8:17:55, 30.06s/it]  1%|          | 6/1000 [03:30<9:41:35, 35.11s/it]
[32m[I 2021-05-13 01:37:06,341][0m Trial 6 finished with value: 0.5565050012423237 and parameters: {'rank': 45.0, 'lambda': 0.01, 'batch_size': 1024, 'learning_rate': 0.001, 'alpha': 0.14561503322165487, 'gamma': 0.003273735795474594}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 01:37:06.996637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.4856822424073024, 0.0)
Epoch 0 Test AUC:(0.5016404744974859, 0.0)
Epoch 0 a 0.5289797729856108 b 0.5289798130666629 c 0.5289797246036606
  0%|          | 1/1000 [02:56<48:56:35, 176.37s/it]Epoch 1 Valid AUC:(0.4853138616975578, 0.0)
Epoch 1 Test AUC:(0.4941355042439727, 0.0)
Epoch 1 a 0.5227108298383687 b 0.5227108305126293 c 0.5227108310370544
  0%|          | 2/1000 [05:53<48:57:32, 176.61s/it]Epoch 2 Valid AUC:(0.4852254075220573, 0.0)
Epoch 2 Test AUC:(0.49422155641349486, 0.0)
Epoch 2 a 0.5226385461259212 b 0.5226385464705433 c 0.5226385458262498
  0%|          | 3/1000 [08:50<48:57:56, 176.81s/it]Epoch 3 Valid AUC:(0.48524905801474316, 0.0)
Epoch 3 Test AUC:(0.49424376314914836, 0.0)
Epoch 3 a 0.5226334093382995 b 0.5226334098027902 c 0.5226334095181023
  0%|          | 4/1000 [11:47<48:55:06, 176.81s/it]Epoch 4 Valid AUC:(0.4852254075220573, 0.0)
Epoch 4 Test AUC:(0.49422155641349486, 0.0)
Epoch 4 a 0.5225650877165039 b 0.5225650877764382 c 0.5225650879712246
  0%|          | 5/1000 [14:43<48:50:50, 176.73s/it]Epoch 5 Valid AUC:(0.4852254075220573, 0.0)
Epoch 5 Test AUC:(0.49422155641349486, 0.0)
Epoch 5 a 0.5226031266875816 b 0.5226031265077787 c 0.5226031263729266
  1%|          | 6/1000 [17:40<48:46:35, 176.66s/it]  1%|          | 6/1000 [20:36<56:55:09, 206.15s/it]
[32m[I 2021-05-13 01:58:02,924][0m Trial 7 finished with value: 0.4856822424073024 and parameters: {'rank': 5.0, 'lambda': 1, 'batch_size': 128, 'learning_rate': 0.01, 'alpha': 0.1386488981125862, 'gamma': 0.004610393902117619}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 01:58:03.632851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7682385822536709, 0.0)
Epoch 0 Test AUC:(0.7151950751634084, 0.0)
Epoch 0 a 0.4409631149209961 b 0.5275382396260977 c 0.4347698464240107
  0%|          | 1/1000 [01:34<26:07:33, 94.15s/it]Epoch 1 Valid AUC:(0.7869708669401699, 0.0)
Epoch 1 Test AUC:(0.7258382026218749, 0.0)
Epoch 1 a 0.37343838535084334 b 0.571490192737138 c 0.37325156103797125
  0%|          | 2/1000 [03:08<26:10:17, 94.41s/it]Epoch 2 Valid AUC:(0.7885840550762072, 0.0)
Epoch 2 Test AUC:(0.7269707076610703, 0.0)
Epoch 2 a 0.3665344614977808 b 0.5950716390336304 c 0.367460522733224
  0%|          | 3/1000 [04:42<26:04:08, 94.13s/it]Epoch 3 Valid AUC:(0.790196167956833, 0.0)
Epoch 3 Test AUC:(0.7269010091234069, 0.0)
Epoch 3 a 0.3643924431421867 b 0.6027478129571112 c 0.36564079793526133
  0%|          | 4/1000 [06:16<25:58:50, 93.91s/it]Epoch 4 Valid AUC:(0.7899239425069364, 0.0)
Epoch 4 Test AUC:(0.7272598698005492, 0.0)
Epoch 4 a 0.3635814538304235 b 0.6075000411547885 c 0.3649389121374134
  0%|          | 5/1000 [07:49<25:56:43, 93.87s/it]Epoch 5 Valid AUC:(0.7895620761276525, 0.0)
Epoch 5 Test AUC:(0.7260377126550932, 0.0)
Epoch 5 a 0.3628171998670163 b 0.6141515038982484 c 0.36440629957307513
  1%|          | 6/1000 [09:23<25:54:37, 93.84s/it]Epoch 6 Valid AUC:(0.7890656644100332, 0.0)
Epoch 6 Test AUC:(0.7258589172222295, 0.0)
Epoch 6 a 0.3621499746498208 b 0.619602357717587 c 0.3638488723478567
  1%|          | 7/1000 [10:58<25:55:52, 94.01s/it]Epoch 7 Valid AUC:(0.7899745179590261, 0.0)
Epoch 7 Test AUC:(0.7252558893393812, 0.0)
Epoch 7 a 0.36207389339834634 b 0.6244238626429253 c 0.3638847880140397
  1%|          | 8/1000 [12:32<25:54:40, 94.03s/it]Epoch 8 Valid AUC:(0.7912774340332471, 0.0)
Epoch 8 Test AUC:(0.7264594225840851, 0.0)
Epoch 8 a 0.36148972767339627 b 0.6334921949106442 c 0.36356393810009335
  1%|          | 9/1000 [14:06<25:55:25, 94.17s/it]Epoch 9 Valid AUC:(0.7890862890647853, 0.0)
Epoch 9 Test AUC:(0.7264495120694057, 0.0)
Epoch 9 a 0.3615325771766889 b 0.6415347805925058 c 0.3638328105451116
  1%|          | 10/1000 [15:40<25:54:36, 94.22s/it]Epoch 10 Valid AUC:(0.7907150280341514, 0.0)
Epoch 10 Test AUC:(0.7264885213601455, 0.0)
Epoch 10 a 0.36062945716337896 b 0.6582543557918288 c 0.36340093966461046
  1%|          | 11/1000 [17:15<25:52:43, 94.20s/it]Epoch 11 Valid AUC:(0.7914708902958966, 0.0)
Epoch 11 Test AUC:(0.7269026423488631, 0.0)
Epoch 11 a 0.36087904444762636 b 0.6835630666801867 c 0.36447917734473284
  1%|          | 12/1000 [18:49<25:50:26, 94.16s/it]Epoch 12 Valid AUC:(0.7919014769021399, 0.0)
Epoch 12 Test AUC:(0.727201804787667, 0.0)
Epoch 12 a 0.36105807848139787 b 0.7238942819461976 c 0.3659107413450237
  1%|▏         | 13/1000 [20:23<25:50:33, 94.26s/it]Epoch 13 Valid AUC:(0.7920814815786167, 0.0)
Epoch 13 Test AUC:(0.7269855264030369, 0.0)
Epoch 13 a 0.3608716306552081 b 0.7708752752549691 c 0.3669513933495497
  1%|▏         | 14/1000 [21:57<25:45:54, 94.07s/it]Epoch 14 Valid AUC:(0.7920584129285492, 0.0)
Epoch 14 Test AUC:(0.7269847781976578, 0.0)
Epoch 14 a 0.36050011844222457 b 0.8123266578800001 c 0.3672208267618233
  2%|▏         | 15/1000 [23:31<25:44:33, 94.08s/it]Epoch 15 Valid AUC:(0.7913905960145616, 0.0)
Epoch 15 Test AUC:(0.7265451027886474, 0.0)
Epoch 15 a 0.36049176785547726 b 0.8400587356186489 c 0.3675418213699425
  2%|▏         | 16/1000 [25:05<25:42:43, 94.07s/it]Epoch 16 Valid AUC:(0.7893287713351949, 0.0)
Epoch 16 Test AUC:(0.725794135462772, 0.0)
Epoch 16 a 0.3602326382213915 b 0.8629985189653738 c 0.36747587779518104
  2%|▏         | 17/1000 [26:39<25:42:27, 94.15s/it]Epoch 17 Valid AUC:(0.7911638850112481, 0.0)
Epoch 17 Test AUC:(0.7262819397172294, 0.0)
Epoch 17 a 0.36015968645362545 b 0.8814967223096422 c 0.36750014647991364
  2%|▏         | 18/1000 [28:14<25:41:23, 94.18s/it]Epoch 18 Valid AUC:(0.7927332644992156, 0.0)
Epoch 18 Test AUC:(0.7255481212586444, 0.0)
Epoch 18 a 0.36013704574323996 b 0.8915185170394314 c 0.36740097148677475
  2%|▏         | 19/1000 [29:48<25:40:06, 94.20s/it]Epoch 19 Valid AUC:(0.7900837364827707, 0.0)
Epoch 19 Test AUC:(0.7258567196361444, 0.0)
Epoch 19 a 0.360120016444377 b 0.9091678742671636 c 0.36755157827251633
  2%|▏         | 20/1000 [31:22<25:39:47, 94.27s/it]Epoch 20 Valid AUC:(0.7905946596628741, 0.0)
Epoch 20 Test AUC:(0.7256451186039989, 0.0)
Epoch 20 a 0.36031057504221226 b 0.9196224365555784 c 0.3676676461154546
  2%|▏         | 21/1000 [32:57<25:40:52, 94.44s/it]Epoch 21 Valid AUC:(0.7939142281548548, 0.0)
Epoch 21 Test AUC:(0.726253379649042, 0.0)
Epoch 21 a 0.3598553936786095 b 0.9392279240207173 c 0.3673539718751696
  2%|▏         | 22/1000 [34:32<25:40:20, 94.50s/it]Epoch 22 Valid AUC:(0.7933409670743106, 0.0)
Epoch 22 Test AUC:(0.7267643697193348, 0.0)
Epoch 22 a 0.35980135942968566 b 0.9554654472550635 c 0.36741262542409914
  2%|▏         | 23/1000 [36:05<25:34:55, 94.26s/it]Epoch 23 Valid AUC:(0.7917625254516416, 0.0)
Epoch 23 Test AUC:(0.7255506095759625, 0.0)
Epoch 23 a 0.35983524715876436 b 0.97323254656264 c 0.36746935207599124
  2%|▏         | 24/1000 [37:39<25:31:26, 94.15s/it]Epoch 24 Valid AUC:(0.7906941009237651, 0.0)
Epoch 24 Test AUC:(0.726454723854304, 0.0)
Epoch 24 a 0.35976895992784674 b 0.9946537330236953 c 0.3675286762971034
  2%|▎         | 25/1000 [39:13<25:28:08, 94.04s/it]Epoch 25 Valid AUC:(0.7925556615255293, 0.0)
Epoch 25 Test AUC:(0.7267314786108668, 0.0)
Epoch 25 a 0.3594876579655488 b 1.0183207158831284 c 0.367309974562714
  3%|▎         | 26/1000 [40:47<25:27:47, 94.11s/it]Epoch 26 Valid AUC:(0.7908088392628342, 0.0)
Epoch 26 Test AUC:(0.7266277987226116, 0.0)
Epoch 26 a 0.3595675162266438 b 1.0439192475207615 c 0.36755229625663527
  3%|▎         | 27/1000 [42:22<25:27:42, 94.21s/it]  3%|▎         | 27/1000 [43:55<26:23:06, 97.62s/it]
[32m[I 2021-05-13 02:42:18,999][0m Trial 8 finished with value: 0.7939142281548548 and parameters: {'rank': 45.0, 'lambda': 1e-05, 'batch_size': 256, 'learning_rate': 0.0005, 'alpha': 0.10992803503589739, 'gamma': 0.004879236270986995}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 02:42:19.734531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.4956047800847134, 0.0)
Epoch 0 Test AUC:(0.5111637095217202, 0.0)
Epoch 0 a 0.5066670731639479 b 0.4247137470024692 c 0.42448949430070415
  0%|          | 1/1000 [00:51<14:21:40, 51.75s/it]Epoch 1 Valid AUC:(0.5018806486281033, 0.0)
Epoch 1 Test AUC:(0.49791205593118243, 0.0)
Epoch 1 a 0.501568615856305 b 0.3776358846927313 c 0.3776358694617657
  0%|          | 2/1000 [01:43<14:24:46, 51.99s/it]Epoch 2 Valid AUC:(0.48874547077814123, 0.0)
Epoch 2 Test AUC:(0.5060741899333208, 0.0)
Epoch 2 a 0.5015592717188945 b 0.3710028310297001 c 0.37100285945284056
  0%|          | 3/1000 [02:36<14:30:39, 52.40s/it]Epoch 3 Valid AUC:(0.49353174916778053, 0.0)
Epoch 3 Test AUC:(0.4938866596857822, 0.0)
Epoch 3 a 0.5015357464132174 b 0.368064624203043 c 0.3680647440119768
  0%|          | 4/1000 [03:29<14:28:33, 52.32s/it]Epoch 4 Valid AUC:(0.4925278309934511, 0.0)
Epoch 4 Test AUC:(0.5035065500186262, 0.0)
Epoch 4 a 0.5016453112035211 b 0.36750418097680243 c 0.3675042032236065
  0%|          | 5/1000 [04:21<14:27:32, 52.31s/it]Epoch 5 Valid AUC:(0.498303981312712, 0.0)
Epoch 5 Test AUC:(0.5058101119136106, 0.0)
Epoch 5 a 0.5015380560632203 b 0.365976596202409 c 0.36597662228693667
  1%|          | 6/1000 [05:13<14:27:14, 52.35s/it]Epoch 6 Valid AUC:(0.4936869204424596, 0.0)
Epoch 6 Test AUC:(0.49080572522822713, 0.0)
Epoch 6 a 0.5016836953954678 b 0.36493177984801817 c 0.36493172923803807
  1%|          | 7/1000 [06:05<14:25:54, 52.32s/it]  1%|          | 7/1000 [06:57<16:28:08, 59.71s/it]
[32m[I 2021-05-13 02:49:36,675][0m Trial 9 finished with value: 0.5018806486281033 and parameters: {'rank': 70.0, 'lambda': 0.01, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.17506861412184563, 'gamma': 0.003431322674861871}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 02:49:37.379738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5014938181246713, 0.0)
Epoch 0 Test AUC:(0.4979850850516479, 0.0)
Epoch 0 a 0.5075851143965538 b 0.48953939719459183 c 0.48953612949286907
  0%|          | 1/1000 [00:51<14:19:07, 51.60s/it]Epoch 1 Valid AUC:(0.497652416262697, 0.0)
Epoch 1 Test AUC:(0.4966374517263768, 0.0)
Epoch 1 a 0.5021229569221166 b 0.46491306414546624 c 0.4649130631860353
  0%|          | 2/1000 [01:43<14:25:19, 52.02s/it]Epoch 2 Valid AUC:(0.49452229136984577, 0.0)
Epoch 2 Test AUC:(0.4952489364591883, 0.0)
Epoch 2 a 0.5019310867522564 b 0.45623127399555874 c 0.45623127321602114
  0%|          | 3/1000 [02:36<14:25:19, 52.08s/it]Epoch 3 Valid AUC:(0.5018360261693227, 0.0)
Epoch 3 Test AUC:(0.5019794072587868, 0.0)
Epoch 3 a 0.5017448239163373 b 0.43691740039608606 c 0.4369173962585403
  0%|          | 4/1000 [03:28<14:25:26, 52.14s/it]Epoch 4 Valid AUC:(0.505977135932974, 0.0)
Epoch 4 Test AUC:(0.4968081280620118, 0.0)
Epoch 4 a 0.5020101853539526 b 0.41719653255023226 c 0.4171965300916906
  0%|          | 5/1000 [04:20<14:22:17, 52.00s/it]Epoch 5 Valid AUC:(0.5069728583285711, 0.0)
Epoch 5 Test AUC:(0.49300049378562205, 0.0)
Epoch 5 a 0.5017929253443866 b 0.4030497224038276 c 0.40304970789243516
  1%|          | 6/1000 [05:12<14:21:17, 51.99s/it]Epoch 6 Valid AUC:(0.497976271914628, 0.0)
Epoch 6 Test AUC:(0.489499285953403, 0.0)
Epoch 6 a 0.5020488348885082 b 0.394579436757435 c 0.39457946032345653
  1%|          | 7/1000 [06:04<14:20:55, 52.02s/it]Epoch 7 Valid AUC:(0.504810559425427, 0.0)
Epoch 7 Test AUC:(0.4957060471912629, 0.0)
Epoch 7 a 0.5017613044207245 b 0.39286263230101204 c 0.3928626033981561
  1%|          | 8/1000 [06:56<14:20:34, 52.05s/it]Epoch 8 Valid AUC:(0.5058209201610836, 0.0)
Epoch 8 Test AUC:(0.5029056299372175, 0.0)
Epoch 8 a 0.5017628362720881 b 0.387102168870404 c 0.38710214554424016
  1%|          | 9/1000 [07:48<14:21:06, 52.14s/it]Epoch 9 Valid AUC:(0.4981115246915655, 0.0)
Epoch 9 Test AUC:(0.4951920899522093, 0.0)
Epoch 9 a 0.5018737007314771 b 0.38671309403490495 c 0.38671311472263376
  1%|          | 10/1000 [08:40<14:20:23, 52.15s/it]Epoch 10 Valid AUC:(0.49662958564008725, 0.0)
Epoch 10 Test AUC:(0.5129834433394049, 0.0)
Epoch 10 a 0.5019748203711251 b 0.383342602543188 c 0.3833425817954948
  1%|          | 11/1000 [09:32<14:18:28, 52.08s/it]  1%|          | 11/1000 [10:24<15:36:16, 56.80s/it]
[32m[I 2021-05-13 03:00:22,485][0m Trial 10 finished with value: 0.5069728583285711 and parameters: {'rank': 100.0, 'lambda': 0.1, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12234166263141551, 'gamma': 0.0011524243149327804}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 03:00:23.162123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7515969734382232, 0.0)
Epoch 0 Test AUC:(0.7044152612708172, 0.0)
Epoch 0 a 0.4551307125170706 b 0.5174025601184584 c 0.4466424116366346
  0%|          | 1/1000 [01:33<25:56:53, 93.51s/it]Epoch 1 Valid AUC:(0.7835393898635286, 0.0)
Epoch 1 Test AUC:(0.7225886782528279, 0.0)
Epoch 1 a 0.3777787619733235 b 0.5426232827381349 c 0.3756539957744015
  0%|          | 2/1000 [03:06<25:53:12, 93.38s/it]Epoch 2 Valid AUC:(0.7881470643563868, 0.0)
Epoch 2 Test AUC:(0.7262053576900778, 0.0)
Epoch 2 a 0.3669355365651954 b 0.5792229305690443 c 0.3674234151240566
  0%|          | 3/1000 [04:40<25:50:34, 93.31s/it]Epoch 3 Valid AUC:(0.7909620843052326, 0.0)
Epoch 3 Test AUC:(0.7267809242977812, 0.0)
Epoch 3 a 0.36376038766363017 b 0.5992561552965905 c 0.365019470123458
  0%|          | 4/1000 [06:13<25:48:26, 93.28s/it]Epoch 4 Valid AUC:(0.7908630928830179, 0.0)
Epoch 4 Test AUC:(0.7275115831919364, 0.0)
Epoch 4 a 0.36268849541963466 b 0.6138428860387092 c 0.364374803195537
  0%|          | 5/1000 [07:46<25:46:59, 93.29s/it]Epoch 5 Valid AUC:(0.7903993643161776, 0.0)
Epoch 5 Test AUC:(0.726732363630944, 0.0)
Epoch 5 a 0.361874805609705 b 0.6263115334678704 c 0.3638181986523346
  1%|          | 6/1000 [09:19<25:45:21, 93.28s/it]Epoch 6 Valid AUC:(0.7899862637466855, 0.0)
Epoch 6 Test AUC:(0.7259118687857775, 0.0)
Epoch 6 a 0.3612335301500931 b 0.6391785468613838 c 0.36351797359450244
  1%|          | 7/1000 [10:52<25:41:43, 93.16s/it]Epoch 7 Valid AUC:(0.7911204454615793, 0.0)
Epoch 7 Test AUC:(0.7255450685806974, 0.0)
Epoch 7 a 0.36119929543683227 b 0.6526646455168964 c 0.36387561672410257
  1%|          | 8/1000 [12:25<25:36:08, 92.91s/it]Epoch 8 Valid AUC:(0.7915993762688142, 0.0)
Epoch 8 Test AUC:(0.7261135165486505, 0.0)
Epoch 8 a 0.3606442723955427 b 0.6748916125393489 c 0.3639650355942053
  1%|          | 9/1000 [13:58<25:34:57, 92.93s/it]Epoch 9 Valid AUC:(0.7896602819341733, 0.0)
Epoch 9 Test AUC:(0.7261277324508546, 0.0)
Epoch 9 a 0.36075836995717747 b 0.7105775868868683 c 0.36527585902324383
  1%|          | 10/1000 [15:30<25:32:13, 92.86s/it]Epoch 10 Valid AUC:(0.7915328590979362, 0.0)
Epoch 10 Test AUC:(0.7263427410240697, 0.0)
Epoch 10 a 0.3598905683343319 b 0.7833870952158147 c 0.36652379442508554
  1%|          | 11/1000 [17:03<25:32:10, 92.95s/it]Epoch 11 Valid AUC:(0.7915683297105983, 0.0)
Epoch 11 Test AUC:(0.7264850582381048, 0.0)
Epoch 11 a 0.36015204467643913 b 0.8563758627749545 c 0.36836185358779533
  1%|          | 12/1000 [18:37<25:31:45, 93.02s/it]Epoch 12 Valid AUC:(0.79229506523845, 0.0)
Epoch 12 Test AUC:(0.7269496082693779, 0.0)
Epoch 12 a 0.3603711130033796 b 0.9103049643082878 c 0.36923155854165673
  1%|▏         | 13/1000 [20:09<25:29:19, 92.97s/it]Epoch 13 Valid AUC:(0.7916631328912341, 0.0)
Epoch 13 Test AUC:(0.7266165799173835, 0.0)
Epoch 13 a 0.3602190573570474 b 0.9455055767741481 c 0.369249169645415
  1%|▏         | 14/1000 [21:43<25:28:17, 93.00s/it]Epoch 14 Valid AUC:(0.7924698141074863, 0.0)
Epoch 14 Test AUC:(0.7265510798807621, 0.0)
Epoch 14 a 0.3598664094444732 b 0.9758571648381845 c 0.36896558021995385
  2%|▏         | 15/1000 [23:16<25:30:13, 93.21s/it]Epoch 15 Valid AUC:(0.7914846584352119, 0.0)
Epoch 15 Test AUC:(0.7259809901364341, 0.0)
Epoch 15 a 0.35993867060188317 b 0.99920421508956 c 0.3690676097598834
  2%|▏         | 16/1000 [24:49<25:28:31, 93.20s/it]Epoch 16 Valid AUC:(0.7898803530110422, 0.0)
Epoch 16 Test AUC:(0.7255807601150132, 0.0)
Epoch 16 a 0.3597033839350495 b 1.0241177314723762 c 0.36890536834536425
  2%|▏         | 17/1000 [26:23<25:28:46, 93.31s/it]Epoch 17 Valid AUC:(0.791610572253647, 0.0)
Epoch 17 Test AUC:(0.725745467909452, 0.0)
Epoch 17 a 0.35974425302304974 b 1.0480252208724108 c 0.3689929762896398
  2%|▏         | 18/1000 [27:56<25:27:43, 93.34s/it]Epoch 18 Valid AUC:(0.7931267080156669, 0.0)
Epoch 18 Test AUC:(0.7250706593402567, 0.0)
Epoch 18 a 0.3597128358585254 b 1.0648811809133956 c 0.3689495525969346
  2%|▏         | 19/1000 [29:30<25:26:15, 93.35s/it]Epoch 19 Valid AUC:(0.7899570754963917, 0.0)
Epoch 19 Test AUC:(0.7251588321375964, 0.0)
Epoch 19 a 0.3597380850816397 b 1.0941764629582764 c 0.36913771888379837
  2%|▏         | 20/1000 [31:03<25:21:36, 93.16s/it]Epoch 20 Valid AUC:(0.7908931449260976, 0.0)
Epoch 20 Test AUC:(0.7252661376153461, 0.0)
Epoch 20 a 0.3599662957656791 b 1.1160920014083986 c 0.3693298566149514
  2%|▏         | 21/1000 [32:35<25:18:45, 93.08s/it]Epoch 21 Valid AUC:(0.7937436252348722, 0.0)
Epoch 21 Test AUC:(0.7254315893397049, 0.0)
Epoch 21 a 0.3595441618495784 b 1.1538237273333298 c 0.36909094731692577
  2%|▏         | 22/1000 [34:08<25:16:47, 93.06s/it]Epoch 22 Valid AUC:(0.7932214624958192, 0.0)
Epoch 22 Test AUC:(0.7257585379885612, 0.0)
Epoch 22 a 0.35955581239891243 b 1.1909265740056874 c 0.36931167045229635
  2%|▏         | 23/1000 [35:41<25:13:00, 92.92s/it]Epoch 23 Valid AUC:(0.7916466721278193, 0.0)
Epoch 23 Test AUC:(0.725405068665608, 0.0)
Epoch 23 a 0.3596315594686109 b 1.233477281372792 c 0.36946596103294993
  2%|▏         | 24/1000 [37:14<25:10:16, 92.84s/it]Epoch 24 Valid AUC:(0.7906100938713609, 0.0)
Epoch 24 Test AUC:(0.7255256750972696, 0.0)
Epoch 24 a 0.3596319785900039 b 1.2877710124616413 c 0.36970402450268897
  2%|▎         | 25/1000 [38:46<25:06:04, 92.68s/it]Epoch 25 Valid AUC:(0.79272336292197, 0.0)
Epoch 25 Test AUC:(0.7261397122878398, 0.0)
Epoch 25 a 0.359408657285769 b 1.351985618981797 c 0.3696483996972232
  3%|▎         | 26/1000 [40:19<25:04:50, 92.70s/it]Epoch 26 Valid AUC:(0.7905044420172351, 0.0)
Epoch 26 Test AUC:(0.726037973458111, 0.0)
Epoch 26 a 0.35956200981284053 b 1.4319295192388461 c 0.37010743434520316
  3%|▎         | 27/1000 [41:52<25:03:51, 92.74s/it]  3%|▎         | 27/1000 [43:24<26:04:08, 96.45s/it]
[32m[I 2021-05-13 03:44:06,456][0m Trial 11 finished with value: 0.7937436252348722 and parameters: {'rank': 30.0, 'lambda': 1e-05, 'batch_size': 256, 'learning_rate': 0.0005, 'alpha': 0.10323187186510167, 'gamma': 0.0049536543335693016}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 03:44:07.230496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7506518508449574, 0.0)
Epoch 0 Test AUC:(0.7039261401748925, 0.0)
Epoch 0 a 0.4554178449409588 b 0.5108015584334041 c 0.4464185663332162
  0%|          | 1/1000 [01:32<25:39:42, 92.47s/it]Epoch 1 Valid AUC:(0.7830307607325151, 0.0)
Epoch 1 Test AUC:(0.7223480682292676, 0.0)
Epoch 1 a 0.3780570057196396 b 0.521518004342344 c 0.3751805025626956
  0%|          | 2/1000 [03:04<25:33:03, 92.17s/it]Epoch 2 Valid AUC:(0.7879377125122492, 0.0)
Epoch 2 Test AUC:(0.7261114172981296, 0.0)
Epoch 2 a 0.36706355972669014 b 0.5491112315318953 c 0.3666431519167284
  0%|          | 3/1000 [04:36<25:29:28, 92.04s/it]Epoch 3 Valid AUC:(0.7909902908563069, 0.0)
Epoch 3 Test AUC:(0.7268240722331325, 0.0)
Epoch 3 a 0.3638049678303586 b 0.5604969156939739 c 0.3639169159969334
  0%|          | 4/1000 [06:08<25:27:19, 92.01s/it]Epoch 4 Valid AUC:(0.7910268521034806, 0.0)
Epoch 4 Test AUC:(0.7276409457642637, 0.0)
Epoch 4 a 0.36268796140639115 b 0.565538337233081 c 0.3629852584909865
  0%|          | 5/1000 [07:40<25:24:54, 91.95s/it]Epoch 5 Valid AUC:(0.7906120944359585, 0.0)
Epoch 5 Test AUC:(0.7269453370855278, 0.0)
Epoch 5 a 0.36184990675876316 b 0.5670294865396182 c 0.36214838220439927
  1%|          | 6/1000 [09:11<25:21:49, 91.86s/it]Epoch 6 Valid AUC:(0.7902888603559877, 0.0)
Epoch 6 Test AUC:(0.7262170040412368, 0.0)
Epoch 6 a 0.36119385798212506 b 0.5688533972446588 c 0.36156826638719686
  1%|          | 7/1000 [10:43<25:18:48, 91.77s/it]Epoch 7 Valid AUC:(0.7914336856897043, 0.0)
Epoch 7 Test AUC:(0.725935221344526, 0.0)
Epoch 7 a 0.3611494119258474 b 0.5698184153923327 c 0.3615633266972344
  1%|          | 8/1000 [12:15<25:21:09, 92.01s/it]Epoch 8 Valid AUC:(0.7919350123113797, 0.0)
Epoch 8 Test AUC:(0.7265682244725932, 0.0)
Epoch 8 a 0.3605829979212471 b 0.569841169375529 c 0.36097602435280857
  1%|          | 9/1000 [13:48<25:23:42, 92.25s/it]Epoch 9 Valid AUC:(0.7898559720111042, 0.0)
Epoch 9 Test AUC:(0.7267096010855801, 0.0)
Epoch 9 a 0.3606959911179495 b 0.5704316537025229 c 0.3610996253473658
  1%|          | 10/1000 [15:20<25:19:50, 92.11s/it]Epoch 10 Valid AUC:(0.7914569119755474, 0.0)
Epoch 10 Test AUC:(0.7269761503207712, 0.0)
Epoch 10 a 0.3598222608417572 b 0.5730668157638918 c 0.36026389701985256
  1%|          | 11/1000 [16:53<25:21:11, 92.29s/it]Epoch 11 Valid AUC:(0.7914781582022595, 0.0)
Epoch 11 Test AUC:(0.7272173802859315, 0.0)
Epoch 11 a 0.36009197926497316 b 0.5725960202020419 c 0.3604916880428191
  1%|          | 12/1000 [18:25<25:19:27, 92.28s/it]Epoch 12 Valid AUC:(0.7920663972446559, 0.0)
Epoch 12 Test AUC:(0.7277266687234191, 0.0)
Epoch 12 a 0.3603118882332769 b 0.574102477288582 c 0.3607648629058055
  1%|▏         | 13/1000 [19:57<25:16:43, 92.20s/it]Epoch 13 Valid AUC:(0.7917310880079663, 0.0)
Epoch 13 Test AUC:(0.7276134588363631, 0.0)
Epoch 13 a 0.3601666802251843 b 0.5751687283487147 c 0.36064305916518513
  1%|▏         | 14/1000 [21:29<25:16:19, 92.27s/it]Epoch 14 Valid AUC:(0.7924434325429508, 0.0)
Epoch 14 Test AUC:(0.7275978705117206, 0.0)
Epoch 14 a 0.35982154885408146 b 0.5761951869522302 c 0.3602655229853912
  2%|▏         | 15/1000 [23:02<25:16:45, 92.39s/it]Epoch 15 Valid AUC:(0.7915510987105896, 0.0)
Epoch 15 Test AUC:(0.7271244660042175, 0.0)
Epoch 15 a 0.35987488970430326 b 0.5774980655138642 c 0.3603625862111508
  2%|▏         | 16/1000 [24:35<25:17:13, 92.51s/it]Epoch 16 Valid AUC:(0.7897917271022579, 0.0)
Epoch 16 Test AUC:(0.7267190455751948, 0.0)
Epoch 16 a 0.3596208202886869 b 0.5786860999566928 c 0.36011234597421027
  2%|▏         | 17/1000 [26:07<25:15:01, 92.47s/it]Epoch 17 Valid AUC:(0.7914419980932786, 0.0)
Epoch 17 Test AUC:(0.7268915133282805, 0.0)
Epoch 17 a 0.3596246145380815 b 0.581198538393082 c 0.36014605866711386
  2%|▏         | 18/1000 [27:40<25:15:47, 92.62s/it]Epoch 18 Valid AUC:(0.7929900352351587, 0.0)
Epoch 18 Test AUC:(0.7263622627712769, 0.0)
Epoch 18 a 0.35958535849328493 b 0.5812024966451963 c 0.36009090704097596
  2%|▏         | 19/1000 [29:13<25:14:48, 92.65s/it]Epoch 19 Valid AUC:(0.7903078984002516, 0.0)
Epoch 19 Test AUC:(0.7264939340916313, 0.0)
Epoch 19 a 0.35956683455098803 b 0.5834615532781037 c 0.3601163697974303
  2%|▏         | 20/1000 [30:45<25:10:22, 92.47s/it]Epoch 20 Valid AUC:(0.7911432155007877, 0.0)
Epoch 20 Test AUC:(0.7267432019202935, 0.0)
Epoch 20 a 0.35976620261338155 b 0.583468432157812 c 0.36030295371289706
  2%|▏         | 21/1000 [32:17<25:06:09, 92.31s/it]Epoch 21 Valid AUC:(0.7942194674061813, 0.0)
Epoch 21 Test AUC:(0.7269893059090665, 0.0)
Epoch 21 a 0.3592799859087712 b 0.5860706830408492 c 0.3598166462221376
  2%|▏         | 22/1000 [33:49<25:04:44, 92.32s/it]Epoch 22 Valid AUC:(0.7932966483527558, 0.0)
Epoch 22 Test AUC:(0.7271989787090635, 0.0)
Epoch 22 a 0.3592478462028312 b 0.5883764733730907 c 0.35984176214432095
  2%|▏         | 23/1000 [35:22<25:07:00, 92.55s/it]Epoch 23 Valid AUC:(0.7922833604617241, 0.0)
Epoch 23 Test AUC:(0.7270802363776608, 0.0)
Epoch 23 a 0.35926572465800666 b 0.5909508722768703 c 0.35986575996971704
  2%|▏         | 24/1000 [36:55<25:04:26, 92.49s/it]Epoch 24 Valid AUC:(0.7914365141625209, 0.0)
Epoch 24 Test AUC:(0.7273291578941189, 0.0)
Epoch 24 a 0.359188951387012 b 0.5919118089455234 c 0.35977484267842125
  2%|▎         | 25/1000 [38:27<25:03:02, 92.50s/it]Epoch 25 Valid AUC:(0.7930755225259422, 0.0)
Epoch 25 Test AUC:(0.7279225488916836, 0.0)
Epoch 25 a 0.35889969481308936 b 0.5932909840909049 c 0.3594758892263205
  3%|▎         | 26/1000 [40:00<25:01:14, 92.48s/it]Epoch 26 Valid AUC:(0.7913002438017972, 0.0)
Epoch 26 Test AUC:(0.728040183879125, 0.0)
Epoch 26 a 0.3589340752998828 b 0.5965453377911742 c 0.35957556357326165
  3%|▎         | 27/1000 [41:32<24:58:39, 92.41s/it]  3%|▎         | 27/1000 [43:05<25:52:48, 95.75s/it]
[32m[I 2021-05-13 04:27:31,567][0m Trial 12 finished with value: 0.7942194674061813 and parameters: {'rank': 30.0, 'lambda': 1e-05, 'batch_size': 256, 'learning_rate': 0.0005, 'alpha': 0.160250042406817, 'gamma': 0.0038789804046782147}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 04:27:32.241725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5868924548043621, 0.0)
Epoch 0 Test AUC:(0.5490575029994805, 0.0)
Epoch 0 a 0.6180844313541888 b 0.6179910632266365 c 0.6024982527168224
  0%|          | 1/1000 [01:31<25:26:22, 91.67s/it]Epoch 1 Valid AUC:(0.6300288503714657, 0.0)
Epoch 1 Test AUC:(0.5984741894732813, 0.0)
Epoch 1 a 0.47766912028463315 b 0.4912891781905767 c 0.4602259546818148
  0%|          | 2/1000 [03:03<25:25:27, 91.71s/it]Epoch 2 Valid AUC:(0.6579545521654254, 0.0)
Epoch 2 Test AUC:(0.6278174106442579, 0.0)
Epoch 2 a 0.44847856450008916 b 0.47548134633952704 c 0.43445081307254807
  0%|          | 3/1000 [04:35<25:25:04, 91.78s/it]Epoch 3 Valid AUC:(0.6830478786961386, 0.0)
Epoch 3 Test AUC:(0.6487312003725259, 0.0)
Epoch 3 a 0.4319229998159217 b 0.47237097209608053 c 0.41626485576572075
  0%|          | 4/1000 [06:07<25:26:57, 91.99s/it]Epoch 4 Valid AUC:(0.7023623853521413, 0.0)
Epoch 4 Test AUC:(0.6639589755313711, 0.0)
Epoch 4 a 0.4186966369749315 b 0.4727105021596674 c 0.4027281727049672
  0%|          | 5/1000 [07:40<25:29:09, 92.21s/it]Epoch 5 Valid AUC:(0.7178782440442948, 0.0)
Epoch 5 Test AUC:(0.6755676598939159, 0.0)
Epoch 5 a 0.4086377008160355 b 0.4741197813984374 c 0.3930737984852052
  1%|          | 6/1000 [09:11<25:24:59, 92.05s/it]Epoch 6 Valid AUC:(0.7303255762656441, 0.0)
Epoch 6 Test AUC:(0.6845630039572069, 0.0)
Epoch 6 a 0.40036997684770426 b 0.47624849871370634 c 0.38566247651154845
  1%|          | 7/1000 [10:44<25:23:37, 92.06s/it]Epoch 7 Valid AUC:(0.7408414396227913, 0.0)
Epoch 7 Test AUC:(0.6917041625516974, 0.0)
Epoch 7 a 0.39370970973666286 b 0.4791554423944811 c 0.38010366479875574
  1%|          | 8/1000 [12:15<25:20:07, 91.94s/it]Epoch 8 Valid AUC:(0.7494993205821182, 0.0)
Epoch 8 Test AUC:(0.6975686732718323, 0.0)
Epoch 8 a 0.3879652146542336 b 0.48118682268639684 c 0.375509748216606
  1%|          | 9/1000 [13:47<25:20:22, 92.05s/it]Epoch 9 Valid AUC:(0.7565230260602132, 0.0)
Epoch 9 Test AUC:(0.7027223504026301, 0.0)
Epoch 9 a 0.38332154447403954 b 0.48394767268442773 c 0.37226415960721565
  1%|          | 10/1000 [15:20<25:18:47, 92.05s/it]Epoch 10 Valid AUC:(0.7630507850384651, 0.0)
Epoch 10 Test AUC:(0.7069148401487639, 0.0)
Epoch 10 a 0.37833108502614426 b 0.4869051996910836 c 0.3683622952258323
  1%|          | 11/1000 [16:52<25:20:36, 92.25s/it]Epoch 11 Valid AUC:(0.7677216753220584, 0.0)
Epoch 11 Test AUC:(0.7103876161765749, 0.0)
Epoch 11 a 0.37524961019066017 b 0.4905325168635044 c 0.36661246508899586
  1%|          | 12/1000 [18:25<25:21:26, 92.39s/it]Epoch 12 Valid AUC:(0.7723378185726747, 0.0)
Epoch 12 Test AUC:(0.71325487172876, 0.0)
Epoch 12 a 0.3724960420033342 b 0.49433656747432303 c 0.3650377692890839
  1%|▏         | 13/1000 [19:57<25:19:30, 92.37s/it]Epoch 13 Valid AUC:(0.7756452298860698, 0.0)
Epoch 13 Test AUC:(0.715556163354851, 0.0)
Epoch 13 a 0.3699242714005457 b 0.4979869542827069 c 0.3634860340198521
  1%|▏         | 14/1000 [21:30<25:17:37, 92.35s/it]Epoch 14 Valid AUC:(0.7787557425815886, 0.0)
Epoch 14 Test AUC:(0.7176322793654888, 0.0)
Epoch 14 a 0.36753542277534723 b 0.5013513773439876 c 0.36186564259485937
  2%|▏         | 15/1000 [23:03<25:19:12, 92.54s/it]Epoch 15 Valid AUC:(0.7813483371696669, 0.0)
Epoch 15 Test AUC:(0.719155963278747, 0.0)
Epoch 15 a 0.3657123060893245 b 0.5056399106679548 c 0.3609281142412777
  2%|▏         | 16/1000 [24:35<25:19:12, 92.63s/it]Epoch 16 Valid AUC:(0.7833448122081674, 0.0)
Epoch 16 Test AUC:(0.7204562886467585, 0.0)
Epoch 16 a 0.3639081925513519 b 0.5101735116370487 c 0.3598807477195498
  2%|▏         | 17/1000 [26:09<25:20:09, 92.79s/it]Epoch 17 Valid AUC:(0.7853057141066723, 0.0)
Epoch 17 Test AUC:(0.7215873827843817, 0.0)
Epoch 17 a 0.36276319646979244 b 0.5140820720366069 c 0.3592261870802049
  2%|▏         | 18/1000 [27:41<25:16:40, 92.67s/it]Epoch 18 Valid AUC:(0.7868477880025098, 0.0)
Epoch 18 Test AUC:(0.7222908497573286, 0.0)
Epoch 18 a 0.3615717192291014 b 0.5181260896280737 c 0.3586706054402549
  2%|▏         | 19/1000 [29:13<25:11:28, 92.44s/it]Epoch 19 Valid AUC:(0.7876236725709219, 0.0)
Epoch 19 Test AUC:(0.7232284579839006, 0.0)
Epoch 19 a 0.36050364830844117 b 0.5225740017545535 c 0.35807560297325103
  2%|▏         | 20/1000 [30:45<25:10:39, 92.49s/it]Epoch 20 Valid AUC:(0.7885311855750275, 0.0)
Epoch 20 Test AUC:(0.7238038920523654, 0.0)
Epoch 20 a 0.35997233502341947 b 0.5265821941661643 c 0.357990434052239
  2%|▏         | 21/1000 [32:18<25:10:37, 92.58s/it]Epoch 21 Valid AUC:(0.7896532677829611, 0.0)
Epoch 21 Test AUC:(0.7244442874495786, 0.0)
Epoch 21 a 0.35892873663657626 b 0.5305751443388956 c 0.3572314251176788
  2%|▏         | 22/1000 [33:51<25:10:06, 92.64s/it]Epoch 22 Valid AUC:(0.7905534206061035, 0.0)
Epoch 22 Test AUC:(0.7248808503242117, 0.0)
Epoch 22 a 0.3582679149610416 b 0.5342113519878214 c 0.35683812722713654
  2%|▏         | 23/1000 [35:23<25:07:21, 92.57s/it]Epoch 23 Valid AUC:(0.7909395206022833, 0.0)
Epoch 23 Test AUC:(0.7250925368655434, 0.0)
Epoch 23 a 0.3578146993514278 b 0.5380532940028898 c 0.3566830676925974
  2%|▏         | 24/1000 [36:57<25:08:50, 92.76s/it]Epoch 24 Valid AUC:(0.7915392016951132, 0.0)
Epoch 24 Test AUC:(0.7255320882862338, 0.0)
Epoch 24 a 0.35734444751705924 b 0.5415659534259581 c 0.35643971089266197
  2%|▎         | 25/1000 [38:29<25:05:45, 92.66s/it]Epoch 25 Valid AUC:(0.7915953507893774, 0.0)
Epoch 25 Test AUC:(0.7256907805094243, 0.0)
Epoch 25 a 0.35678832050060605 b 0.5450990379936018 c 0.3560458562623567
  3%|▎         | 26/1000 [40:01<25:02:16, 92.54s/it]Epoch 26 Valid AUC:(0.7920838204834152, 0.0)
Epoch 26 Test AUC:(0.7262399675331881, 0.0)
Epoch 26 a 0.3565650143673722 b 0.5485642256151503 c 0.35592671380316465
  3%|▎         | 27/1000 [41:34<25:01:43, 92.60s/it]Epoch 27 Valid AUC:(0.7924884061578491, 0.0)
Epoch 27 Test AUC:(0.726478636498222, 0.0)
Epoch 27 a 0.3560136247508722 b 0.551434485305483 c 0.35552374418952337
  3%|▎         | 28/1000 [43:06<24:58:53, 92.52s/it]Epoch 28 Valid AUC:(0.7926938440210253, 0.0)
Epoch 28 Test AUC:(0.7265449274948157, 0.0)
Epoch 28 a 0.35643100903427577 b 0.5555326420536464 c 0.3560670869691031
  3%|▎         | 29/1000 [44:40<25:01:11, 92.76s/it]Epoch 29 Valid AUC:(0.7932527833146525, 0.0)
Epoch 29 Test AUC:(0.726557296398598, 0.0)
Epoch 29 a 0.35582491041908804 b 0.5586539286243124 c 0.3555716931580058
  3%|▎         | 30/1000 [46:13<25:02:30, 92.94s/it]Epoch 30 Valid AUC:(0.7932963933160134, 0.0)
Epoch 30 Test AUC:(0.726509291541471, 0.0)
Epoch 30 a 0.35541565488401794 b 0.5624929336115149 c 0.35528591533062204
  3%|▎         | 31/1000 [47:45<24:58:15, 92.77s/it]Epoch 31 Valid AUC:(0.7932149097176083, 0.0)
Epoch 31 Test AUC:(0.726353506630611, 0.0)
Epoch 31 a 0.3554385356620044 b 0.5643992774803154 c 0.35534862463383127
  3%|▎         | 32/1000 [49:19<24:58:08, 92.86s/it]Epoch 32 Valid AUC:(0.7929611007400157, 0.0)
Epoch 32 Test AUC:(0.7264988551452966, 0.0)
Epoch 32 a 0.3554408121816589 b 0.5668807736704767 c 0.35538797173461684
  3%|▎         | 33/1000 [50:51<24:54:22, 92.72s/it]Epoch 33 Valid AUC:(0.7931836311913002, 0.0)
Epoch 33 Test AUC:(0.7266330447111844, 0.0)
Epoch 33 a 0.35537732852776527 b 0.5693437393522358 c 0.35539015770798
  3%|▎         | 34/1000 [52:23<24:48:51, 92.48s/it]Epoch 34 Valid AUC:(0.7934874606917892, 0.0)
Epoch 34 Test AUC:(0.726786807329791, 0.0)
Epoch 34 a 0.3553730777091903 b 0.5727228162514132 c 0.35543042604232455
  4%|▎         | 35/1000 [53:55<24:46:58, 92.45s/it]Epoch 35 Valid AUC:(0.7934223519901571, 0.0)
Epoch 35 Test AUC:(0.7266473204698187, 0.0)
Epoch 35 a 0.35500543847889965 b 0.574522283775226 c 0.35510469631290054
  4%|▎         | 36/1000 [55:28<24:46:24, 92.52s/it]Epoch 36 Valid AUC:(0.7933037458074267, 0.0)
Epoch 36 Test AUC:(0.7270434546012213, 0.0)
Epoch 36 a 0.3551674314307975 b 0.5766785093836142 c 0.35528180911627333
  4%|▎         | 37/1000 [57:01<24:48:28, 92.74s/it]Epoch 37 Valid AUC:(0.7939184497178171, 0.0)
Epoch 37 Test AUC:(0.7269300565939556, 0.0)
Epoch 37 a 0.35503941696414526 b 0.5801012978947139 c 0.3551683570717422
  4%|▍         | 38/1000 [58:35<24:50:12, 92.94s/it]Epoch 38 Valid AUC:(0.7933303580584629, 0.0)
Epoch 38 Test AUC:(0.7268697597913139, 0.0)
Epoch 38 a 0.35530139613799167 b 0.5816967260070011 c 0.3555037486900986
  4%|▍         | 39/1000 [1:00:07<24:47:08, 92.85s/it]Epoch 39 Valid AUC:(0.7933422320052893, 0.0)
Epoch 39 Test AUC:(0.7268611361898866, 0.0)
Epoch 39 a 0.3550293202131567 b 0.5828403446156254 c 0.35520536912758827
  4%|▍         | 40/1000 [1:01:39<24:42:24, 92.65s/it]Epoch 40 Valid AUC:(0.7934749280068443, 0.0)
Epoch 40 Test AUC:(0.7271407597796461, 0.0)
Epoch 40 a 0.35512129227880024 b 0.5859124444020346 c 0.35532816135187745
  4%|▍         | 41/1000 [1:03:12<24:38:43, 92.52s/it]Epoch 41 Valid AUC:(0.79396273639958, 0.0)
Epoch 41 Test AUC:(0.7270352884739402, 0.0)
Epoch 41 a 0.3549771414436325 b 0.5877712121312048 c 0.3551876612412378
  4%|▍         | 42/1000 [1:04:45<24:39:26, 92.66s/it]Epoch 42 Valid AUC:(0.7938654917868121, 0.0)
Epoch 42 Test AUC:(0.7271059447144889, 0.0)
Epoch 42 a 0.3544401949500174 b 0.5908804445919137 c 0.3546741868648491
  4%|▍         | 43/1000 [1:06:17<24:37:43, 92.65s/it]Epoch 43 Valid AUC:(0.7938974662173973, 0.0)
Epoch 43 Test AUC:(0.7272025316157497, 0.0)
Epoch 43 a 0.3547387931428445 b 0.5920669319524132 c 0.3549824696431457
  4%|▍         | 44/1000 [1:07:50<24:35:33, 92.61s/it]Epoch 44 Valid AUC:(0.7936206206295289, 0.0)
Epoch 44 Test AUC:(0.7271441630452564, 0.0)
Epoch 44 a 0.35519603881197914 b 0.5944080505092859 c 0.3554698652184945
  4%|▍         | 45/1000 [1:09:23<24:36:47, 92.78s/it]Epoch 45 Valid AUC:(0.7936441609053311, 0.0)
Epoch 45 Test AUC:(0.7273042618945598, 0.0)
Epoch 45 a 0.3546656567745765 b 0.5962929456406676 c 0.354944795939764
  5%|▍         | 46/1000 [1:10:57<24:39:16, 93.04s/it]Epoch 46 Valid AUC:(0.7940743271495065, 0.0)
Epoch 46 Test AUC:(0.7273264173247015, 0.0)
Epoch 46 a 0.3545538340535922 b 0.5997025431761559 c 0.35485571766763147
  5%|▍         | 47/1000 [1:12:29<24:35:29, 92.90s/it]Epoch 47 Valid AUC:(0.7936344387509193, 0.0)
Epoch 47 Test AUC:(0.7273003370229136, 0.0)
Epoch 47 a 0.35468490850517687 b 0.6009730556361392 c 0.3550026684819573
  5%|▍         | 48/1000 [1:14:02<24:32:23, 92.80s/it]Epoch 48 Valid AUC:(0.7940594491518047, 0.0)
Epoch 48 Test AUC:(0.7272460215878458, 0.0)
Epoch 48 a 0.35458186058930946 b 0.603724740460605 c 0.3549012291719256
  5%|▍         | 49/1000 [1:15:34<24:29:56, 92.74s/it]Epoch 49 Valid AUC:(0.7939551109291411, 0.0)
Epoch 49 Test AUC:(0.7273942859657805, 0.0)
Epoch 49 a 0.3550910328475522 b 0.6051385087266534 c 0.35541639808318026
  5%|▌         | 50/1000 [1:17:07<24:28:43, 92.76s/it]Epoch 50 Valid AUC:(0.7942405034518595, 0.0)
Epoch 50 Test AUC:(0.7275296812111935, 0.0)
Epoch 50 a 0.35481588641402706 b 0.6082456472294191 c 0.35515945739069693
  5%|▌         | 51/1000 [1:18:40<24:27:56, 92.81s/it]Epoch 51 Valid AUC:(0.7937307657440512, 0.0)
Epoch 51 Test AUC:(0.7275240076766898, 0.0)
Epoch 51 a 0.3547428634085166 b 0.6104455998605886 c 0.355128105467474
  5%|▌         | 52/1000 [1:20:13<24:29:14, 92.99s/it]Epoch 52 Valid AUC:(0.7941457182135071, 0.0)
Epoch 52 Test AUC:(0.727515734662926, 0.0)
Epoch 52 a 0.35470174939579646 b 0.6133968484113873 c 0.35505652940369226
  5%|▌         | 53/1000 [1:21:47<24:29:14, 93.09s/it]Epoch 53 Valid AUC:(0.7942026247284487, 0.0)
Epoch 53 Test AUC:(0.7273560676350129, 0.0)
Epoch 53 a 0.3545856656622839 b 0.6170638048912678 c 0.35497255332513117
  5%|▌         | 54/1000 [1:23:20<24:29:58, 93.23s/it]Epoch 54 Valid AUC:(0.7941032603630579, 0.0)
Epoch 54 Test AUC:(0.7274613465450499, 0.0)
Epoch 54 a 0.35449355295006657 b 0.6201872097054717 c 0.3549390180969622
  6%|▌         | 55/1000 [1:24:53<24:25:51, 93.07s/it]Epoch 55 Valid AUC:(0.7936624030811679, 0.0)
Epoch 55 Test AUC:(0.7272871985364555, 0.0)
Epoch 55 a 0.354889332078832 b 0.6213466548463948 c 0.35528902736468093
  6%|▌         | 56/1000 [1:26:26<24:24:39, 93.09s/it]  6%|▌         | 56/1000 [1:27:59<24:43:15, 94.27s/it]
[32m[I 2021-05-13 05:55:50,622][0m Trial 13 finished with value: 0.7942405034518595 and parameters: {'rank': 15.0, 'lambda': 1e-05, 'batch_size': 256, 'learning_rate': 0.0001, 'alpha': 0.16230214822552472, 'gamma': 0.003841463674543816}. Best is trial 4 with value: 0.794749968180642.[0m
2021-05-13 05:55:51.289370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5062287264753852, 0.0)
Epoch 0 Test AUC:(0.49478878160008544, 0.0)
Epoch 0 a 0.6704657291262682 b 0.6674664139267904 c 0.6672830137928247
  0%|          | 1/1000 [01:33<25:49:56, 93.09s/it]Epoch 1 Valid AUC:(0.516264063443668, 0.0)
Epoch 1 Test AUC:(0.5028473853550444, 0.0)
Epoch 1 a 0.5831027892034059 b 0.5643523217926563 c 0.5639929363665207
  0%|          | 2/1000 [03:05<25:38:59, 92.52s/it]Epoch 2 Valid AUC:(0.5290767159338529, 0.0)
Epoch 2 Test AUC:(0.5145527763317106, 0.0)
Epoch 2 a 0.5208035007988663 b 0.5013954645131435 c 0.5010264199264572
  0%|          | 3/1000 [04:38<25:42:27, 92.83s/it]Epoch 3 Valid AUC:(0.5427303796363655, 0.0)
Epoch 3 Test AUC:(0.5288796010521033, 0.0)
Epoch 3 a 0.5019019837950317 b 0.48476979181440305 c 0.4835487175695373
  0%|          | 4/1000 [06:10<25:34:12, 92.42s/it]Epoch 4 Valid AUC:(0.5598108938695893, 0.0)
Epoch 4 Test AUC:(0.5472786169200388, 0.0)
Epoch 4 a 0.4959899700083723 b 0.4786466019194371 c 0.4745544811009881
  0%|          | 5/1000 [07:42<25:33:24, 92.47s/it]Epoch 5 Valid AUC:(0.5739871765577895, 0.0)
Epoch 5 Test AUC:(0.5654540476433841, 0.0)
Epoch 5 a 0.48737267181427185 b 0.4736425781573808 c 0.464013320819233
  1%|          | 6/1000 [09:15<25:32:45, 92.52s/it]Epoch 6 Valid AUC:(0.5834205806766776, 0.0)
Epoch 6 Test AUC:(0.5807404521757404, 0.0)
Epoch 6 a 0.4755392553101123 b 0.4716363608897092 c 0.45437515930270767
  1%|          | 7/1000 [10:47<25:30:00, 92.45s/it]Epoch 7 Valid AUC:(0.5902479399029062, 0.0)
Epoch 7 Test AUC:(0.5931726028276716, 0.0)
Epoch 7 a 0.46550572407197666 b 0.4738360692857497 c 0.4470393921827646
  1%|          | 8/1000 [12:20<25:29:46, 92.53s/it]Epoch 8 Valid AUC:(0.5952273195543022, 0.0)
Epoch 8 Test AUC:(0.6029166867025378, 0.0)
Epoch 8 a 0.45882222347216345 b 0.4774359564186342 c 0.4410788692698872
  1%|          | 9/1000 [13:52<25:27:48, 92.50s/it]Epoch 9 Valid AUC:(0.5990481428988246, 0.0)
Epoch 9 Test AUC:(0.6101251923320715, 0.0)
Epoch 9 a 0.4544240105559888 b 0.4799355929586249 c 0.4358559115012167
  1%|          | 10/1000 [15:24<25:23:17, 92.32s/it]Epoch 10 Valid AUC:(0.6023624683992815, 0.0)
Epoch 10 Test AUC:(0.6157032387275516, 0.0)
Epoch 10 a 0.4511191230304764 b 0.4811243656535504 c 0.4309053537951149
  1%|          | 11/1000 [16:56<25:18:11, 92.10s/it]Epoch 11 Valid AUC:(0.6055695105794162, 0.0)
Epoch 11 Test AUC:(0.6202533706449247, 0.0)
Epoch 11 a 0.44876200782221326 b 0.48135137971737973 c 0.4265679514384126
  1%|          | 12/1000 [18:27<25:13:08, 91.89s/it]Epoch 12 Valid AUC:(0.6088207420403469, 0.0)
Epoch 12 Test AUC:(0.6240502435902324, 0.0)
Epoch 12 a 0.447161238737989 b 0.4809720430755519 c 0.42312750391197396
  1%|▏         | 13/1000 [19:58<25:06:51, 91.60s/it]Epoch 13 Valid AUC:(0.6128666910592864, 0.0)
Epoch 13 Test AUC:(0.6276700740409934, 0.0)
Epoch 13 a 0.44507655870146917 b 0.48010689319979016 c 0.41907729430337787
  1%|▏         | 14/1000 [21:30<25:08:03, 91.77s/it]Epoch 14 Valid AUC:(0.6179776837672758, 0.0)
Epoch 14 Test AUC:(0.6315650217474017, 0.0)
Epoch 14 a 0.44319159634995986 b 0.4792568201210417 c 0.41555704752084477
  2%|▏         | 15/1000 [23:02<25:07:22, 91.82s/it]Epoch 15 Valid AUC:(0.6245527462940829, 0.0)
Epoch 15 Test AUC:(0.6354690719066799, 0.0)
Epoch 15 a 0.44089462552631886 b 0.4778456942776079 c 0.4117140063277672
  2%|▏         | 16/1000 [24:34<25:05:03, 91.77s/it]Epoch 16 Valid AUC:(0.6325014392787095, 0.0)
Epoch 16 Test AUC:(0.639959997263535, 0.0)
Epoch 16 a 0.4383909955350926 b 0.47710374513382403 c 0.4085054227284023
  2%|▏         | 17/1000 [26:05<25:02:09, 91.69s/it]Epoch 17 Valid AUC:(0.6419181545108653, 0.0)
Epoch 17 Test AUC:(0.6449245323499401, 0.0)
Epoch 17 a 0.4353454320483524 b 0.4761487774445977 c 0.4051144584503692
  2%|▏         | 18/1000 [27:37<24:59:30, 91.62s/it]Epoch 18 Valid AUC:(0.6524850034294368, 0.0)
Epoch 18 Test AUC:(0.6502004619642335, 0.0)
Epoch 18 a 0.4317871164867816 b 0.47564780889022756 c 0.4017694627255261
  2%|▏         | 19/1000 [29:09<25:02:03, 91.87s/it]Epoch 19 Valid AUC:(0.6631279724852727, 0.0)
Epoch 19 Test AUC:(0.655592696898123, 0.0)
Epoch 19 a 0.4280227020352899 b 0.47496605968811145 c 0.39862194558384434
  2%|▏         | 20/1000 [30:41<25:00:50, 91.89s/it]Epoch 20 Valid AUC:(0.6738468207391388, 0.0)
Epoch 20 Test AUC:(0.6611076289632765, 0.0)
Epoch 20 a 0.4240805923159214 b 0.4751425908365 c 0.39594146864155166
  2%|▏         | 21/1000 [32:13<24:58:47, 91.86s/it]Epoch 21 Valid AUC:(0.6841141962873089, 0.0)
Epoch 21 Test AUC:(0.6666776631480107, 0.0)
Epoch 21 a 0.4198250260871181 b 0.47554420300532635 c 0.39297219019540597
  2%|▏         | 22/1000 [33:44<24:54:41, 91.70s/it]Epoch 22 Valid AUC:(0.6943770696039409, 0.0)
Epoch 22 Test AUC:(0.6721443081757227, 0.0)
Epoch 22 a 0.4158748116351709 b 0.47566444158434146 c 0.39006088776007986
  2%|▏         | 23/1000 [35:16<24:51:56, 91.62s/it]Epoch 23 Valid AUC:(0.703469939436899, 0.0)
Epoch 23 Test AUC:(0.6772290820042887, 0.0)
Epoch 23 a 0.4115121824220872 b 0.4762352881597081 c 0.3875615246279139
  2%|▏         | 24/1000 [36:47<24:48:13, 91.49s/it]Epoch 24 Valid AUC:(0.7123455769185382, 0.0)
Epoch 24 Test AUC:(0.6823060787723706, 0.0)
Epoch 24 a 0.40732753477705796 b 0.47748631556748866 c 0.385137927274349
  2%|▎         | 25/1000 [38:18<24:46:38, 91.49s/it]Epoch 25 Valid AUC:(0.7199784882787574, 0.0)
Epoch 25 Test AUC:(0.6869565899234119, 0.0)
Epoch 25 a 0.40318162466438723 b 0.47870497903233805 c 0.3826425112708953
  3%|▎         | 26/1000 [39:50<24:47:08, 91.61s/it]Epoch 26 Valid AUC:(0.7278972266212714, 0.0)
Epoch 26 Test AUC:(0.6915105825805414, 0.0)
Epoch 26 a 0.3993877468994206 b 0.4798117614607936 c 0.38036808542442513
  3%|▎         | 27/1000 [41:23<24:51:00, 91.94s/it]Epoch 27 Valid AUC:(0.734604527621407, 0.0)
Epoch 27 Test AUC:(0.6954989961029145, 0.0)
Epoch 27 a 0.39568546585273934 b 0.4814470856482354 c 0.3781675055952859
  3%|▎         | 28/1000 [42:55<24:48:12, 91.87s/it]Epoch 28 Valid AUC:(0.7412749854242016, 0.0)
Epoch 28 Test AUC:(0.6992321989081853, 0.0)
Epoch 28 a 0.3925689671121133 b 0.4834916635718144 c 0.37674045553749475
  3%|▎         | 29/1000 [44:26<24:45:34, 91.80s/it]Epoch 29 Valid AUC:(0.7468643681077409, 0.0)
Epoch 29 Test AUC:(0.702326113660204, 0.0)
Epoch 29 a 0.38923672255375974 b 0.4854338940840132 c 0.3746600979470631
  3%|▎         | 30/1000 [45:59<24:46:44, 91.96s/it]Epoch 30 Valid AUC:(0.7521896621668992, 0.0)
Epoch 30 Test AUC:(0.7054061673731414, 0.0)
Epoch 30 a 0.3860167590845039 b 0.4867745255920249 c 0.37287662686476525
  3%|▎         | 31/1000 [47:31<24:46:47, 92.06s/it]Epoch 31 Valid AUC:(0.7566558925134602, 0.0)
Epoch 31 Test AUC:(0.7080742549288531, 0.0)
Epoch 31 a 0.38326123128954315 b 0.48916818687253794 c 0.3713341172132454
  3%|▎         | 32/1000 [49:04<24:49:06, 92.30s/it]Epoch 32 Valid AUC:(0.7606726058632143, 0.0)
Epoch 32 Test AUC:(0.7107593673635353, 0.0)
Epoch 32 a 0.3807233033825454 b 0.4915361028441961 c 0.3701118440695212
  3%|▎         | 33/1000 [50:36<24:44:18, 92.10s/it]Epoch 33 Valid AUC:(0.7644666131836249, 0.0)
Epoch 33 Test AUC:(0.7131604653117471, 0.0)
Epoch 33 a 0.37846944500622853 b 0.49364638196630495 c 0.3687813645997038
  3%|▎         | 34/1000 [52:07<24:41:13, 92.00s/it]Epoch 34 Valid AUC:(0.7681102321294704, 0.0)
Epoch 34 Test AUC:(0.7152677451452918, 0.0)
Epoch 34 a 0.3763883639149503 b 0.495636406139109 c 0.3676175872984547
  4%|▎         | 35/1000 [53:40<24:44:16, 92.29s/it]Epoch 35 Valid AUC:(0.7710183007599551, 0.0)
Epoch 35 Test AUC:(0.7170879193352855, 0.0)
Epoch 35 a 0.3741838156397434 b 0.4976039338759493 c 0.366330582341198
  4%|▎         | 36/1000 [55:13<24:43:38, 92.34s/it]Epoch 36 Valid AUC:(0.7735408563632452, 0.0)
Epoch 36 Test AUC:(0.7189881172971748, 0.0)
Epoch 36 a 0.37255364917293643 b 0.49964121766613284 c 0.36542969864139135
  4%|▎         | 37/1000 [56:44<24:36:39, 92.00s/it]Epoch 37 Valid AUC:(0.7768201867215497, 0.0)
Epoch 37 Test AUC:(0.7204902015900014, 0.0)
Epoch 37 a 0.37079871642277756 b 0.5015221397941501 c 0.3643804181149788
  4%|▍         | 38/1000 [58:16<24:35:12, 92.01s/it]Epoch 38 Valid AUC:(0.7784415091199192, 0.0)
Epoch 38 Test AUC:(0.7217561095105716, 0.0)
Epoch 38 a 0.369644281040255 b 0.5033552378895777 c 0.3639230457110184
  4%|▍         | 39/1000 [59:48<24:32:20, 91.93s/it]Epoch 39 Valid AUC:(0.7802900474687201, 0.0)
Epoch 39 Test AUC:(0.7229513782924302, 0.0)
Epoch 39 a 0.36811729357156237 b 0.5056665790093017 c 0.3629857129314296
  4%|▍         | 40/1000 [1:01:19<24:29:39, 91.85s/it]Epoch 40 Valid AUC:(0.7820975184940342, 0.0)
Epoch 40 Test AUC:(0.7242053833342827, 0.0)
Epoch 40 a 0.36684894399863616 b 0.5073604832892447 c 0.3622442039565541
  4%|▍         | 41/1000 [1:02:51<24:26:00, 91.72s/it]Epoch 41 Valid AUC:(0.7839969629455759, 0.0)
Epoch 41 Test AUC:(0.7250648532665144, 0.0)
Epoch 41 a 0.36561212945032406 b 0.5092444182701514 c 0.3614451423197445
  4%|▍         | 42/1000 [1:04:23<24:24:27, 91.72s/it]Epoch 42 Valid AUC:(0.7853163359384366, 0.0)
Epoch 42 Test AUC:(0.7260356732610026, 0.0)
Epoch 42 a 0.36427874074615463 b 0.5103073789620064 c 0.36048617695179025
  4%|▍         | 43/1000 [1:05:54<24:22:54, 91.72s/it]Epoch 43 Valid AUC:(0.7864101270102457, 0.0)
Epoch 43 Test AUC:(0.7267631170097572, 0.0)
Epoch 43 a 0.36372281889800334 b 0.5119479228133407 c 0.36026886276436043
  4%|▍         | 44/1000 [1:07:26<24:23:48, 91.87s/it]Epoch 44 Valid AUC:(0.7870509420693292, 0.0)
Epoch 44 Test AUC:(0.7273879711123803, 0.0)
Epoch 44 a 0.3634321433557591 b 0.5139291567102044 c 0.36035572894862
  4%|▍         | 45/1000 [1:08:58<24:21:01, 91.79s/it]Epoch 45 Valid AUC:(0.7880876433585879, 0.0)
Epoch 45 Test AUC:(0.7281758099993407, 0.0)
Epoch 45 a 0.3622992730416522 b 0.51414566041838 c 0.35939234402218095
  5%|▍         | 46/1000 [1:10:30<24:18:44, 91.74s/it]Epoch 46 Valid AUC:(0.7894547415436635, 0.0)
Epoch 46 Test AUC:(0.7287024396997877, 0.0)
Epoch 46 a 0.36147927239507255 b 0.516207911149117 c 0.35894125610050304
  5%|▍         | 47/1000 [1:12:02<24:18:17, 91.81s/it]Epoch 47 Valid AUC:(0.7898154506456689, 0.0)
Epoch 47 Test AUC:(0.7290835156635022, 0.0)
Epoch 47 a 0.3611205261897753 b 0.5168537239973214 c 0.3587473791310005
  5%|▍         | 48/1000 [1:13:34<24:20:41, 92.06s/it]Epoch 48 Valid AUC:(0.7906969076095234, 0.0)
Epoch 48 Test AUC:(0.7293897796402191, 0.0)
Epoch 48 a 0.36064435595597777 b 0.5179736548866065 c 0.35843452856214475
  5%|▍         | 49/1000 [1:15:06<24:17:24, 91.95s/it]Epoch 49 Valid AUC:(0.7910799420384276, 0.0)
Epoch 49 Test AUC:(0.7299680483382062, 0.0)
Epoch 49 a 0.36067429487734015 b 0.519601135306675 c 0.3586869233510864
  5%|▌         | 50/1000 [1:16:38<24:16:00, 91.96s/it]Epoch 50 Valid AUC:(0.7919703560464665, 0.0)
Epoch 50 Test AUC:(0.73033141962492, 0.0)
Epoch 50 a 0.3599898855031376 b 0.5196699482394416 c 0.35814149467877937
  5%|▌         | 51/1000 [1:18:09<24:10:52, 91.73s/it]Epoch 51 Valid AUC:(0.7920782519676072, 0.0)
Epoch 51 Test AUC:(0.7306255156444422, 0.0)
Epoch 51 a 0.35958649502913476 b 0.5202859468023542 c 0.35786420949388076
  5%|▌         | 52/1000 [1:19:41<24:09:36, 91.75s/it]Epoch 52 Valid AUC:(0.792813716416326, 0.0)
Epoch 52 Test AUC:(0.730841640112537, 0.0)
Epoch 52 a 0.35925116886195524 b 0.5217299050908213 c 0.357678366498928
  5%|▌         | 53/1000 [1:21:14<24:14:18, 92.14s/it]Epoch 53 Valid AUC:(0.7932265773281758, 0.0)
Epoch 53 Test AUC:(0.7310032567498953, 0.0)
Epoch 53 a 0.3588560633136473 b 0.5219522056505234 c 0.3573495790332376
  5%|▌         | 54/1000 [1:22:46<24:11:41, 92.07s/it]Epoch 54 Valid AUC:(0.7935214228710553, 0.0)
Epoch 54 Test AUC:(0.7312030104842941, 0.0)
Epoch 54 a 0.358585364112192 b 0.5227077115529499 c 0.3571642586283041
  6%|▌         | 55/1000 [1:24:19<24:12:48, 92.24s/it]Epoch 55 Valid AUC:(0.7932476441320542, 0.0)
Epoch 55 Test AUC:(0.731159092966267, 0.0)
Epoch 55 a 0.35877906838413215 b 0.5234646740213966 c 0.357455442069282
  6%|▌         | 56/1000 [1:25:50<24:08:20, 92.06s/it]Epoch 56 Valid AUC:(0.7937703669266671, 0.0)
Epoch 56 Test AUC:(0.731241592229103, 0.0)
Epoch 56 a 0.35820860507142854 b 0.5234098459033659 c 0.3568697419744622
  6%|▌         | 57/1000 [1:27:22<24:06:28, 92.03s/it]Epoch 57 Valid AUC:(0.7939704925923694, 0.0)
Epoch 57 Test AUC:(0.7313966374855025, 0.0)
Epoch 57 a 0.35790339238207103 b 0.5237494311941941 c 0.3566892567714695
  6%|▌         | 58/1000 [1:28:54<24:03:19, 91.93s/it]Epoch 58 Valid AUC:(0.7942252255975565, 0.0)
Epoch 58 Test AUC:(0.7314689868079378, 0.0)
Epoch 58 a 0.35793208788098463 b 0.524834280732412 c 0.3568404424838137
  6%|▌         | 59/1000 [1:30:26<24:01:05, 91.89s/it]Epoch 59 Valid AUC:(0.794347536861806, 0.0)
Epoch 59 Test AUC:(0.7314677298229008, 0.0)
Epoch 59 a 0.3578907402468399 b 0.5252227204846185 c 0.35683259985576454
  6%|▌         | 60/1000 [1:31:57<23:58:47, 91.84s/it]Epoch 60 Valid AUC:(0.7945934294476505, 0.0)
Epoch 60 Test AUC:(0.7315151061875093, 0.0)
Epoch 60 a 0.3576121162660645 b 0.5253887087766314 c 0.35660521596130473
  6%|▌         | 61/1000 [1:33:29<23:56:41, 91.80s/it]Epoch 61 Valid AUC:(0.7941971254185909, 0.0)
Epoch 61 Test AUC:(0.7314537490709587, 0.0)
Epoch 61 a 0.35737665930024576 b 0.5254753686532648 c 0.3563664586431304
  6%|▌         | 62/1000 [1:35:01<23:53:44, 91.71s/it]Epoch 62 Valid AUC:(0.7945510971931851, 0.0)
Epoch 62 Test AUC:(0.7316663249078268, 0.0)
Epoch 62 a 0.3577904431093147 b 0.5254629526879466 c 0.35677915988433767
  6%|▋         | 63/1000 [1:36:32<23:52:21, 91.72s/it]Epoch 63 Valid AUC:(0.7945662981519879, 0.0)
Epoch 63 Test AUC:(0.7317952385569266, 0.0)
Epoch 63 a 0.3577664475625669 b 0.5258284034563502 c 0.35684754209259384
  6%|▋         | 64/1000 [1:38:04<23:49:44, 91.65s/it]Epoch 64 Valid AUC:(0.7946012650991235, 0.0)
Epoch 64 Test AUC:(0.7317196398854161, 0.0)
Epoch 64 a 0.3571914741750694 b 0.525974952389057 c 0.3562868024321869
  6%|▋         | 65/1000 [1:39:36<23:49:51, 91.76s/it]Epoch 65 Valid AUC:(0.7947873893758265, 0.0)
Epoch 65 Test AUC:(0.7315333752251387, 0.0)
Epoch 65 a 0.35743533590549914 b 0.5262233101026393 c 0.3565727959516303
  7%|▋         | 66/1000 [1:41:07<23:47:32, 91.70s/it]Epoch 66 Valid AUC:(0.7948335100152698, 0.0)
Epoch 66 Test AUC:(0.731493523668915, 0.0)
Epoch 66 a 0.35743571311175465 b 0.5263068750950413 c 0.35658678787215137
  7%|▋         | 67/1000 [1:42:39<23:44:52, 91.63s/it]Epoch 67 Valid AUC:(0.7948164161455697, 0.0)
Epoch 67 Test AUC:(0.7316924736169637, 0.0)
Epoch 67 a 0.3569446008210211 b 0.5263094622904146 c 0.3561109177003684
  7%|▋         | 68/1000 [1:44:11<23:44:33, 91.71s/it]Epoch 68 Valid AUC:(0.7948142310317717, 0.0)
Epoch 68 Test AUC:(0.7316749656110912, 0.0)
Epoch 68 a 0.3574523178024791 b 0.5276771078047379 c 0.35667279428639403
  7%|▋         | 69/1000 [1:45:43<23:44:31, 91.81s/it]Epoch 69 Valid AUC:(0.7944129275136057, 0.0)
Epoch 69 Test AUC:(0.7315926672948428, 0.0)
Epoch 69 a 0.35782446950614094 b 0.5265258796198268 c 0.3570344661263153
  7%|▋         | 70/1000 [1:47:15<23:43:29, 91.84s/it]Epoch 70 Valid AUC:(0.7950069990796942, 0.0)
Epoch 70 Test AUC:(0.7317737971284896, 0.0)
Epoch 70 a 0.35670624688357655 b 0.5261222812791225 c 0.3558669173021911
  7%|▋         | 71/1000 [1:48:46<23:40:00, 91.71s/it]Epoch 71 Valid AUC:(0.7950709018035644, 0.0)
Epoch 71 Test AUC:(0.7318440215476479, 0.0)
Epoch 71 a 0.3567508761611743 b 0.5267849995096925 c 0.35598238391175835
  7%|▋         | 72/1000 [1:50:18<23:37:27, 91.65s/it]Epoch 72 Valid AUC:(0.7950690101742589, 0.0)
Epoch 72 Test AUC:(0.7318764081519173, 0.0)
Epoch 72 a 0.35687170287133224 b 0.5264967115112473 c 0.3561082530309497
  7%|▋         | 73/1000 [1:51:49<23:36:28, 91.68s/it]Epoch 73 Valid AUC:(0.794733445900827, 0.0)
Epoch 73 Test AUC:(0.7318788879183169, 0.0)
Epoch 73 a 0.35684926106296555 b 0.5265567774623933 c 0.35610943627909153
  7%|▋         | 74/1000 [1:53:21<23:36:50, 91.80s/it]Epoch 74 Valid AUC:(0.7951989033348307, 0.0)
Epoch 74 Test AUC:(0.731731850597204, 0.0)
Epoch 74 a 0.35707570099734687 b 0.5265348917341808 c 0.35631009885362935
  8%|▊         | 75/1000 [1:54:53<23:35:03, 91.79s/it]Epoch 75 Valid AUC:(0.7948075411232521, 0.0)
Epoch 75 Test AUC:(0.7316988141231197, 0.0)
Epoch 75 a 0.35724081338891084 b 0.5266651465919177 c 0.3565128710967914
  8%|▊         | 76/1000 [1:56:25<23:33:09, 91.76s/it]Epoch 76 Valid AUC:(0.7946538846899275, 0.0)
Epoch 76 Test AUC:(0.731719263644997, 0.0)
Epoch 76 a 0.3572388808552168 b 0.5265877946641604 c 0.35650743472144397
  8%|▊         | 77/1000 [1:57:56<23:30:25, 91.68s/it]Epoch 77 Valid AUC:(0.7950027813615068, 0.0)
Epoch 77 Test AUC:(0.7317385288646455, 0.0)
Epoch 77 a 0.35680590102250426 b 0.5258580863295906 c 0.35602315825595704
  8%|▊         | 78/1000 [1:59:28<23:30:04, 91.76s/it]Epoch 78 Valid AUC:(0.7949972961491574, 0.0)
Epoch 78 Test AUC:(0.7316615663216153, 0.0)
Epoch 78 a 0.3572597159166451 b 0.526347049345193 c 0.3565221682820522
  8%|▊         | 79/1000 [2:00:59<23:25:25, 91.56s/it]Epoch 79 Valid AUC:(0.7947404497993058, 0.0)
Epoch 79 Test AUC:(0.7316731570918034, 0.0)
Epoch 79 a 0.3572585631004522 b 0.5257493808295886 c 0.3564859875131181
  8%|▊         | 80/1000 [2:02:32<23:29:08, 91.90s/it]  8%|▊         | 80/1000 [2:04:05<23:46:58, 93.06s/it]
[32m[I 2021-05-13 08:00:15,445][0m Trial 14 finished with value: 0.7951989033348307 and parameters: {'rank': 5.0, 'lambda': 0.001, 'batch_size': 256, 'learning_rate': 0.0001, 'alpha': 0.1605477859346066, 'gamma': 0.0037717970473625175}. Best is trial 14 with value: 0.7951989033348307.[0m
2021-05-13 08:00:16.112854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5305592765572913, 0.0)
Epoch 0 Test AUC:(0.5153926732112234, 0.0)
Epoch 0 a 0.686317240999591 b 0.6862615707420534 c 0.6851753457900016
  0%|          | 1/1000 [00:19<5:27:19, 19.66s/it]Epoch 1 Valid AUC:(0.5611876360319846, 0.0)
Epoch 1 Test AUC:(0.5370156376506164, 0.0)
Epoch 1 a 0.6360778126024431 b 0.6075965887115847 c 0.597665500256323
  0%|          | 2/1000 [00:39<5:27:14, 19.67s/it]Epoch 2 Valid AUC:(0.6017155824404552, 0.0)
Epoch 2 Test AUC:(0.5818064695472137, 0.0)
Epoch 2 a 0.5431034190039481 b 0.5036118946248486 c 0.48004979856552615
  0%|          | 3/1000 [00:59<5:28:12, 19.75s/it]Epoch 3 Valid AUC:(0.6160797733809638, 0.0)
Epoch 3 Test AUC:(0.6155168800071694, 0.0)
Epoch 3 a 0.47692992898725695 b 0.4782801568508148 c 0.43985958830002814
  0%|          | 4/1000 [01:19<5:30:41, 19.92s/it]Epoch 4 Valid AUC:(0.6217929783253321, 0.0)
Epoch 4 Test AUC:(0.6308426486933882, 0.0)
Epoch 4 a 0.4553908537472448 b 0.4651426372508849 c 0.41789295644529406
  0%|          | 5/1000 [01:39<5:32:23, 20.04s/it]Epoch 5 Valid AUC:(0.6311306206330148, 0.0)
Epoch 5 Test AUC:(0.6409735718511181, 0.0)
Epoch 5 a 0.4475338562361656 b 0.45141951235071304 c 0.4027922646172585
  1%|          | 6/1000 [01:59<5:31:07, 19.99s/it]Epoch 6 Valid AUC:(0.6448064904744008, 0.0)
Epoch 6 Test AUC:(0.6511412340306946, 0.0)
Epoch 6 a 0.4410290037912707 b 0.440706905338072 c 0.3918581508821057
  1%|          | 7/1000 [02:19<5:28:50, 19.87s/it]Epoch 7 Valid AUC:(0.6642472633865479, 0.0)
Epoch 7 Test AUC:(0.6636358234903816, 0.0)
Epoch 7 a 0.43388840532110584 b 0.4338811943607946 c 0.3844489688354154
  1%|          | 8/1000 [02:39<5:28:57, 19.90s/it]Epoch 8 Valid AUC:(0.6852818711189175, 0.0)
Epoch 8 Test AUC:(0.677561238162584, 0.0)
Epoch 8 a 0.4249192204686903 b 0.42977570453959124 c 0.378528986967379
  1%|          | 9/1000 [02:58<5:28:36, 19.90s/it]Epoch 9 Valid AUC:(0.7069068325199396, 0.0)
Epoch 9 Test AUC:(0.6916495136308035, 0.0)
Epoch 9 a 0.4149713655633311 b 0.4290971412293373 c 0.37435299662813065
  1%|          | 10/1000 [03:19<5:29:11, 19.95s/it]Epoch 10 Valid AUC:(0.7263449781691624, 0.0)
Epoch 10 Test AUC:(0.7032016080139277, 0.0)
Epoch 10 a 0.4046827533072041 b 0.430529429306907 c 0.37026518727502516
  1%|          | 11/1000 [03:38<5:27:24, 19.86s/it]Epoch 11 Valid AUC:(0.7406871872493399, 0.0)
Epoch 11 Test AUC:(0.7119519597078663, 0.0)
Epoch 11 a 0.39613925136866107 b 0.4344497395138587 c 0.36808011680841446
  1%|          | 12/1000 [03:58<5:28:45, 19.96s/it]Epoch 12 Valid AUC:(0.7528900635491071, 0.0)
Epoch 12 Test AUC:(0.7182609471778161, 0.0)
Epoch 12 a 0.3890705925803031 b 0.43992693121394805 c 0.36614843313732454
  1%|▏         | 13/1000 [04:18<5:27:16, 19.90s/it]Epoch 13 Valid AUC:(0.7604752958544119, 0.0)
Epoch 13 Test AUC:(0.7226121590753557, 0.0)
Epoch 13 a 0.3834712161652504 b 0.4461585081392719 c 0.3645401748438035
  1%|▏         | 14/1000 [04:38<5:26:24, 19.86s/it]Epoch 14 Valid AUC:(0.7662605352217994, 0.0)
Epoch 14 Test AUC:(0.7253713694953307, 0.0)
Epoch 14 a 0.3791905057526404 b 0.4522801630439297 c 0.36303811640508715
  2%|▏         | 15/1000 [04:58<5:26:29, 19.89s/it]Epoch 15 Valid AUC:(0.7707406669932094, 0.0)
Epoch 15 Test AUC:(0.7272638203249513, 0.0)
Epoch 15 a 0.37597271896177725 b 0.45848171244705876 c 0.36218748361833636
  2%|▏         | 16/1000 [05:18<5:24:54, 19.81s/it]Epoch 16 Valid AUC:(0.7739931646667104, 0.0)
Epoch 16 Test AUC:(0.7283252629549635, 0.0)
Epoch 16 a 0.3736197977296768 b 0.4646938866184604 c 0.36158561850747756
  2%|▏         | 17/1000 [05:37<5:23:48, 19.76s/it]Epoch 17 Valid AUC:(0.7774361606892856, 0.0)
Epoch 17 Test AUC:(0.7294256421929072, 0.0)
Epoch 17 a 0.3717351911529418 b 0.4697806510713793 c 0.36096138987810383
  2%|▏         | 18/1000 [05:57<5:23:36, 19.77s/it]Epoch 18 Valid AUC:(0.7790790087013513, 0.0)
Epoch 18 Test AUC:(0.7295593187036779, 0.0)
Epoch 18 a 0.37038437493385806 b 0.4754987779644228 c 0.36068519901844764
  2%|▏         | 19/1000 [06:17<5:22:41, 19.74s/it]Epoch 19 Valid AUC:(0.7801561493341783, 0.0)
Epoch 19 Test AUC:(0.730339141104433, 0.0)
Epoch 19 a 0.3691461691933294 b 0.4799101314237041 c 0.360199268066114
  2%|▏         | 20/1000 [06:37<5:24:44, 19.88s/it]Epoch 20 Valid AUC:(0.7810755144980519, 0.0)
Epoch 20 Test AUC:(0.7309456919657522, 0.0)
Epoch 20 a 0.3684608035029904 b 0.4847901023684009 c 0.36028019459016863
  2%|▏         | 21/1000 [06:57<5:24:33, 19.89s/it]Epoch 21 Valid AUC:(0.7827158518720353, 0.0)
Epoch 21 Test AUC:(0.7314595551447011, 0.0)
Epoch 21 a 0.36734052555214974 b 0.4883571901629048 c 0.3595278289529585
  2%|▏         | 22/1000 [07:16<5:23:09, 19.83s/it]Epoch 22 Valid AUC:(0.7831936189940334, 0.0)
Epoch 22 Test AUC:(0.7316134887816801, 0.0)
Epoch 22 a 0.36674156376431066 b 0.4919715718396248 c 0.3594349084361907
  2%|▏         | 23/1000 [07:36<5:21:48, 19.76s/it]Epoch 23 Valid AUC:(0.7843081500638448, 0.0)
Epoch 23 Test AUC:(0.7316159813744575, 0.0)
Epoch 23 a 0.3660810231681793 b 0.49578692884214465 c 0.3591729976957844
  2%|▏         | 24/1000 [07:56<5:20:31, 19.70s/it]Epoch 24 Valid AUC:(0.7840522290231793, 0.0)
Epoch 24 Test AUC:(0.7320610652394944, 0.0)
Epoch 24 a 0.365577939777605 b 0.49886692964261575 c 0.35905431643609076
  2%|▎         | 25/1000 [08:16<5:23:39, 19.92s/it]Epoch 25 Valid AUC:(0.7842270496613492, 0.0)
Epoch 25 Test AUC:(0.7320231547417971, 0.0)
Epoch 25 a 0.3650862824532293 b 0.5021282304679194 c 0.3589452622878936
  3%|▎         | 26/1000 [08:36<5:22:36, 19.87s/it]Epoch 26 Valid AUC:(0.7850373757243121, 0.0)
Epoch 26 Test AUC:(0.7324669987236343, 0.0)
Epoch 26 a 0.36476207812947614 b 0.5045448221987293 c 0.3588113330544964
  3%|▎         | 27/1000 [08:55<5:21:12, 19.81s/it]Epoch 27 Valid AUC:(0.7851759145022924, 0.0)
Epoch 27 Test AUC:(0.7324243424661034, 0.0)
Epoch 27 a 0.36431840927370135 b 0.5074995066369733 c 0.3585778594978394
  3%|▎         | 28/1000 [09:15<5:20:31, 19.79s/it]Epoch 28 Valid AUC:(0.7861251715102869, 0.0)
Epoch 28 Test AUC:(0.7327607398800338, 0.0)
Epoch 28 a 0.3643554278439091 b 0.5098126778198827 c 0.35893283087399697
  3%|▎         | 29/1000 [09:35<5:18:38, 19.69s/it]Epoch 29 Valid AUC:(0.7863377298967839, 0.0)
Epoch 29 Test AUC:(0.732121704078881, 0.0)
Epoch 29 a 0.36386104480874154 b 0.5117562713642274 c 0.3585633214923643
  3%|▎         | 30/1000 [09:55<5:20:18, 19.81s/it]Epoch 30 Valid AUC:(0.7875736610191673, 0.0)
Epoch 30 Test AUC:(0.7320683848258323, 0.0)
Epoch 30 a 0.3631789484812367 b 0.5139775771287179 c 0.35804988299646684
  3%|▎         | 31/1000 [10:14<5:17:37, 19.67s/it]Epoch 31 Valid AUC:(0.7875420108312746, 0.0)
Epoch 31 Test AUC:(0.7316977623601295, 0.0)
Epoch 31 a 0.36336025066914096 b 0.5159566623549308 c 0.3583830532527739
  3%|▎         | 32/1000 [10:34<5:18:10, 19.72s/it]Epoch 32 Valid AUC:(0.7867034820620125, 0.0)
Epoch 32 Test AUC:(0.7319251483880456, 0.0)
Epoch 32 a 0.3630181442826025 b 0.5181625857949257 c 0.3582779700236936
  3%|▎         | 33/1000 [10:53<5:16:37, 19.65s/it]Epoch 33 Valid AUC:(0.7877391093774514, 0.0)
Epoch 33 Test AUC:(0.73203805899295, 0.0)
Epoch 33 a 0.3630726205245141 b 0.520554750677078 c 0.3584768433243998
  3%|▎         | 34/1000 [11:14<5:18:35, 19.79s/it]Epoch 34 Valid AUC:(0.7874713438665678, 0.0)
Epoch 34 Test AUC:(0.732029217343098, 0.0)
Epoch 34 a 0.3629599696686191 b 0.5216560048922416 c 0.3583814588285262
  4%|▎         | 35/1000 [11:34<5:20:26, 19.92s/it]Epoch 35 Valid AUC:(0.787116340410679, 0.0)
Epoch 35 Test AUC:(0.7319694464219513, 0.0)
Epoch 35 a 0.36243106905491124 b 0.5227355610939765 c 0.3579267657572223
  4%|▎         | 36/1000 [11:53<5:17:40, 19.77s/it]Epoch 36 Valid AUC:(0.787266600626077, 0.0)
Epoch 36 Test AUC:(0.732097530631945, 0.0)
Epoch 36 a 0.362518037278806 b 0.5246110678680481 c 0.3582764229466838
  4%|▎         | 37/1000 [12:13<5:16:31, 19.72s/it]Epoch 37 Valid AUC:(0.7895567203560618, 0.0)
Epoch 37 Test AUC:(0.7323041935085881, 0.0)
Epoch 37 a 0.36242765741002175 b 0.5265718652836738 c 0.35824529682436296
  4%|▍         | 38/1000 [12:32<5:15:15, 19.66s/it]Epoch 38 Valid AUC:(0.7873185050887289, 0.0)
Epoch 38 Test AUC:(0.7322968226167386, 0.0)
Epoch 38 a 0.36258881731379417 b 0.5276636779308319 c 0.3585149847692059
  4%|▍         | 39/1000 [12:53<5:18:05, 19.86s/it]Epoch 39 Valid AUC:(0.7884572723386196, 0.0)
Epoch 39 Test AUC:(0.732560614180675, 0.0)
Epoch 39 a 0.36222401717978137 b 0.5287270014805179 c 0.35822132566282827
  4%|▍         | 40/1000 [13:12<5:16:27, 19.78s/it]Epoch 40 Valid AUC:(0.7884969773301608, 0.0)
Epoch 40 Test AUC:(0.7327108238925955, 0.0)
Epoch 40 a 0.36232287773201544 b 0.5299759485548542 c 0.358383547875189
  4%|▍         | 41/1000 [13:32<5:15:19, 19.73s/it]Epoch 41 Valid AUC:(0.7886154104980156, 0.0)
Epoch 41 Test AUC:(0.7323888689802126, 0.0)
Epoch 41 a 0.3620024888265517 b 0.530499393661176 c 0.35809236692805446
  4%|▍         | 42/1000 [13:51<5:14:36, 19.70s/it]Epoch 42 Valid AUC:(0.789162987199893, 0.0)
Epoch 42 Test AUC:(0.7325598061188655, 0.0)
Epoch 42 a 0.36132087991122275 b 0.5316102072115867 c 0.3575154050223289
  4%|▍         | 43/1000 [14:11<5:13:39, 19.67s/it]  4%|▍         | 43/1000 [14:31<5:23:19, 20.27s/it]
[32m[I 2021-05-13 08:15:06,737][0m Trial 15 finished with value: 0.7895567203560618 and parameters: {'rank': 100.0, 'lambda': 0.001, 'batch_size': 2048, 'learning_rate': 0.0001, 'alpha': 0.13694381731297844, 'gamma': 0.0024309611008631908}. Best is trial 14 with value: 0.7951989033348307.[0m
2021-05-13 08:15:07.402822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]2021-05-13 08:16:47.286783: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 24994135 get requests, put_count=24994135 evicted_count=5000 eviction_rate=0.000200047 and unsatisfied allocation rate=0.000200567
Epoch 0 Valid AUC:(0.7792390589955196, 0.0)
Epoch 0 Test AUC:(0.7218206048142553, 0.0)
Epoch 0 a 0.42004193884266217 b 0.4916652029668781 c 0.41782302986568126
  0%|          | 1/1000 [01:33<25:48:31, 93.00s/it]Epoch 1 Valid AUC:(0.7779270449020304, 0.0)
Epoch 1 Test AUC:(0.7241343978833672, 0.0)
Epoch 1 a 0.3840829625695764 b 0.47975754950727734 c 0.3830847300334236
  0%|          | 2/1000 [03:06<25:51:32, 93.28s/it]Epoch 2 Valid AUC:(0.7759551277231183, 0.0)
Epoch 2 Test AUC:(0.7263012989969828, 0.0)
Epoch 2 a 0.3803722376914571 b 0.48167694667335487 c 0.3794261644663705
  0%|          | 3/1000 [04:39<25:48:37, 93.20s/it]Epoch 3 Valid AUC:(0.7832613485506316, 0.0)
Epoch 3 Test AUC:(0.7274233676400036, 0.0)
Epoch 3 a 0.37747125696368383 b 0.4821931897274685 c 0.3765583169052539
  0%|          | 4/1000 [06:13<25:53:15, 93.57s/it]Epoch 4 Valid AUC:(0.7834333163657431, 0.0)
Epoch 4 Test AUC:(0.7295397413754997, 0.0)
Epoch 4 a 0.3751684871897611 b 0.48380000385600075 c 0.37451369985488336
  0%|          | 5/1000 [07:47<25:52:41, 93.63s/it]Epoch 5 Valid AUC:(0.7801367101517214, 0.0)
Epoch 5 Test AUC:(0.726712320277701, 0.0)
Epoch 5 a 0.3726809045198698 b 0.48457963752674627 c 0.3724022668971862
  1%|          | 6/1000 [09:20<25:46:03, 93.32s/it]Epoch 6 Valid AUC:(0.7849747507473371, 0.0)
Epoch 6 Test AUC:(0.7284815951246151, 0.0)
Epoch 6 a 0.37036429861301867 b 0.4859017936936327 c 0.37035075570615966
  1%|          | 7/1000 [10:53<25:43:46, 93.28s/it]Epoch 7 Valid AUC:(0.7884033955063869, 0.0)
Epoch 7 Test AUC:(0.7292120573476422, 0.0)
Epoch 7 a 0.3692452665006131 b 0.48687474816377974 c 0.36943643418715993
  1%|          | 8/1000 [12:27<25:45:07, 93.45s/it]Epoch 8 Valid AUC:(0.7893826443226525, 0.0)
Epoch 8 Test AUC:(0.7299768173052499, 0.0)
Epoch 8 a 0.36815469533624784 b 0.48787144273219696 c 0.36849726352773204
  1%|          | 9/1000 [14:00<25:40:35, 93.28s/it]Epoch 9 Valid AUC:(0.7875656613239604, 0.0)
Epoch 9 Test AUC:(0.7305470780679502, 0.0)
Epoch 9 a 0.3679988373753051 b 0.48847525340450604 c 0.3683932890414712
  1%|          | 10/1000 [15:33<25:38:19, 93.23s/it]Epoch 10 Valid AUC:(0.7903249320351432, 0.0)
Epoch 10 Test AUC:(0.7305806361480705, 0.0)
Epoch 10 a 0.3668806226080812 b 0.4891892600827054 c 0.3673073840093325
  1%|          | 11/1000 [17:06<25:38:43, 93.35s/it]Epoch 11 Valid AUC:(0.7910001257907856, 0.0)
Epoch 11 Test AUC:(0.7302943300154102, 0.0)
Epoch 11 a 0.3668247326099177 b 0.489768726605045 c 0.36736814272955387
  1%|          | 12/1000 [18:40<25:36:26, 93.31s/it]Epoch 12 Valid AUC:(0.7898341939238488, 0.0)
Epoch 12 Test AUC:(0.7319298257405302, 0.0)
Epoch 12 a 0.3667328590958171 b 0.49027649992308625 c 0.3671593182463521
  1%|▏         | 13/1000 [20:13<25:37:56, 93.49s/it]Epoch 13 Valid AUC:(0.7907020916478301, 0.0)
Epoch 13 Test AUC:(0.7307439501427745, 0.0)
Epoch 13 a 0.36634392394746096 b 0.4904835064946046 c 0.3669910673164506
  1%|▏         | 14/1000 [21:46<25:34:00, 93.35s/it]Epoch 14 Valid AUC:(0.7903266532127565, 0.0)
Epoch 14 Test AUC:(0.7307476655169144, 0.0)
Epoch 14 a 0.36576000161813776 b 0.49047693814070414 c 0.3665008883720912
  2%|▏         | 15/1000 [23:20<25:31:51, 93.31s/it]Epoch 15 Valid AUC:(0.7895417564917181, 0.0)
Epoch 15 Test AUC:(0.7307014520772381, 0.0)
Epoch 15 a 0.36550884608411693 b 0.49059459633030883 c 0.3662044473697002
  2%|▏         | 16/1000 [24:53<25:28:05, 93.18s/it]Epoch 16 Valid AUC:(0.7868000077018533, 0.0)
Epoch 16 Test AUC:(0.729633600533721, 0.0)
Epoch 16 a 0.3651407744203295 b 0.4901815392301836 c 0.36582335700811275
  2%|▏         | 17/1000 [26:26<25:28:12, 93.28s/it]  2%|▏         | 17/1000 [27:59<26:58:44, 98.80s/it]
[32m[I 2021-05-13 08:43:26,075][0m Trial 16 finished with value: 0.7910001257907856 and parameters: {'rank': 90.0, 'lambda': 0.001, 'batch_size': 256, 'learning_rate': 0.001, 'alpha': 0.15947946566393276, 'gamma': 0.003880704011522863}. Best is trial 14 with value: 0.7951989033348307.[0m
2021-05-13 08:43:26.744164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5062514234638683, 0.0)
Epoch 0 Test AUC:(0.49481033846592387, 0.0)
Epoch 0 a 0.6704727702097634 b 0.6677245663205382 c 0.6675403225469877
  0%|          | 1/1000 [01:32<25:31:55, 92.01s/it]Epoch 1 Valid AUC:(0.5163853161131978, 0.0)
Epoch 1 Test AUC:(0.5029729983495572, 0.0)
Epoch 1 a 0.5830094548658106 b 0.5650703955883951 c 0.564704780577414
  0%|          | 2/1000 [03:03<25:28:45, 91.91s/it]Epoch 2 Valid AUC:(0.529341026273593, 0.0)
Epoch 2 Test AUC:(0.514795541186763, 0.0)
Epoch 2 a 0.5205580709086097 b 0.5017703083199514 c 0.5013893782133068
  0%|          | 3/1000 [04:35<25:24:22, 91.74s/it]Epoch 3 Valid AUC:(0.5432433802765667, 0.0)
Epoch 3 Test AUC:(0.5293695216589189, 0.0)
Epoch 3 a 0.5017362999424368 b 0.4852091042808364 c 0.4839409757667864
  0%|          | 4/1000 [06:06<25:21:40, 91.67s/it]Epoch 4 Valid AUC:(0.5604594202657537, 0.0)
Epoch 4 Test AUC:(0.5479583465428993, 0.0)
Epoch 4 a 0.49578649591152335 b 0.47927208679542693 c 0.4749954979064719
  0%|          | 5/1000 [07:38<25:19:12, 91.61s/it]Epoch 5 Valid AUC:(0.5745564518882387, 0.0)
Epoch 5 Test AUC:(0.5661426830479864, 0.0)
Epoch 5 a 0.4869213574369189 b 0.47444244247806866 c 0.4643177461156423
  1%|          | 6/1000 [09:10<25:17:26, 91.60s/it]Epoch 6 Valid AUC:(0.583917847215941, 0.0)
Epoch 6 Test AUC:(0.5813910317170289, 0.0)
Epoch 6 a 0.474878333733835 b 0.4727558743965698 c 0.45457477714694
  1%|          | 7/1000 [10:41<25:14:43, 91.52s/it]Epoch 7 Valid AUC:(0.5906458369504122, 0.0)
Epoch 7 Test AUC:(0.5937037858922831, 0.0)
Epoch 7 a 0.46493521197820814 b 0.4752637336191757 c 0.44722744921443447
  1%|          | 8/1000 [12:13<25:14:33, 91.61s/it]Epoch 8 Valid AUC:(0.5955511867405583, 0.0)
Epoch 8 Test AUC:(0.6033315430702567, 0.0)
Epoch 8 a 0.4584452969507432 b 0.47883989438564484 c 0.4412558208588863
  1%|          | 9/1000 [13:45<25:15:36, 91.76s/it]Epoch 9 Valid AUC:(0.5993224342744939, 0.0)
Epoch 9 Test AUC:(0.6104258041515813, 0.0)
Epoch 9 a 0.454178385031775 b 0.48108831057006446 c 0.43601484839585225
  1%|          | 10/1000 [15:16<25:13:33, 91.73s/it]Epoch 10 Valid AUC:(0.6026175346183029, 0.0)
Epoch 10 Test AUC:(0.6159293549440529, 0.0)
Epoch 10 a 0.45094902669519965 b 0.48201332410696285 c 0.4310494099764277
  1%|          | 11/1000 [16:48<25:11:19, 91.69s/it]Epoch 11 Valid AUC:(0.6058533318707467, 0.0)
Epoch 11 Test AUC:(0.6204494346579394, 0.0)
Epoch 11 a 0.4486295883684331 b 0.482004985393173 c 0.4266969692599126
  1%|          | 12/1000 [18:20<25:11:36, 91.80s/it]Epoch 12 Valid AUC:(0.6091769296869392, 0.0)
Epoch 12 Test AUC:(0.6242651067978311, 0.0)
Epoch 12 a 0.44704309693524535 b 0.4814490341624504 c 0.4232429085483014
  1%|▏         | 13/1000 [19:52<25:11:04, 91.86s/it]Epoch 13 Valid AUC:(0.6133618647593521, 0.0)
Epoch 13 Test AUC:(0.6279329335548004, 0.0)
Epoch 13 a 0.4449436664881121 b 0.48045132181773964 c 0.4191837307492972
  1%|▏         | 14/1000 [21:24<25:10:36, 91.92s/it]Epoch 14 Valid AUC:(0.6186889556100322, 0.0)
Epoch 14 Test AUC:(0.6319153272304657, 0.0)
Epoch 14 a 0.4430204720444363 b 0.47948868021039176 c 0.41564997263117814
  2%|▏         | 15/1000 [22:57<25:11:20, 92.06s/it]Epoch 15 Valid AUC:(0.6255516278131475, 0.0)
Epoch 15 Test AUC:(0.6359297013417661, 0.0)
Epoch 15 a 0.4406583206034762 b 0.47799389133271075 c 0.4117959268855857
  2%|▏         | 16/1000 [24:28<25:09:12, 92.02s/it]Epoch 16 Valid AUC:(0.6338333898122238, 0.0)
Epoch 16 Test AUC:(0.64056050690085, 0.0)
Epoch 16 a 0.438067925018324 b 0.4771956012282573 c 0.40858368941356
  2%|▏         | 17/1000 [26:01<25:08:24, 92.07s/it]Epoch 17 Valid AUC:(0.643589004019338, 0.0)
Epoch 17 Test AUC:(0.6456464906844005, 0.0)
Epoch 17 a 0.43492189676349075 b 0.47621743545925593 c 0.40520067824804085
  2%|▏         | 18/1000 [27:33<25:07:41, 92.12s/it]Epoch 18 Valid AUC:(0.6544297213883276, 0.0)
Epoch 18 Test AUC:(0.651043753558438, 0.0)
Epoch 18 a 0.43126109239441046 b 0.47571039244802427 c 0.40186577993379513
  2%|▏         | 19/1000 [29:05<25:06:45, 92.16s/it]Epoch 19 Valid AUC:(0.6652411185030812, 0.0)
Epoch 19 Test AUC:(0.6565341744153702, 0.0)
Epoch 19 a 0.4274071657381787 b 0.4750365700640189 c 0.3987323453488724
  2%|▏         | 20/1000 [30:38<25:08:02, 92.33s/it]Epoch 20 Valid AUC:(0.6760330315796695, 0.0)
Epoch 20 Test AUC:(0.6621207760049287, 0.0)
Epoch 20 a 0.4233966742602872 b 0.4752342507872783 c 0.3960685511709939
  2%|▏         | 21/1000 [32:10<25:04:34, 92.21s/it]Epoch 21 Valid AUC:(0.6863133447957526, 0.0)
Epoch 21 Test AUC:(0.6677287035855228, 0.0)
Epoch 21 a 0.4190904748751604 b 0.4756530347604387 c 0.39311696532026863
  2%|▏         | 22/1000 [33:42<25:02:13, 92.16s/it]Epoch 22 Valid AUC:(0.6965648503942679, 0.0)
Epoch 22 Test AUC:(0.6732135278662189, 0.0)
Epoch 22 a 0.41509797365612666 b 0.47579341335315817 c 0.3902184437038433
  2%|▏         | 23/1000 [35:15<25:05:34, 92.46s/it]Epoch 23 Valid AUC:(0.7056089941119168, 0.0)
Epoch 23 Test AUC:(0.6783035861624913, 0.0)
Epoch 23 a 0.41072210987329005 b 0.4763742234085647 c 0.387733605815851
  2%|▏         | 24/1000 [36:48<25:07:35, 92.68s/it]Epoch 24 Valid AUC:(0.7144193908879817, 0.0)
Epoch 24 Test AUC:(0.6833623951266707, 0.0)
Epoch 24 a 0.4065244328268097 b 0.4776460351778468 c 0.3853172992076912
  2%|▎         | 25/1000 [38:22<25:09:50, 92.91s/it]Epoch 25 Valid AUC:(0.7219856851131726, 0.0)
Epoch 25 Test AUC:(0.6879944833235474, 0.0)
Epoch 25 a 0.4023821555392843 b 0.4788670902041122 c 0.3828275463650644
  3%|▎         | 26/1000 [39:55<25:10:40, 93.06s/it]Epoch 26 Valid AUC:(0.72981729957234, 0.0)
Epoch 26 Test AUC:(0.6925200783799433, 0.0)
Epoch 26 a 0.3985924028774622 b 0.47996184220856103 c 0.38055539326048954
  3%|▎         | 27/1000 [41:28<25:09:29, 93.08s/it]Epoch 27 Valid AUC:(0.7364273739019912, 0.0)
Epoch 27 Test AUC:(0.6964750578105162, 0.0)
Epoch 27 a 0.3949046823640225 b 0.481588554514246 c 0.3783522995424942
  3%|▎         | 28/1000 [43:01<25:07:39, 93.07s/it]Epoch 28 Valid AUC:(0.7429871098740117, 0.0)
Epoch 28 Test AUC:(0.7001704441781945, 0.0)
Epoch 28 a 0.3918111424450903 b 0.48360279145495033 c 0.3769228685669736
  3%|▎         | 29/1000 [44:34<25:03:53, 92.93s/it]Epoch 29 Valid AUC:(0.7484825172851345, 0.0)
Epoch 29 Test AUC:(0.7032190433369919, 0.0)
Epoch 29 a 0.3885036133964297 b 0.48549683853774006 c 0.37483242438952447
  3%|▎         | 30/1000 [46:06<25:00:38, 92.82s/it]Epoch 30 Valid AUC:(0.7537041869681894, 0.0)
Epoch 30 Test AUC:(0.7062548203933201, 0.0)
Epoch 30 a 0.3853153419986337 b 0.4867854462842826 c 0.3730447258447977
  3%|▎         | 31/1000 [47:39<24:57:22, 92.72s/it]Epoch 31 Valid AUC:(0.7580662046880705, 0.0)
Epoch 31 Test AUC:(0.7088739496644788, 0.0)
Epoch 31 a 0.38259054762376865 b 0.4891158884739732 c 0.3714861882404542
  3%|▎         | 32/1000 [49:12<24:56:41, 92.77s/it]Epoch 32 Valid AUC:(0.7619839240524265, 0.0)
Epoch 32 Test AUC:(0.7115169659267997, 0.0)
Epoch 32 a 0.38009488198838726 b 0.49140518936712735 c 0.3702576372105351
  3%|▎         | 33/1000 [50:45<24:56:40, 92.86s/it]Epoch 33 Valid AUC:(0.7656882366165997, 0.0)
Epoch 33 Test AUC:(0.7138707730195892, 0.0)
Epoch 33 a 0.3778755809639541 b 0.49341716208088565 c 0.368911639395614
  3%|▎         | 34/1000 [52:18<24:56:23, 92.94s/it]Epoch 34 Valid AUC:(0.7692354388578964, 0.0)
Epoch 34 Test AUC:(0.7159268200242282, 0.0)
Epoch 34 a 0.375831003160304 b 0.4953021531553575 c 0.3677382752209362
  4%|▎         | 35/1000 [53:52<25:00:17, 93.28s/it]Epoch 35 Valid AUC:(0.7720618213984921, 0.0)
Epoch 35 Test AUC:(0.7177051973240123, 0.0)
Epoch 35 a 0.37366493241168125 b 0.49715660128675 c 0.36643789915491637
  4%|▎         | 36/1000 [55:25<24:56:05, 93.12s/it]Epoch 36 Valid AUC:(0.7745095128243547, 0.0)
Epoch 36 Test AUC:(0.7195668819484418, 0.0)
Epoch 36 a 0.3720693223972915 b 0.499090358674886 c 0.3655228408529485
  4%|▎         | 37/1000 [56:57<24:48:09, 92.72s/it]Epoch 37 Valid AUC:(0.7777028752949994, 0.0)
Epoch 37 Test AUC:(0.7210199096211511, 0.0)
Epoch 37 a 0.3703483954161945 b 0.5008256469873835 c 0.364469683446155
  4%|▍         | 38/1000 [58:28<24:42:21, 92.45s/it]Epoch 38 Valid AUC:(0.7792519389918073, 0.0)
Epoch 38 Test AUC:(0.7222529649123871, 0.0)
Epoch 38 a 0.36923312631171473 b 0.5025530434410337 c 0.36399766808784223
  4%|▍         | 39/1000 [1:00:00<24:38:55, 92.34s/it]Epoch 39 Valid AUC:(0.7810399003471227, 0.0)
Epoch 39 Test AUC:(0.7234185192520448, 0.0)
Epoch 39 a 0.3677401449718706 b 0.5047211898284659 c 0.36305104525876
  4%|▍         | 40/1000 [1:01:33<24:36:51, 92.30s/it]Epoch 40 Valid AUC:(0.7827817923266616, 0.0)
Epoch 40 Test AUC:(0.7246306290681236, 0.0)
Epoch 40 a 0.3665053581507873 b 0.5062666747051945 c 0.3623000035583373
  4%|▍         | 41/1000 [1:03:05<24:34:55, 92.28s/it]Epoch 41 Valid AUC:(0.7846306369758718, 0.0)
Epoch 41 Test AUC:(0.7254591746031697, 0.0)
Epoch 41 a 0.36529670403876774 b 0.5080167531847234 c 0.36149141096493126
  4%|▍         | 42/1000 [1:04:38<24:36:17, 92.46s/it]Epoch 42 Valid AUC:(0.7858920243536046, 0.0)
Epoch 42 Test AUC:(0.7263868466623065, 0.0)
Epoch 42 a 0.3639909515318496 b 0.5089191515261019 c 0.36052818548391524
  4%|▍         | 43/1000 [1:06:10<24:35:04, 92.48s/it]Epoch 43 Valid AUC:(0.7869410635258745, 0.0)
Epoch 43 Test AUC:(0.7270944266271091, 0.0)
Epoch 43 a 0.3634600781458964 b 0.510432574470758 c 0.36030391044539944
  4%|▍         | 44/1000 [1:07:42<24:30:37, 92.30s/it]Epoch 44 Valid AUC:(0.7875420915715499, 0.0)
Epoch 44 Test AUC:(0.7276908061707311, 0.0)
Epoch 44 a 0.36319768039033684 b 0.5122751638563107 c 0.3603833506944434
  4%|▍         | 45/1000 [1:09:15<24:32:46, 92.53s/it]Epoch 45 Valid AUC:(0.7885357787995743, 0.0)
Epoch 45 Test AUC:(0.7284517053885824, 0.0)
Epoch 45 a 0.3620835659309652 b 0.5123456341160135 c 0.3594169617298863
  5%|▍         | 46/1000 [1:10:49<24:38:13, 92.97s/it]Epoch 46 Valid AUC:(0.789862197983439, 0.0)
Epoch 46 Test AUC:(0.7289491721810792, 0.0)
Epoch 46 a 0.3612912747881542 b 0.5142840590155581 c 0.3589621732532378
  5%|▍         | 47/1000 [1:12:21<24:31:34, 92.65s/it]Epoch 47 Valid AUC:(0.7901859434184865, 0.0)
Epoch 47 Test AUC:(0.7293112522790817, 0.0)
Epoch 47 a 0.360948490844646 b 0.5147645722632437 c 0.35876580209319503
  5%|▍         | 48/1000 [1:13:53<24:28:08, 92.53s/it]Epoch 48 Valid AUC:(0.7910408957850049, 0.0)
Epoch 48 Test AUC:(0.7296012823368005, 0.0)
Epoch 48 a 0.360487036421985 b 0.5157684837308688 c 0.35844856566586486
  5%|▍         | 49/1000 [1:15:25<24:20:00, 92.11s/it]Epoch 49 Valid AUC:(0.7914033504148655, 0.0)
Epoch 49 Test AUC:(0.7301633983495163, 0.0)
Epoch 49 a 0.36053446939653555 b 0.5172886139670129 c 0.3586958980776175
  5%|▌         | 50/1000 [1:16:57<24:17:55, 92.08s/it]Epoch 50 Valid AUC:(0.7922681274631295, 0.0)
Epoch 50 Test AUC:(0.7305097362063411, 0.0)
Epoch 50 a 0.35986453156835835 b 0.5172106843419239 c 0.3581518075715608
  5%|▌         | 51/1000 [1:18:30<24:23:36, 92.54s/it]Epoch 51 Valid AUC:(0.7923461405112912, 0.0)
Epoch 51 Test AUC:(0.7307900182168343, 0.0)
Epoch 51 a 0.3594762602562396 b 0.5177034668819286 c 0.3578706117762886
  5%|▌         | 52/1000 [1:20:03<24:23:54, 92.65s/it]Epoch 52 Valid AUC:(0.793059743569296, 0.0)
Epoch 52 Test AUC:(0.7309928160782615, 0.0)
Epoch 52 a 0.35915251975687934 b 0.5190305818074665 c 0.35768009335462236
  5%|▌         | 53/1000 [1:21:36<24:24:25, 92.78s/it]Epoch 53 Valid AUC:(0.793453651021932, 0.0)
Epoch 53 Test AUC:(0.7311389983075124, 0.0)
Epoch 53 a 0.35876642071625114 b 0.5191274300607397 c 0.3573534833473459
  5%|▌         | 54/1000 [1:23:09<24:24:27, 92.88s/it]Epoch 54 Valid AUC:(0.7937316859268706, 0.0)
Epoch 54 Test AUC:(0.7313283541248706, 0.0)
Epoch 54 a 0.3585051394684214 b 0.519785884040702 c 0.35716248542010426
  6%|▌         | 55/1000 [1:24:42<24:22:03, 92.83s/it]Epoch 55 Valid AUC:(0.793443521321369, 0.0)
Epoch 55 Test AUC:(0.731279746427981, 0.0)
Epoch 55 a 0.3587065372068877 b 0.5204348957814441 c 0.3574521719389998
  6%|▌         | 56/1000 [1:26:15<24:21:56, 92.92s/it]Epoch 56 Valid AUC:(0.7939618521013274, 0.0)
Epoch 56 Test AUC:(0.7313526259073706, 0.0)
Epoch 56 a 0.35814006473696686 b 0.5202598627244442 c 0.35686351682698464
  6%|▌         | 57/1000 [1:27:48<24:19:44, 92.88s/it]Epoch 57 Valid AUC:(0.7941472266469032, 0.0)
Epoch 57 Test AUC:(0.7314973886841307, 0.0)
Epoch 57 a 0.35784530597673336 b 0.5205203683323544 c 0.356684785823467
  6%|▌         | 58/1000 [1:29:20<24:14:20, 92.63s/it]Epoch 58 Valid AUC:(0.7943875776303649, 0.0)
Epoch 58 Test AUC:(0.7315620934853206, 0.0)
Epoch 58 a 0.3578828371746439 b 0.5214905933714968 c 0.3568356468883798
  6%|▌         | 59/1000 [1:30:52<24:11:32, 92.55s/it]Epoch 59 Valid AUC:(0.7945033643114203, 0.0)
Epoch 59 Test AUC:(0.7315539359089581, 0.0)
Epoch 59 a 0.35784723233409094 b 0.5217986422885111 c 0.35682561070146696
  6%|▌         | 60/1000 [1:32:25<24:11:41, 92.66s/it]Epoch 60 Valid AUC:(0.7947392489479106, 0.0)
Epoch 60 Test AUC:(0.7315955831580919, 0.0)
Epoch 60 a 0.3575745173683109 b 0.5218542163041037 c 0.35659628818692335
  6%|▌         | 61/1000 [1:33:57<24:08:10, 92.54s/it]Epoch 61 Valid AUC:(0.7943314272545089, 0.0)
Epoch 61 Test AUC:(0.7315308612550647, 0.0)
Epoch 61 a 0.35734152215227516 b 0.5218453701113311 c 0.3563541768782096
  6%|▌         | 62/1000 [1:35:31<24:11:09, 92.82s/it]Epoch 62 Valid AUC:(0.7946809788194318, 0.0)
Epoch 62 Test AUC:(0.7317344629028422, 0.0)
Epoch 62 a 0.35775611437182553 b 0.5217505202326976 c 0.3567668491565965
  6%|▋         | 63/1000 [1:37:05<24:14:56, 93.17s/it]Epoch 63 Valid AUC:(0.7946940728415285, 0.0)
Epoch 63 Test AUC:(0.7318609395401356, 0.0)
Epoch 63 a 0.35773899665540854 b 0.5220926271777757 c 0.3568361605736811
  6%|▋         | 64/1000 [1:38:37<24:10:17, 92.97s/it]Epoch 64 Valid AUC:(0.7947190702870599, 0.0)
Epoch 64 Test AUC:(0.7317795134175863, 0.0)
Epoch 64 a 0.3571667928451024 b 0.5221128828928504 c 0.3562751479252004
  6%|▋         | 65/1000 [1:40:10<24:07:56, 92.92s/it]Epoch 65 Valid AUC:(0.7949056649079059, 0.0)
Epoch 65 Test AUC:(0.7315919447422194, 0.0)
Epoch 65 a 0.3574135587129075 b 0.5222898473142378 c 0.35655901408651225
  7%|▋         | 66/1000 [1:41:43<24:04:19, 92.78s/it]Epoch 66 Valid AUC:(0.7949438473685427, 0.0)
Epoch 66 Test AUC:(0.7315489806516184, 0.0)
Epoch 66 a 0.35741738495332614 b 0.522292395982464 c 0.3565743089741624
  7%|▋         | 67/1000 [1:43:16<24:04:40, 92.90s/it]Epoch 67 Valid AUC:(0.7949157548791271, 0.0)
Epoch 67 Test AUC:(0.7317430993306473, 0.0)
Epoch 67 a 0.35692773657425547 b 0.522231360406463 c 0.3560954284979784
  7%|▋         | 68/1000 [1:44:50<24:07:12, 93.17s/it]Epoch 68 Valid AUC:(0.7949108002457294, 0.0)
Epoch 68 Test AUC:(0.7317240778121794, 0.0)
Epoch 68 a 0.3574380684846364 b 0.5235203852056257 c 0.3566541840552804
  7%|▋         | 69/1000 [1:46:22<24:00:50, 92.86s/it]Epoch 69 Valid AUC:(0.7945078537270418, 0.0)
Epoch 69 Test AUC:(0.7316414802137793, 0.0)
Epoch 69 a 0.35781167702415817 b 0.5223484061193658 c 0.35701587511380195
  7%|▋         | 70/1000 [1:47:54<23:58:19, 92.80s/it]Epoch 70 Valid AUC:(0.7951057687865498, 0.0)
Epoch 70 Test AUC:(0.7318172528969112, 0.0)
Epoch 70 a 0.3566930381884757 b 0.5218337061299645 c 0.355846912987995
  7%|▋         | 71/1000 [1:49:28<23:58:49, 92.93s/it]Epoch 71 Valid AUC:(0.7951592816467481, 0.0)
Epoch 71 Test AUC:(0.7318839543375987, 0.0)
Epoch 71 a 0.3567404742811767 b 0.522412963166563 c 0.35596387810870195
  7%|▋         | 72/1000 [1:51:00<23:53:03, 92.65s/it]Epoch 72 Valid AUC:(0.7951593085601731, 0.0)
Epoch 72 Test AUC:(0.7319143272005333, 0.0)
Epoch 72 a 0.35686206364895495 b 0.5220971454976789 c 0.35608732895232303
  7%|▋         | 73/1000 [1:52:32<23:51:38, 92.66s/it]Epoch 73 Valid AUC:(0.7948241274826506, 0.0)
Epoch 73 Test AUC:(0.7319161100670654, 0.0)
Epoch 73 a 0.35684179564117186 b 0.522108436710158 c 0.3560878940871064
  7%|▋         | 74/1000 [1:54:05<23:49:43, 92.64s/it]Epoch 74 Valid AUC:(0.795287269080506, 0.0)
Epoch 74 Test AUC:(0.7317676661198397, 0.0)
Epoch 74 a 0.3570673385676244 b 0.5219981320487181 c 0.35628953333232005
  8%|▊         | 75/1000 [1:55:37<23:47:11, 92.57s/it]Epoch 75 Valid AUC:(0.7948915404861063, 0.0)
Epoch 75 Test AUC:(0.7317337360747596, 0.0)
Epoch 75 a 0.3572354785333457 b 0.5220964787231844 c 0.35649019917491936
  8%|▊         | 76/1000 [1:57:11<23:51:23, 92.95s/it]Epoch 76 Valid AUC:(0.7947319848863227, 0.0)
Epoch 76 Test AUC:(0.731754711478132, 0.0)
Epoch 76 a 0.3572337868467903 b 0.5219647787826162 c 0.35648082067788966
  8%|▊         | 77/1000 [1:58:44<23:47:42, 92.81s/it]Epoch 77 Valid AUC:(0.79509213521436, 0.0)
Epoch 77 Test AUC:(0.7317729163838718, 0.0)
Epoch 77 a 0.35679939584113224 b 0.5211388643238866 c 0.3560016414888908
  8%|▊         | 78/1000 [2:00:17<23:49:36, 93.03s/it]Epoch 78 Valid AUC:(0.7950792103623638, 0.0)
Epoch 78 Test AUC:(0.7316911353981997, 0.0)
Epoch 78 a 0.35725467998377036 b 0.5216359640031274 c 0.3564946148057339
  8%|▊         | 79/1000 [2:01:50<23:46:09, 92.91s/it]Epoch 79 Valid AUC:(0.7948181796157083, 0.0)
Epoch 79 Test AUC:(0.7317039831534248, 0.0)
Epoch 79 a 0.3572538252807479 b 0.5209782113071898 c 0.3564596043326245
  8%|▊         | 80/1000 [2:03:23<23:46:35, 93.04s/it]  8%|▊         | 80/1000 [2:04:55<23:56:41, 93.70s/it]
[32m[I 2021-05-13 10:48:41,602][0m Trial 17 finished with value: 0.795287269080506 and parameters: {'rank': 5.0, 'lambda': 0.001, 'batch_size': 256, 'learning_rate': 0.0001, 'alpha': 0.12588545187068798, 'gamma': 0.0018100269273387591}. Best is trial 17 with value: 0.795287269080506.[0m
2021-05-13 10:48:42.357387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5019626730581933, 0.0)
Epoch 0 Test AUC:(0.49127764187589046, 0.0)
Epoch 0 a 0.692847685948495 b 0.6928452262955327 c 0.6928375094167648
  0%|          | 1/1000 [00:19<5:18:29, 19.13s/it]Epoch 1 Valid AUC:(0.5029696696157151, 0.0)
Epoch 1 Test AUC:(0.4929380549778662, 0.0)
Epoch 1 a 0.6906489335721538 b 0.6905667277113083 c 0.6905071855552735
  0%|          | 2/1000 [00:37<5:15:09, 18.95s/it]Epoch 2 Valid AUC:(0.5033937188228476, 0.0)
Epoch 2 Test AUC:(0.4928777624506837, 0.0)
Epoch 2 a 0.6859543809006291 b 0.6852398240758527 c 0.685089418003636
  0%|          | 3/1000 [00:57<5:16:30, 19.05s/it]Epoch 3 Valid AUC:(0.5039569399142457, 0.0)
Epoch 3 Test AUC:(0.4931359275101689, 0.0)
Epoch 3 a 0.6790316013559219 b 0.6762313737023261 c 0.675987688764449
  0%|          | 4/1000 [01:16<5:16:00, 19.04s/it]Epoch 4 Valid AUC:(0.5045814351849982, 0.0)
Epoch 4 Test AUC:(0.4933742159593242, 0.0)
Epoch 4 a 0.6702317119606079 b 0.6633997088478457 c 0.6630787575437177
  0%|          | 5/1000 [01:35<5:20:34, 19.33s/it]Epoch 5 Valid AUC:(0.5048753144077581, 0.0)
Epoch 5 Test AUC:(0.49354262202606586, 0.0)
Epoch 5 a 0.6599676522516436 b 0.6471096094577543 c 0.6467626537046125
  1%|          | 6/1000 [01:54<5:16:07, 19.08s/it]Epoch 6 Valid AUC:(0.5056723055093904, 0.0)
Epoch 6 Test AUC:(0.494176275023948, 0.0)
Epoch 6 a 0.6486079524601659 b 0.6282612830400467 c 0.6279296048225895
  1%|          | 7/1000 [02:13<5:12:19, 18.87s/it]Epoch 7 Valid AUC:(0.5062410451345213, 0.0)
Epoch 7 Test AUC:(0.4943975514205109, 0.0)
Epoch 7 a 0.6365077832052785 b 0.6078230623276003 c 0.6074983088239547
  1%|          | 8/1000 [02:31<5:08:26, 18.66s/it]Epoch 8 Valid AUC:(0.5075278451934868, 0.0)
Epoch 8 Test AUC:(0.4954093645188585, 0.0)
Epoch 8 a 0.6240044889911529 b 0.5879470033030356 c 0.5876165690921968
  1%|          | 9/1000 [02:49<5:07:28, 18.62s/it]Epoch 9 Valid AUC:(0.5087061149434348, 0.0)
Epoch 9 Test AUC:(0.4965496124148633, 0.0)
Epoch 9 a 0.6115694252714035 b 0.5688333266204403 c 0.5685863168008866
  1%|          | 10/1000 [03:09<5:11:59, 18.91s/it]Epoch 10 Valid AUC:(0.5103835274828517, 0.0)
Epoch 10 Test AUC:(0.49771281097644143, 0.0)
Epoch 10 a 0.5992949931852279 b 0.5511937295236895 c 0.5509810226578866
  1%|          | 11/1000 [03:28<5:11:38, 18.91s/it]Epoch 11 Valid AUC:(0.5118868306674758, 0.0)
Epoch 11 Test AUC:(0.4987008396946503, 0.0)
Epoch 11 a 0.5875513438255556 b 0.5356141223061469 c 0.535473570227623
  1%|          | 12/1000 [03:47<5:10:55, 18.88s/it]Epoch 12 Valid AUC:(0.5134546171369968, 0.0)
Epoch 12 Test AUC:(0.49992388613564276, 0.0)
Epoch 12 a 0.5763110263693717 b 0.5223233469070927 c 0.5221627224837581
  1%|▏         | 13/1000 [04:05<5:07:53, 18.72s/it]Epoch 13 Valid AUC:(0.5147468114153031, 0.0)
Epoch 13 Test AUC:(0.5008428148804915, 0.0)
Epoch 13 a 0.5659029233840204 b 0.5108676163419601 c 0.5107362159798222
  1%|▏         | 14/1000 [04:23<5:05:44, 18.60s/it]Epoch 14 Valid AUC:(0.5169556013378833, 0.0)
Epoch 14 Test AUC:(0.5026368018822145, 0.0)
Epoch 14 a 0.5562976127670657 b 0.5014963046677651 c 0.501409356392199
  2%|▏         | 15/1000 [04:43<5:11:04, 18.95s/it]Epoch 15 Valid AUC:(0.5192719783180116, 0.0)
Epoch 15 Test AUC:(0.5044535813575164, 0.0)
Epoch 15 a 0.5476188678895274 b 0.49353830636509005 c 0.49342849754518076
  2%|▏         | 16/1000 [05:02<5:11:35, 19.00s/it]Epoch 16 Valid AUC:(0.5212856676958292, 0.0)
Epoch 16 Test AUC:(0.5062507321991284, 0.0)
Epoch 16 a 0.5398041928006757 b 0.4870355965629701 c 0.4869116306785614
  2%|▏         | 17/1000 [05:20<5:06:38, 18.72s/it]Epoch 17 Valid AUC:(0.523288499429015, 0.0)
Epoch 17 Test AUC:(0.5081549448173094, 0.0)
Epoch 17 a 0.5329071677500202 b 0.48178354674769985 c 0.48165081705777874
  2%|▏         | 18/1000 [05:38<5:04:26, 18.60s/it]Epoch 18 Valid AUC:(0.5253187828557812, 0.0)
Epoch 18 Test AUC:(0.5102920545304565, 0.0)
Epoch 18 a 0.526903506248228 b 0.4769923384151151 c 0.4768251598842682
  2%|▏         | 19/1000 [05:57<5:02:13, 18.48s/it]Epoch 19 Valid AUC:(0.527084795672149, 0.0)
Epoch 19 Test AUC:(0.5122678212356412, 0.0)
Epoch 19 a 0.5216870341570147 b 0.47340112924575806 c 0.47316533206932004
  2%|▏         | 20/1000 [06:16<5:08:22, 18.88s/it]Epoch 20 Valid AUC:(0.5288087069205519, 0.0)
Epoch 20 Test AUC:(0.5142106327004683, 0.0)
Epoch 20 a 0.5171963896962904 b 0.47055939344629166 c 0.4702330385485003
  2%|▏         | 21/1000 [06:36<5:08:44, 18.92s/it]Epoch 21 Valid AUC:(0.5304578757427362, 0.0)
Epoch 21 Test AUC:(0.5161901660853047, 0.0)
Epoch 21 a 0.5134074678344112 b 0.4682044225835031 c 0.46776987876622905
  2%|▏         | 22/1000 [06:54<5:07:46, 18.88s/it]Epoch 22 Valid AUC:(0.532423704079622, 0.0)
Epoch 22 Test AUC:(0.5184808588477674, 0.0)
Epoch 22 a 0.5102402250612935 b 0.4660749923317663 c 0.4654749701580694
  2%|▏         | 23/1000 [07:13<5:05:19, 18.75s/it]Epoch 23 Valid AUC:(0.5345179901944088, 0.0)
Epoch 23 Test AUC:(0.5207890980952363, 0.0)
Epoch 23 a 0.5075971243842956 b 0.4643360111982592 c 0.4635438604220267
  2%|▏         | 24/1000 [07:31<5:01:56, 18.56s/it]Epoch 24 Valid AUC:(0.536823145557871, 0.0)
Epoch 24 Test AUC:(0.5232001108335868, 0.0)
Epoch 24 a 0.5053234189268081 b 0.46278550620040587 c 0.46174381072482756
  2%|▎         | 25/1000 [07:50<5:05:28, 18.80s/it]Epoch 25 Valid AUC:(0.5393577160830711, 0.0)
Epoch 25 Test AUC:(0.5257724965081149, 0.0)
Epoch 25 a 0.5033469476526783 b 0.46138784265325916 c 0.4599727860862209
  3%|▎         | 26/1000 [08:09<5:05:19, 18.81s/it]Epoch 26 Valid AUC:(0.5423276868728287, 0.0)
Epoch 26 Test AUC:(0.528938542534144, 0.0)
Epoch 26 a 0.5014999840528734 b 0.46009059394559554 c 0.45823671380358355
  3%|▎         | 27/1000 [08:28<5:04:50, 18.80s/it]Epoch 27 Valid AUC:(0.5454071504469484, 0.0)
Epoch 27 Test AUC:(0.5322244852655893, 0.0)
Epoch 27 a 0.4998646368903498 b 0.45876420577687604 c 0.456336033200064
  3%|▎         | 28/1000 [08:46<5:01:26, 18.61s/it]Epoch 28 Valid AUC:(0.5487359669044227, 0.0)
Epoch 28 Test AUC:(0.5357463093625987, 0.0)
Epoch 28 a 0.4980831992241644 b 0.45775483332334027 c 0.4546522082340333
  3%|▎         | 29/1000 [09:04<4:58:49, 18.47s/it]Epoch 29 Valid AUC:(0.552115668959171, 0.0)
Epoch 29 Test AUC:(0.5394289933406685, 0.0)
Epoch 29 a 0.4962954516372373 b 0.4565535930375899 c 0.4525449989784148
  3%|▎         | 30/1000 [09:23<5:01:47, 18.67s/it]Epoch 30 Valid AUC:(0.5555512279052827, 0.0)
Epoch 30 Test AUC:(0.5432401377691515, 0.0)
Epoch 30 a 0.49431686031241573 b 0.455334794377127 c 0.4503593920700012
  3%|▎         | 31/1000 [09:42<5:02:37, 18.74s/it]Epoch 31 Valid AUC:(0.5588519403390164, 0.0)
Epoch 31 Test AUC:(0.5471228875901497, 0.0)
Epoch 31 a 0.49234544101261324 b 0.4544225887906167 c 0.44835716029328687
  3%|▎         | 32/1000 [10:01<5:02:26, 18.75s/it]Epoch 32 Valid AUC:(0.5619870032045738, 0.0)
Epoch 32 Test AUC:(0.5509339251321499, 0.0)
Epoch 32 a 0.49007100563856865 b 0.4536052504854818 c 0.44624195488229873
  3%|▎         | 33/1000 [10:19<5:01:14, 18.69s/it]Epoch 33 Valid AUC:(0.56497527896816, 0.0)
Epoch 33 Test AUC:(0.5546471658179046, 0.0)
Epoch 33 a 0.4875653451008181 b 0.4528432875390976 c 0.4440912854286932
  3%|▎         | 34/1000 [10:38<4:59:03, 18.58s/it]Epoch 34 Valid AUC:(0.5678695551090878, 0.0)
Epoch 34 Test AUC:(0.5582476412643715, 0.0)
Epoch 34 a 0.4852438030704375 b 0.45239963574755576 c 0.4421276853930566
  4%|▎         | 35/1000 [10:57<5:01:43, 18.76s/it]Epoch 35 Valid AUC:(0.5705196957263511, 0.0)
Epoch 35 Test AUC:(0.5617309049938686, 0.0)
Epoch 35 a 0.48263511061668396 b 0.45189071062111086 c 0.43992163937899376
  4%|▎         | 36/1000 [11:16<5:01:16, 18.75s/it]Epoch 36 Valid AUC:(0.5729205834244101, 0.0)
Epoch 36 Test AUC:(0.5650749426664113, 0.0)
Epoch 36 a 0.4803180483079726 b 0.4517950857839277 c 0.4381390824433296
  4%|▎         | 37/1000 [11:35<5:02:12, 18.83s/it]Epoch 37 Valid AUC:(0.5750825914062451, 0.0)
Epoch 37 Test AUC:(0.5681571084562476, 0.0)
Epoch 37 a 0.4777963993049437 b 0.4516344962100829 c 0.43618302527935277
  4%|▍         | 38/1000 [11:53<4:59:41, 18.69s/it]Epoch 38 Valid AUC:(0.5771266083693514, 0.0)
Epoch 38 Test AUC:(0.5711555949564784, 0.0)
Epoch 38 a 0.4754852693407766 b 0.4520233953672071 c 0.43446071445941925
  4%|▍         | 39/1000 [12:11<4:56:49, 18.53s/it]Epoch 39 Valid AUC:(0.5791356840171554, 0.0)
Epoch 39 Test AUC:(0.5740725826513516, 0.0)
Epoch 39 a 0.4731699153780937 b 0.45235187416115114 c 0.43263689380499626
  4%|▍         | 40/1000 [12:30<4:58:37, 18.66s/it]Epoch 40 Valid AUC:(0.5810672233688993, 0.0)
Epoch 40 Test AUC:(0.5768790454476151, 0.0)
Epoch 40 a 0.4710835963487625 b 0.4529416914428434 c 0.43106098232730744
  4%|▍         | 41/1000 [12:49<5:00:59, 18.83s/it]Epoch 41 Valid AUC:(0.5828471017255494, 0.0)
Epoch 41 Test AUC:(0.5796410007124668, 0.0)
Epoch 41 a 0.46891397670392065 b 0.45346864168682405 c 0.4291853604297484
  4%|▍         | 42/1000 [13:09<5:02:05, 18.92s/it]Epoch 42 Valid AUC:(0.5844321076607542, 0.0)
Epoch 42 Test AUC:(0.5822965440705645, 0.0)
Epoch 42 a 0.4670281357342197 b 0.4540171873184942 c 0.4273743228085579
  4%|▍         | 43/1000 [13:27<4:59:16, 18.76s/it]Epoch 43 Valid AUC:(0.5857942563387986, 0.0)
Epoch 43 Test AUC:(0.5848849627175031, 0.0)
Epoch 43 a 0.4655403989937998 b 0.45485343736025596 c 0.4260567306510864
  4%|▍         | 44/1000 [13:46<4:58:31, 18.74s/it]Epoch 44 Valid AUC:(0.5870949988335465, 0.0)
Epoch 44 Test AUC:(0.5873891377142075, 0.0)
Epoch 44 a 0.46407659904610726 b 0.45581867521808994 c 0.4246325632256846
  4%|▍         | 45/1000 [14:05<4:59:29, 18.82s/it]Epoch 45 Valid AUC:(0.5883192725980957, 0.0)
Epoch 45 Test AUC:(0.5897729200522158, 0.0)
Epoch 45 a 0.4627444335529881 b 0.4565467252846687 c 0.4231670369063654
  5%|▍         | 46/1000 [14:23<4:58:39, 18.78s/it]Epoch 46 Valid AUC:(0.5894576745943604, 0.0)
Epoch 46 Test AUC:(0.5919835591145676, 0.0)
Epoch 46 a 0.4613801204869824 b 0.4571361250935062 c 0.4217045376858404
  5%|▍         | 47/1000 [14:42<4:59:06, 18.83s/it]Epoch 47 Valid AUC:(0.5905947591143877, 0.0)
Epoch 47 Test AUC:(0.5941700632091172, 0.0)
Epoch 47 a 0.4602575330964981 b 0.45776122399876196 c 0.4202101718514196
  5%|▍         | 48/1000 [15:01<4:59:19, 18.86s/it]Epoch 48 Valid AUC:(0.591654330407005, 0.0)
Epoch 48 Test AUC:(0.596247987739043, 0.0)
Epoch 48 a 0.45909543143164727 b 0.4583492807803615 c 0.4186809531623317
  5%|▍         | 49/1000 [15:20<4:57:52, 18.79s/it]Epoch 49 Valid AUC:(0.5925596531709459, 0.0)
Epoch 49 Test AUC:(0.5982183759164164, 0.0)
Epoch 49 a 0.4582661986351013 b 0.4590488479983422 c 0.41744781429729155
  5%|▌         | 50/1000 [15:38<4:56:39, 18.74s/it]Epoch 50 Valid AUC:(0.5934510809179961, 0.0)
Epoch 50 Test AUC:(0.6001298482645049, 0.0)
Epoch 50 a 0.4573269705137899 b 0.4592760402348734 c 0.4159409620108143
  5%|▌         | 51/1000 [15:57<4:53:35, 18.56s/it]Epoch 51 Valid AUC:(0.5942476439680104, 0.0)
Epoch 51 Test AUC:(0.6020821811772142, 0.0)
Epoch 51 a 0.45669569651926717 b 0.4596041594782183 c 0.41458013125004306
  5%|▌         | 52/1000 [16:16<4:56:51, 18.79s/it]Epoch 52 Valid AUC:(0.5950266466489567, 0.0)
Epoch 52 Test AUC:(0.603845910753404, 0.0)
Epoch 52 a 0.45596321191518535 b 0.4599780022136627 c 0.41349974995659244
  5%|▌         | 53/1000 [16:35<4:58:36, 18.92s/it]Epoch 53 Valid AUC:(0.5957665684735052, 0.0)
Epoch 53 Test AUC:(0.6054464759759653, 0.0)
Epoch 53 a 0.45497485875122007 b 0.4601478725671768 c 0.41176311695767986
  5%|▌         | 54/1000 [16:54<4:57:50, 18.89s/it]Epoch 54 Valid AUC:(0.5964018803779559, 0.0)
Epoch 54 Test AUC:(0.6070206103090756, 0.0)
Epoch 54 a 0.4546757833130898 b 0.4604073606671826 c 0.4108928713587023
  6%|▌         | 55/1000 [17:13<4:56:18, 18.81s/it]Epoch 55 Valid AUC:(0.5969679491660458, 0.0)
Epoch 55 Test AUC:(0.6085011206342265, 0.0)
Epoch 55 a 0.45386229118993204 b 0.4604051699561457 c 0.4094053756806158
  6%|▌         | 56/1000 [17:31<4:52:50, 18.61s/it]Epoch 56 Valid AUC:(0.5975144301070449, 0.0)
Epoch 56 Test AUC:(0.6098730428438348, 0.0)
Epoch 56 a 0.45349419813963676 b 0.4604202417596694 c 0.4081963293494717
  6%|▌         | 57/1000 [17:50<4:54:36, 18.74s/it]Epoch 57 Valid AUC:(0.59801340116323, 0.0)
Epoch 57 Test AUC:(0.6110170531440319, 0.0)
Epoch 57 a 0.452714993588386 b 0.4604758560176819 c 0.40702489691395916
  6%|▌         | 58/1000 [18:09<4:54:36, 18.76s/it]Epoch 58 Valid AUC:(0.5985042943471165, 0.0)
Epoch 58 Test AUC:(0.6121151834903789, 0.0)
Epoch 58 a 0.45224631890173883 b 0.4604915952490222 c 0.4058930306665359
  6%|▌         | 59/1000 [18:27<4:51:40, 18.60s/it]Epoch 59 Valid AUC:(0.5989416144359963, 0.0)
Epoch 59 Test AUC:(0.6131764850302338, 0.0)
Epoch 59 a 0.45194899314834225 b 0.4608383366177159 c 0.4051205186593917
  6%|▌         | 60/1000 [18:45<4:51:05, 18.58s/it]Epoch 60 Valid AUC:(0.5993307312989682, 0.0)
Epoch 60 Test AUC:(0.6141967849153108, 0.0)
Epoch 60 a 0.4513502394960773 b 0.4604613533423793 c 0.4037609876644227
  6%|▌         | 61/1000 [19:04<4:49:28, 18.50s/it]Epoch 61 Valid AUC:(0.5997634530369345, 0.0)
Epoch 61 Test AUC:(0.6151749586998113, 0.0)
Epoch 61 a 0.45089419450490703 b 0.4604050406525212 c 0.4024610560267202
  6%|▌         | 62/1000 [19:22<4:50:37, 18.59s/it]Epoch 62 Valid AUC:(0.6001019188339083, 0.0)
Epoch 62 Test AUC:(0.616072377608874, 0.0)
Epoch 62 a 0.450541325874867 b 0.4602276211784732 c 0.4015374279791309
  6%|▋         | 63/1000 [19:41<4:51:57, 18.70s/it]Epoch 63 Valid AUC:(0.6004869179428431, 0.0)
Epoch 63 Test AUC:(0.6169052328069041, 0.0)
Epoch 63 a 0.4501951469048377 b 0.4601218181271707 c 0.4007034042189198
  6%|▋         | 64/1000 [20:00<4:52:08, 18.73s/it]Epoch 64 Valid AUC:(0.6008008553568368, 0.0)
Epoch 64 Test AUC:(0.6177081512388491, 0.0)
Epoch 64 a 0.4499620268902471 b 0.4601741111086261 c 0.3998123943325012
  6%|▋         | 65/1000 [20:19<4:53:36, 18.84s/it]Epoch 65 Valid AUC:(0.6011388367121592, 0.0)
Epoch 65 Test AUC:(0.6182915633143855, 0.0)
Epoch 65 a 0.44949905069604995 b 0.45972848659561527 c 0.39853417512870604
  7%|▋         | 66/1000 [20:38<4:54:31, 18.92s/it]Epoch 66 Valid AUC:(0.6014052642413389, 0.0)
Epoch 66 Test AUC:(0.6188725725817898, 0.0)
Epoch 66 a 0.449225255798909 b 0.4598528605795676 c 0.39800424969965414
  7%|▋         | 67/1000 [20:58<4:55:43, 19.02s/it]Epoch 67 Valid AUC:(0.601754787611245, 0.0)
Epoch 67 Test AUC:(0.619437484744894, 0.0)
Epoch 67 a 0.448728408303953 b 0.45929494620330874 c 0.39662167213616834
  7%|▋         | 68/1000 [21:17<4:54:55, 18.99s/it]Epoch 68 Valid AUC:(0.6020208088758651, 0.0)
Epoch 68 Test AUC:(0.6198554750242866, 0.0)
Epoch 68 a 0.44868399347028426 b 0.4595751457156674 c 0.396227287188653
  7%|▋         | 69/1000 [21:36<4:56:11, 19.09s/it]Epoch 69 Valid AUC:(0.602298146594935, 0.0)
Epoch 69 Test AUC:(0.6203628737087594, 0.0)
Epoch 69 a 0.4484949433995831 b 0.45927983065766675 c 0.3953978200593302
  7%|▋         | 70/1000 [21:55<4:55:08, 19.04s/it]Epoch 70 Valid AUC:(0.602598970762957, 0.0)
Epoch 70 Test AUC:(0.6208236014794098, 0.0)
Epoch 70 a 0.4480992284032606 b 0.45860357173988897 c 0.39389463994772206
  7%|▋         | 71/1000 [22:14<4:54:28, 19.02s/it]Epoch 71 Valid AUC:(0.6028615714594088, 0.0)
Epoch 71 Test AUC:(0.6214249662085867, 0.0)
Epoch 71 a 0.4476410393272677 b 0.4584981842387107 c 0.39326416628976024
  7%|▋         | 72/1000 [22:33<4:52:43, 18.93s/it]Epoch 72 Valid AUC:(0.6031393731146633, 0.0)
Epoch 72 Test AUC:(0.621873205362594, 0.0)
Epoch 72 a 0.4475588599039662 b 0.45792428740570623 c 0.39238795277572447
  7%|▋         | 73/1000 [22:51<4:49:36, 18.75s/it]Epoch 73 Valid AUC:(0.6034476753700821, 0.0)
Epoch 73 Test AUC:(0.6223791332890644, 0.0)
Epoch 73 a 0.44728860619568056 b 0.45788437248237673 c 0.39178612539845126
  7%|▋         | 74/1000 [23:09<4:45:35, 18.50s/it]Epoch 74 Valid AUC:(0.6037720782616565, 0.0)
Epoch 74 Test AUC:(0.6227780293671809, 0.0)
Epoch 74 a 0.4471448998778097 b 0.4577082734434835 c 0.39100285186882944
  8%|▊         | 75/1000 [23:27<4:43:57, 18.42s/it]Epoch 75 Valid AUC:(0.6040932784556463, 0.0)
Epoch 75 Test AUC:(0.6232187437128035, 0.0)
Epoch 75 a 0.44695102543600146 b 0.45739403270906015 c 0.3904674444948473
  8%|▊         | 76/1000 [23:46<4:45:58, 18.57s/it]Epoch 76 Valid AUC:(0.6044055690243435, 0.0)
Epoch 76 Test AUC:(0.6235840902617183, 0.0)
Epoch 76 a 0.4467192813754082 b 0.4571854443319382 c 0.3896912735316061
  8%|▊         | 77/1000 [24:05<4:46:41, 18.64s/it]Epoch 77 Valid AUC:(0.6047563611700034, 0.0)
Epoch 77 Test AUC:(0.6240441339588793, 0.0)
Epoch 77 a 0.4463820731447589 b 0.45671672590317264 c 0.38850563620367357
  8%|▊         | 78/1000 [24:24<4:47:53, 18.74s/it]Epoch 78 Valid AUC:(0.6051301450702306, 0.0)
Epoch 78 Test AUC:(0.6245120573275474, 0.0)
Epoch 78 a 0.44626112811027036 b 0.45642792145090716 c 0.38814452194398447
  8%|▊         | 79/1000 [24:43<4:50:16, 18.91s/it]Epoch 79 Valid AUC:(0.6056153056945752, 0.0)
Epoch 79 Test AUC:(0.6249817892155036, 0.0)
Epoch 79 a 0.4461772999455852 b 0.4558585735578691 c 0.38737292155142755
  8%|▊         | 80/1000 [25:02<4:50:35, 18.95s/it]Epoch 80 Valid AUC:(0.6060754714365718, 0.0)
Epoch 80 Test AUC:(0.6254211396896066, 0.0)
Epoch 80 a 0.4457934813634042 b 0.4556229383714737 c 0.38637465334707694
  8%|▊         | 81/1000 [25:21<4:48:50, 18.86s/it]Epoch 81 Valid AUC:(0.6065605346599495, 0.0)
Epoch 81 Test AUC:(0.6258547311200195, 0.0)
Epoch 81 a 0.4455676057165669 b 0.4551979969105413 c 0.38597955722962657
  8%|▊         | 82/1000 [25:40<4:49:50, 18.94s/it]Epoch 82 Valid AUC:(0.6071137747154185, 0.0)
Epoch 82 Test AUC:(0.626187344752461, 0.0)
Epoch 82 a 0.4454704523086548 b 0.45526827415150983 c 0.38579039612124044
  8%|▊         | 83/1000 [25:59<4:50:42, 19.02s/it]Epoch 83 Valid AUC:(0.6077219322555565, 0.0)
Epoch 83 Test AUC:(0.6267240175068258, 0.0)
Epoch 83 a 0.4451030677845401 b 0.4545780982702009 c 0.3843557118408142
  8%|▊         | 84/1000 [26:18<4:49:53, 18.99s/it]Epoch 84 Valid AUC:(0.6084761489535968, 0.0)
Epoch 84 Test AUC:(0.6272661542981883, 0.0)
Epoch 84 a 0.4450273319117485 b 0.4537993854572696 c 0.38394445180892944
  8%|▊         | 85/1000 [26:37<4:49:10, 18.96s/it]Epoch 85 Valid AUC:(0.6092744600946496, 0.0)
Epoch 85 Test AUC:(0.6277828136275254, 0.0)
Epoch 85 a 0.44475431692215706 b 0.45395939508753436 c 0.38382703642691335
  9%|▊         | 86/1000 [26:55<4:46:55, 18.84s/it]Epoch 86 Valid AUC:(0.6102327625766538, 0.0)
Epoch 86 Test AUC:(0.6283890310030186, 0.0)
Epoch 86 a 0.4442368113706189 b 0.4537212841453091 c 0.38308810322515424
  9%|▊         | 87/1000 [27:14<4:43:52, 18.66s/it]Epoch 87 Valid AUC:(0.6112234547249444, 0.0)
Epoch 87 Test AUC:(0.629258774863971, 0.0)
Epoch 87 a 0.4438619673732788 b 0.45340391320566975 c 0.38253340197186314
  9%|▉         | 88/1000 [27:32<4:42:29, 18.59s/it]Epoch 88 Valid AUC:(0.6124416217051841, 0.0)
Epoch 88 Test AUC:(0.6299984763545659, 0.0)
Epoch 88 a 0.44354914825770164 b 0.45307911115307964 c 0.38180796729941524
  9%|▉         | 89/1000 [27:51<4:44:19, 18.73s/it]Epoch 89 Valid AUC:(0.6138440508094297, 0.0)
Epoch 89 Test AUC:(0.6308946596558882, 0.0)
Epoch 89 a 0.4431502549879013 b 0.4528884063324621 c 0.38144894160570636
  9%|▉         | 90/1000 [28:10<4:44:53, 18.78s/it]Epoch 90 Valid AUC:(0.615324737745846, 0.0)
Epoch 90 Test AUC:(0.6317212598569485, 0.0)
Epoch 90 a 0.44239958832340853 b 0.45231533242810157 c 0.3807000013128404
  9%|▉         | 91/1000 [28:29<4:46:01, 18.88s/it]Epoch 91 Valid AUC:(0.6170658377017325, 0.0)
Epoch 91 Test AUC:(0.6328055248887547, 0.0)
Epoch 91 a 0.44201463244615063 b 0.4524058702011262 c 0.38060983150236066
  9%|▉         | 92/1000 [28:48<4:46:30, 18.93s/it]Epoch 92 Valid AUC:(0.6190217798404728, 0.0)
Epoch 92 Test AUC:(0.633833965248357, 0.0)
Epoch 92 a 0.4412570821662103 b 0.4519229387083361 c 0.37969415250324434
  9%|▉         | 93/1000 [29:08<4:48:24, 19.08s/it]Epoch 93 Valid AUC:(0.6212896857420342, 0.0)
Epoch 93 Test AUC:(0.6351495582815627, 0.0)
Epoch 93 a 0.4406143842685607 b 0.4520573613624419 c 0.3795387124822986
  9%|▉         | 94/1000 [29:27<4:48:08, 19.08s/it]Epoch 94 Valid AUC:(0.6237879487752116, 0.0)
Epoch 94 Test AUC:(0.6366781119429744, 0.0)
Epoch 94 a 0.4398216054804863 b 0.45180117266793407 c 0.37893651810384565
 10%|▉         | 95/1000 [29:46<4:48:49, 19.15s/it]Epoch 95 Valid AUC:(0.6265052640198798, 0.0)
Epoch 95 Test AUC:(0.6381302503201475, 0.0)
Epoch 95 a 0.4387030940382711 b 0.45180151611566544 c 0.3782898507291271
 10%|▉         | 96/1000 [30:05<4:47:44, 19.10s/it]Epoch 96 Valid AUC:(0.6295448585587244, 0.0)
Epoch 96 Test AUC:(0.6399743884595708, 0.0)
Epoch 96 a 0.437630232063032 b 0.4517407035154681 c 0.3779529712853893
 10%|▉         | 97/1000 [30:24<4:48:12, 19.15s/it]Epoch 97 Valid AUC:(0.6328225254110408, 0.0)
Epoch 97 Test AUC:(0.6417739506602333, 0.0)
Epoch 97 a 0.43680510285400576 b 0.4516322502205449 c 0.37775447724326966
 10%|▉         | 98/1000 [30:44<4:48:54, 19.22s/it]Epoch 98 Valid AUC:(0.636505458462968, 0.0)
Epoch 98 Test AUC:(0.6437629499119809, 0.0)
Epoch 98 a 0.43555234420684075 b 0.45165124463458217 c 0.3769938974611221
 10%|▉         | 99/1000 [31:02<4:46:49, 19.10s/it]Epoch 99 Valid AUC:(0.640428415692481, 0.0)
Epoch 99 Test AUC:(0.646100852296139, 0.0)
Epoch 99 a 0.4341603707401983 b 0.45214648088139875 c 0.37686798673483635
 10%|█         | 100/1000 [31:21<4:45:36, 19.04s/it]Epoch 100 Valid AUC:(0.6447742443463814, 0.0)
Epoch 100 Test AUC:(0.6485175043653187, 0.0)
Epoch 100 a 0.4323830335370956 b 0.4520908303318485 c 0.3760848143889058
 10%|█         | 101/1000 [31:40<4:43:17, 18.91s/it]Epoch 101 Valid AUC:(0.649130388531637, 0.0)
Epoch 101 Test AUC:(0.651020875575673, 0.0)
Epoch 101 a 0.4311646172596562 b 0.452925167256786 c 0.3761410624269516
 10%|█         | 102/1000 [31:59<4:43:00, 18.91s/it]Epoch 102 Valid AUC:(0.6537946875892693, 0.0)
Epoch 102 Test AUC:(0.6536574358944365, 0.0)
Epoch 102 a 0.4294779110820063 b 0.4529453871711608 c 0.37566075642262736
 10%|█         | 103/1000 [32:18<4:44:30, 19.03s/it]Epoch 103 Valid AUC:(0.6584842621978255, 0.0)
Epoch 103 Test AUC:(0.656331419308536, 0.0)
Epoch 103 a 0.427814846077273 b 0.4535627922704143 c 0.375687787129033
 10%|█         | 104/1000 [32:37<4:44:40, 19.06s/it]Epoch 104 Valid AUC:(0.6633563534025326, 0.0)
Epoch 104 Test AUC:(0.6591970031561313, 0.0)
Epoch 104 a 0.42592163191687676 b 0.4545923231109496 c 0.37549922999835783
 10%|█         | 105/1000 [32:57<4:47:20, 19.26s/it]Epoch 105 Valid AUC:(0.668426544076511, 0.0)
Epoch 105 Test AUC:(0.6620155997059151, 0.0)
Epoch 105 a 0.4238343409472896 b 0.45528929488312814 c 0.3747478247650208
 11%|█         | 106/1000 [33:16<4:45:30, 19.16s/it]Epoch 106 Valid AUC:(0.6733865716936837, 0.0)
Epoch 106 Test AUC:(0.6649239167693087, 0.0)
Epoch 106 a 0.42184185404931346 b 0.45565144813829855 c 0.37437101093030745
 11%|█         | 107/1000 [33:35<4:45:05, 19.16s/it]Epoch 107 Valid AUC:(0.6784669010393668, 0.0)
Epoch 107 Test AUC:(0.6678694816342066, 0.0)
Epoch 107 a 0.42002887639307207 b 0.45749816779167424 c 0.374917091140824
 11%|█         | 108/1000 [33:55<4:47:06, 19.31s/it]Epoch 108 Valid AUC:(0.6834134860415084, 0.0)
Epoch 108 Test AUC:(0.6708109463336267, 0.0)
Epoch 108 a 0.4179799482226372 b 0.45827842191342383 c 0.3743110351985501
 11%|█         | 109/1000 [34:14<4:46:09, 19.27s/it]Epoch 109 Valid AUC:(0.6881963028520459, 0.0)
Epoch 109 Test AUC:(0.6735947406446313, 0.0)
Epoch 109 a 0.4157547224913874 b 0.45939737966945093 c 0.37380878507129606
 11%|█         | 110/1000 [34:34<4:48:05, 19.42s/it]Epoch 110 Valid AUC:(0.6930427378731029, 0.0)
Epoch 110 Test AUC:(0.6764905263367887, 0.0)
Epoch 110 a 0.4135024845600128 b 0.4608295333962287 c 0.3733673696556399
 11%|█         | 111/1000 [34:53<4:44:51, 19.23s/it]Epoch 111 Valid AUC:(0.6979261839800098, 0.0)
Epoch 111 Test AUC:(0.6791890380609469, 0.0)
Epoch 111 a 0.41125582687316403 b 0.46183249786976843 c 0.37284940769595487
 11%|█         | 112/1000 [35:12<4:43:48, 19.18s/it]Epoch 112 Valid AUC:(0.7026365152472601, 0.0)
Epoch 112 Test AUC:(0.6819253961509126, 0.0)
Epoch 112 a 0.4092576508560488 b 0.463712936687854 c 0.37278614193201065
 11%|█▏        | 113/1000 [35:30<4:40:22, 18.97s/it]Epoch 113 Valid AUC:(0.7071282889974043, 0.0)
Epoch 113 Test AUC:(0.6846514076293494, 0.0)
Epoch 113 a 0.40694719961574 b 0.46469295962202933 c 0.37211199537400275
 11%|█▏        | 114/1000 [35:49<4:38:56, 18.89s/it]Epoch 114 Valid AUC:(0.7117044235192536, 0.0)
Epoch 114 Test AUC:(0.6871745742163065, 0.0)
Epoch 114 a 0.4048433013020023 b 0.46651609530372007 c 0.3716779829513642
 12%|█▏        | 115/1000 [36:08<4:39:05, 18.92s/it]Epoch 115 Valid AUC:(0.7159151249922002, 0.0)
Epoch 115 Test AUC:(0.6896054721159054, 0.0)
Epoch 115 a 0.40297751921799874 b 0.46856393977519006 c 0.3718488536054088
 12%|█▏        | 116/1000 [36:27<4:38:55, 18.93s/it]Epoch 116 Valid AUC:(0.7202979916453757, 0.0)
Epoch 116 Test AUC:(0.6921281897796351, 0.0)
Epoch 116 a 0.40099391004731577 b 0.4705643850949503 c 0.37150910953360217
 12%|█▏        | 117/1000 [36:46<4:40:12, 19.04s/it]Epoch 117 Valid AUC:(0.7241903085812323, 0.0)
Epoch 117 Test AUC:(0.6942296250603037, 0.0)
Epoch 117 a 0.39898661908603483 b 0.47254239599550923 c 0.37130279406424493
 12%|█▏        | 118/1000 [37:05<4:39:55, 19.04s/it]Epoch 118 Valid AUC:(0.72789960397382, 0.0)
Epoch 118 Test AUC:(0.6965245120483491, 0.0)
Epoch 118 a 0.39678758791377466 b 0.4740311376029445 c 0.37023612472318834
 12%|█▏        | 119/1000 [37:24<4:40:02, 19.07s/it]Epoch 119 Valid AUC:(0.7317290601198344, 0.0)
Epoch 119 Test AUC:(0.6986132663167058, 0.0)
Epoch 119 a 0.39469351234935945 b 0.4760746734757577 c 0.3697674598905348
 12%|█▏        | 120/1000 [37:44<4:42:13, 19.24s/it]Epoch 120 Valid AUC:(0.7350983377079354, 0.0)
Epoch 120 Test AUC:(0.7005617684178739, 0.0)
Epoch 120 a 0.39278779755676946 b 0.4782624509065382 c 0.36929727634114606
 12%|█▏        | 121/1000 [38:03<4:41:45, 19.23s/it]Epoch 121 Valid AUC:(0.7385590876199208, 0.0)
Epoch 121 Test AUC:(0.7026213597782804, 0.0)
Epoch 121 a 0.3913975807447587 b 0.4798381443946592 c 0.3694730588505345
 12%|█▏        | 122/1000 [38:22<4:40:56, 19.20s/it]Epoch 122 Valid AUC:(0.7417362353927514, 0.0)
Epoch 122 Test AUC:(0.7044399648747075, 0.0)
Epoch 122 a 0.38939122014468713 b 0.4828021459041103 c 0.3684516957690639
 12%|█▏        | 123/1000 [38:42<4:41:44, 19.28s/it]Epoch 123 Valid AUC:(0.7448050079291564, 0.0)
Epoch 123 Test AUC:(0.7060892917106938, 0.0)
Epoch 123 a 0.38786626462974855 b 0.4847125569658895 c 0.368442167678187
 12%|█▏        | 124/1000 [39:01<4:40:03, 19.18s/it]Epoch 124 Valid AUC:(0.7476317275283615, 0.0)
Epoch 124 Test AUC:(0.7077885131568218, 0.0)
Epoch 124 a 0.3865036613518192 b 0.48753367364406586 c 0.3684492654377414
 12%|█▎        | 125/1000 [39:20<4:39:22, 19.16s/it]Epoch 125 Valid AUC:(0.75033204117793, 0.0)
Epoch 125 Test AUC:(0.7093787403187729, 0.0)
Epoch 125 a 0.3848038048994157 b 0.48956266646423646 c 0.36744885338890937
 13%|█▎        | 126/1000 [39:39<4:40:08, 19.23s/it]Epoch 126 Valid AUC:(0.7529753521931817, 0.0)
Epoch 126 Test AUC:(0.7109137670255791, 0.0)
Epoch 126 a 0.3834319376657086 b 0.4917689417639086 c 0.3675561381443854
 13%|█▎        | 127/1000 [39:58<4:36:12, 18.98s/it]Epoch 127 Valid AUC:(0.7553168458068669, 0.0)
Epoch 127 Test AUC:(0.7122059818472806, 0.0)
Epoch 127 a 0.381607509428455 b 0.49370879367474585 c 0.3664375110980003
 13%|█▎        | 128/1000 [40:16<4:33:23, 18.81s/it]Epoch 128 Valid AUC:(0.7574455849505294, 0.0)
Epoch 128 Test AUC:(0.7133789541088402, 0.0)
Epoch 128 a 0.38067667234328484 b 0.4964989652076075 c 0.36672765280931224
 13%|█▎        | 129/1000 [40:34<4:30:24, 18.63s/it]Epoch 129 Valid AUC:(0.7596831773643106, 0.0)
Epoch 129 Test AUC:(0.7146258148581865, 0.0)
Epoch 129 a 0.3792849995436207 b 0.49805906607258704 c 0.3659417150962737
 13%|█▎        | 130/1000 [40:53<4:31:33, 18.73s/it]Epoch 130 Valid AUC:(0.7617499912800503, 0.0)
Epoch 130 Test AUC:(0.7159561154714169, 0.0)
Epoch 130 a 0.3778540931882397 b 0.500548052451303 c 0.365347791342966
 13%|█▎        | 131/1000 [41:13<4:35:19, 19.01s/it]Epoch 131 Valid AUC:(0.7635525832858752, 0.0)
Epoch 131 Test AUC:(0.7171590458763581, 0.0)
Epoch 131 a 0.37664598659161597 b 0.5026314294626636 c 0.3649813919778793
 13%|█▎        | 132/1000 [41:32<4:36:32, 19.12s/it]Epoch 132 Valid AUC:(0.7654610270741264, 0.0)
Epoch 132 Test AUC:(0.7181397550082292, 0.0)
Epoch 132 a 0.3755044884258701 b 0.5045663286601344 c 0.36455235293795984
 13%|█▎        | 133/1000 [41:51<4:36:17, 19.12s/it]Epoch 133 Valid AUC:(0.7672630090423161, 0.0)
Epoch 133 Test AUC:(0.7191722185750417, 0.0)
Epoch 133 a 0.37479379965413 b 0.5067241816751419 c 0.36453813482676783
 13%|█▎        | 134/1000 [42:10<4:34:51, 19.04s/it]Epoch 134 Valid AUC:(0.7687345377246556, 0.0)
Epoch 134 Test AUC:(0.7201391906561513, 0.0)
Epoch 134 a 0.3731749531242155 b 0.5084776825481846 c 0.36334921203313336
 14%|█▎        | 135/1000 [42:29<4:35:11, 19.09s/it]Epoch 135 Valid AUC:(0.7702259246699281, 0.0)
Epoch 135 Test AUC:(0.721004103248084, 0.0)
Epoch 135 a 0.37238052247032044 b 0.5106825499284652 c 0.3631461250685876
 14%|█▎        | 136/1000 [42:49<4:36:00, 19.17s/it]Epoch 136 Valid AUC:(0.7717090914862266, 0.0)
Epoch 136 Test AUC:(0.7217218160514501, 0.0)
Epoch 136 a 0.3716195475670599 b 0.5122255408956159 c 0.36297161636813996
 14%|█▎        | 137/1000 [43:08<4:35:35, 19.16s/it]Epoch 137 Valid AUC:(0.7729362975325177, 0.0)
Epoch 137 Test AUC:(0.7225667494220295, 0.0)
Epoch 137 a 0.3711282567631814 b 0.5149040135645098 c 0.3631238399013396
 14%|█▍        | 138/1000 [43:27<4:36:19, 19.23s/it]Epoch 138 Valid AUC:(0.7740838398405757, 0.0)
Epoch 138 Test AUC:(0.7231720561246897, 0.0)
Epoch 138 a 0.3696245704927752 b 0.516230471432209 c 0.36180433294465464
 14%|█▍        | 139/1000 [43:46<4:34:20, 19.12s/it]Epoch 139 Valid AUC:(0.7753984581283393, 0.0)
Epoch 139 Test AUC:(0.7239136302664622, 0.0)
Epoch 139 a 0.3694522414476641 b 0.5180831892836478 c 0.3622010331000051
 14%|█▍        | 140/1000 [44:05<4:31:48, 18.96s/it]Epoch 140 Valid AUC:(0.7763170979113275, 0.0)
Epoch 140 Test AUC:(0.7244880681529078, 0.0)
Epoch 140 a 0.3687074309395206 b 0.5200979457266869 c 0.36190001882853046
 14%|█▍        | 141/1000 [44:23<4:30:12, 18.87s/it]Epoch 141 Valid AUC:(0.7774561701800358, 0.0)
Epoch 141 Test AUC:(0.7250873379070231, 0.0)
Epoch 141 a 0.36793250494426294 b 0.5214585253307896 c 0.36146427859221736
 14%|█▍        | 142/1000 [44:42<4:28:11, 18.75s/it]Epoch 142 Valid AUC:(0.7782575789281558, 0.0)
Epoch 142 Test AUC:(0.7255743554769675, 0.0)
Epoch 142 a 0.3672330670299069 b 0.5234572401931209 c 0.36104122525261295
 14%|█▍        | 143/1000 [45:01<4:29:14, 18.85s/it]Epoch 143 Valid AUC:(0.7791324074998909, 0.0)
Epoch 143 Test AUC:(0.7260360323995846, 0.0)
Epoch 143 a 0.366531204792761 b 0.5243477525730287 c 0.3607047202606355
 14%|█▍        | 144/1000 [45:20<4:29:03, 18.86s/it]Epoch 144 Valid AUC:(0.7798045997678412, 0.0)
Epoch 144 Test AUC:(0.7266186150360148, 0.0)
Epoch 144 a 0.3658991395946472 b 0.5259793487287336 c 0.36024210890454633
 14%|█▍        | 145/1000 [45:39<4:29:46, 18.93s/it]Epoch 145 Valid AUC:(0.7806886763050699, 0.0)
Epoch 145 Test AUC:(0.727139515620987, 0.0)
Epoch 145 a 0.36551364054602964 b 0.5273751150215825 c 0.3603216546677774
 15%|█▍        | 146/1000 [45:58<4:30:45, 19.02s/it]Epoch 146 Valid AUC:(0.7815871105137823, 0.0)
Epoch 146 Test AUC:(0.7274346847807959, 0.0)
Epoch 146 a 0.36471228469764033 b 0.5287377795865459 c 0.3595881601495127
 15%|█▍        | 147/1000 [46:17<4:31:41, 19.11s/it]Epoch 147 Valid AUC:(0.7822485374117012, 0.0)
Epoch 147 Test AUC:(0.7278714999075282, 0.0)
Epoch 147 a 0.36491397912463835 b 0.5302750737436356 c 0.360064703129953
 15%|█▍        | 148/1000 [46:37<4:31:52, 19.15s/it]Epoch 148 Valid AUC:(0.7827994654757966, 0.0)
Epoch 148 Test AUC:(0.7283092941144425, 0.0)
Epoch 148 a 0.3646248170445042 b 0.5313114985342948 c 0.3600964192901888
 15%|█▍        | 149/1000 [46:56<4:31:02, 19.11s/it]Epoch 149 Valid AUC:(0.783230759520642, 0.0)
Epoch 149 Test AUC:(0.7285812902847939, 0.0)
Epoch 149 a 0.36385776246747664 b 0.5325445374173503 c 0.3594402730945618
 15%|█▌        | 150/1000 [47:15<4:30:55, 19.12s/it]Epoch 150 Valid AUC:(0.7838506474693393, 0.0)
Epoch 150 Test AUC:(0.7286753632159807, 0.0)
Epoch 150 a 0.3637986687883254 b 0.5338647745309337 c 0.3595608609818643
 15%|█▌        | 151/1000 [47:34<4:29:37, 19.06s/it]Epoch 151 Valid AUC:(0.7842640774078908, 0.0)
Epoch 151 Test AUC:(0.7289386374493406, 0.0)
Epoch 151 a 0.36336577779823737 b 0.5343918747478916 c 0.35932119791546174
 15%|█▌        | 152/1000 [47:53<4:30:26, 19.13s/it]Epoch 152 Valid AUC:(0.7847382676075367, 0.0)
Epoch 152 Test AUC:(0.7293113164109714, 0.0)
Epoch 152 a 0.3629470046970152 b 0.5360952168703079 c 0.358982716116213
 15%|█▌        | 153/1000 [48:11<4:27:08, 18.92s/it]Epoch 153 Valid AUC:(0.7851562561676599, 0.0)
Epoch 153 Test AUC:(0.7295465265294239, 0.0)
Epoch 153 a 0.3627124794067875 b 0.536824583045898 c 0.35891742307332253
 15%|█▌        | 154/1000 [48:30<4:25:07, 18.80s/it]Epoch 154 Valid AUC:(0.7856935493779739, 0.0)
Epoch 154 Test AUC:(0.7297069460381753, 0.0)
Epoch 154 a 0.36238064376577256 b 0.5376950915782682 c 0.35867281065833184
 16%|█▌        | 155/1000 [48:49<4:24:36, 18.79s/it]Epoch 155 Valid AUC:(0.7859949553886142, 0.0)
Epoch 155 Test AUC:(0.7298903717934713, 0.0)
Epoch 155 a 0.36181377042685786 b 0.5383642460069349 c 0.35817828462008505
 16%|█▌        | 156/1000 [49:07<4:22:05, 18.63s/it]Epoch 156 Valid AUC:(0.7864276348340553, 0.0)
Epoch 156 Test AUC:(0.7300858714458571, 0.0)
Epoch 156 a 0.36165507786696954 b 0.5387136724687391 c 0.358184004743253
 16%|█▌        | 157/1000 [49:26<4:23:46, 18.77s/it]Epoch 157 Valid AUC:(0.7867285512766775, 0.0)
Epoch 157 Test AUC:(0.7302457950013288, 0.0)
Epoch 157 a 0.3608294400957323 b 0.5399109975945565 c 0.357334783961696
 16%|█▌        | 158/1000 [49:45<4:24:45, 18.87s/it]Epoch 158 Valid AUC:(0.7872480803448478, 0.0)
Epoch 158 Test AUC:(0.730388860420743, 0.0)
Epoch 158 a 0.36113730217179946 b 0.5408736092429007 c 0.3578780651573212
 16%|█▌        | 159/1000 [50:04<4:25:43, 18.96s/it]Epoch 159 Valid AUC:(0.7872556058511365, 0.0)
Epoch 159 Test AUC:(0.730431089132343, 0.0)
Epoch 159 a 0.36139008210551354 b 0.5421434064065257 c 0.35826403263115114
 16%|█▌        | 160/1000 [50:24<4:26:58, 19.07s/it]Epoch 160 Valid AUC:(0.7877510615013696, 0.0)
Epoch 160 Test AUC:(0.7305013776833911, 0.0)
Epoch 160 a 0.36091853582089944 b 0.542267610469172 c 0.35780236028855844
 16%|█▌        | 161/1000 [50:43<4:26:20, 19.05s/it]Epoch 161 Valid AUC:(0.7878818953502276, 0.0)
Epoch 161 Test AUC:(0.7305687118920563, 0.0)
Epoch 161 a 0.36047913422507627 b 0.5430215145311048 c 0.35746816016973987
 16%|█▌        | 162/1000 [51:02<4:25:52, 19.04s/it]Epoch 162 Valid AUC:(0.7881079130124472, 0.0)
Epoch 162 Test AUC:(0.7307899540849446, 0.0)
Epoch 162 a 0.3604431178781294 b 0.5433553389964565 c 0.3575018800554737
 16%|█▋        | 163/1000 [51:21<4:24:39, 18.97s/it]Epoch 163 Valid AUC:(0.7882663369667858, 0.0)
Epoch 163 Test AUC:(0.7308874559344977, 0.0)
Epoch 163 a 0.3604585910516401 b 0.544660143794552 c 0.3575977228822247
 16%|█▋        | 164/1000 [51:40<4:24:30, 18.98s/it]Epoch 164 Valid AUC:(0.7884486356923526, 0.0)
Epoch 164 Test AUC:(0.7308589728245778, 0.0)
Epoch 164 a 0.36035421154191416 b 0.5448315220494424 c 0.35756682027732173
 16%|█▋        | 165/1000 [51:59<4:25:28, 19.08s/it]Epoch 165 Valid AUC:(0.7885775304930132, 0.0)
Epoch 165 Test AUC:(0.730977364568317, 0.0)
Epoch 165 a 0.35960027839868297 b 0.5454710909435826 c 0.356781244998978
 17%|█▋        | 166/1000 [52:18<4:23:36, 18.96s/it]Epoch 166 Valid AUC:(0.7887792927512786, 0.0)
Epoch 166 Test AUC:(0.7310107601809834, 0.0)
Epoch 166 a 0.3600590889973025 b 0.5459988535411896 c 0.3573534296404931
 17%|█▋        | 167/1000 [52:36<4:23:20, 18.97s/it]Epoch 167 Valid AUC:(0.7889635228354926, 0.0)
Epoch 167 Test AUC:(0.7310289864640198, 0.0)
Epoch 167 a 0.35989758252136167 b 0.5466374029074946 c 0.357275013481417
 17%|█▋        | 168/1000 [52:55<4:20:58, 18.82s/it]Epoch 168 Valid AUC:(0.7891412706290378, 0.0)
Epoch 168 Test AUC:(0.7311383142340229, 0.0)
Epoch 168 a 0.35951860080803594 b 0.5472736522074668 c 0.3569044420315373
 17%|█▋        | 169/1000 [53:13<4:18:38, 18.68s/it]Epoch 169 Valid AUC:(0.7894460087780212, 0.0)
Epoch 169 Test AUC:(0.7312048703090938, 0.0)
Epoch 169 a 0.3592959952450568 b 0.5467874874030391 c 0.3567200762129599
 17%|█▋        | 170/1000 [53:33<4:22:25, 18.97s/it]Epoch 170 Valid AUC:(0.7896329340495182, 0.0)
Epoch 170 Test AUC:(0.7312601049679132, 0.0)
Epoch 170 a 0.35962280727201895 b 0.5473385669531361 c 0.3570932863700774
 17%|█▋        | 171/1000 [53:52<4:21:33, 18.93s/it]Epoch 171 Valid AUC:(0.7897147085692325, 0.0)
Epoch 171 Test AUC:(0.7313778382909186, 0.0)
Epoch 171 a 0.3596353761611446 b 0.5480153055921677 c 0.35715165686222816
 17%|█▋        | 172/1000 [54:11<4:21:52, 18.98s/it]Epoch 172 Valid AUC:(0.7898883398903322, 0.0)
Epoch 172 Test AUC:(0.7316199917552898, 0.0)
Epoch 172 a 0.3596438044501889 b 0.5488104248239148 c 0.3571822910058883
 17%|█▋        | 173/1000 [54:30<4:23:37, 19.13s/it]Epoch 173 Valid AUC:(0.7898539855440151, 0.0)
Epoch 173 Test AUC:(0.7317160613259741, 0.0)
Epoch 173 a 0.35956842260014626 b 0.548373642948366 c 0.3571588546037674
 17%|█▋        | 174/1000 [54:49<4:23:10, 19.12s/it]Epoch 174 Valid AUC:(0.789959022234139, 0.0)
Epoch 174 Test AUC:(0.7316159257934864, 0.0)
Epoch 174 a 0.35889989329922584 b 0.548866813701968 c 0.3564008284480341
 18%|█▊        | 175/1000 [55:09<4:24:18, 19.22s/it]Epoch 175 Valid AUC:(0.7898635039253512, 0.0)
Epoch 175 Test AUC:(0.7315837016566707, 0.0)
Epoch 175 a 0.35897860051162783 b 0.5492342330755726 c 0.3565314436151135
 18%|█▊        | 176/1000 [55:28<4:23:21, 19.18s/it]Epoch 176 Valid AUC:(0.7903026925748864, 0.0)
Epoch 176 Test AUC:(0.7315767198316184, 0.0)
Epoch 176 a 0.35854904714130587 b 0.5486774021579374 c 0.356132967097144
 18%|█▊        | 177/1000 [55:47<4:22:40, 19.15s/it]Epoch 177 Valid AUC:(0.7903643115024, 0.0)
Epoch 177 Test AUC:(0.7315237725435296, 0.0)
Epoch 177 a 0.35899079422796926 b 0.5497304768331589 c 0.35666778202979793
 18%|█▊        | 178/1000 [56:06<4:22:56, 19.19s/it]Epoch 178 Valid AUC:(0.7904132452355599, 0.0)
Epoch 178 Test AUC:(0.7316867573278668, 0.0)
Epoch 178 a 0.3591696817067362 b 0.5498953456840208 c 0.3568794741745918
 18%|█▊        | 179/1000 [56:26<4:23:17, 19.24s/it]Epoch 179 Valid AUC:(0.79036430381285, 0.0)
Epoch 179 Test AUC:(0.7317449762572842, 0.0)
Epoch 179 a 0.3588638259999214 b 0.5505639867436501 c 0.3565467341292289
 18%|█▊        | 180/1000 [56:45<4:23:51, 19.31s/it]Epoch 180 Valid AUC:(0.7904289793364977, 0.0)
Epoch 180 Test AUC:(0.7317018967292818, 0.0)
Epoch 180 a 0.3584061459668221 b 0.5497696700115358 c 0.35610991187634006
 18%|█▊        | 181/1000 [57:04<4:19:34, 19.02s/it]Epoch 181 Valid AUC:(0.7904776785383818, 0.0)
Epoch 181 Test AUC:(0.7318335723250955, 0.0)
Epoch 181 a 0.3581775852268742 b 0.5500158028256509 c 0.3558080342988814
 18%|█▊        | 182/1000 [57:22<4:17:04, 18.86s/it]Epoch 182 Valid AUC:(0.7906802353834829, 0.0)
Epoch 182 Test AUC:(0.7318785202288163, 0.0)
Epoch 182 a 0.3583976547083547 b 0.5502335068679625 c 0.3561365799077095
 18%|█▊        | 183/1000 [57:41<4:17:05, 18.88s/it]Epoch 183 Valid AUC:(0.7906849683015217, 0.0)
Epoch 183 Test AUC:(0.7318171374595098, 0.0)
Epoch 183 a 0.35896762628709117 b 0.5510451832125264 c 0.3568295274050005
 18%|█▊        | 184/1000 [58:00<4:19:15, 19.06s/it]Epoch 184 Valid AUC:(0.7906175130055411, 0.0)
Epoch 184 Test AUC:(0.7317426461319605, 0.0)
Epoch 184 a 0.35844602171451817 b 0.5510336694217497 c 0.35617015318524453
 18%|█▊        | 185/1000 [58:20<4:21:38, 19.26s/it]Epoch 185 Valid AUC:(0.7906670977872694, 0.0)
Epoch 185 Test AUC:(0.7319059002702343, 0.0)
Epoch 185 a 0.35858819850029483 b 0.5507273092385261 c 0.3563321975450362
 19%|█▊        | 186/1000 [58:39<4:20:48, 19.22s/it]Epoch 186 Valid AUC:(0.7908573949264514, 0.0)
Epoch 186 Test AUC:(0.7319217066433015, 0.0)
Epoch 186 a 0.358435221016407 b 0.5509199956732411 c 0.3561687541584815
 19%|█▊        | 187/1000 [58:58<4:19:41, 19.17s/it]Epoch 187 Valid AUC:(0.7908545228795179, 0.0)
Epoch 187 Test AUC:(0.732005415861122, 0.0)
Epoch 187 a 0.35869839787483215 b 0.5511749391594241 c 0.35650649522581407
 19%|█▉        | 188/1000 [59:17<4:19:07, 19.15s/it]Epoch 188 Valid AUC:(0.7909266969960291, 0.0)
Epoch 188 Test AUC:(0.7320458659816491, 0.0)
Epoch 188 a 0.35877321636484516 b 0.5513211051302571 c 0.35659057406648514
 19%|█▉        | 189/1000 [59:37<4:18:51, 19.15s/it]Epoch 189 Valid AUC:(0.7910958529990157, 0.0)
Epoch 189 Test AUC:(0.7320700137758291, 0.0)
Epoch 189 a 0.35824427537379727 b 0.550953124800036 c 0.3560006969398068
 19%|█▉        | 190/1000 [59:56<4:19:51, 19.25s/it]Epoch 190 Valid AUC:(0.7910281029369508, 0.0)
Epoch 190 Test AUC:(0.7321076378177527, 0.0)
Epoch 190 a 0.3580947580837434 b 0.5512493997812271 c 0.35585488306899227
 19%|█▉        | 191/1000 [1:00:15<4:18:04, 19.14s/it]Epoch 191 Valid AUC:(0.791127014900482, 0.0)
Epoch 191 Test AUC:(0.7322730467875185, 0.0)
Epoch 191 a 0.35819542744467336 b 0.5514490695730332 c 0.35599535343147093
 19%|█▉        | 192/1000 [1:00:34<4:17:07, 19.09s/it]Epoch 192 Valid AUC:(0.7912940575588041, 0.0)
Epoch 192 Test AUC:(0.732198457124405, 0.0)
Epoch 192 a 0.3585441006768134 b 0.5515168251529816 c 0.3564190835722031
 19%|█▉        | 193/1000 [1:00:53<4:16:33, 19.07s/it]Epoch 193 Valid AUC:(0.7913516330645975, 0.0)
Epoch 193 Test AUC:(0.7322401300262946, 0.0)
Epoch 193 a 0.35847693898024097 b 0.5514148343955317 c 0.3562878838950588
 19%|█▉        | 194/1000 [1:01:11<4:12:29, 18.80s/it]Epoch 194 Valid AUC:(0.7911947662441385, 0.0)
Epoch 194 Test AUC:(0.7322282485248736, 0.0)
Epoch 194 a 0.35879457477600346 b 0.5517820182346529 c 0.35665873654427066
 20%|█▉        | 195/1000 [1:01:29<4:10:27, 18.67s/it]Epoch 195 Valid AUC:(0.7911438960259647, 0.0)
Epoch 195 Test AUC:(0.7322713494301726, 0.0)
Epoch 195 a 0.35774510305735374 b 0.5512939552145619 c 0.3554493265767251
 20%|█▉        | 196/1000 [1:01:48<4:11:02, 18.73s/it]Epoch 196 Valid AUC:(0.7911359283705497, 0.0)
Epoch 196 Test AUC:(0.7321867466413563, 0.0)
Epoch 196 a 0.3583711638085304 b 0.5516760243523505 c 0.35620459529661364
 20%|█▉        | 197/1000 [1:02:08<4:13:08, 18.91s/it]Epoch 197 Valid AUC:(0.7912046434711424, 0.0)
Epoch 197 Test AUC:(0.7322518148565875, 0.0)
Epoch 197 a 0.35819799404951835 b 0.5514375932755009 c 0.35599137746518655
 20%|█▉        | 198/1000 [1:02:27<4:14:10, 19.02s/it]Epoch 198 Valid AUC:(0.7911489365260044, 0.0)
Epoch 198 Test AUC:(0.7321150899433292, 0.0)
Epoch 198 a 0.358002434094106 b 0.551551420361765 c 0.3558067946184066
 20%|█▉        | 199/1000 [1:02:45<4:10:38, 18.78s/it] 20%|█▉        | 199/1000 [1:03:03<4:13:50, 19.01s/it]
[32m[I 2021-05-13 11:52:05,432][0m Trial 18 finished with value: 0.7913516330645975 and parameters: {'rank': 5.0, 'lambda': 0.001, 'batch_size': 2048, 'learning_rate': 0.0001, 'alpha': 0.12447276274564119, 'gamma': 0.0013118941641084643}. Best is trial 17 with value: 0.795287269080506.[0m
2021-05-13 11:52:06.155607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5238550347164729, 0.0)
Epoch 0 Test AUC:(0.5098634311837611, 0.0)
Epoch 0 a 0.6873666110538668 b 0.6868513885044283 c 0.6864649422707096
  0%|          | 1/1000 [00:29<8:16:46, 29.84s/it]Epoch 1 Valid AUC:(0.5340284452449596, 0.0)
Epoch 1 Test AUC:(0.5158020869192412, 0.0)
Epoch 1 a 0.6516851643400807 b 0.6314489858285073 c 0.6289959501835608
  0%|          | 2/1000 [00:59<8:10:56, 29.52s/it]Epoch 2 Valid AUC:(0.5514600246028691, 0.0)
Epoch 2 Test AUC:(0.5292260457954109, 0.0)
Epoch 2 a 0.5952500700950623 b 0.5353581409060186 c 0.5303823298984959
  0%|          | 3/1000 [01:28<8:11:12, 29.56s/it]Epoch 3 Valid AUC:(0.5721080594317324, 0.0)
Epoch 3 Test AUC:(0.5486840202514996, 0.0)
Epoch 3 a 0.5423710975916155 b 0.4818044470683221 c 0.4750902977201246
  0%|          | 4/1000 [01:58<8:11:38, 29.62s/it]Epoch 4 Valid AUC:(0.5881561105993516, 0.0)
Epoch 4 Test AUC:(0.5691869639928812, 0.0)
Epoch 4 a 0.5051855908766869 b 0.46419083651515747 c 0.45469664505893187
  0%|          | 5/1000 [02:28<8:13:30, 29.76s/it]Epoch 5 Valid AUC:(0.5965904217365493, 0.0)
Epoch 5 Test AUC:(0.5858633716522657, 0.0)
Epoch 5 a 0.4824783155514348 b 0.45818058148987834 c 0.44364978469187216
  1%|          | 6/1000 [02:58<8:13:59, 29.82s/it]Epoch 6 Valid AUC:(0.6007762423888064, 0.0)
Epoch 6 Test AUC:(0.5984721629055686, 0.0)
Epoch 6 a 0.4684807206353834 b 0.4555977862929144 c 0.4338221608871414
  1%|          | 7/1000 [03:27<8:10:12, 29.62s/it]Epoch 7 Valid AUC:(0.603547879178017, 0.0)
Epoch 7 Test AUC:(0.6078730129070686, 0.0)
Epoch 7 a 0.4604784547080917 b 0.4544659690751183 c 0.42528288486984467
  1%|          | 8/1000 [03:57<8:10:48, 29.69s/it]Epoch 8 Valid AUC:(0.6055510941071123, 0.0)
Epoch 8 Test AUC:(0.614631235713045, 0.0)
Epoch 8 a 0.45525235899033084 b 0.4532905070772094 c 0.41734204837872135
  1%|          | 9/1000 [04:27<8:11:40, 29.77s/it]Epoch 9 Valid AUC:(0.6076777788593273, 0.0)
Epoch 9 Test AUC:(0.6201417811569468, 0.0)
Epoch 9 a 0.4518995903913052 b 0.45196836622011277 c 0.41045507896811734
  1%|          | 10/1000 [04:56<8:07:21, 29.54s/it]Epoch 10 Valid AUC:(0.6101265519485597, 0.0)
Epoch 10 Test AUC:(0.6245892122662465, 0.0)
Epoch 10 a 0.449199955309591 b 0.45019012497317407 c 0.4041583623376585
  1%|          | 11/1000 [05:26<8:08:03, 29.61s/it]Epoch 11 Valid AUC:(0.6131248459142334, 0.0)
Epoch 11 Test AUC:(0.628515037339788, 0.0)
Epoch 11 a 0.4471196127274344 b 0.4488994998316611 c 0.39928107191958734
  1%|          | 12/1000 [05:56<8:09:51, 29.75s/it]Epoch 12 Valid AUC:(0.6170979672049098, 0.0)
Epoch 12 Test AUC:(0.6320634291409466, 0.0)
Epoch 12 a 0.44535908775944866 b 0.44694635632538027 c 0.3948455123651412
  1%|▏         | 13/1000 [06:25<8:06:18, 29.56s/it]Epoch 13 Valid AUC:(0.6222329782223947, 0.0)
Epoch 13 Test AUC:(0.6361437436611773, 0.0)
Epoch 13 a 0.4431354941860322 b 0.44544484886911606 c 0.3907682476264815
  1%|▏         | 14/1000 [06:55<8:06:19, 29.59s/it]Epoch 14 Valid AUC:(0.6294339137309998, 0.0)
Epoch 14 Test AUC:(0.6408736842952705, 0.0)
Epoch 14 a 0.4405434332307308 b 0.4442049067827963 c 0.3872846741109125
  2%|▏         | 15/1000 [07:24<8:05:44, 29.59s/it]2021-05-13 12:00:10.616306: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 35469138 get requests, put_count=35469138 evicted_count=15000 eviction_rate=0.000422903 and unsatisfied allocation rate=0.000423269
Epoch 15 Valid AUC:(0.6389401276358675, 0.0)
Epoch 15 Test AUC:(0.6463666789787068, 0.0)
Epoch 15 a 0.43732866596791053 b 0.4430285622515986 c 0.3841394761637334
  2%|▏         | 16/1000 [07:53<8:03:57, 29.51s/it]Epoch 16 Valid AUC:(0.6507273735041852, 0.0)
Epoch 16 Test AUC:(0.6529588343941838, 0.0)
Epoch 16 a 0.43323282464858026 b 0.442605210648429 c 0.3814993964568261
  2%|▏         | 17/1000 [08:22<8:00:28, 29.33s/it]Epoch 17 Valid AUC:(0.6645983246664586, 0.0)
Epoch 17 Test AUC:(0.6606240574135355, 0.0)
Epoch 17 a 0.4281643011396931 b 0.44218747870576 c 0.3788286977477612
  2%|▏         | 18/1000 [08:52<8:02:47, 29.50s/it]Epoch 18 Valid AUC:(0.6789733783779655, 0.0)
Epoch 18 Test AUC:(0.6682990626837872, 0.0)
Epoch 18 a 0.42237859363517455 b 0.4432410327417235 c 0.37683672205575053
  2%|▏         | 19/1000 [09:21<8:01:07, 29.43s/it]Epoch 19 Valid AUC:(0.6934114825548819, 0.0)
Epoch 19 Test AUC:(0.6764357748048714, 0.0)
Epoch 19 a 0.4161636931521277 b 0.44475833554902383 c 0.3749189945238252
  2%|▏         | 20/1000 [09:50<7:58:28, 29.29s/it]Epoch 20 Valid AUC:(0.7073814033523116, 0.0)
Epoch 20 Test AUC:(0.6845781219813253, 0.0)
Epoch 20 a 0.4100323034630668 b 0.44710595689473615 c 0.373475291075245
  2%|▏         | 21/1000 [10:20<8:00:22, 29.44s/it]Epoch 21 Valid AUC:(0.7205488375830263, 0.0)
Epoch 21 Test AUC:(0.6921462407688398, 0.0)
Epoch 21 a 0.40327942779948633 b 0.4503884532999608 c 0.37149184822074827
  2%|▏         | 22/1000 [10:50<8:02:32, 29.60s/it]Epoch 22 Valid AUC:(0.7323181219440831, 0.0)
Epoch 22 Test AUC:(0.6988624358098038, 0.0)
Epoch 22 a 0.3975264755708556 b 0.45453727713996367 c 0.3702313407294212
  2%|▏         | 23/1000 [11:19<7:59:25, 29.44s/it]Epoch 23 Valid AUC:(0.7429274146155954, 0.0)
Epoch 23 Test AUC:(0.7047943149422784, 0.0)
Epoch 23 a 0.39158933633758175 b 0.45977881646925406 c 0.3687295034047096
  2%|▏         | 24/1000 [11:49<7:57:48, 29.37s/it]Epoch 24 Valid AUC:(0.7514925185907175, 0.0)
Epoch 24 Test AUC:(0.7100554984974133, 0.0)
Epoch 24 a 0.3865869165428223 b 0.4651303686682255 c 0.3675735095335591
  2%|▎         | 25/1000 [12:19<8:02:24, 29.69s/it]Epoch 25 Valid AUC:(0.7584928337392356, 0.0)
Epoch 25 Test AUC:(0.7143917633892068, 0.0)
Epoch 25 a 0.3820544904278171 b 0.4710931875292332 c 0.3663449277800898
  3%|▎         | 26/1000 [12:48<7:58:01, 29.45s/it]Epoch 26 Valid AUC:(0.7647844197228715, 0.0)
Epoch 26 Test AUC:(0.7182022237442002, 0.0)
Epoch 26 a 0.37815313365670944 b 0.4768954211425397 c 0.3650489743919142
  3%|▎         | 27/1000 [13:17<7:56:48, 29.40s/it]Epoch 27 Valid AUC:(0.7698832744761505, 0.0)
Epoch 27 Test AUC:(0.7210368318890982, 0.0)
Epoch 27 a 0.3747811129977626 b 0.48291602574529185 c 0.3638522644196787
  3%|▎         | 28/1000 [13:47<7:58:44, 29.55s/it]Epoch 28 Valid AUC:(0.774526830972597, 0.0)
Epoch 28 Test AUC:(0.7234919502656854, 0.0)
Epoch 28 a 0.3723925989001028 b 0.48855176423826524 c 0.3633109712071957
  3%|▎         | 29/1000 [14:16<7:57:21, 29.50s/it]Epoch 29 Valid AUC:(0.7779152350347874, 0.0)
Epoch 29 Test AUC:(0.7250932551427074, 0.0)
Epoch 29 a 0.36973935461813406 b 0.4934473720289046 c 0.3620710836783532
  3%|▎         | 30/1000 [14:46<7:58:50, 29.62s/it]Epoch 30 Valid AUC:(0.7810464172407667, 0.0)
Epoch 30 Test AUC:(0.7265489549774853, 0.0)
Epoch 30 a 0.3673827621725298 b 0.49846255094293623 c 0.36087716082411425
  3%|▎         | 31/1000 [15:17<8:01:29, 29.81s/it]Epoch 31 Valid AUC:(0.783247484291941, 0.0)
Epoch 31 Test AUC:(0.7275670401746399, 0.0)
Epoch 31 a 0.3661879814199863 b 0.5034262367313908 c 0.3606161333380207
  3%|▎         | 32/1000 [15:46<8:00:03, 29.76s/it]Epoch 32 Valid AUC:(0.7846078912869052, 0.0)
Epoch 32 Test AUC:(0.7286642683990725, 0.0)
Epoch 32 a 0.3647957694145941 b 0.5076222561540142 c 0.3599676583563128
  3%|▎         | 33/1000 [16:16<8:00:28, 29.81s/it]Epoch 33 Valid AUC:(0.7863121852116092, 0.0)
Epoch 33 Test AUC:(0.7294595551361501, 0.0)
Epoch 33 a 0.36394214281632054 b 0.511859666195608 c 0.35980972659683996
  3%|▎         | 34/1000 [16:46<8:00:22, 29.84s/it]Epoch 34 Valid AUC:(0.7873121381413103, 0.0)
Epoch 34 Test AUC:(0.7300801380549231, 0.0)
Epoch 34 a 0.36306983100310447 b 0.5157761900655685 c 0.3593397628395788
  4%|▎         | 35/1000 [17:16<7:59:00, 29.78s/it]Epoch 35 Valid AUC:(0.788225137639357, 0.0)
Epoch 35 Test AUC:(0.7304778840344853, 0.0)
Epoch 35 a 0.3619259305057987 b 0.5179011737627368 c 0.3585446842255131
  4%|▎         | 36/1000 [17:46<8:01:34, 29.97s/it]Epoch 36 Valid AUC:(0.7890314984576916, 0.0)
Epoch 36 Test AUC:(0.7310040776380827, 0.0)
Epoch 36 a 0.3616704156081523 b 0.5208509350495953 c 0.35862763923022056
  4%|▎         | 37/1000 [18:16<8:00:03, 29.91s/it]Epoch 37 Valid AUC:(0.7906308915409885, 0.0)
Epoch 37 Test AUC:(0.7313705315309588, 0.0)
Epoch 37 a 0.3611902832504242 b 0.5236942318658675 c 0.3584369944949304
  4%|▍         | 38/1000 [18:45<7:54:36, 29.60s/it]Epoch 38 Valid AUC:(0.7903218254569341, 0.0)
Epoch 38 Test AUC:(0.7317116960820191, 0.0)
Epoch 38 a 0.36104797343573264 b 0.525966561249187 c 0.3585068438081972
  4%|▍         | 39/1000 [19:14<7:53:18, 29.55s/it]Epoch 39 Valid AUC:(0.7910311992624266, 0.0)
Epoch 39 Test AUC:(0.7320017175888193, 0.0)
Epoch 39 a 0.36045068478392017 b 0.5279838403146113 c 0.3581035222497679
  4%|▍         | 40/1000 [19:44<7:52:45, 29.55s/it]Epoch 40 Valid AUC:(0.7912399103107289, 0.0)
Epoch 40 Test AUC:(0.7322031943333199, 0.0)
Epoch 40 a 0.3603212447656739 b 0.5298901326473682 c 0.3581162053010156
  4%|▍         | 41/1000 [20:14<7:54:12, 29.67s/it]Epoch 41 Valid AUC:(0.7916051575288394, 0.0)
Epoch 41 Test AUC:(0.7321275400808385, 0.0)
Epoch 41 a 0.3598957896953629 b 0.5311391650428695 c 0.3577535577839421
  4%|▍         | 42/1000 [20:43<7:53:47, 29.67s/it]Epoch 42 Valid AUC:(0.7920170969762782, 0.0)
Epoch 42 Test AUC:(0.7323512192855333, 0.0)
Epoch 42 a 0.35910346346997446 b 0.5323499241663564 c 0.3570631144027556
  4%|▍         | 43/1000 [21:14<7:55:54, 29.84s/it]Epoch 43 Valid AUC:(0.791813580219016, 0.0)
Epoch 43 Test AUC:(0.732429571352839, 0.0)
Epoch 43 a 0.35949196330001276 b 0.5337849214913384 c 0.3574859924133747
  4%|▍         | 44/1000 [21:44<7:55:53, 29.87s/it]Epoch 44 Valid AUC:(0.7919645196779994, 0.0)
Epoch 44 Test AUC:(0.7323971206166799, 0.0)
Epoch 44 a 0.3596617851045824 b 0.5357906522770082 c 0.35782880275960893
  4%|▍         | 45/1000 [22:13<7:55:16, 29.86s/it]Epoch 45 Valid AUC:(0.7918714120431436, 0.0)
Epoch 45 Test AUC:(0.7325961646248335, 0.0)
Epoch 45 a 0.35917832846603087 b 0.5357366849578196 c 0.3572934726553579
  5%|▍         | 46/1000 [22:44<7:56:32, 29.97s/it]Epoch 46 Valid AUC:(0.7926651043278161, 0.0)
Epoch 46 Test AUC:(0.7325587885595498, 0.0)
Epoch 46 a 0.3589773818610176 b 0.5365786790367095 c 0.35714774698980395
  5%|▍         | 47/1000 [23:13<7:51:45, 29.70s/it]Epoch 47 Valid AUC:(0.7923088910493904, 0.0)
Epoch 47 Test AUC:(0.732522293238884, 0.0)
Epoch 47 a 0.35900881201509505 b 0.5382315616213507 c 0.35727602579901296
  5%|▍         | 48/1000 [23:42<7:51:10, 29.70s/it]Epoch 48 Valid AUC:(0.7924265949915849, 0.0)
Epoch 48 Test AUC:(0.7320882315079469, 0.0)
Epoch 48 a 0.3589776987510343 b 0.538189749203382 c 0.35718813826960905
  5%|▍         | 49/1000 [24:12<7:50:18, 29.67s/it]Epoch 49 Valid AUC:(0.792633607930924, 0.0)
Epoch 49 Test AUC:(0.7324150262402681, 0.0)
Epoch 49 a 0.3592964517733743 b 0.5387610179041663 c 0.3575846654993872
  5%|▌         | 50/1000 [24:42<7:51:14, 29.76s/it]Epoch 50 Valid AUC:(0.792811795310412, 0.0)
Epoch 50 Test AUC:(0.7323297735816368, 0.0)
Epoch 50 a 0.3589198018514341 b 0.5393972667234559 c 0.35721913412694006
  5%|▌         | 51/1000 [25:12<7:52:25, 29.87s/it]Epoch 51 Valid AUC:(0.7928451013147428, 0.0)
Epoch 51 Test AUC:(0.7323291108854438, 0.0)
Epoch 51 a 0.3586560502167671 b 0.5397074688826838 c 0.3569672226665481
  5%|▌         | 52/1000 [25:42<7:52:07, 29.88s/it]Epoch 52 Valid AUC:(0.79293867801215, 0.0)
Epoch 52 Test AUC:(0.7323385724768957, 0.0)
Epoch 52 a 0.3587640235500951 b 0.5400122722550746 c 0.3570781183098593
  5%|▌         | 53/1000 [26:12<7:51:12, 29.85s/it]Epoch 53 Valid AUC:(0.7928671703233074, 0.0)
Epoch 53 Test AUC:(0.7323208464225985, 0.0)
Epoch 53 a 0.3585684041102086 b 0.5405291881292097 c 0.35685414784858305
  5%|▌         | 54/1000 [26:42<7:52:36, 29.98s/it]Epoch 54 Valid AUC:(0.7928956383190824, 0.0)
Epoch 54 Test AUC:(0.7323171609766738, 0.0)
Epoch 54 a 0.358737719515639 b 0.5412121635050543 c 0.35702846703990815
  6%|▌         | 55/1000 [27:12<7:50:31, 29.87s/it]Epoch 55 Valid AUC:(0.7925369413159994, 0.0)
Epoch 55 Test AUC:(0.7319780999515937, 0.0)
Epoch 55 a 0.35875147364793286 b 0.5406124012604836 c 0.3570599083698565
  6%|▌         | 56/1000 [27:41<7:48:17, 29.76s/it]Epoch 56 Valid AUC:(0.7931211266839423, 0.0)
Epoch 56 Test AUC:(0.7320251171776202, 0.0)
Epoch 56 a 0.3584668558211096 b 0.5406884809415187 c 0.35670445390766664
  6%|▌         | 57/1000 [28:12<7:50:30, 29.94s/it]Epoch 57 Valid AUC:(0.7928734539672675, 0.0)
Epoch 57 Test AUC:(0.731831990405151, 0.0)
Epoch 57 a 0.358328168791148 b 0.5410640142377345 c 0.356620607477042
  6%|▌         | 58/1000 [28:41<7:49:07, 29.88s/it]Epoch 58 Valid AUC:(0.7930044685205508, 0.0)
Epoch 58 Test AUC:(0.7319623064049045, 0.0)
Epoch 58 a 0.3585009579696963 b 0.541602797806263 c 0.35679741864723546
  6%|▌         | 59/1000 [29:11<7:46:59, 29.78s/it]Epoch 59 Valid AUC:(0.792682622404359, 0.0)
Epoch 59 Test AUC:(0.7319643671762915, 0.0)
Epoch 59 a 0.35869058317715125 b 0.5414082258939743 c 0.35694660030065045
  6%|▌         | 60/1000 [29:41<7:49:49, 29.99s/it]Epoch 60 Valid AUC:(0.7926957023289474, 0.0)
Epoch 60 Test AUC:(0.7317368443336776, 0.0)
Epoch 60 a 0.3586002281836925 b 0.5417804973981073 c 0.35687281227400225
  6%|▌         | 61/1000 [30:11<7:48:27, 29.93s/it]Epoch 61 Valid AUC:(0.7925545093746175, 0.0)
Epoch 61 Test AUC:(0.7315926929475987, 0.0)
Epoch 61 a 0.3582272244797599 b 0.5405302092192634 c 0.35638302348313794
  6%|▌         | 62/1000 [30:41<7:49:12, 30.01s/it]  6%|▌         | 62/1000 [31:11<7:51:54, 30.19s/it]
[32m[I 2021-05-13 12:23:36,656][0m Trial 19 finished with value: 0.7931211266839423 and parameters: {'rank': 20.0, 'lambda': 0.001, 'batch_size': 1024, 'learning_rate': 0.0001, 'alpha': 0.1235552739558494, 'gamma': 0.0017655385600939557}. Best is trial 17 with value: 0.795287269080506.[0m
2021-05-13 12:23:37.339255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7774947883818404, 0.0)
Epoch 0 Test AUC:(0.7180681410647952, 0.0)
Epoch 0 a 0.4167987630520788 b 0.4937383720212779 c 0.41713194444145957
  0%|          | 1/1000 [00:50<13:52:58, 50.03s/it]Epoch 1 Valid AUC:(0.7732580872586761, 0.0)
Epoch 1 Test AUC:(0.7193528139762747, 0.0)
Epoch 1 a 0.3880350982519223 b 0.4893135922535564 c 0.3882154539317432
  0%|          | 2/1000 [01:40<13:57:39, 50.36s/it]Epoch 2 Valid AUC:(0.7727117088450105, 0.0)
Epoch 2 Test AUC:(0.7226027787176306, 0.0)
Epoch 2 a 0.3833257441429545 b 0.4848227884687888 c 0.38239946175868844
  0%|          | 3/1000 [02:31<14:04:30, 50.82s/it]Epoch 3 Valid AUC:(0.7792098476765758, 0.0)
Epoch 3 Test AUC:(0.7236494368093506, 0.0)
Epoch 3 a 0.3785882003350517 b 0.4761212772166945 c 0.37683664709029785
  0%|          | 4/1000 [03:22<14:03:49, 50.83s/it]Epoch 4 Valid AUC:(0.7822427843466927, 0.0)
Epoch 4 Test AUC:(0.7246833754096248, 0.0)
Epoch 4 a 0.3750469107143356 b 0.4685536373549064 c 0.3707462558803904
  0%|          | 5/1000 [04:13<14:02:34, 50.81s/it]Epoch 5 Valid AUC:(0.7782178957236731, 0.0)
Epoch 5 Test AUC:(0.7205372017141907, 0.0)
Epoch 5 a 0.37221527939111415 b 0.4645431232404421 c 0.3653355687556852
  1%|          | 6/1000 [05:03<13:58:32, 50.62s/it]Epoch 6 Valid AUC:(0.786523076247343, 0.0)
Epoch 6 Test AUC:(0.7224162404279574, 0.0)
Epoch 6 a 0.3701166202964437 b 0.46272085088359516 c 0.36020810569316086
  1%|          | 7/1000 [05:55<14:01:47, 50.86s/it]Epoch 7 Valid AUC:(0.7835313068648632, 0.0)
Epoch 7 Test AUC:(0.7229485308365301, 0.0)
Epoch 7 a 0.3682014029510544 b 0.4555692509626239 c 0.3546182008936132
  1%|          | 8/1000 [06:46<14:03:52, 51.04s/it]Epoch 8 Valid AUC:(0.7902417554541414, 0.0)
Epoch 8 Test AUC:(0.7248769767580773, 0.0)
Epoch 8 a 0.36634856438492863 b 0.4491130024854326 c 0.3480222149634025
  1%|          | 9/1000 [07:38<14:06:18, 51.24s/it]Epoch 9 Valid AUC:(0.7893371529447193, 0.0)
Epoch 9 Test AUC:(0.7225492713443723, 0.0)
Epoch 9 a 0.3645991485723307 b 0.43672196995804247 c 0.34091696922687936
  1%|          | 10/1000 [08:28<13:59:52, 50.90s/it]Epoch 10 Valid AUC:(0.7912694574066904, 0.0)
Epoch 10 Test AUC:(0.7218188433250198, 0.0)
Epoch 10 a 0.360993631588861 b 0.418788895400717 c 0.332359721722977
  1%|          | 11/1000 [09:19<13:59:47, 50.95s/it]Epoch 11 Valid AUC:(0.7923656783763066, 0.0)
Epoch 11 Test AUC:(0.7301947930472258, 0.0)
Epoch 11 a 0.3566596153636334 b 0.4009092753561929 c 0.3243442491386498
  1%|          | 12/1000 [10:10<14:00:13, 51.03s/it]Epoch 12 Valid AUC:(0.7957660371255987, 0.0)
Epoch 12 Test AUC:(0.7356668251536678, 0.0)
Epoch 12 a 0.3493621613777859 b 0.38353602879004217 c 0.31635907016529646
  1%|▏         | 13/1000 [11:01<13:59:04, 51.01s/it]Epoch 13 Valid AUC:(0.7977520005492185, 0.0)
Epoch 13 Test AUC:(0.739638124012425, 0.0)
Epoch 13 a 0.3425030707713344 b 0.36792660886852796 c 0.3082681266774594
  1%|▏         | 14/1000 [11:52<13:58:01, 51.00s/it]Epoch 14 Valid AUC:(0.7978666440505039, 0.0)
Epoch 14 Test AUC:(0.7432684849194653, 0.0)
Epoch 14 a 0.3371494543744285 b 0.3568992789242589 c 0.3016431706112395
  2%|▏         | 15/1000 [12:42<13:52:38, 50.72s/it]Epoch 15 Valid AUC:(0.8002745266759, 0.0)
Epoch 15 Test AUC:(0.7427598634536299, 0.0)
Epoch 15 a 0.3335550070648462 b 0.347370486324222 c 0.29415408769243917
  2%|▏         | 16/1000 [13:33<13:54:23, 50.88s/it]Epoch 16 Valid AUC:(0.7980033193941956, 0.0)
Epoch 16 Test AUC:(0.7456809384876031, 0.0)
Epoch 16 a 0.3308026879366255 b 0.3371268589971531 c 0.28742630935650715
  2%|▏         | 17/1000 [14:24<13:52:49, 50.83s/it]Epoch 17 Valid AUC:(0.8003587234038714, 0.0)
Epoch 17 Test AUC:(0.7481910264445324, 0.0)
Epoch 17 a 0.32918050795253856 b 0.3293584835241498 c 0.2815763156119007
  2%|▏         | 18/1000 [15:15<13:52:03, 50.84s/it]Epoch 18 Valid AUC:(0.8038969442507419, 0.0)
Epoch 18 Test AUC:(0.7475474159019184, 0.0)
Epoch 18 a 0.3273960296776693 b 0.3211468025832109 c 0.27521408893452803
  2%|▏         | 19/1000 [16:06<13:53:28, 50.98s/it]Epoch 19 Valid AUC:(0.801849460582167, 0.0)
Epoch 19 Test AUC:(0.7473476878202755, 0.0)
Epoch 19 a 0.3266641532991014 b 0.3130358607476386 c 0.26922339707672954
  2%|▏         | 20/1000 [16:56<13:48:05, 50.70s/it]Epoch 20 Valid AUC:(0.7992210237198422, 0.0)
Epoch 20 Test AUC:(0.7479258282544832, 0.0)
Epoch 20 a 0.3260581647486274 b 0.30587852960621087 c 0.26419535138357575
  2%|▏         | 21/1000 [17:47<13:47:38, 50.72s/it]Epoch 21 Valid AUC:(0.8052073230332597, 0.0)
Epoch 21 Test AUC:(0.7513051812209223, 0.0)
Epoch 21 a 0.3246427542366972 b 0.2992760755526468 c 0.25875995276679453
  2%|▏         | 22/1000 [18:38<13:46:47, 50.72s/it]Epoch 22 Valid AUC:(0.8016195391917192, 0.0)
Epoch 22 Test AUC:(0.7473323816759475, 0.0)
Epoch 22 a 0.3236528163704594 b 0.2930253502168886 c 0.253974516386957
  2%|▏         | 23/1000 [19:29<13:46:22, 50.75s/it]Epoch 23 Valid AUC:(0.8022040398312129, 0.0)
Epoch 23 Test AUC:(0.7478499687799548, 0.0)
Epoch 23 a 0.3232079550653876 b 0.2882801913159714 c 0.24972553425271746
  2%|▏         | 24/1000 [20:19<13:45:27, 50.74s/it]Epoch 24 Valid AUC:(0.8030420495558486, 0.0)
Epoch 24 Test AUC:(0.7480659350560552, 0.0)
Epoch 24 a 0.3229401982885971 b 0.28364424083674217 c 0.2461467059685191
  2%|▎         | 25/1000 [21:10<13:41:32, 50.56s/it]Epoch 25 Valid AUC:(0.8038789494220975, 0.0)
Epoch 25 Test AUC:(0.7503013461296463, 0.0)
Epoch 25 a 0.3215646193300934 b 0.2794485454947896 c 0.24248690135642076
  3%|▎         | 26/1000 [22:01<13:43:11, 50.71s/it]Epoch 26 Valid AUC:(0.7996332143592484, 0.0)
Epoch 26 Test AUC:(0.7518086464828304, 0.0)
Epoch 26 a 0.3208355746518678 b 0.27657927863554693 c 0.2400071622740095
  3%|▎         | 27/1000 [22:51<13:42:27, 50.72s/it]  3%|▎         | 27/1000 [23:42<14:14:35, 52.70s/it]
[32m[I 2021-05-13 12:47:39,520][0m Trial 20 finished with value: 0.8052073230332597 and parameters: {'rank': 15.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.13315712593121384, 'gamma': 0.0017886527793637755}. Best is trial 20 with value: 0.8052073230332597.[0m
2021-05-13 12:47:40.183979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.777494992154916, 0.0)
Epoch 0 Test AUC:(0.7180596243498507, 0.0)
Epoch 0 a 0.41680016699931033 b 0.49372668153563254 c 0.41712866708546337
  0%|          | 1/1000 [00:51<14:11:49, 51.16s/it]Epoch 1 Valid AUC:(0.77326401333856, 0.0)
Epoch 1 Test AUC:(0.7193466402130317, 0.0)
Epoch 1 a 0.3880366373589821 b 0.48931477385267647 c 0.38820997006456615
  0%|          | 2/1000 [01:41<13:59:38, 50.48s/it]Epoch 2 Valid AUC:(0.7727407215172454, 0.0)
Epoch 2 Test AUC:(0.7226192777151059, 0.0)
Epoch 2 a 0.3833238656971776 b 0.4848336810677104 c 0.38238993071214533
  0%|          | 3/1000 [02:31<14:00:09, 50.56s/it]Epoch 3 Valid AUC:(0.7792058965294559, 0.0)
Epoch 3 Test AUC:(0.723703470064104, 0.0)
Epoch 3 a 0.37858483687013206 b 0.4761944821542897 c 0.37682304691740687
  0%|          | 4/1000 [03:22<13:58:59, 50.54s/it]Epoch 4 Valid AUC:(0.7822372286468013, 0.0)
Epoch 4 Test AUC:(0.7245810807701859, 0.0)
Epoch 4 a 0.3750685388653331 b 0.468708517206027 c 0.37072571002741456
  0%|          | 5/1000 [04:13<14:01:06, 50.72s/it]Epoch 5 Valid AUC:(0.7783225056437709, 0.0)
Epoch 5 Test AUC:(0.7205618069825168, 0.0)
Epoch 5 a 0.3722487861961426 b 0.4648735750489072 c 0.365289126843274
  1%|          | 6/1000 [05:03<13:54:30, 50.37s/it]Epoch 6 Valid AUC:(0.786235811319194, 0.0)
Epoch 6 Test AUC:(0.722340821325738, 0.0)
Epoch 6 a 0.37019604048738536 b 0.4627972485074095 c 0.3600941925221526
  1%|          | 7/1000 [05:54<13:58:12, 50.65s/it]Epoch 7 Valid AUC:(0.784196361948801, 0.0)
Epoch 7 Test AUC:(0.7231388443567736, 0.0)
Epoch 7 a 0.36838739528742354 b 0.4553365997625309 c 0.35458114947111796
  1%|          | 8/1000 [06:45<13:58:16, 50.70s/it]Epoch 8 Valid AUC:(0.7898221828467137, 0.0)
Epoch 8 Test AUC:(0.7252394544737956, 0.0)
Epoch 8 a 0.3667327978721327 b 0.4485005531872302 c 0.34799099915943876
  1%|          | 9/1000 [07:35<13:57:49, 50.73s/it]Epoch 9 Valid AUC:(0.7888397403040054, 0.0)
Epoch 9 Test AUC:(0.723406778840781, 0.0)
Epoch 9 a 0.3652215815286042 b 0.4353548622946864 c 0.3408499728266142
  1%|          | 10/1000 [08:26<13:55:42, 50.65s/it]Epoch 10 Valid AUC:(0.7906162288506873, 0.0)
Epoch 10 Test AUC:(0.7229896735814654, 0.0)
Epoch 10 a 0.36199194918455974 b 0.41513040451936317 c 0.33240041364606476
  1%|          | 11/1000 [09:17<13:55:13, 50.67s/it]Epoch 11 Valid AUC:(0.7928661860609045, 0.0)
Epoch 11 Test AUC:(0.7332997897897747, 0.0)
Epoch 11 a 0.3573924339633113 b 0.3952651847176389 c 0.32444406419212907
  1%|          | 12/1000 [10:07<13:52:27, 50.55s/it]Epoch 12 Valid AUC:(0.7961151619204953, 0.0)
Epoch 12 Test AUC:(0.7372432083783748, 0.0)
Epoch 12 a 0.3497248369323416 b 0.37715690488546666 c 0.3164165558469607
  1%|▏         | 13/1000 [10:58<13:55:54, 50.82s/it]Epoch 13 Valid AUC:(0.7976910249807233, 0.0)
Epoch 13 Test AUC:(0.7404400676396474, 0.0)
Epoch 13 a 0.3433013063681198 b 0.3632603765013712 c 0.30823748182482885
  1%|▏         | 14/1000 [11:48<13:47:18, 50.34s/it]Epoch 14 Valid AUC:(0.7987227857340925, 0.0)
Epoch 14 Test AUC:(0.7438478182068203, 0.0)
Epoch 14 a 0.33842077665405734 b 0.3532643017754468 c 0.3016433413299756
  2%|▏         | 15/1000 [12:38<13:47:51, 50.43s/it]Epoch 15 Valid AUC:(0.8009605716682159, 0.0)
Epoch 15 Test AUC:(0.7435133832287131, 0.0)
Epoch 15 a 0.3349917580783967 b 0.3438582635021785 c 0.2940759319114973
  2%|▏         | 16/1000 [13:29<13:47:06, 50.43s/it]Epoch 16 Valid AUC:(0.7987220193422736, 0.0)
Epoch 16 Test AUC:(0.7463091531012436, 0.0)
Epoch 16 a 0.3323844918302847 b 0.3341708054964691 c 0.2870009972056153
  2%|▏         | 17/1000 [14:19<13:45:32, 50.39s/it]Epoch 17 Valid AUC:(0.8007049543647762, 0.0)
Epoch 17 Test AUC:(0.7481097285857624, 0.0)
Epoch 17 a 0.330527838806751 b 0.32708690991583966 c 0.28127295456421925
  2%|▏         | 18/1000 [15:09<13:45:19, 50.43s/it]Epoch 18 Valid AUC:(0.8039754942858134, 0.0)
Epoch 18 Test AUC:(0.74742004141817, 0.0)
Epoch 18 a 0.32834916563341077 b 0.3190160100488835 c 0.2746201315875984
  2%|▏         | 19/1000 [16:00<13:44:08, 50.41s/it]Epoch 19 Valid AUC:(0.8022039052640876, 0.0)
Epoch 19 Test AUC:(0.7477896933546095, 0.0)
Epoch 19 a 0.32725254192918357 b 0.3118423225294416 c 0.26860872126920843
  2%|▏         | 20/1000 [16:50<13:42:46, 50.37s/it]Epoch 20 Valid AUC:(0.7990511577150701, 0.0)
Epoch 20 Test AUC:(0.7476585949458026, 0.0)
Epoch 20 a 0.3263665889830177 b 0.3054049751408383 c 0.263472068567631
  2%|▏         | 21/1000 [17:40<13:41:23, 50.34s/it]Epoch 21 Valid AUC:(0.8049945570289121, 0.0)
Epoch 21 Test AUC:(0.7512634142589278, 0.0)
Epoch 21 a 0.3247874478698976 b 0.2989880749037568 c 0.2578536679507261
  2%|▏         | 22/1000 [18:31<13:41:31, 50.40s/it]Epoch 22 Valid AUC:(0.8014778976803048, 0.0)
Epoch 22 Test AUC:(0.7475826756148438, 0.0)
Epoch 22 a 0.32364032038260754 b 0.2935198874960483 c 0.2533845933870051
  2%|▏         | 23/1000 [19:21<13:41:31, 50.45s/it]Epoch 23 Valid AUC:(0.8028078873785633, 0.0)
Epoch 23 Test AUC:(0.748672520121049, 0.0)
Epoch 23 a 0.32327629328973334 b 0.28911403819948617 c 0.24913900377045214
  2%|▏         | 24/1000 [20:12<13:43:35, 50.63s/it]Epoch 24 Valid AUC:(0.8029731050503468, 0.0)
Epoch 24 Test AUC:(0.7483222830453339, 0.0)
Epoch 24 a 0.32289219370310457 b 0.28478584284153985 c 0.24562550424570048
  2%|▎         | 25/1000 [21:02<13:38:59, 50.40s/it]Epoch 25 Valid AUC:(0.8036710342422224, 0.0)
Epoch 25 Test AUC:(0.7507318506784378, 0.0)
Epoch 25 a 0.3212742001357932 b 0.28120063581097293 c 0.24208418260397804
  3%|▎         | 26/1000 [21:53<13:38:46, 50.44s/it]Epoch 26 Valid AUC:(0.7996401657124687, 0.0)
Epoch 26 Test AUC:(0.7524373057442391, 0.0)
Epoch 26 a 0.32046109761750435 b 0.27945108061105434 c 0.23988615147304726
  3%|▎         | 27/1000 [22:43<13:37:57, 50.44s/it]  3%|▎         | 27/1000 [23:34<14:09:31, 52.39s/it]
[32m[I 2021-05-13 13:11:36,168][0m Trial 21 finished with value: 0.8049945570289121 and parameters: {'rank': 15.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.13459773430820082, 'gamma': 0.0018316061829784889}. Best is trial 20 with value: 0.8052073230332597.[0m
2021-05-13 13:11:36.862966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7749685392313562, 0.0)
Epoch 0 Test AUC:(0.7162539738951315, 0.0)
Epoch 0 a 0.41534575628083 b 0.49313687774497017 c 0.415993985515725
  0%|          | 1/1000 [00:50<14:07:55, 50.93s/it]Epoch 1 Valid AUC:(0.7736243302735144, 0.0)
Epoch 1 Test AUC:(0.719721730533713, 0.0)
Epoch 1 a 0.3888594712050148 b 0.48978757216656954 c 0.3892575131815444
  0%|          | 2/1000 [01:42<14:09:06, 51.05s/it]Epoch 2 Valid AUC:(0.7795092428698852, 0.0)
Epoch 2 Test AUC:(0.7262813368774668, 0.0)
Epoch 2 a 0.38156273343433555 b 0.48626606673062206 c 0.38188533086172294
  0%|          | 3/1000 [02:33<14:11:07, 51.22s/it]Epoch 3 Valid AUC:(0.7833361345509671, 0.0)
Epoch 3 Test AUC:(0.7252138059933979, 0.0)
Epoch 3 a 0.3742577921096948 b 0.48214611201219154 c 0.37449052090376195
  0%|          | 4/1000 [03:24<14:11:29, 51.29s/it]Epoch 4 Valid AUC:(0.7871086277920064, 0.0)
Epoch 4 Test AUC:(0.7259001540272695, 0.0)
Epoch 4 a 0.36992969365426953 b 0.4770550696662734 c 0.3687261810724884
  0%|          | 5/1000 [04:16<14:10:16, 51.27s/it]Epoch 5 Valid AUC:(0.785236697832037, 0.0)
Epoch 5 Test AUC:(0.7238713459738912, 0.0)
Epoch 5 a 0.3672532836196408 b 0.4730344264200276 c 0.3644133145420604
  1%|          | 6/1000 [05:07<14:10:43, 51.35s/it]Epoch 6 Valid AUC:(0.7900358805682056, 0.0)
Epoch 6 Test AUC:(0.7237325175346526, 0.0)
Epoch 6 a 0.3654169116461541 b 0.4636233055615569 c 0.36068614549799943
  1%|          | 7/1000 [05:59<14:11:20, 51.44s/it]Epoch 7 Valid AUC:(0.7874871253863973, 0.0)
Epoch 7 Test AUC:(0.7234836473237063, 0.0)
Epoch 7 a 0.36371882964427804 b 0.4525137116131888 c 0.3566366856846531
  1%|          | 8/1000 [06:51<14:13:56, 51.65s/it]Epoch 8 Valid AUC:(0.7933016978239373, 0.0)
Epoch 8 Test AUC:(0.7252391167125101, 0.0)
Epoch 8 a 0.36176872553240125 b 0.4412499004806311 c 0.3519587221759666
  1%|          | 9/1000 [07:43<14:15:34, 51.80s/it]Epoch 9 Valid AUC:(0.7906933101817045, 0.0)
Epoch 9 Test AUC:(0.7225223573280191, 0.0)
Epoch 9 a 0.36051188364355136 b 0.42933055464650544 c 0.34689262083598543
  1%|          | 10/1000 [08:34<14:09:57, 51.51s/it]Epoch 10 Valid AUC:(0.7926326582714962, 0.0)
Epoch 10 Test AUC:(0.7198315799097518, 0.0)
Epoch 10 a 0.35833549361593525 b 0.4154139027988887 c 0.3403946114497885
  1%|          | 11/1000 [09:25<14:04:59, 51.26s/it]Epoch 11 Valid AUC:(0.7926937555912, 0.0)
Epoch 11 Test AUC:(0.7227878163210862, 0.0)
Epoch 11 a 0.3573716272050946 b 0.4014261628780327 c 0.33489452611272724
  1%|          | 12/1000 [10:16<14:03:14, 51.21s/it]Epoch 12 Valid AUC:(0.7926838617035044, 0.0)
Epoch 12 Test AUC:(0.7222870274967059, 0.0)
Epoch 12 a 0.3564583687954985 b 0.3881904657337987 c 0.32952413958323074
  1%|▏         | 13/1000 [11:07<14:01:49, 51.17s/it]Epoch 13 Valid AUC:(0.7939253023884788, 0.0)
Epoch 13 Test AUC:(0.7228169706781177, 0.0)
Epoch 13 a 0.3551297220185969 b 0.3742594900025688 c 0.323044848933786
  1%|▏         | 14/1000 [11:58<13:59:40, 51.10s/it]Epoch 14 Valid AUC:(0.7940597836472306, 0.0)
Epoch 14 Test AUC:(0.7274095707328119, 0.0)
Epoch 14 a 0.3535009709522278 b 0.3624585689433384 c 0.31714313508759084
  2%|▏         | 15/1000 [12:49<13:58:32, 51.08s/it]Epoch 15 Valid AUC:(0.7924883664285073, 0.0)
Epoch 15 Test AUC:(0.7283406033029659, 0.0)
Epoch 15 a 0.35180146113727656 b 0.3507050059331015 c 0.31094064990759374
  2%|▏         | 16/1000 [13:39<13:56:17, 50.99s/it]Epoch 16 Valid AUC:(0.7922894467405669, 0.0)
Epoch 16 Test AUC:(0.732307742139815, 0.0)
Epoch 16 a 0.3492481439885959 b 0.3410633455819527 c 0.3057469421888981
  2%|▏         | 17/1000 [14:30<13:53:40, 50.89s/it]Epoch 17 Valid AUC:(0.7933720572066432, 0.0)
Epoch 17 Test AUC:(0.7388164576914078, 0.0)
Epoch 17 a 0.3464297072988161 b 0.33336771344035204 c 0.3015801492831117
  2%|▏         | 18/1000 [15:21<13:53:57, 50.95s/it]Epoch 18 Valid AUC:(0.7983659854866818, 0.0)
Epoch 18 Test AUC:(0.7411192158000419, 0.0)
Epoch 18 a 0.3423216261374399 b 0.3263696549643933 c 0.2978828620742744
  2%|▏         | 19/1000 [16:12<13:53:46, 51.00s/it]Epoch 19 Valid AUC:(0.7978188009518555, 0.0)
Epoch 19 Test AUC:(0.7423589450832601, 0.0)
Epoch 19 a 0.3386093749846491 b 0.31847138531970787 c 0.29274001909453623
  2%|▏         | 20/1000 [17:03<13:53:35, 51.04s/it]Epoch 20 Valid AUC:(0.7965399057503132, 0.0)
Epoch 20 Test AUC:(0.7464233762721559, 0.0)
Epoch 20 a 0.33558977483743635 b 0.3132246387316667 c 0.28884142955064296
  2%|▏         | 21/1000 [17:54<13:51:43, 50.97s/it]Epoch 21 Valid AUC:(0.8032297924828312, 0.0)
Epoch 21 Test AUC:(0.7492679761654601, 0.0)
Epoch 21 a 0.3324638884552048 b 0.30834449033142336 c 0.28415075616097785
  2%|▏         | 22/1000 [18:45<13:50:46, 50.97s/it]Epoch 22 Valid AUC:(0.8006637153080055, 0.0)
Epoch 22 Test AUC:(0.7476269351696158, 0.0)
Epoch 22 a 0.3299562158119271 b 0.3055441637993818 c 0.280065245071887
  2%|▏         | 23/1000 [19:36<13:50:11, 50.98s/it]Epoch 23 Valid AUC:(0.8013262905120611, 0.0)
Epoch 23 Test AUC:(0.7478735735908025, 0.0)
Epoch 23 a 0.32872502370859297 b 0.301708931384432 c 0.27517292859928466
  2%|▏         | 24/1000 [20:27<13:49:48, 51.01s/it]Epoch 24 Valid AUC:(0.8015755459944488, 0.0)
Epoch 24 Test AUC:(0.7483349726085645, 0.0)
Epoch 24 a 0.3277756339107721 b 0.29730994738563443 c 0.2707577991173781
  2%|▎         | 25/1000 [21:19<13:52:29, 51.23s/it]Epoch 25 Valid AUC:(0.8028117193376578, 0.0)
Epoch 25 Test AUC:(0.7522813754677625, 0.0)
Epoch 25 a 0.3265500639525937 b 0.29415142617115314 c 0.2662269038033917
  3%|▎         | 26/1000 [22:09<13:47:07, 50.95s/it]Epoch 26 Valid AUC:(0.7997445270037824, 0.0)
Epoch 26 Test AUC:(0.7516312576760795, 0.0)
Epoch 26 a 0.32597317380204766 b 0.2901660888727522 c 0.26184985770186187
  3%|▎         | 27/1000 [23:01<13:47:14, 51.01s/it]  3%|▎         | 27/1000 [23:52<14:20:05, 53.04s/it]
[32m[I 2021-05-13 13:35:48,163][0m Trial 22 finished with value: 0.8032297924828312 and parameters: {'rank': 20.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.13182577356464154, 'gamma': 0.001795897024521588}. Best is trial 20 with value: 0.8052073230332597.[0m
2021-05-13 13:35:48.919234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7748905018329529, 0.0)
Epoch 0 Test AUC:(0.7162207920554304, 0.0)
Epoch 0 a 0.4153588179731273 b 0.4926692310953044 c 0.41599112797071275
  0%|          | 1/1000 [00:50<14:08:51, 50.98s/it]Epoch 1 Valid AUC:(0.7736538824958425, 0.0)
Epoch 1 Test AUC:(0.7197434071124121, 0.0)
Epoch 1 a 0.388876272699003 b 0.48903734721168424 c 0.3892385847491758
  0%|          | 2/1000 [01:42<14:14:29, 51.37s/it]Epoch 2 Valid AUC:(0.7793952863017352, 0.0)
Epoch 2 Test AUC:(0.726220432959603, 0.0)
Epoch 2 a 0.3815634055756467 b 0.48436317855203653 c 0.381822525135708
  0%|          | 3/1000 [02:32<14:00:46, 50.60s/it]Epoch 3 Valid AUC:(0.7831429089748183, 0.0)
Epoch 3 Test AUC:(0.7254805134205834, 0.0)
Epoch 3 a 0.3743242497895085 b 0.4787785774865141 c 0.3745701585257317
  0%|          | 4/1000 [03:23<14:06:03, 50.97s/it]Epoch 4 Valid AUC:(0.7871614985747778, 0.0)
Epoch 4 Test AUC:(0.7260329925480156, 0.0)
Epoch 4 a 0.3701208838874425 b 0.47216464821961324 c 0.36909036946968293
  0%|          | 5/1000 [04:14<14:05:58, 51.01s/it]Epoch 5 Valid AUC:(0.7828656763462654, 0.0)
Epoch 5 Test AUC:(0.72339929251153, 0.0)
Epoch 5 a 0.36757597501129213 b 0.46671723390009323 c 0.3652009478277364
  1%|          | 6/1000 [05:05<14:04:59, 51.01s/it]Epoch 6 Valid AUC:(0.7879624062205548, 0.0)
Epoch 6 Test AUC:(0.7245761297883054, 0.0)
Epoch 6 a 0.3657974270387914 b 0.45483988793323216 c 0.36167188915208554
  1%|          | 7/1000 [05:57<14:05:29, 51.09s/it]Epoch 7 Valid AUC:(0.7866233351637196, 0.0)
Epoch 7 Test AUC:(0.7232095732801306, 0.0)
Epoch 7 a 0.36418292046312833 b 0.441590793955494 c 0.35858365821406635
  1%|          | 8/1000 [06:47<14:00:54, 50.86s/it]Epoch 8 Valid AUC:(0.7905536000289373, 0.0)
Epoch 8 Test AUC:(0.724976560756314, 0.0)
Epoch 8 a 0.3623282067492694 b 0.4260238054652569 c 0.35471820063754106
  1%|          | 9/1000 [07:38<13:59:50, 50.85s/it]Epoch 9 Valid AUC:(0.7884346509640451, 0.0)
Epoch 9 Test AUC:(0.7232900416997945, 0.0)
Epoch 9 a 0.36118383600678244 b 0.4137471640253931 c 0.3517703373787149
  1%|          | 10/1000 [08:29<14:00:58, 50.97s/it]Epoch 10 Valid AUC:(0.790847119124438, 0.0)
Epoch 10 Test AUC:(0.7214132604285433, 0.0)
Epoch 10 a 0.35908564763289824 b 0.40461070946524563 c 0.3478530923605445
  1%|          | 11/1000 [09:20<14:01:43, 51.07s/it]Epoch 11 Valid AUC:(0.7918719054559367, 0.0)
Epoch 11 Test AUC:(0.7231042216872853, 0.0)
Epoch 11 a 0.35820364886126527 b 0.3974586571726041 c 0.3454095398036527
  1%|          | 12/1000 [10:12<14:01:33, 51.11s/it]Epoch 12 Valid AUC:(0.7914118755626572, 0.0)
Epoch 12 Test AUC:(0.7233314965532593, 0.0)
Epoch 12 a 0.35752245166172203 b 0.3906881932161703 c 0.34204767389556534
  1%|▏         | 13/1000 [11:03<14:00:44, 51.11s/it]Epoch 13 Valid AUC:(0.7929290583850719, 0.0)
Epoch 13 Test AUC:(0.7231038240695695, 0.0)
Epoch 13 a 0.35650192144171333 b 0.3822996989941933 c 0.33680231374514175
  1%|▏         | 14/1000 [11:54<14:01:19, 51.20s/it]Epoch 14 Valid AUC:(0.792906531848281, 0.0)
Epoch 14 Test AUC:(0.7263995533273743, 0.0)
Epoch 14 a 0.3552566493301085 b 0.3748984468175132 c 0.3313776161709062
  2%|▏         | 15/1000 [12:44<13:56:07, 50.93s/it]Epoch 15 Valid AUC:(0.7927734423980831, 0.0)
Epoch 15 Test AUC:(0.7265145546318811, 0.0)
Epoch 15 a 0.3541657296224859 b 0.3663942436097373 c 0.32505853734985446
  2%|▏         | 16/1000 [13:35<13:53:59, 50.85s/it]Epoch 16 Valid AUC:(0.791694082048483, 0.0)
Epoch 16 Test AUC:(0.7283394617553303, 0.0)
Epoch 16 a 0.3526054864198389 b 0.35768312371712574 c 0.31877738609160455
  2%|▏         | 17/1000 [14:25<13:49:37, 50.64s/it]Epoch 17 Valid AUC:(0.7916365962541064, 0.0)
Epoch 17 Test AUC:(0.7327576701002496, 0.0)
Epoch 17 a 0.35103419027338084 b 0.35062456406817827 c 0.3142701473154532
  2%|▏         | 18/1000 [15:16<13:50:19, 50.73s/it]Epoch 18 Valid AUC:(0.7946657445392455, 0.0)
Epoch 18 Test AUC:(0.7335371290869634, 0.0)
Epoch 18 a 0.3485243857746393 b 0.3439237194761664 c 0.30932533267278306
  2%|▏         | 19/1000 [16:07<13:48:49, 50.69s/it]Epoch 19 Valid AUC:(0.7934807348987029, 0.0)
Epoch 19 Test AUC:(0.7375508832566638, 0.0)
Epoch 19 a 0.34644069781965414 b 0.3372623594234167 c 0.30486486147586966
  2%|▏         | 20/1000 [16:57<13:47:51, 50.69s/it]Epoch 20 Valid AUC:(0.7956494686736242, 0.0)
Epoch 20 Test AUC:(0.7404635612885532, 0.0)
Epoch 20 a 0.3443735370813481 b 0.33040048646734993 c 0.3005587090428926
  2%|▏         | 21/1000 [17:48<13:46:47, 50.67s/it]Epoch 21 Valid AUC:(0.8002307090566885, 0.0)
Epoch 21 Test AUC:(0.7436928028786359, 0.0)
Epoch 21 a 0.3411972030427614 b 0.32374537260959324 c 0.29536299842224273
  2%|▏         | 22/1000 [18:39<13:46:33, 50.71s/it]Epoch 22 Valid AUC:(0.7978979020713454, 0.0)
Epoch 22 Test AUC:(0.7433902628269775, 0.0)
Epoch 22 a 0.33809518544246975 b 0.31699978081992936 c 0.2901488948815785
  2%|▏         | 23/1000 [19:29<13:44:08, 50.61s/it]Epoch 23 Valid AUC:(0.7999412756754332, 0.0)
Epoch 23 Test AUC:(0.7440776754502173, 0.0)
Epoch 23 a 0.33559245105000807 b 0.31233401809419903 c 0.2856379044307789
  2%|▏         | 24/1000 [20:20<13:45:33, 50.75s/it]Epoch 24 Valid AUC:(0.8000477669721031, 0.0)
Epoch 24 Test AUC:(0.7464225254557534, 0.0)
Epoch 24 a 0.33362489902757303 b 0.3068092106213752 c 0.2800829942737307
  2%|▎         | 25/1000 [21:11<13:44:14, 50.72s/it]Epoch 25 Valid AUC:(0.8028551332554932, 0.0)
Epoch 25 Test AUC:(0.7505801488312184, 0.0)
Epoch 25 a 0.33137845177525727 b 0.3025062665253338 c 0.27570868770721213
  3%|▎         | 26/1000 [22:02<13:42:41, 50.68s/it]Epoch 26 Valid AUC:(0.798177535121097, 0.0)
Epoch 26 Test AUC:(0.7485218272822266, 0.0)
Epoch 26 a 0.3300477984085889 b 0.2982525505890069 c 0.2719175387136413
  3%|▎         | 27/1000 [22:52<13:42:20, 50.71s/it]Epoch 27 Valid AUC:(0.8016092377578724, 0.0)
Epoch 27 Test AUC:(0.7459653634181671, 0.0)
Epoch 27 a 0.3282666774822673 b 0.2937473985151026 c 0.26644742275987354
  3%|▎         | 28/1000 [23:43<13:43:23, 50.83s/it]Epoch 28 Valid AUC:(0.8012907929859738, 0.0)
Epoch 28 Test AUC:(0.7491906160047141, 0.0)
Epoch 28 a 0.3275558874760595 b 0.2911119417585358 c 0.2635615071660316
  3%|▎         | 29/1000 [24:34<13:40:10, 50.68s/it]Epoch 29 Valid AUC:(0.8041299504323404, 0.0)
Epoch 29 Test AUC:(0.750765780723518, 0.0)
Epoch 29 a 0.3263869725122778 b 0.28648433407067775 c 0.25902033448818945
  3%|▎         | 30/1000 [25:25<13:41:37, 50.82s/it]Epoch 30 Valid AUC:(0.8041374810649957, 0.0)
Epoch 30 Test AUC:(0.749191000796052, 0.0)
Epoch 30 a 0.32585722028129777 b 0.28303958577529287 c 0.25574829427888934
  3%|▎         | 31/1000 [26:16<13:40:45, 50.82s/it]Epoch 31 Valid AUC:(0.806365133453781, 0.0)
Epoch 31 Test AUC:(0.7503235870689742, 0.0)
Epoch 31 a 0.32474515351731054 b 0.2791783788374492 c 0.25234179141775703
  3%|▎         | 32/1000 [27:06<13:37:54, 50.70s/it]Epoch 32 Valid AUC:(0.8037733501132301, 0.0)
Epoch 32 Test AUC:(0.7483330529273345, 0.0)
Epoch 32 a 0.3245689397006927 b 0.27635965659704725 c 0.24959171390989177
  3%|▎         | 33/1000 [27:57<13:37:55, 50.75s/it]Epoch 33 Valid AUC:(0.8016073333126501, 0.0)
Epoch 33 Test AUC:(0.7496263793684564, 0.0)
Epoch 33 a 0.3241527488294022 b 0.2732624686819687 c 0.24663343524908876
  3%|▎         | 34/1000 [28:48<13:36:59, 50.75s/it]Epoch 34 Valid AUC:(0.8003310217999153, 0.0)
Epoch 34 Test AUC:(0.7484853747161538, 0.0)
Epoch 34 a 0.3243479433673728 b 0.27032153848071455 c 0.24441653142272826
  4%|▎         | 35/1000 [29:39<13:37:43, 50.84s/it]Epoch 35 Valid AUC:(0.8033949063456894, 0.0)
Epoch 35 Test AUC:(0.7546323735837857, 0.0)
Epoch 35 a 0.3233069977769909 b 0.2677928411085121 c 0.24191823400841872
  4%|▎         | 36/1000 [30:30<13:38:10, 50.92s/it]Epoch 36 Valid AUC:(0.8024662534869802, 0.0)
Epoch 36 Test AUC:(0.7541754680737579, 0.0)
Epoch 36 a 0.32284612512924304 b 0.26528681925604763 c 0.23940557736146378
  4%|▎         | 37/1000 [31:21<13:39:18, 51.05s/it]  4%|▎         | 37/1000 [32:13<13:58:30, 52.24s/it]
[32m[I 2021-05-13 14:08:21,222][0m Trial 23 finished with value: 0.806365133453781 and parameters: {'rank': 20.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.1354648130204157, 'gamma': 0.0016420200047398206}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 14:08:21.892905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7728111526690848, 0.0)
Epoch 0 Test AUC:(0.7157083526044318, 0.0)
Epoch 0 a 0.4143953583010246 b 0.49444900468081776 c 0.4157294329982888
  0%|          | 1/1000 [00:51<14:09:19, 51.01s/it]Epoch 1 Valid AUC:(0.7694375497090962, 0.0)
Epoch 1 Test AUC:(0.7177796886515616, 0.0)
Epoch 1 a 0.3909330765606172 b 0.4910162114041672 c 0.3918833919094362
  0%|          | 2/1000 [01:42<14:10:53, 51.16s/it]Epoch 2 Valid AUC:(0.7728767906680769, 0.0)
Epoch 2 Test AUC:(0.722609940111974, 0.0)
Epoch 2 a 0.3855293095711491 b 0.4956826117316962 c 0.3866665989940075
  0%|          | 3/1000 [02:33<14:13:32, 51.37s/it]Epoch 3 Valid AUC:(0.7821077725089892, 0.0)
Epoch 3 Test AUC:(0.7252758386325193, 0.0)
Epoch 3 a 0.37932904733258715 b 0.48638988194811034 c 0.3802666811036392
  0%|          | 4/1000 [03:24<14:05:29, 50.93s/it]Epoch 4 Valid AUC:(0.7844288029484728, 0.0)
Epoch 4 Test AUC:(0.726126578076841, 0.0)
Epoch 4 a 0.3738372787023694 b 0.48433729364598543 c 0.37381074923864555
  0%|          | 5/1000 [04:15<14:07:17, 51.09s/it]Epoch 5 Valid AUC:(0.7817172664006465, 0.0)
Epoch 5 Test AUC:(0.7226973732548532, 0.0)
Epoch 5 a 0.3698792866537988 b 0.48080819365484134 c 0.36866219380731796
  1%|          | 6/1000 [05:06<14:05:57, 51.06s/it]Epoch 6 Valid AUC:(0.7882201035472756, 0.0)
Epoch 6 Test AUC:(0.7241051195380157, 0.0)
Epoch 6 a 0.36748496357583904 b 0.4771324411724175 c 0.36464635125348266
  1%|          | 7/1000 [05:57<14:06:03, 51.12s/it]Epoch 7 Valid AUC:(0.787630325313283, 0.0)
Epoch 7 Test AUC:(0.7243016837797698, 0.0)
Epoch 7 a 0.36529824581424475 b 0.47626975520515824 c 0.35920190127562707
  1%|          | 8/1000 [06:48<14:04:30, 51.08s/it]Epoch 8 Valid AUC:(0.7917368692679916, 0.0)
Epoch 8 Test AUC:(0.7251387716825163, 0.0)
Epoch 8 a 0.3628634075283764 b 0.47287237356366285 c 0.3531267024741566
  1%|          | 9/1000 [07:39<14:00:18, 50.88s/it]Epoch 9 Valid AUC:(0.7897814769320779, 0.0)
Epoch 9 Test AUC:(0.7230628865466812, 0.0)
Epoch 9 a 0.36108592182577737 b 0.46658003216298294 c 0.34720054424744495
  1%|          | 10/1000 [08:30<14:00:08, 50.92s/it]Epoch 10 Valid AUC:(0.7918969810785601, 0.0)
Epoch 10 Test AUC:(0.7200434246430779, 0.0)
Epoch 10 a 0.3585908956211098 b 0.4545241959497962 c 0.33977764748951317
  1%|          | 11/1000 [09:21<14:02:42, 51.12s/it]Epoch 11 Valid AUC:(0.7916761641153389, 0.0)
Epoch 11 Test AUC:(0.7226721394940085, 0.0)
Epoch 11 a 0.3575873151271636 b 0.44262852881036296 c 0.3339056936907816
  1%|          | 12/1000 [10:12<14:01:36, 51.11s/it]Epoch 12 Valid AUC:(0.7916052818432315, 0.0)
Epoch 12 Test AUC:(0.7215977336713699, 0.0)
Epoch 12 a 0.35671440294570844 b 0.4295931460272138 c 0.3291381557342752
  1%|▏         | 13/1000 [11:04<14:01:00, 51.12s/it]Epoch 13 Valid AUC:(0.7928003545415703, 0.0)
Epoch 13 Test AUC:(0.7224414100569124, 0.0)
Epoch 13 a 0.35563982042748205 b 0.41621438436345076 c 0.32363034655870326
  1%|▏         | 14/1000 [11:54<13:56:54, 50.93s/it]Epoch 14 Valid AUC:(0.7931725249178844, 0.0)
Epoch 14 Test AUC:(0.7254947378737061, 0.0)
Epoch 14 a 0.3542927573144556 b 0.4036653019053116 c 0.31849662027128745
  2%|▏         | 15/1000 [12:46<13:59:00, 51.11s/it]Epoch 15 Valid AUC:(0.7928237576870637, 0.0)
Epoch 15 Test AUC:(0.7258816883185119, 0.0)
Epoch 15 a 0.3529371706172974 b 0.3876741817539607 c 0.313396175022816
  2%|▏         | 16/1000 [13:36<13:57:16, 51.05s/it]Epoch 16 Valid AUC:(0.7924688298450835, 0.0)
Epoch 16 Test AUC:(0.7295055291501051, 0.0)
Epoch 16 a 0.35100836970916455 b 0.3714448621935048 c 0.30798345801216254
  2%|▏         | 17/1000 [14:28<13:58:08, 51.16s/it]Epoch 17 Valid AUC:(0.7925160167687966, 0.0)
Epoch 17 Test AUC:(0.7349406725936247, 0.0)
Epoch 17 a 0.34871026213979817 b 0.3575737407389781 c 0.3041933550681147
  2%|▏         | 18/1000 [15:19<13:58:47, 51.25s/it]Epoch 18 Valid AUC:(0.7962626923456353, 0.0)
Epoch 18 Test AUC:(0.7366359264135136, 0.0)
Epoch 18 a 0.3458595088190236 b 0.3458107454436166 c 0.3001567535477145
  2%|▏         | 19/1000 [16:10<13:53:42, 50.99s/it]Epoch 19 Valid AUC:(0.7947827525771629, 0.0)
Epoch 19 Test AUC:(0.7401398363360162, 0.0)
Epoch 19 a 0.34332778546172127 b 0.33450597296778106 c 0.2961597178783455
  2%|▏         | 20/1000 [17:01<13:53:38, 51.04s/it]Epoch 20 Valid AUC:(0.7972319729418883, 0.0)
Epoch 20 Test AUC:(0.7442174402150447, 0.0)
Epoch 20 a 0.34077918523514056 b 0.32648203238635 c 0.29355457817884517
  2%|▏         | 21/1000 [17:52<13:53:16, 51.07s/it]Epoch 21 Valid AUC:(0.8020645488306214, 0.0)
Epoch 21 Test AUC:(0.7480096529097051, 0.0)
Epoch 21 a 0.33714068913363837 b 0.3194837714704709 c 0.2892236379790354
  2%|▏         | 22/1000 [18:43<13:52:17, 51.06s/it]Epoch 22 Valid AUC:(0.7998438939323566, 0.0)
Epoch 22 Test AUC:(0.7474433255695695, 0.0)
Epoch 22 a 0.33387460201319075 b 0.31482469897634785 c 0.2861687988342654
  2%|▏         | 23/1000 [19:35<13:54:41, 51.26s/it]Epoch 23 Valid AUC:(0.8023404678277122, 0.0)
Epoch 23 Test AUC:(0.7484283058852907, 0.0)
Epoch 23 a 0.3322818094575909 b 0.3094017454675985 c 0.28177006080956524
  2%|▏         | 24/1000 [20:26<13:52:55, 51.20s/it]Epoch 24 Valid AUC:(0.8007312667233616, 0.0)
Epoch 24 Test AUC:(0.749416877586832, 0.0)
Epoch 24 a 0.3309981864942631 b 0.3039438007343223 c 0.2774488931630459
  2%|▎         | 25/1000 [21:17<13:50:31, 51.11s/it]Epoch 25 Valid AUC:(0.8035351483589998, 0.0)
Epoch 25 Test AUC:(0.7519181666485024, 0.0)
Epoch 25 a 0.3295250538009513 b 0.2983256954422419 c 0.2726485464474565
  3%|▎         | 26/1000 [22:08<13:50:05, 51.14s/it]Epoch 26 Valid AUC:(0.798845393046018, 0.0)
Epoch 26 Test AUC:(0.7510860425540142, 0.0)
Epoch 26 a 0.3287253684441089 b 0.2929940847623756 c 0.26795304921911034
  3%|▎         | 27/1000 [22:59<13:49:33, 51.16s/it]Epoch 27 Valid AUC:(0.8023059173978694, 0.0)
Epoch 27 Test AUC:(0.7477184599270541, 0.0)
Epoch 27 a 0.3274425376708838 b 0.28806511560076437 c 0.26382338730861965
  3%|▎         | 28/1000 [23:50<13:49:29, 51.20s/it]Epoch 28 Valid AUC:(0.8021150204737858, 0.0)
Epoch 28 Test AUC:(0.7514857466939402, 0.0)
Epoch 28 a 0.32698703963511905 b 0.28367301839698006 c 0.26076571136653065
  3%|▎         | 29/1000 [24:41<13:44:26, 50.94s/it]Epoch 29 Valid AUC:(0.8040925933167393, 0.0)
Epoch 29 Test AUC:(0.7516827128288692, 0.0)
Epoch 29 a 0.3257867514007768 b 0.2788205988690167 c 0.2567208831758806
  3%|▎         | 30/1000 [25:32<13:42:30, 50.88s/it]Epoch 30 Valid AUC:(0.8040116851529943, 0.0)
Epoch 30 Test AUC:(0.7508530257461875, 0.0)
Epoch 30 a 0.32495539534979423 b 0.2749473809656243 c 0.2535378751260654
  3%|▎         | 31/1000 [26:23<13:42:53, 50.95s/it]Epoch 31 Valid AUC:(0.8057743799285274, 0.0)
Epoch 31 Test AUC:(0.7519514468237675, 0.0)
Epoch 31 a 0.32359848769617755 b 0.2720587081772461 c 0.2506130685508851
  3%|▎         | 32/1000 [27:13<13:40:30, 50.86s/it]Epoch 32 Valid AUC:(0.8037892098101516, 0.0)
Epoch 32 Test AUC:(0.750528796289452, 0.0)
Epoch 32 a 0.3228372733597784 b 0.2679824156600465 c 0.24705863307779224
  3%|▎         | 33/1000 [28:04<13:40:45, 50.93s/it]Epoch 33 Valid AUC:(0.8012002254658088, 0.0)
Epoch 33 Test AUC:(0.7508599306129723, 0.0)
Epoch 33 a 0.3221280972962408 b 0.26498581169236834 c 0.24483319607299098
  3%|▎         | 34/1000 [28:55<13:37:15, 50.76s/it]Epoch 34 Valid AUC:(0.800463590923895, 0.0)
Epoch 34 Test AUC:(0.7503039926389589, 0.0)
Epoch 34 a 0.32164518975875744 b 0.26238597689619964 c 0.24263995004371858
  4%|▎         | 35/1000 [29:45<13:35:53, 50.73s/it]Epoch 35 Valid AUC:(0.8029963044227647, 0.0)
Epoch 35 Test AUC:(0.7562210957840598, 0.0)
Epoch 35 a 0.31970281734073186 b 0.25979278265110683 c 0.23990228358408816
  4%|▎         | 36/1000 [30:37<13:38:43, 50.96s/it]Epoch 36 Valid AUC:(0.8014556748807397, 0.0)
Epoch 36 Test AUC:(0.7546288292280181, 0.0)
Epoch 36 a 0.3187779920921479 b 0.25819922875710416 c 0.2383461103472911
  4%|▎         | 37/1000 [31:28<13:36:18, 50.86s/it]  4%|▎         | 37/1000 [32:19<14:01:12, 52.41s/it]
[32m[I 2021-05-13 14:41:00,077][0m Trial 24 finished with value: 0.8057743799285274 and parameters: {'rank': 30.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.1114561616242367, 'gamma': 0.001464266906866228}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 14:41:00.848159: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7727533797981742, 0.0)
Epoch 0 Test AUC:(0.7156820499787597, 0.0)
Epoch 0 a 0.41440411448718556 b 0.49354957634774255 c 0.41572887688815235
  0%|          | 1/1000 [00:50<14:05:00, 50.75s/it]Epoch 1 Valid AUC:(0.7693835588152048, 0.0)
Epoch 1 Test AUC:(0.7178125156281399, 0.0)
Epoch 1 a 0.39093891253893526 b 0.48964100230627616 c 0.39184963889045255
  0%|          | 2/1000 [01:41<14:07:29, 50.95s/it]Epoch 2 Valid AUC:(0.7725700878390628, 0.0)
Epoch 2 Test AUC:(0.7226122317581639, 0.0)
Epoch 2 a 0.3854834125555257 b 0.4936185047420218 c 0.3865626904686212
  0%|          | 3/1000 [02:32<14:07:24, 51.00s/it]Epoch 3 Valid AUC:(0.7822714010071014, 0.0)
Epoch 3 Test AUC:(0.725285462691425, 0.0)
Epoch 3 a 0.3792124820547085 b 0.481793044798331 c 0.3800551093200323
  0%|          | 4/1000 [03:23<14:05:53, 50.96s/it]Epoch 4 Valid AUC:(0.7845282224223055, 0.0)
Epoch 4 Test AUC:(0.7263940251584871, 0.0)
Epoch 4 a 0.3738447296427529 b 0.4781509893281119 c 0.3735865605189287
  0%|          | 5/1000 [04:15<14:06:46, 51.06s/it]Epoch 5 Valid AUC:(0.781427312693173, 0.0)
Epoch 5 Test AUC:(0.7223624979044371, 0.0)
Epoch 5 a 0.37008654873375924 b 0.4718508211299927 c 0.3683878700857911
  1%|          | 6/1000 [05:05<14:02:11, 50.84s/it]Epoch 6 Valid AUC:(0.7886046681966342, 0.0)
Epoch 6 Test AUC:(0.7243640755574732, 0.0)
Epoch 6 a 0.36768745326660046 b 0.4644755171818033 c 0.36423183968609246
  1%|          | 7/1000 [05:56<14:03:46, 50.98s/it]Epoch 7 Valid AUC:(0.7871437805699343, 0.0)
Epoch 7 Test AUC:(0.7241146324349794, 0.0)
Epoch 7 a 0.36546013976486635 b 0.45959613752557 c 0.35861036799083534
  1%|          | 8/1000 [06:47<14:01:41, 50.91s/it]Epoch 8 Valid AUC:(0.7924290300157587, 0.0)
Epoch 8 Test AUC:(0.7258863613955371, 0.0)
Epoch 8 a 0.3632455005252385 b 0.4505187549461541 c 0.3523880041221258
  1%|          | 9/1000 [07:38<14:01:29, 50.95s/it]Epoch 9 Valid AUC:(0.7900411889209046, 0.0)
Epoch 9 Test AUC:(0.7230188877949271, 0.0)
Epoch 9 a 0.36143784108056387 b 0.43802651457143743 c 0.34619833340107553
  1%|          | 10/1000 [08:29<13:59:22, 50.87s/it]Epoch 10 Valid AUC:(0.7918581321902547, 0.0)
Epoch 10 Test AUC:(0.7202353884906149, 0.0)
Epoch 10 a 0.3587690995972401 b 0.42182286242604017 c 0.33841762078599913
  1%|          | 11/1000 [09:19<13:57:57, 50.84s/it]Epoch 11 Valid AUC:(0.7920402361138876, 0.0)
Epoch 11 Test AUC:(0.723070924410183, 0.0)
Epoch 11 a 0.35764079416541744 b 0.40777590648988843 c 0.3325002898632641
  1%|          | 12/1000 [10:10<13:56:36, 50.81s/it]Epoch 12 Valid AUC:(0.7921594459262948, 0.0)
Epoch 12 Test AUC:(0.7225509858035554, 0.0)
Epoch 12 a 0.3566279306378163 b 0.3951785311972351 c 0.3277902268547887
  1%|▏         | 13/1000 [11:01<13:54:32, 50.73s/it]Epoch 13 Valid AUC:(0.7932983490249025, 0.0)
Epoch 13 Test AUC:(0.7235935437297976, 0.0)
Epoch 13 a 0.35533591151477345 b 0.38243200487534046 c 0.32202171499820303
  1%|▏         | 14/1000 [11:51<13:53:27, 50.72s/it]Epoch 14 Valid AUC:(0.7931860944104907, 0.0)
Epoch 14 Test AUC:(0.7261362149621247, 0.0)
Epoch 14 a 0.3537313555567797 b 0.3719116330026861 c 0.3174335912199807
  2%|▏         | 15/1000 [12:42<13:53:30, 50.77s/it]Epoch 15 Valid AUC:(0.792277881657333, 0.0)
Epoch 15 Test AUC:(0.7272657998626115, 0.0)
Epoch 15 a 0.3519783560299058 b 0.3603058907107808 c 0.31280781181765277
  2%|▏         | 16/1000 [13:33<13:52:40, 50.77s/it]Epoch 16 Valid AUC:(0.7925050963261729, 0.0)
Epoch 16 Test AUC:(0.731479957636526, 0.0)
Epoch 16 a 0.3494822734918153 b 0.34853803727708355 c 0.3076569782176488
  2%|▏         | 17/1000 [14:24<13:51:51, 50.77s/it]Epoch 17 Valid AUC:(0.7936799583238692, 0.0)
Epoch 17 Test AUC:(0.7379410916014635, 0.0)
Epoch 17 a 0.3463669111071458 b 0.3399511846138438 c 0.3049349195400714
  2%|▏         | 18/1000 [15:15<13:52:36, 50.87s/it]Epoch 18 Valid AUC:(0.7973458462065799, 0.0)
Epoch 18 Test AUC:(0.7403266568060038, 0.0)
Epoch 18 a 0.34242211872902917 b 0.3316257518661814 c 0.30052267491697543
  2%|▏         | 19/1000 [16:06<13:50:03, 50.77s/it]Epoch 19 Valid AUC:(0.7958094177220506, 0.0)
Epoch 19 Test AUC:(0.7422652227397366, 0.0)
Epoch 19 a 0.33911403413989416 b 0.32596035172761806 c 0.297231617348055
  2%|▏         | 20/1000 [16:55<13:44:18, 50.47s/it]Epoch 20 Valid AUC:(0.7975529783339443, 0.0)
Epoch 20 Test AUC:(0.7452638075755316, 0.0)
Epoch 20 a 0.336806378614015 b 0.32205975025712363 c 0.2951311545232892
  2%|▏         | 21/1000 [17:47<13:48:57, 50.80s/it]Epoch 21 Valid AUC:(0.8019325884626852, 0.0)
Epoch 21 Test AUC:(0.7480061641349085, 0.0)
Epoch 21 a 0.33367687295859966 b 0.31762681124915537 c 0.2920895024864247
  2%|▏         | 22/1000 [18:38<13:50:27, 50.95s/it]Epoch 22 Valid AUC:(0.8007278077074431, 0.0)
Epoch 22 Test AUC:(0.7470120984681546, 0.0)
Epoch 22 a 0.33099609955215836 b 0.3139020056431922 c 0.2886427525783209
  2%|▏         | 23/1000 [19:29<13:50:04, 50.98s/it]Epoch 23 Valid AUC:(0.8011112355849901, 0.0)
Epoch 23 Test AUC:(0.7470866325502971, 0.0)
Epoch 23 a 0.32962757007217025 b 0.31037786860820993 c 0.2852321026970443
  2%|▏         | 24/1000 [20:21<13:52:07, 51.15s/it]Epoch 24 Valid AUC:(0.8007046493459586, 0.0)
Epoch 24 Test AUC:(0.7478188947416934, 0.0)
Epoch 24 a 0.3285679799810022 b 0.30608925775023293 c 0.28124838659700974
  2%|▎         | 25/1000 [21:12<13:52:23, 51.22s/it]Epoch 25 Valid AUC:(0.802950768189123, 0.0)
Epoch 25 Test AUC:(0.7503640500158792, 0.0)
Epoch 25 a 0.3274333524991809 b 0.3016131075934865 c 0.277129234082742
  3%|▎         | 26/1000 [22:03<13:50:37, 51.17s/it]Epoch 26 Valid AUC:(0.7990679414395859, 0.0)
Epoch 26 Test AUC:(0.7496723619333301, 0.0)
Epoch 26 a 0.32685277495585696 b 0.29848141524513483 c 0.27405088639235353
  3%|▎         | 27/1000 [22:54<13:49:00, 51.12s/it]Epoch 27 Valid AUC:(0.8016277708550182, 0.0)
Epoch 27 Test AUC:(0.7462955186615056, 0.0)
Epoch 27 a 0.32601768653877305 b 0.2948351703599185 c 0.2705589695655604
  3%|▎         | 28/1000 [23:45<13:48:35, 51.15s/it]Epoch 28 Valid AUC:(0.8021166404056572, 0.0)
Epoch 28 Test AUC:(0.749840883437473, 0.0)
Epoch 28 a 0.3260099154482905 b 0.29111421533993315 c 0.2676161526134556
  3%|▎         | 29/1000 [24:36<13:46:05, 51.05s/it]Epoch 29 Valid AUC:(0.8041458139740367, 0.0)
Epoch 29 Test AUC:(0.7508435000228459, 0.0)
Epoch 29 a 0.3254460183907323 b 0.28634074908986656 c 0.26333233180420257
  3%|▎         | 30/1000 [25:27<13:43:58, 50.97s/it]Epoch 30 Valid AUC:(0.8035536237845206, 0.0)
Epoch 30 Test AUC:(0.7496543921778522, 0.0)
Epoch 30 a 0.3252304307291925 b 0.28346250933300804 c 0.26042251855554716
  3%|▎         | 31/1000 [26:18<13:44:11, 51.03s/it]Epoch 31 Valid AUC:(0.8055674041553467, 0.0)
Epoch 31 Test AUC:(0.7504221535078953, 0.0)
Epoch 31 a 0.32453066914134343 b 0.2786688289232177 c 0.25639561460291593
  3%|▎         | 32/1000 [27:09<13:41:23, 50.91s/it]Epoch 32 Valid AUC:(0.8022473973590148, 0.0)
Epoch 32 Test AUC:(0.7477891418203586, 0.0)
Epoch 32 a 0.3244245480483686 b 0.2739575233317957 c 0.25214685214837074
  3%|▎         | 33/1000 [28:00<13:39:50, 50.87s/it]Epoch 33 Valid AUC:(0.8016000013267037, 0.0)
Epoch 33 Test AUC:(0.7488043453579386, 0.0)
Epoch 33 a 0.32427522929861274 b 0.27195767821440514 c 0.2503762537804648
  3%|▎         | 34/1000 [28:51<13:39:37, 50.91s/it]Epoch 34 Valid AUC:(0.800415859323722, 0.0)
Epoch 34 Test AUC:(0.7477413592871157, 0.0)
Epoch 34 a 0.3246243507329607 b 0.26804294195813194 c 0.24752231266057229
  4%|▎         | 35/1000 [29:42<13:40:35, 51.02s/it]Epoch 35 Valid AUC:(0.8033650426965854, 0.0)
Epoch 35 Test AUC:(0.7533056044999449, 0.0)
Epoch 35 a 0.32352726842076246 b 0.2639801882102456 c 0.24345356408858923
  4%|▎         | 36/1000 [30:33<13:41:30, 51.13s/it]Epoch 36 Valid AUC:(0.8016636964327234, 0.0)
Epoch 36 Test AUC:(0.752958796342596, 0.0)
Epoch 36 a 0.3232800274547677 b 0.2607952735313707 c 0.2410662872810479
  4%|▎         | 37/1000 [31:24<13:40:00, 51.09s/it]  4%|▎         | 37/1000 [32:15<13:59:41, 52.32s/it]
[32m[I 2021-05-13 15:13:35,896][0m Trial 25 finished with value: 0.8055674041553467 and parameters: {'rank': 30.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.11333743870289004, 'gamma': 0.001102309779284418}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 15:13:36.560092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.77265572379448, 0.0)
Epoch 0 Test AUC:(0.7147688375230077, 0.0)
Epoch 0 a 0.41450271693993385 b 0.49389399663063605 c 0.4163181096974993
  0%|          | 1/1000 [00:51<14:23:53, 51.89s/it]Epoch 1 Valid AUC:(0.7736547872995618, 0.0)
Epoch 1 Test AUC:(0.7195453250826033, 0.0)
Epoch 1 a 0.38993857732001447 b 0.48865314172786967 c 0.39143131718309354
  0%|          | 2/1000 [01:43<14:21:27, 51.79s/it]Epoch 2 Valid AUC:(0.7796759894805315, 0.0)
Epoch 2 Test AUC:(0.7261217083286875, 0.0)
Epoch 2 a 0.3811515705806149 b 0.49225837837762276 c 0.383599538318588
  0%|          | 3/1000 [02:35<14:20:10, 51.77s/it]Epoch 3 Valid AUC:(0.784988493254819, 0.0)
Epoch 3 Test AUC:(0.725900312219264, 0.0)
Epoch 3 a 0.37486070958181644 b 0.4843540590413859 c 0.37669446422780306
  0%|          | 4/1000 [03:26<14:15:16, 51.52s/it]Epoch 4 Valid AUC:(0.7864679742134734, 0.0)
Epoch 4 Test AUC:(0.7265675147463477, 0.0)
Epoch 4 a 0.37063810918892415 b 0.478556681027115 c 0.3711790251779844
  0%|          | 5/1000 [04:17<14:13:51, 51.49s/it]Epoch 5 Valid AUC:(0.7837580755398018, 0.0)
Epoch 5 Test AUC:(0.723713692687313, 0.0)
Epoch 5 a 0.3680675035151437 b 0.4722879585365894 c 0.36704803532517893
  1%|          | 6/1000 [05:10<14:16:30, 51.70s/it]Epoch 6 Valid AUC:(0.789104313370038, 0.0)
Epoch 6 Test AUC:(0.7245331314940299, 0.0)
Epoch 6 a 0.36647680965467716 b 0.46112968678205785 c 0.36310896913050644
  1%|          | 7/1000 [06:01<14:14:52, 51.65s/it]Epoch 7 Valid AUC:(0.7885287569588121, 0.0)
Epoch 7 Test AUC:(0.7238651038032994, 0.0)
Epoch 7 a 0.3649030750546177 b 0.44492115515098724 c 0.3580185752999135
  1%|          | 8/1000 [06:51<14:04:31, 51.08s/it]Epoch 8 Valid AUC:(0.7920957995207585, 0.0)
Epoch 8 Test AUC:(0.7254426756056944, 0.0)
Epoch 8 a 0.36323302516515105 b 0.43080796826053674 c 0.3527738850721171
  1%|          | 9/1000 [07:42<14:02:05, 50.98s/it]Epoch 9 Valid AUC:(0.7899603896924514, 0.0)
Epoch 9 Test AUC:(0.722997501947461, 0.0)
Epoch 9 a 0.361981259805096 b 0.41427668005647794 c 0.3467534750520104
  1%|          | 10/1000 [08:33<14:03:23, 51.11s/it]Epoch 10 Valid AUC:(0.7925690656928102, 0.0)
Epoch 10 Test AUC:(0.7201856648988455, 0.0)
Epoch 10 a 0.3594717368993241 b 0.3982637866402056 c 0.33931949021111074
  1%|          | 11/1000 [09:24<14:03:25, 51.17s/it]Epoch 11 Valid AUC:(0.7924487857513581, 0.0)
Epoch 11 Test AUC:(0.7240579526709134, 0.0)
Epoch 11 a 0.35810630584146896 b 0.38596287399710305 c 0.3328809408354807
  1%|          | 12/1000 [10:16<14:03:14, 51.21s/it]Epoch 12 Valid AUC:(0.7931179380838662, 0.0)
Epoch 12 Test AUC:(0.7234035166653278, 0.0)
Epoch 12 a 0.35677073515157104 b 0.37518804917632936 c 0.32684915262448716
  1%|▏         | 13/1000 [11:07<14:00:47, 51.11s/it]Epoch 13 Valid AUC:(0.7937404110029628, 0.0)
Epoch 13 Test AUC:(0.7223776501322299, 0.0)
Epoch 13 a 0.35516245792089574 b 0.3646629734538211 c 0.3201073100509298
  1%|▏         | 14/1000 [11:58<13:58:56, 51.05s/it]Epoch 14 Valid AUC:(0.7935764749228498, 0.0)
Epoch 14 Test AUC:(0.7259500229846555, 0.0)
Epoch 14 a 0.3535273223215905 b 0.35582166574370694 c 0.3150258914565656
  2%|▏         | 15/1000 [12:49<14:00:12, 51.18s/it]Epoch 15 Valid AUC:(0.7926704331859817, 0.0)
Epoch 15 Test AUC:(0.7271455183658575, 0.0)
Epoch 15 a 0.3518835552021771 b 0.3478676902816089 c 0.3103713030426555
  2%|▏         | 16/1000 [13:41<14:01:12, 51.29s/it]Epoch 16 Valid AUC:(0.7922958367566356, 0.0)
Epoch 16 Test AUC:(0.7308487416504502, 0.0)
Epoch 16 a 0.34937620978480133 b 0.33988207038979174 c 0.30523002117692344
  2%|▏         | 17/1000 [14:32<14:02:54, 51.45s/it]Epoch 17 Valid AUC:(0.7947436435257484, 0.0)
Epoch 17 Test AUC:(0.7387086733622155, 0.0)
Epoch 17 a 0.34659700314523706 b 0.33366359317566546 c 0.3017977622433208
  2%|▏         | 18/1000 [15:24<14:00:47, 51.37s/it]Epoch 18 Valid AUC:(0.7978961052798235, 0.0)
Epoch 18 Test AUC:(0.7384690723470522, 0.0)
Epoch 18 a 0.3429241494033898 b 0.3285235219318382 c 0.29731834069703905
  2%|▏         | 19/1000 [16:15<13:59:30, 51.35s/it]Epoch 19 Valid AUC:(0.797365549396921, 0.0)
Epoch 19 Test AUC:(0.7418477668927577, 0.0)
Epoch 19 a 0.33977140267370215 b 0.3235665449434123 c 0.29322174881065877
  2%|▏         | 20/1000 [17:07<14:00:36, 51.47s/it]Epoch 20 Valid AUC:(0.7965408323410909, 0.0)
Epoch 20 Test AUC:(0.7442252001736914, 0.0)
Epoch 20 a 0.33727404145407724 b 0.3202467359287638 c 0.2892111988974289
  2%|▏         | 21/1000 [17:59<14:03:28, 51.69s/it]Epoch 21 Valid AUC:(0.8012499755728628, 0.0)
Epoch 21 Test AUC:(0.7474358691685338, 0.0)
Epoch 21 a 0.3342683881341332 b 0.3164022538503651 c 0.28516980465988756
  2%|▏         | 22/1000 [18:50<14:02:06, 51.66s/it]Epoch 22 Valid AUC:(0.7999506082259771, 0.0)
Epoch 22 Test AUC:(0.7479340585136539, 0.0)
Epoch 22 a 0.3320909481892883 b 0.31210275225236384 c 0.279854849310708
  2%|▏         | 23/1000 [19:41<13:57:30, 51.43s/it]Epoch 23 Valid AUC:(0.7985017765321208, 0.0)
Epoch 23 Test AUC:(0.7460785091733336, 0.0)
Epoch 23 a 0.33072132106038404 b 0.30890892278140697 c 0.2760470055298546
  2%|▏         | 24/1000 [20:33<13:56:24, 51.42s/it]Epoch 24 Valid AUC:(0.7984331934354701, 0.0)
Epoch 24 Test AUC:(0.7469323440501954, 0.0)
Epoch 24 a 0.32949294848461264 b 0.3034017482094122 c 0.27135598383679
  2%|▎         | 25/1000 [21:23<13:51:09, 51.15s/it]Epoch 25 Valid AUC:(0.8002604842759673, 0.0)
Epoch 25 Test AUC:(0.7487801163300317, 0.0)
Epoch 25 a 0.3284425020697611 b 0.30062657348826616 c 0.26773861836139823
  3%|▎         | 26/1000 [22:15<13:53:05, 51.32s/it]Epoch 26 Valid AUC:(0.7959149644856595, 0.0)
Epoch 26 Test AUC:(0.7480112305541903, 0.0)
Epoch 26 a 0.3279936626643482 b 0.29689070948172863 c 0.2650509584897481
  3%|▎         | 27/1000 [23:05<13:47:50, 51.05s/it]  3%|▎         | 27/1000 [23:57<14:23:16, 53.23s/it]
[32m[I 2021-05-13 15:37:53,241][0m Trial 26 finished with value: 0.8012499755728628 and parameters: {'rank': 35.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.11303074446795766, 'gamma': 0.0010217967198885144}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 15:37:53.995540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7723721306264668, 0.0)
Epoch 0 Test AUC:(0.7151548046121723, 0.0)
Epoch 0 a 0.4140725713860341 b 0.495655296673957 c 0.4160357277757925
  0%|          | 1/1000 [00:51<14:16:20, 51.43s/it]Epoch 1 Valid AUC:(0.7745773038973531, 0.0)
Epoch 1 Test AUC:(0.720293367994311, 0.0)
Epoch 1 a 0.3892308807588919 b 0.4908840336070454 c 0.39141962148054266
  0%|          | 2/1000 [01:42<14:07:56, 50.98s/it]Epoch 2 Valid AUC:(0.780595631468206, 0.0)
Epoch 2 Test AUC:(0.7259162938861629, 0.0)
Epoch 2 a 0.38076946906880355 b 0.49727793922366753 c 0.38383848896208905
  0%|          | 3/1000 [02:33<14:11:34, 51.25s/it]Epoch 3 Valid AUC:(0.7841476640285086, 0.0)
Epoch 3 Test AUC:(0.7254289770340667, 0.0)
Epoch 3 a 0.374821365419288 b 0.4941200923991635 c 0.3771694392505546
  0%|          | 4/1000 [03:24<14:10:04, 51.21s/it]Epoch 4 Valid AUC:(0.7873219192489389, 0.0)
Epoch 4 Test AUC:(0.7258428158424699, 0.0)
Epoch 4 a 0.37122194232115563 b 0.48937783754567504 c 0.37222756934117984
  0%|          | 5/1000 [04:16<14:11:40, 51.36s/it]Epoch 5 Valid AUC:(0.7837878097481471, 0.0)
Epoch 5 Test AUC:(0.7227347236673809, 0.0)
Epoch 5 a 0.3687896971971216 b 0.4848048346383231 c 0.3685280660268526
  1%|          | 6/1000 [05:07<14:08:30, 51.22s/it]Epoch 6 Valid AUC:(0.7876953237980315, 0.0)
Epoch 6 Test AUC:(0.7237236887111785, 0.0)
Epoch 6 a 0.3671627087852125 b 0.474835137486218 c 0.36493164966523767
  1%|          | 7/1000 [05:59<14:09:55, 51.35s/it]Epoch 7 Valid AUC:(0.7873160764725134, 0.0)
Epoch 7 Test AUC:(0.7223776073776368, 0.0)
Epoch 7 a 0.3655912690239413 b 0.46118025856478595 c 0.3606440380545449
  1%|          | 8/1000 [06:49<14:05:55, 51.16s/it]Epoch 8 Valid AUC:(0.7924025343895644, 0.0)
Epoch 8 Test AUC:(0.7250250230875872, 0.0)
Epoch 8 a 0.3639409198487549 b 0.4480683967860892 c 0.35618192874929555
  1%|          | 9/1000 [07:41<14:07:59, 51.34s/it]Epoch 9 Valid AUC:(0.7894066088052976, 0.0)
Epoch 9 Test AUC:(0.7214057484465365, 0.0)
Epoch 9 a 0.36306394711586554 b 0.4339857159605928 c 0.35117208352031365
  1%|          | 10/1000 [08:32<14:04:47, 51.20s/it]Epoch 10 Valid AUC:(0.7926639919062463, 0.0)
Epoch 10 Test AUC:(0.7204260654248997, 0.0)
Epoch 10 a 0.36102093861136636 b 0.4169409640837963 c 0.34399051367636896
  1%|          | 11/1000 [09:24<14:06:35, 51.36s/it]Epoch 11 Valid AUC:(0.7921880113230367, 0.0)
Epoch 11 Test AUC:(0.7224441506263298, 0.0)
Epoch 11 a 0.3604150873794402 b 0.40022298867553774 c 0.3377420396752041
  1%|          | 12/1000 [10:15<14:03:35, 51.23s/it]Epoch 12 Valid AUC:(0.7927139650102508, 0.0)
Epoch 12 Test AUC:(0.7236309240705405, 0.0)
Epoch 12 a 0.3596991429506413 b 0.3870631706426801 c 0.3320959181612886
  1%|▏         | 13/1000 [11:06<14:04:25, 51.33s/it]Epoch 13 Valid AUC:(0.7927480130561587, 0.0)
Epoch 13 Test AUC:(0.7213929690986604, 0.0)
Epoch 13 a 0.3584217394981346 b 0.37421262486120105 c 0.325386252921352
  1%|▏         | 14/1000 [11:57<14:01:23, 51.20s/it]Epoch 14 Valid AUC:(0.7933961959857555, 0.0)
Epoch 14 Test AUC:(0.7242991869115329, 0.0)
Epoch 14 a 0.35714414583845155 b 0.36419802928114803 c 0.31949609194243217
  2%|▏         | 15/1000 [12:49<14:03:09, 51.36s/it]Epoch 15 Valid AUC:(0.7927529946029817, 0.0)
Epoch 15 Test AUC:(0.7244533856269892, 0.0)
Epoch 15 a 0.3554286307971962 b 0.35560010850309604 c 0.31492638923752475
  2%|▏         | 16/1000 [13:40<14:02:08, 51.35s/it]Epoch 16 Valid AUC:(0.7914612975822435, 0.0)
Epoch 16 Test AUC:(0.7266159984549174, 0.0)
Epoch 16 a 0.3527188142180683 b 0.3468303892694009 c 0.30989150852864417
  2%|▏         | 17/1000 [14:31<13:59:13, 51.22s/it]Epoch 17 Valid AUC:(0.7935842695633892, 0.0)
Epoch 17 Test AUC:(0.7342710715338684, 0.0)
Epoch 17 a 0.348786103233725 b 0.3406099337087551 c 0.30715490376925325
  2%|▏         | 18/1000 [15:22<13:58:31, 51.23s/it]Epoch 18 Valid AUC:(0.7969424806074162, 0.0)
Epoch 18 Test AUC:(0.7349158492768738, 0.0)
Epoch 18 a 0.3440291901949186 b 0.3347419716222905 c 0.3027885474669382
  2%|▏         | 19/1000 [16:13<13:56:31, 51.16s/it]Epoch 19 Valid AUC:(0.7970150738044036, 0.0)
Epoch 19 Test AUC:(0.7387876795747956, 0.0)
Epoch 19 a 0.3402214789054763 b 0.3303784800607194 c 0.2986803468863969
  2%|▏         | 20/1000 [17:04<13:52:04, 50.94s/it]Epoch 20 Valid AUC:(0.7956320287741732, 0.0)
Epoch 20 Test AUC:(0.7407696970014909, 0.0)
Epoch 20 a 0.3375896043940569 b 0.3269725405354375 c 0.29451290594500074
  2%|▏         | 21/1000 [17:55<13:53:08, 51.06s/it]Epoch 21 Valid AUC:(0.8008868801471669, 0.0)
Epoch 21 Test AUC:(0.745759859190997, 0.0)
Epoch 21 a 0.3345816099427835 b 0.32268239716648817 c 0.28972870576189796
  2%|▏         | 22/1000 [18:46<13:53:45, 51.15s/it]Epoch 22 Valid AUC:(0.800126654065784, 0.0)
Epoch 22 Test AUC:(0.7446310395977265, 0.0)
Epoch 22 a 0.33239248065161753 b 0.3185137802326463 c 0.28553542042042407
  2%|▏         | 23/1000 [19:37<13:51:52, 51.09s/it]Epoch 23 Valid AUC:(0.7988402333579528, 0.0)
Epoch 23 Test AUC:(0.7446348191037561, 0.0)
Epoch 23 a 0.3310053589598274 b 0.3157554553668024 c 0.28166954150382184
  2%|▏         | 24/1000 [20:28<13:50:28, 51.05s/it]Epoch 24 Valid AUC:(0.7986001861117171, 0.0)
Epoch 24 Test AUC:(0.7444127303699244, 0.0)
Epoch 24 a 0.32987650635256854 b 0.31128816537454096 c 0.27689926788000996
  2%|▎         | 25/1000 [21:19<13:48:49, 51.00s/it]Epoch 25 Valid AUC:(0.8002152633138766, 0.0)
Epoch 25 Test AUC:(0.7477908434531638, 0.0)
Epoch 25 a 0.32867516676185116 b 0.30837388231720725 c 0.2739165603394959
  3%|▎         | 26/1000 [22:10<13:46:03, 50.89s/it]Epoch 26 Valid AUC:(0.7963998700732617, 0.0)
Epoch 26 Test AUC:(0.7475635001798407, 0.0)
Epoch 26 a 0.3282385645977688 b 0.3048018718989082 c 0.27075741840320333
  3%|▎         | 27/1000 [23:01<13:46:34, 50.97s/it]  3%|▎         | 27/1000 [23:52<14:20:05, 53.04s/it]
[32m[I 2021-05-13 16:02:05,270][0m Trial 27 finished with value: 0.8008868801471669 and parameters: {'rank': 40.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.10310226649091542, 'gamma': 0.0013969166269921134}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 16:02:05.956413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7739277214696523, 0.0)
Epoch 0 Test AUC:(0.7162916791707818, 0.0)
Epoch 0 a 0.4145826214036232 b 0.4947205227265655 c 0.4158074976932595
  0%|          | 1/1000 [00:50<14:02:18, 50.59s/it]Epoch 1 Valid AUC:(0.7742765514984646, 0.0)
Epoch 1 Test AUC:(0.7199875016353098, 0.0)
Epoch 1 a 0.38888923844821016 b 0.4911961790541528 c 0.39001997843594616
  0%|          | 2/1000 [01:40<13:53:43, 50.12s/it]Epoch 2 Valid AUC:(0.781717318945905, 0.0)
Epoch 2 Test AUC:(0.7262860099544921, 0.0)
Epoch 2 a 0.3806948608435855 b 0.49618235848079506 c 0.38260548809164724
  0%|          | 3/1000 [02:31<13:57:34, 50.41s/it]Epoch 3 Valid AUC:(0.7826478147334363, 0.0)
Epoch 3 Test AUC:(0.725940112469976, 0.0)
Epoch 3 a 0.37522207989059464 b 0.49773764754205163 c 0.37742042265667525
  0%|          | 4/1000 [03:21<13:59:31, 50.57s/it]Epoch 4 Valid AUC:(0.7857678368391495, 0.0)
Epoch 4 Test AUC:(0.7272694553803212, 0.0)
Epoch 4 a 0.3717303626853935 b 0.49558804140724166 c 0.3729774655110879
  0%|          | 5/1000 [04:12<14:00:42, 50.70s/it]Epoch 5 Valid AUC:(0.7832892641803966, 0.0)
Epoch 5 Test AUC:(0.7235542650851212, 0.0)
Epoch 5 a 0.3681035051403391 b 0.4931642913242701 c 0.36848505797760345
  1%|          | 6/1000 [05:03<13:57:49, 50.57s/it]2021-05-13 16:08:11.338610: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 47110834 get requests, put_count=47110834 evicted_count=25000 eviction_rate=0.000530663 and unsatisfied allocation rate=0.000530939
Epoch 6 Valid AUC:(0.7889467942194187, 0.0)
Epoch 6 Test AUC:(0.7257967007383577, 0.0)
Epoch 6 a 0.3665418521739108 b 0.4899388797566205 c 0.36568575234000594
  1%|          | 7/1000 [05:53<13:58:08, 50.64s/it]Epoch 7 Valid AUC:(0.7876733432192923, 0.0)
Epoch 7 Test AUC:(0.7242250247943505, 0.0)
Epoch 7 a 0.3651663986609975 b 0.4822568983978909 c 0.36269405921939873
  1%|          | 8/1000 [06:45<14:00:46, 50.85s/it]Epoch 8 Valid AUC:(0.7915890351056256, 0.0)
Epoch 8 Test AUC:(0.7251883798368843, 0.0)
Epoch 8 a 0.3632931224177301 b 0.4725986699942852 c 0.35921395160782504
  1%|          | 9/1000 [07:36<14:01:10, 50.93s/it]Epoch 9 Valid AUC:(0.7894375592441382, 0.0)
Epoch 9 Test AUC:(0.7227398114639592, 0.0)
Epoch 9 a 0.3617392963686699 b 0.4636417660914676 c 0.3560050479483077
  1%|          | 10/1000 [08:27<13:59:39, 50.89s/it]Epoch 10 Valid AUC:(0.791045935003453, 0.0)
Epoch 10 Test AUC:(0.7199049125878283, 0.0)
Epoch 10 a 0.3593140287058694 b 0.4549346227401219 c 0.35218016758291293
  1%|          | 11/1000 [09:18<14:00:26, 50.99s/it]Epoch 11 Valid AUC:(0.7916506745386059, 0.0)
Epoch 11 Test AUC:(0.7216969371537282, 0.0)
Epoch 11 a 0.35829642498996894 b 0.444161115997514 c 0.34849057770830766
  1%|          | 12/1000 [10:08<13:57:17, 50.85s/it]Epoch 12 Valid AUC:(0.7916881059865238, 0.0)
Epoch 12 Test AUC:(0.7207620908738701, 0.0)
Epoch 12 a 0.35778216444990285 b 0.4313082526507272 c 0.34492977482212384
  1%|▏         | 13/1000 [10:59<13:56:49, 50.87s/it]Epoch 13 Valid AUC:(0.7925387547682131, 0.0)
Epoch 13 Test AUC:(0.7195197279077173, 0.0)
Epoch 13 a 0.35696999209987323 b 0.41756460550325497 c 0.339315896662668
  1%|▏         | 14/1000 [11:50<13:56:58, 50.93s/it]Epoch 14 Valid AUC:(0.793035945693568, 0.0)
Epoch 14 Test AUC:(0.722054451061188, 0.0)
Epoch 14 a 0.35626441234314227 b 0.4038021670021042 c 0.33392880632124194
  2%|▏         | 15/1000 [12:42<13:59:39, 51.15s/it]Epoch 15 Valid AUC:(0.792239828637455, 0.0)
Epoch 15 Test AUC:(0.7190605777815522, 0.0)
Epoch 15 a 0.35565565679394745 b 0.3888320871881796 c 0.3278166081464027
  2%|▏         | 16/1000 [13:33<13:58:57, 51.16s/it]Epoch 16 Valid AUC:(0.7899588851038304, 0.0)
Epoch 16 Test AUC:(0.7200612020028868, 0.0)
Epoch 16 a 0.3549217171592252 b 0.3740952076086816 c 0.3216174724596127
  2%|▏         | 17/1000 [14:24<13:57:43, 51.13s/it]Epoch 17 Valid AUC:(0.791072447290339, 0.0)
Epoch 17 Test AUC:(0.7241515339242797, 0.0)
Epoch 17 a 0.35421126631184124 b 0.3604830216234119 c 0.3159639172151055
  2%|▏         | 18/1000 [15:16<13:57:27, 51.17s/it]Epoch 18 Valid AUC:(0.7935653853101255, 0.0)
Epoch 18 Test AUC:(0.7236122445888173, 0.0)
Epoch 18 a 0.3528051640785916 b 0.34831837863029846 c 0.309748485294626
  2%|▏         | 19/1000 [16:06<13:54:59, 51.07s/it]Epoch 19 Valid AUC:(0.7936702451405991, 0.0)
Epoch 19 Test AUC:(0.7286322452088444, 0.0)
Epoch 19 a 0.35134216051706124 b 0.33701704133684246 c 0.3039530041352124
  2%|▏         | 20/1000 [16:57<13:53:12, 51.01s/it]Epoch 20 Valid AUC:(0.7934674806776474, 0.0)
Epoch 20 Test AUC:(0.7328070388288963, 0.0)
Epoch 20 a 0.34996831309147763 b 0.3286815845750467 c 0.29908319630133556
  2%|▏         | 21/1000 [17:48<13:51:36, 50.97s/it]Epoch 21 Valid AUC:(0.7974402815704063, 0.0)
Epoch 21 Test AUC:(0.736967077838871, 0.0)
Epoch 21 a 0.347620767486887 b 0.32119837595183603 c 0.2945549929705664
  2%|▏         | 22/1000 [18:39<13:50:58, 50.98s/it]Epoch 22 Valid AUC:(0.7952986316722559, 0.0)
Epoch 22 Test AUC:(0.7403013717396475, 0.0)
Epoch 22 a 0.345369891861315 b 0.3155104438783657 c 0.2906390168897103
  2%|▏         | 23/1000 [19:29<13:45:52, 50.72s/it]Epoch 23 Valid AUC:(0.796871679075584, 0.0)
Epoch 23 Test AUC:(0.7434895731958184, 0.0)
Epoch 23 a 0.3424054179752856 b 0.311660550369823 c 0.28781994736530414
  2%|▏         | 24/1000 [20:20<13:45:26, 50.74s/it]Epoch 24 Valid AUC:(0.7978969601014676, 0.0)
Epoch 24 Test AUC:(0.7434204432942433, 0.0)
Epoch 24 a 0.3388283781002705 b 0.307894665410581 c 0.2847462551334734
  2%|▎         | 25/1000 [21:11<13:44:32, 50.74s/it]Epoch 25 Valid AUC:(0.8007695594008819, 0.0)
Epoch 25 Test AUC:(0.7470633441234382, 0.0)
Epoch 25 a 0.3349810460923423 b 0.306083943912201 c 0.2815505002346077
  3%|▎         | 26/1000 [22:01<13:41:38, 50.61s/it]Epoch 26 Valid AUC:(0.7984056558752478, 0.0)
Epoch 26 Test AUC:(0.7480008027089344, 0.0)
Epoch 26 a 0.33236382394969105 b 0.30370791331383307 c 0.27825947858438166
  3%|▎         | 27/1000 [22:52<13:40:29, 50.60s/it]Epoch 27 Valid AUC:(0.8012166503446569, 0.0)
Epoch 27 Test AUC:(0.7443602106277666, 0.0)
Epoch 27 a 0.3301559804191052 b 0.29926237646842624 c 0.27304359853747384
  3%|▎         | 28/1000 [23:42<13:38:12, 50.51s/it]Epoch 28 Valid AUC:(0.8006373696280368, 0.0)
Epoch 28 Test AUC:(0.7473906732881731, 0.0)
Epoch 28 a 0.32909248034719013 b 0.29720850963467804 c 0.2703483939110873
  3%|▎         | 29/1000 [24:33<13:39:21, 50.63s/it]Epoch 29 Valid AUC:(0.8036515015035736, 0.0)
Epoch 29 Test AUC:(0.7494472547252259, 0.0)
Epoch 29 a 0.3278018178594424 b 0.2929031906473325 c 0.26492071583477306
  3%|▎         | 30/1000 [25:23<13:36:25, 50.50s/it]Epoch 30 Valid AUC:(0.8030584321421714, 0.0)
Epoch 30 Test AUC:(0.748037943623956, 0.0)
Epoch 30 a 0.32707651544144933 b 0.28910522963439433 c 0.2609931603223985
  3%|▎         | 31/1000 [26:14<13:37:59, 50.65s/it]Epoch 31 Valid AUC:(0.8059500348828748, 0.0)
Epoch 31 Test AUC:(0.7500508384177844, 0.0)
Epoch 31 a 0.32588994245174185 b 0.28579168312506414 c 0.2576568994963433
  3%|▎         | 32/1000 [27:04<13:35:43, 50.56s/it]Epoch 32 Valid AUC:(0.8028903872791631, 0.0)
Epoch 32 Test AUC:(0.7477262968439684, 0.0)
Epoch 32 a 0.32555970033889325 b 0.2821337673325894 c 0.2538397846147568
  3%|▎         | 33/1000 [27:55<13:36:42, 50.68s/it]Epoch 33 Valid AUC:(0.8012876172018146, 0.0)
Epoch 33 Test AUC:(0.7486522330666254, 0.0)
Epoch 33 a 0.3250347061656131 b 0.2790626602573414 c 0.2510043028254864
  3%|▎         | 34/1000 [28:46<13:34:36, 50.60s/it]Epoch 34 Valid AUC:(0.7998969864304869, 0.0)
Epoch 34 Test AUC:(0.7475321995422359, 0.0)
Epoch 34 a 0.32515847467080927 b 0.2766406366103132 c 0.24851103094022278
  4%|▎         | 35/1000 [29:36<13:33:07, 50.56s/it]Epoch 35 Valid AUC:(0.803468358209096, 0.0)
Epoch 35 Test AUC:(0.7541160178120594, 0.0)
Epoch 35 a 0.3239180003133578 b 0.27345809082629935 c 0.24557673295498852
  4%|▎         | 36/1000 [30:26<13:30:33, 50.45s/it]Epoch 36 Valid AUC:(0.8014685933247775, 0.0)
Epoch 36 Test AUC:(0.7522070808113415, 0.0)
Epoch 36 a 0.3234714791928259 b 0.27115880783414936 c 0.24293664241700585
  4%|▎         | 37/1000 [31:17<13:30:10, 50.48s/it]  4%|▎         | 37/1000 [32:07<13:56:10, 52.10s/it]
[32m[I 2021-05-13 16:34:34,685][0m Trial 28 finished with value: 0.8059500348828748 and parameters: {'rank': 25.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.11324799365857033, 'gamma': 0.0015337765643872953}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 16:34:35.441411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7666535506866328, 0.0)
Epoch 0 Test AUC:(0.713186614020884, 0.0)
Epoch 0 a 0.4110806594397208 b 0.4999475719312617 c 0.4153415865488182
  0%|          | 1/1000 [02:56<49:03:00, 176.76s/it]Epoch 1 Valid AUC:(0.7875573719890362, 0.0)
Epoch 1 Test AUC:(0.7233287089537896, 0.0)
Epoch 1 a 0.3823293096429442 b 0.4930307515875786 c 0.3864625731624509
  0%|          | 2/1000 [05:54<49:07:48, 177.22s/it]Epoch 2 Valid AUC:(0.7811132471200123, 0.0)
Epoch 2 Test AUC:(0.7198561680762408, 0.0)
Epoch 2 a 0.37116671700822823 b 0.49390507265813033 c 0.3752660085173214
  0%|          | 3/1000 [08:51<49:04:27, 177.20s/it]Epoch 3 Valid AUC:(0.7864657378360085, 0.0)
Epoch 3 Test AUC:(0.7207987272846931, 0.0)
Epoch 3 a 0.36523729102763774 b 0.577423022388513 c 0.36973427578454765
  0%|          | 4/1000 [11:48<49:02:27, 177.26s/it]Epoch 4 Valid AUC:(0.7903612177401077, 0.0)
Epoch 4 Test AUC:(0.7208557704628004, 0.0)
Epoch 4 a 0.3629920256833086 b 0.6534291617890708 c 0.36689620135776235
  0%|          | 5/1000 [14:46<49:00:50, 177.34s/it]Epoch 5 Valid AUC:(0.7854251302553383, 0.0)
Epoch 5 Test AUC:(0.7179528746818112, 0.0)
Epoch 5 a 0.36127493315872206 b 0.7479692105374305 c 0.3636537540072829
  1%|          | 6/1000 [17:43<48:58:50, 177.39s/it]Epoch 6 Valid AUC:(0.7881704905705303, 0.0)
Epoch 6 Test AUC:(0.7186660811510651, 0.0)
Epoch 6 a 0.3597598451954327 b 0.8831217406741814 c 0.3600577350954964
  1%|          | 7/1000 [20:41<48:58:02, 177.53s/it]Epoch 7 Valid AUC:(0.791609767414078, 0.0)
Epoch 7 Test AUC:(0.7203472516079885, 0.0)
Epoch 7 a 0.3595686273217621 b 1.0111026470537698 c 0.3582745714814535
  1%|          | 8/1000 [23:39<48:56:51, 177.63s/it]Epoch 8 Valid AUC:(0.7926483385455837, 0.0)
Epoch 8 Test AUC:(0.722671053527344, 0.0)
Epoch 8 a 0.35832371440228655 b 1.2269664235064706 c 0.3542840705932595
  1%|          | 9/1000 [26:36<48:49:28, 177.36s/it]Epoch 9 Valid AUC:(0.7840770150060851, 0.0)
Epoch 9 Test AUC:(0.7168471511197306, 0.0)
Epoch 9 a 0.35813145308772665 b 1.4893699629693968 c 0.3521164577021678
  1%|          | 10/1000 [29:34<48:51:32, 177.67s/it]Epoch 10 Valid AUC:(0.7921824863813456, 0.0)
Epoch 10 Test AUC:(0.718810660083075, 0.0)
Epoch 10 a 0.3570429383509719 b 1.795888170757265 c 0.3485597684986931
  1%|          | 11/1000 [32:32<48:51:52, 177.87s/it]Epoch 11 Valid AUC:(0.7925777407868272, 0.0)
Epoch 11 Test AUC:(0.7193555502702328, 0.0)
Epoch 11 a 0.3570017044181018 b 2.1473929976146384 c 0.34669823184152415
  1%|          | 12/1000 [35:31<48:54:37, 178.22s/it]Epoch 12 Valid AUC:(0.7864423398168817, 0.0)
Epoch 12 Test AUC:(0.7172624820634328, 0.0)
Epoch 12 a 0.35690154580988437 b 2.532054790724097 c 0.34398183612412336
  1%|▏         | 13/1000 [38:30<48:51:06, 178.18s/it]Epoch 13 Valid AUC:(0.791675172163386, 0.0)
Epoch 13 Test AUC:(0.7174210631246812, 0.0)
Epoch 13 a 0.35646428579118994 b 2.876370253666014 c 0.3416383768698269
  1%|▏         | 14/1000 [41:28<48:48:36, 178.21s/it]Epoch 14 Valid AUC:(0.7929177303962971, 0.0)
Epoch 14 Test AUC:(0.7194287461336113, 0.0)
Epoch 14 a 0.3562001778724027 b 3.2527046871281198 c 0.340374797665036
  2%|▏         | 15/1000 [44:26<48:46:19, 178.25s/it]Epoch 15 Valid AUC:(0.7857715457654437, 0.0)
Epoch 15 Test AUC:(0.7181914880658741, 0.0)
Epoch 15 a 0.35570888266963774 b 3.6252134672177383 c 0.3383528891821612
  2%|▏         | 16/1000 [47:24<48:39:56, 178.05s/it]Epoch 16 Valid AUC:(0.7846897542364448, 0.0)
Epoch 16 Test AUC:(0.713812763587678, 0.0)
Epoch 16 a 0.3549956182189297 b 3.949841355606202 c 0.33605832313250633
  2%|▏         | 17/1000 [50:21<48:34:56, 177.92s/it]Epoch 17 Valid AUC:(0.7866606269181454, 0.0)
Epoch 17 Test AUC:(0.720153953817147, 0.0)
Epoch 17 a 0.3544214270847895 b 4.283368526241059 c 0.3348952535036043
  2%|▏         | 18/1000 [53:19<48:28:53, 177.73s/it]Epoch 18 Valid AUC:(0.7879023085423539, 0.0)
Epoch 18 Test AUC:(0.7217969401469773, 0.0)
Epoch 18 a 0.35331815587569265 b 4.594946007802895 c 0.33359220827746594
  2%|▏         | 19/1000 [56:16<48:24:10, 177.63s/it]Epoch 19 Valid AUC:(0.7898502638018041, 0.0)
Epoch 19 Test AUC:(0.7220745072408089, 0.0)
Epoch 19 a 0.35206961347087057 b 4.891778970975382 c 0.3326017456986066
  2%|▏         | 20/1000 [59:14<48:23:47, 177.78s/it]  2%|▏         | 20/1000 [1:02:13<50:49:20, 186.69s/it]
[32m[I 2021-05-13 17:37:08,367][0m Trial 29 finished with value: 0.7929177303962971 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 128, 'learning_rate': 0.01, 'alpha': 0.10008615975800222, 'gamma': 0.0021201903298779684}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 17:37:09.100813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5010157190704306, 0.0)
Epoch 0 Test AUC:(0.504256127820226, 0.0)
Epoch 0 a 0.5084188218927479 b 0.49264447471985157 c 0.4926416635873092
  0%|          | 1/1000 [00:51<14:12:22, 51.19s/it]Epoch 1 Valid AUC:(0.4959254727684018, 0.0)
Epoch 1 Test AUC:(0.49059039599556375, 0.0)
Epoch 1 a 0.5019535825286113 b 0.46853802657463184 c 0.4685380291531024
  0%|          | 2/1000 [01:41<14:07:08, 50.93s/it]Epoch 2 Valid AUC:(0.5019475592476241, 0.0)
Epoch 2 Test AUC:(0.4929670853465776, 0.0)
Epoch 2 a 0.5018044075735618 b 0.45778121267046246 c 0.45778120475515754
  0%|          | 3/1000 [02:32<14:04:27, 50.82s/it]Epoch 3 Valid AUC:(0.5027836683718124, 0.0)
Epoch 3 Test AUC:(0.49854847515123785, 0.0)
Epoch 3 a 0.5017396593597573 b 0.4335232657685846 c 0.4335232559943823
  0%|          | 4/1000 [03:23<14:04:54, 50.90s/it]Epoch 4 Valid AUC:(0.49954849012814545, 0.0)
Epoch 4 Test AUC:(0.4952047795154399, 0.0)
Epoch 4 a 0.5018701038849905 b 0.41524087135460774 c 0.4152408783704462
  0%|          | 5/1000 [04:14<14:02:24, 50.80s/it]Epoch 5 Valid AUC:(0.5002861281563373, 0.0)
Epoch 5 Test AUC:(0.49643185771456116, 0.0)
Epoch 5 a 0.5017943562756122 b 0.4069560464599003 c 0.4069560385445954
  1%|          | 6/1000 [05:05<14:05:29, 51.04s/it]Epoch 6 Valid AUC:(0.496467983338406, 0.0)
Epoch 6 Test AUC:(0.4946864142778382, 0.0)
Epoch 6 a 0.5019194615079123 b 0.40031322321181806 c 0.40031324419936903
  1%|          | 7/1000 [05:56<14:05:29, 51.09s/it]Epoch 7 Valid AUC:(0.49443632732696086, 0.0)
Epoch 7 Test AUC:(0.4985576673887533, 0.0)
Epoch 7 a 0.501643397858445 b 0.398042805357958 c 0.3980428193896349
  1%|          | 8/1000 [06:47<14:04:02, 51.05s/it]Epoch 8 Valid AUC:(0.4979826388620467, 0.0)
Epoch 8 Test AUC:(0.49808836732218736, 0.0)
Epoch 8 a 0.5016613162499318 b 0.3948638038016421 c 0.3948637879110678
  1%|          | 9/1000 [07:39<14:05:54, 51.22s/it]  1%|          | 9/1000 [08:30<15:37:07, 56.74s/it]
[32m[I 2021-05-13 17:45:59,285][0m Trial 30 finished with value: 0.5027836683718124 and parameters: {'rank': 25.0, 'lambda': 0.1, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.11671917673727172, 'gamma': 0.001440874227603872}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 17:46:00.008547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7726828820035678, 0.0)
Epoch 0 Test AUC:(0.7147612229299775, 0.0)
Epoch 0 a 0.4145042686395242 b 0.4943156004911457 c 0.41630504104932786
  0%|          | 1/1000 [00:51<14:10:24, 51.08s/it]Epoch 1 Valid AUC:(0.7737386367161906, 0.0)
Epoch 1 Test AUC:(0.719585133884234, 0.0)
Epoch 1 a 0.3899324837944637 b 0.4892201024881551 c 0.39143962417569916
  0%|          | 2/1000 [01:42<14:10:20, 51.12s/it]Epoch 2 Valid AUC:(0.7798865767790394, 0.0)
Epoch 2 Test AUC:(0.7260593251019027, 0.0)
Epoch 2 a 0.3811580551342225 b 0.4933656681951143 c 0.3836842735768324
  0%|          | 3/1000 [02:34<14:14:51, 51.45s/it]Epoch 3 Valid AUC:(0.7848631676869606, 0.0)
Epoch 3 Test AUC:(0.7259458415854508, 0.0)
Epoch 3 a 0.37488519215967575 b 0.48654298529298734 c 0.3768573776936867
  0%|          | 4/1000 [03:25<14:13:16, 51.40s/it]Epoch 4 Valid AUC:(0.7867426167452604, 0.0)
Epoch 4 Test AUC:(0.7267196398640389, 0.0)
Epoch 4 a 0.370649326135455 b 0.4810531046428911 c 0.3713325328630221
  0%|          | 5/1000 [04:16<14:09:37, 51.23s/it]Epoch 5 Valid AUC:(0.7839812211550881, 0.0)
Epoch 5 Test AUC:(0.723691259352316, 0.0)
Epoch 5 a 0.36804216800321277 b 0.47544968284111866 c 0.36727797781197835
  1%|          | 6/1000 [05:08<14:13:39, 51.53s/it]Epoch 6 Valid AUC:(0.7891268514411539, 0.0)
Epoch 6 Test AUC:(0.7248822655012431, 0.0)
Epoch 6 a 0.36648695275817117 b 0.4653733528595815 c 0.3634347360978424
  1%|          | 7/1000 [05:59<14:09:03, 51.30s/it]Epoch 7 Valid AUC:(0.7887602598333812, 0.0)
Epoch 7 Test AUC:(0.7239603097312032, 0.0)
Epoch 7 a 0.3650191476647283 b 0.4489487362819418 c 0.3585276679253914
  1%|          | 8/1000 [06:50<14:07:15, 51.25s/it]Epoch 8 Valid AUC:(0.7918251529917999, 0.0)
Epoch 8 Test AUC:(0.725522960180608, 0.0)
Epoch 8 a 0.3634283372933716 b 0.4358861442183105 c 0.3534420662122953
  1%|          | 9/1000 [07:41<14:06:58, 51.28s/it]Epoch 9 Valid AUC:(0.7899496730229034, 0.0)
Epoch 9 Test AUC:(0.7227093915709721, 0.0)
Epoch 9 a 0.3623138040124291 b 0.4199228699898096 c 0.3476112680415992
  1%|          | 10/1000 [08:33<14:06:18, 51.29s/it]Epoch 10 Valid AUC:(0.7929030407925708, 0.0)
Epoch 10 Test AUC:(0.7208211007632597, 0.0)
Epoch 10 a 0.35980367834419313 b 0.40363288885151116 c 0.3401126772824907
  1%|          | 11/1000 [09:24<14:04:24, 51.23s/it]Epoch 11 Valid AUC:(0.7920387558755083, 0.0)
Epoch 11 Test AUC:(0.7237026962059689, 0.0)
Epoch 11 a 0.3585253933545809 b 0.3911190126503497 c 0.33398306057966454
  1%|          | 12/1000 [10:15<14:04:36, 51.29s/it]Epoch 12 Valid AUC:(0.7929341527119618, 0.0)
Epoch 12 Test AUC:(0.7225643166856824, 0.0)
Epoch 12 a 0.3571483956376312 b 0.37999312834480636 c 0.3278535037213408
  1%|▏         | 13/1000 [11:07<14:08:43, 51.59s/it]Epoch 13 Valid AUC:(0.7932407504504589, 0.0)
Epoch 13 Test AUC:(0.7224617740696035, 0.0)
Epoch 13 a 0.3555708486189545 b 0.36914744643378306 c 0.32100816595722254
  1%|▏         | 14/1000 [11:58<14:03:19, 51.32s/it]Epoch 14 Valid AUC:(0.7931246459346692, 0.0)
Epoch 14 Test AUC:(0.7251795467379509, 0.0)
Epoch 14 a 0.3539935507524901 b 0.3600534418938865 c 0.3161996599414219
  2%|▏         | 15/1000 [12:50<14:04:17, 51.43s/it]Epoch 15 Valid AUC:(0.7923433492046329, 0.0)
Epoch 15 Test AUC:(0.7260252069366129, 0.0)
Epoch 15 a 0.352297269362559 b 0.35161659985001176 c 0.31105089445469125
  2%|▏         | 16/1000 [13:41<14:05:01, 51.53s/it]Epoch 16 Valid AUC:(0.7920124012243979, 0.0)
Epoch 16 Test AUC:(0.7301750703534311, 0.0)
Epoch 16 a 0.3497480852623101 b 0.34340557503988084 c 0.30611060346875874
  2%|▏         | 17/1000 [14:33<14:02:56, 51.45s/it]Epoch 17 Valid AUC:(0.7943471549474883, 0.0)
Epoch 17 Test AUC:(0.7374772855001103, 0.0)
Epoch 17 a 0.34690756013455765 b 0.33694731187772464 c 0.3026249998771928
  2%|▏         | 18/1000 [15:24<14:01:12, 51.40s/it]Epoch 18 Valid AUC:(0.7976427025667903, 0.0)
Epoch 18 Test AUC:(0.7376335449869537, 0.0)
Epoch 18 a 0.3432516915577518 b 0.33134016070807243 c 0.2977446289789269
  2%|▏         | 19/1000 [16:15<13:59:14, 51.33s/it]Epoch 19 Valid AUC:(0.7975152444303922, 0.0)
Epoch 19 Test AUC:(0.7410692271297954, 0.0)
Epoch 19 a 0.3401390916744708 b 0.32632323092138266 c 0.29397834498637637
  2%|▏         | 20/1000 [17:07<14:00:32, 51.46s/it]Epoch 20 Valid AUC:(0.7967276153559124, 0.0)
Epoch 20 Test AUC:(0.7438072013433801, 0.0)
Epoch 20 a 0.3375953634979739 b 0.32114336452253867 c 0.2895243085426104
  2%|▏         | 21/1000 [17:59<14:00:58, 51.54s/it]Epoch 21 Valid AUC:(0.8005912823099769, 0.0)
Epoch 21 Test AUC:(0.7470548103066565, 0.0)
Epoch 21 a 0.3345234444443609 b 0.3168526999427519 c 0.2852242315259258
  2%|▏         | 22/1000 [18:50<13:58:49, 51.46s/it]Epoch 22 Valid AUC:(0.8005015888353311, 0.0)
Epoch 22 Test AUC:(0.7475105614426706, 0.0)
Epoch 22 a 0.3322208996869669 b 0.31305014721344654 c 0.2805698301110949
  2%|▏         | 23/1000 [19:41<13:55:39, 51.32s/it]Epoch 23 Valid AUC:(0.798626231899235, 0.0)
Epoch 23 Test AUC:(0.745526051423198, 0.0)
Epoch 23 a 0.33076162531342307 b 0.3102298799594883 c 0.2769684491742785
  2%|▏         | 24/1000 [20:32<13:52:36, 51.19s/it]Epoch 24 Valid AUC:(0.7991241776820838, 0.0)
Epoch 24 Test AUC:(0.7463420271078742, 0.0)
Epoch 24 a 0.32947977142074936 b 0.3047949470264811 c 0.2721444218451348
  2%|▎         | 25/1000 [21:23<13:50:11, 51.09s/it]Epoch 25 Valid AUC:(0.8004953410759378, 0.0)
Epoch 25 Test AUC:(0.7489236990800224, 0.0)
Epoch 25 a 0.3284140942202248 b 0.3014058539085465 c 0.26885409548249045
  3%|▎         | 26/1000 [22:14<13:50:15, 51.14s/it]Epoch 26 Valid AUC:(0.7962033174851365, 0.0)
Epoch 26 Test AUC:(0.7486001964513697, 0.0)
Epoch 26 a 0.32785909282609493 b 0.29767890115618945 c 0.26564062463205823
  3%|▎         | 27/1000 [23:05<13:50:37, 51.22s/it]  3%|▎         | 27/1000 [23:57<14:23:11, 53.23s/it]
[32m[I 2021-05-13 18:10:16,605][0m Trial 31 finished with value: 0.8005912823099769 and parameters: {'rank': 35.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.10895739594948191, 'gamma': 0.0010852591163969054}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 18:10:17.277339: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.773971149484996, 0.0)
Epoch 0 Test AUC:(0.7162577961557541, 0.0)
Epoch 0 a 0.414576751485437 b 0.4970556368050681 c 0.41583582249205836
  0%|          | 1/1000 [00:50<13:57:28, 50.30s/it]Epoch 1 Valid AUC:(0.7744453986378588, 0.0)
Epoch 1 Test AUC:(0.7200439804527882, 0.0)
Epoch 1 a 0.38888347646600047 b 0.4948945286528206 c 0.39008581284546034
  0%|          | 2/1000 [01:40<13:55:11, 50.21s/it]Epoch 2 Valid AUC:(0.7814331311193567, 0.0)
Epoch 2 Test AUC:(0.7262131903315328, 0.0)
Epoch 2 a 0.38069313518717973 b 0.5003325431879377 c 0.3826858218407007
  0%|          | 3/1000 [02:31<13:58:23, 50.45s/it]Epoch 3 Valid AUC:(0.782752529744051, 0.0)
Epoch 3 Test AUC:(0.7258026094231235, 0.0)
Epoch 3 a 0.37523115035034044 b 0.5041305196117347 c 0.3775574590118838
  0%|          | 4/1000 [03:21<13:58:32, 50.51s/it]Epoch 4 Valid AUC:(0.7855145302454917, 0.0)
Epoch 4 Test AUC:(0.7272295268658298, 0.0)
Epoch 4 a 0.37175675902807975 b 0.5066441898974374 c 0.3732132418774503
  0%|          | 5/1000 [04:11<13:54:34, 50.33s/it]Epoch 5 Valid AUC:(0.7831669042156635, 0.0)
Epoch 5 Test AUC:(0.7233806386825627, 0.0)
Epoch 5 a 0.3681417674845613 b 0.5108934625293647 c 0.36891942322853827
  1%|          | 6/1000 [05:02<13:58:35, 50.62s/it]Epoch 6 Valid AUC:(0.7885925840687739, 0.0)
Epoch 6 Test AUC:(0.7253237408786228, 0.0)
Epoch 6 a 0.3665570418239839 b 0.5151246114515923 c 0.3661655349510776
  1%|          | 7/1000 [05:53<13:59:05, 50.70s/it]Epoch 7 Valid AUC:(0.7872183307574024, 0.0)
Epoch 7 Test AUC:(0.7240489870327415, 0.0)
Epoch 7 a 0.36512997320720125 b 0.5129588588142778 c 0.3633794934456977
  1%|          | 8/1000 [06:44<13:55:58, 50.56s/it]Epoch 8 Valid AUC:(0.7914442049941351, 0.0)
Epoch 8 Test AUC:(0.7251399388829077, 0.0)
Epoch 8 a 0.3631935421249996 b 0.508743600226504 c 0.3600894204327758
  1%|          | 9/1000 [07:35<14:01:35, 50.95s/it]Epoch 9 Valid AUC:(0.7891980489848123, 0.0)
Epoch 9 Test AUC:(0.7224161121641781, 0.0)
Epoch 9 a 0.3616523457245088 b 0.5049320428184341 c 0.35730263404922946
  1%|          | 10/1000 [08:27<14:01:55, 51.03s/it]Epoch 10 Valid AUC:(0.7912635197924814, 0.0)
Epoch 10 Test AUC:(0.720173321647819, 0.0)
Epoch 10 a 0.3592092990875244 b 0.5034338410951242 c 0.353752132512674
  1%|          | 11/1000 [09:19<14:06:34, 51.36s/it]Epoch 11 Valid AUC:(0.792013229132617, 0.0)
Epoch 11 Test AUC:(0.7221900814568631, 0.0)
Epoch 11 a 0.35829548252900123 b 0.5004649004586026 c 0.35064983907599806
  1%|          | 12/1000 [10:10<14:04:18, 51.27s/it]Epoch 12 Valid AUC:(0.791732574654304, 0.0)
Epoch 12 Test AUC:(0.7209048356338361, 0.0)
Epoch 12 a 0.3577302787265547 b 0.49841720831226294 c 0.3473742345209333
  1%|▏         | 13/1000 [11:01<14:03:20, 51.27s/it]Epoch 13 Valid AUC:(0.7925782329180286, 0.0)
Epoch 13 Test AUC:(0.7194258046176064, 0.0)
Epoch 13 a 0.35683664319740693 b 0.4908029510221731 c 0.342215398547635
  1%|▏         | 14/1000 [11:52<14:03:03, 51.30s/it]Epoch 14 Valid AUC:(0.7933556092591451, 0.0)
Epoch 14 Test AUC:(0.722227709774246, 0.0)
Epoch 14 a 0.356089520742236 b 0.4811056508144862 c 0.33728958087667854
  2%|▏         | 15/1000 [12:44<14:02:31, 51.32s/it]Epoch 15 Valid AUC:(0.7921238420280989, 0.0)
Epoch 15 Test AUC:(0.7189438833951588, 0.0)
Epoch 15 a 0.35547547279229347 b 0.46526198595822216 c 0.3314458829176498
  2%|▏         | 16/1000 [13:35<14:00:24, 51.24s/it]Epoch 16 Valid AUC:(0.7902038395645722, 0.0)
Epoch 16 Test AUC:(0.7198523372646994, 0.0)
Epoch 16 a 0.35470589647590517 b 0.44782257769669087 c 0.32575310583805417
  2%|▏         | 17/1000 [14:26<13:59:35, 51.25s/it]Epoch 17 Valid AUC:(0.790964486008023, 0.0)
Epoch 17 Test AUC:(0.723315852647646, 0.0)
Epoch 17 a 0.3541582990100446 b 0.42803041130244374 c 0.32005741340773447
  2%|▏         | 18/1000 [15:18<13:59:21, 51.28s/it]Epoch 18 Valid AUC:(0.7936766518173596, 0.0)
Epoch 18 Test AUC:(0.7224431629952293, 0.0)
Epoch 18 a 0.35287101875608357 b 0.4096643172159521 c 0.31459405028844023
  2%|▏         | 19/1000 [16:08<13:56:56, 51.19s/it]Epoch 19 Valid AUC:(0.7929664385693229, 0.0)
Epoch 19 Test AUC:(0.7261358985781358, 0.0)
Epoch 19 a 0.35163585101095 b 0.3884999382663781 c 0.30901051449104094
  2%|▏         | 20/1000 [17:00<13:58:51, 51.36s/it]Epoch 20 Valid AUC:(0.7925770230954917, 0.0)
Epoch 20 Test AUC:(0.7309497707539335, 0.0)
Epoch 20 a 0.350285913203084 b 0.3714186798039097 c 0.3046996612364138
  2%|▏         | 21/1000 [17:52<13:58:02, 51.36s/it]Epoch 21 Valid AUC:(0.7971895086834807, 0.0)
Epoch 21 Test AUC:(0.7349778904669139, 0.0)
Epoch 21 a 0.3478171885373367 b 0.35576852334577075 c 0.2993020954985974
  2%|▏         | 22/1000 [18:43<13:59:46, 51.52s/it]Epoch 22 Valid AUC:(0.7944831151630278, 0.0)
Epoch 22 Test AUC:(0.7392285478369535, 0.0)
Epoch 22 a 0.3458938652600801 b 0.34296623280110733 c 0.29505973406720687
  2%|▏         | 23/1000 [19:35<13:58:33, 51.50s/it]Epoch 23 Valid AUC:(0.7954885597130367, 0.0)
Epoch 23 Test AUC:(0.7403621858728657, 0.0)
Epoch 23 a 0.34426618647767265 b 0.33286323735651596 c 0.29079900858867574
  2%|▏         | 24/1000 [20:26<13:54:31, 51.30s/it]Epoch 24 Valid AUC:(0.795364397830415, 0.0)
Epoch 24 Test AUC:(0.7425341705076004, 0.0)
Epoch 24 a 0.3424091924364178 b 0.3229282807176502 c 0.28711735371732616
  2%|▎         | 25/1000 [21:18<13:55:57, 51.44s/it]Epoch 25 Valid AUC:(0.7997244585598153, 0.0)
Epoch 25 Test AUC:(0.7467724718002354, 0.0)
Epoch 25 a 0.33931254465095473 b 0.31554017958027014 c 0.2837284287396571
  3%|▎         | 26/1000 [22:09<13:55:02, 51.44s/it]Epoch 26 Valid AUC:(0.7960406988812607, 0.0)
Epoch 26 Test AUC:(0.7482966815949886, 0.0)
Epoch 26 a 0.3364410630054397 b 0.3088643381773106 c 0.28050779645711604
  3%|▎         | 27/1000 [23:01<13:55:20, 51.51s/it]Epoch 27 Valid AUC:(0.8000862685490657, 0.0)
Epoch 27 Test AUC:(0.7460659949039347, 0.0)
Epoch 27 a 0.3331383359983893 b 0.30251958006824287 c 0.2762019140139912
  3%|▎         | 28/1000 [23:52<13:53:27, 51.45s/it]Epoch 28 Valid AUC:(0.7983431206096898, 0.0)
Epoch 28 Test AUC:(0.7486615022624085, 0.0)
Epoch 28 a 0.33169452909012914 b 0.29867407745518676 c 0.2736827057432121
  3%|▎         | 29/1000 [24:43<13:51:44, 51.39s/it]Epoch 29 Valid AUC:(0.8020271878702454, 0.0)
Epoch 29 Test AUC:(0.7488391133930434, 0.0)
Epoch 29 a 0.33002597939080636 b 0.2934075383173388 c 0.2694053759337431
  3%|▎         | 30/1000 [25:34<13:49:02, 51.28s/it]Epoch 30 Valid AUC:(0.8026409549371248, 0.0)
Epoch 30 Test AUC:(0.7497295675788911, 0.0)
Epoch 30 a 0.32867637144727724 b 0.28927939062866886 c 0.26540550289739306
  3%|▎         | 31/1000 [26:25<13:47:40, 51.25s/it]Epoch 31 Valid AUC:(0.8042995742162867, 0.0)
Epoch 31 Test AUC:(0.7487596539817765, 0.0)
Epoch 31 a 0.32726608453622047 b 0.28651127318141445 c 0.26365503872664164
  3%|▎         | 32/1000 [27:16<13:45:02, 51.14s/it]Epoch 32 Valid AUC:(0.8027984305136273, 0.0)
Epoch 32 Test AUC:(0.7484015799891471, 0.0)
Epoch 32 a 0.3267461171812215 b 0.28238811174508793 c 0.2598020317748759
  3%|▎         | 33/1000 [28:07<13:43:37, 51.10s/it]Epoch 33 Valid AUC:(0.7993059125073155, 0.0)
Epoch 33 Test AUC:(0.7488569164056081, 0.0)
Epoch 33 a 0.3259473896362412 b 0.2803543609692537 c 0.25831844779087504
  3%|▎         | 34/1000 [28:58<13:41:36, 51.03s/it]Epoch 34 Valid AUC:(0.7993115899584156, 0.0)
Epoch 34 Test AUC:(0.747596049251564, 0.0)
Epoch 34 a 0.32605714073603304 b 0.27695217899513436 c 0.2547974977454909
  4%|▎         | 35/1000 [29:49<13:40:17, 51.00s/it]Epoch 35 Valid AUC:(0.8031131074060148, 0.0)
Epoch 35 Test AUC:(0.7543025347244361, 0.0)
Epoch 35 a 0.32460470572563727 b 0.2733478764113286 c 0.2518507422096053
  4%|▎         | 36/1000 [30:40<13:40:54, 51.09s/it]Epoch 36 Valid AUC:(0.8010264672671337, 0.0)
Epoch 36 Test AUC:(0.7522416949299111, 0.0)
Epoch 36 a 0.32425787361334985 b 0.27089675517389233 c 0.24891663374195636
  4%|▎         | 37/1000 [31:31<13:38:26, 50.99s/it]  4%|▎         | 37/1000 [32:23<14:02:51, 52.51s/it]
[32m[I 2021-05-13 18:42:59,678][0m Trial 32 finished with value: 0.8042995742162867 and parameters: {'rank': 25.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.11486014954020761, 'gamma': 0.0027154438750131515}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 18:43:00.392670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7707848729346971, 0.0)
Epoch 0 Test AUC:(0.7149517630495644, 0.0)
Epoch 0 a 0.413252414292253 b 0.49817274627791086 c 0.4158571650924337
  0%|          | 1/1000 [00:51<14:14:53, 51.34s/it]Epoch 1 Valid AUC:(0.7751615148971293, 0.0)
Epoch 1 Test AUC:(0.7214922538147455, 0.0)
Epoch 1 a 0.3884821199555272 b 0.49608152361223157 c 0.39212632862854774
  0%|          | 2/1000 [01:43<14:19:52, 51.70s/it]Epoch 2 Valid AUC:(0.7803738328057652, 0.0)
Epoch 2 Test AUC:(0.7258743388039588, 0.0)
Epoch 2 a 0.38080551057034573 b 0.5026982309113086 c 0.3854587943381227
  0%|          | 3/1000 [02:34<14:18:05, 51.64s/it]Epoch 3 Valid AUC:(0.7830238990907117, 0.0)
Epoch 3 Test AUC:(0.7247254886838234, 0.0)
Epoch 3 a 0.3755071771216824 b 0.5006957973992561 c 0.37948366112152576
  0%|          | 4/1000 [03:26<14:19:40, 51.79s/it]Epoch 4 Valid AUC:(0.78629820689126, 0.0)
Epoch 4 Test AUC:(0.7259222111218472, 0.0)
Epoch 4 a 0.37227965678487507 b 0.5011192378503696 c 0.3752224645024574
  0%|          | 5/1000 [04:18<14:20:38, 51.90s/it]Epoch 5 Valid AUC:(0.7843935604591281, 0.0)
Epoch 5 Test AUC:(0.7230186996747175, 0.0)
Epoch 5 a 0.36949668869646024 b 0.49870322731658967 c 0.3714178981075824
  1%|          | 6/1000 [05:11<14:23:12, 52.11s/it]Epoch 6 Valid AUC:(0.7869042562131, 0.0)
Epoch 6 Test AUC:(0.7231056368643167, 0.0)
Epoch 6 a 0.36705597653475325 b 0.49619539372877813 c 0.3675996345173665
  1%|          | 7/1000 [06:03<14:19:26, 51.93s/it]Epoch 7 Valid AUC:(0.7871740402308645, 0.0)
Epoch 7 Test AUC:(0.7228457530701892, 0.0)
Epoch 7 a 0.36460048236117754 b 0.4882785740872504 c 0.3632793484079526
  1%|          | 8/1000 [06:54<14:18:32, 51.93s/it]Epoch 8 Valid AUC:(0.7924485268698407, 0.0)
Epoch 8 Test AUC:(0.7252641024967148, 0.0)
Epoch 8 a 0.36239696766289187 b 0.4818656726382388 c 0.35831868576571735
  1%|          | 9/1000 [07:47<14:21:27, 52.16s/it]Epoch 9 Valid AUC:(0.7882798013688752, 0.0)
Epoch 9 Test AUC:(0.7194593840750231, 0.0)
Epoch 9 a 0.3611370707661573 b 0.4746911615672965 c 0.35327317459242685
  1%|          | 10/1000 [08:39<14:20:48, 52.17s/it]Epoch 10 Valid AUC:(0.7914524212783342, 0.0)
Epoch 10 Test AUC:(0.7180600134166478, 0.0)
Epoch 10 a 0.3591349633406825 b 0.4622739059344624 c 0.34680209235406256
  1%|          | 11/1000 [09:31<14:17:44, 52.04s/it]Epoch 11 Valid AUC:(0.7908262009851934, 0.0)
Epoch 11 Test AUC:(0.7198958828177666, 0.0)
Epoch 11 a 0.3584929232746063 b 0.4453002326565249 c 0.341736900914363
  1%|          | 12/1000 [10:23<14:15:16, 51.94s/it]Epoch 12 Valid AUC:(0.7903699838271333, 0.0)
Epoch 12 Test AUC:(0.7191915308247426, 0.0)
Epoch 12 a 0.35794622269674564 b 0.428305876926637 c 0.33733283549966947
  1%|▏         | 13/1000 [11:15<14:14:16, 51.93s/it]Epoch 13 Valid AUC:(0.791604409079304, 0.0)
Epoch 13 Test AUC:(0.7184287717820916, 0.0)
Epoch 13 a 0.357073243295163 b 0.4085739000102644 c 0.33167247573134884
  1%|▏         | 14/1000 [12:06<14:11:05, 51.79s/it]Epoch 14 Valid AUC:(0.7929430584924795, 0.0)
Epoch 14 Test AUC:(0.7203102646095021, 0.0)
Epoch 14 a 0.3564054761494189 b 0.3918008430143237 c 0.32705514321864493
  2%|▏         | 15/1000 [12:59<14:14:24, 52.05s/it]Epoch 15 Valid AUC:(0.7911181424413477, 0.0)
Epoch 15 Test AUC:(0.7183101619899277, 0.0)
Epoch 15 a 0.3554938757563501 b 0.3764365100165008 c 0.3215758179275083
  2%|▏         | 16/1000 [13:51<14:12:33, 51.99s/it]Epoch 16 Valid AUC:(0.790561922685245, 0.0)
Epoch 16 Test AUC:(0.7205860146331272, 0.0)
Epoch 16 a 0.3544573008534414 b 0.3637682576654423 c 0.3169351023447586
  2%|▏         | 17/1000 [14:42<14:09:40, 51.86s/it]Epoch 17 Valid AUC:(0.7906910904649314, 0.0)
Epoch 17 Test AUC:(0.7244956399913449, 0.0)
Epoch 17 a 0.3537663623720587 b 0.3522714953907059 c 0.31228534424568805
  2%|▏         | 18/1000 [15:35<14:14:12, 52.19s/it]Epoch 18 Valid AUC:(0.7939709091096623, 0.0)
Epoch 18 Test AUC:(0.7241705682691255, 0.0)
Epoch 18 a 0.3521878819470434 b 0.3438863384291919 c 0.30761524681114333
  2%|▏         | 19/1000 [16:27<14:12:09, 52.12s/it]Epoch 19 Valid AUC:(0.792552050000202, 0.0)
Epoch 19 Test AUC:(0.7289055411188259, 0.0)
Epoch 19 a 0.3507788380986488 b 0.3366589580383339 c 0.3042263882140998
  2%|▏         | 20/1000 [17:19<14:11:51, 52.15s/it]Epoch 20 Valid AUC:(0.7924786417109122, 0.0)
Epoch 20 Test AUC:(0.7330769058205115, 0.0)
Epoch 20 a 0.3494583876200125 b 0.33176535158090187 c 0.3016495386839393
  2%|▏         | 21/1000 [18:11<14:10:26, 52.12s/it]Epoch 21 Valid AUC:(0.7969122478599111, 0.0)
Epoch 21 Test AUC:(0.7369014067838773, 0.0)
Epoch 21 a 0.3473390634031123 b 0.32603707160028655 c 0.29837318427366033
  2%|▏         | 22/1000 [19:04<14:10:37, 52.19s/it]Epoch 22 Valid AUC:(0.7945087841625945, 0.0)
Epoch 22 Test AUC:(0.7407813219753534, 0.0)
Epoch 22 a 0.3449154651500809 b 0.32180925232303936 c 0.29589657974195194
  2%|▏         | 23/1000 [19:56<14:08:33, 52.11s/it]Epoch 23 Valid AUC:(0.7951750400979275, 0.0)
Epoch 23 Test AUC:(0.7408990809511148, 0.0)
Epoch 23 a 0.3421095140743064 b 0.3187779817183013 c 0.29358880173872176
  2%|▏         | 24/1000 [20:49<14:11:25, 52.34s/it]Epoch 24 Valid AUC:(0.7975848156342209, 0.0)
Epoch 24 Test AUC:(0.7404280792517437, 0.0)
Epoch 24 a 0.3386327859381555 b 0.31542680938718787 c 0.29106857961931937
  2%|▎         | 25/1000 [21:40<14:07:43, 52.17s/it]Epoch 25 Valid AUC:(0.7996480052087166, 0.0)
Epoch 25 Test AUC:(0.7463702579656948, 0.0)
Epoch 25 a 0.33497732517944734 b 0.3138172234927625 c 0.2893082141216612
  3%|▎         | 26/1000 [22:33<14:11:17, 52.44s/it]Epoch 26 Valid AUC:(0.7967426471446147, 0.0)
Epoch 26 Test AUC:(0.7468385361974857, 0.0)
Epoch 26 a 0.3327344849675714 b 0.3115880358327083 c 0.2866064729824872
  3%|▎         | 27/1000 [23:26<14:08:52, 52.35s/it]Epoch 27 Valid AUC:(0.7991809957672, 0.0)
Epoch 27 Test AUC:(0.7443093454883616, 0.0)
Epoch 27 a 0.3304725764263084 b 0.3075387061721602 c 0.28262770622668854
  3%|▎         | 28/1000 [24:18<14:09:39, 52.45s/it]Epoch 28 Valid AUC:(0.7984495029710679, 0.0)
Epoch 28 Test AUC:(0.7455303311579669, 0.0)
Epoch 28 a 0.32959787124839107 b 0.30585511031764856 c 0.2800311238712948
  3%|▎         | 29/1000 [25:10<14:06:04, 52.28s/it]Epoch 29 Valid AUC:(0.8021263843471274, 0.0)
Epoch 29 Test AUC:(0.7473891341228217, 0.0)
Epoch 29 a 0.32827850912418405 b 0.30248093647016605 c 0.2761091019665931
  3%|▎         | 30/1000 [26:02<14:02:39, 52.12s/it]Epoch 30 Valid AUC:(0.8018246041117193, 0.0)
Epoch 30 Test AUC:(0.7474071509083519, 0.0)
Epoch 30 a 0.3276655913238794 b 0.29856390264672295 c 0.2725556511094632
  3%|▎         | 31/1000 [26:54<14:02:59, 52.20s/it]Epoch 31 Valid AUC:(0.8040842821947567, 0.0)
Epoch 31 Test AUC:(0.7492697718583702, 0.0)
Epoch 31 a 0.3265319155975127 b 0.2955808397569887 c 0.2692921780484543
  3%|▎         | 32/1000 [27:45<13:57:03, 51.88s/it]Epoch 32 Valid AUC:(0.7994143607944663, 0.0)
Epoch 32 Test AUC:(0.7462606095362435, 0.0)
Epoch 32 a 0.326047779148973 b 0.29156314484190415 c 0.2657192326347593
  3%|▎         | 33/1000 [28:38<13:58:37, 52.03s/it]Epoch 33 Valid AUC:(0.799951125989012, 0.0)
Epoch 33 Test AUC:(0.7483607322509042, 0.0)
Epoch 33 a 0.32564230284220735 b 0.28948490750381883 c 0.2638879655532434
  3%|▎         | 34/1000 [29:30<13:56:54, 51.98s/it]Epoch 34 Valid AUC:(0.7990112681743283, 0.0)
Epoch 34 Test AUC:(0.7487393754782716, 0.0)
Epoch 34 a 0.32585699937233265 b 0.2868652290681478 c 0.26198510504824296
  4%|▎         | 35/1000 [30:22<13:57:59, 52.10s/it]Epoch 35 Valid AUC:(0.8025566338947614, 0.0)
Epoch 35 Test AUC:(0.7540093151740724, 0.0)
Epoch 35 a 0.32465181492224066 b 0.2833442316508629 c 0.2583594966522405
  4%|▎         | 36/1000 [31:14<13:56:40, 52.08s/it]Epoch 36 Valid AUC:(0.800263697226285, 0.0)
Epoch 36 Test AUC:(0.7506552857531233, 0.0)
Epoch 36 a 0.3243030983077688 b 0.28090415370296423 c 0.25645202866022737
  4%|▎         | 37/1000 [32:07<13:58:12, 52.22s/it]  4%|▎         | 37/1000 [32:59<14:18:43, 53.50s/it]
[32m[I 2021-05-13 19:16:19,215][0m Trial 33 finished with value: 0.8040842821947567 and parameters: {'rank': 55.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.10618389912172149, 'gamma': 0.002147086870214051}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 19:16:20.027495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.4949167345278, 0.0)
Epoch 0 Test AUC:(0.47310365198233234, 0.0)
Epoch 0 a 0.5175034481754726 b 0.5173526971153091 c 0.5173509936457429
  0%|          | 1/1000 [00:51<14:15:09, 51.36s/it]Epoch 1 Valid AUC:(0.4895383838550782, 0.0)
Epoch 1 Test AUC:(0.508139950781511, 0.0)
Epoch 1 a 0.5056830012582437 b 0.5056824130671365 c 0.5056824124075278
  0%|          | 2/1000 [01:43<14:17:46, 51.57s/it]Epoch 2 Valid AUC:(0.4970108630068113, 0.0)
Epoch 2 Test AUC:(0.49214252453960794, 0.0)
Epoch 2 a 0.5061324382092152 b 0.5061320790822357 c 0.5061320771034095
  0%|          | 3/1000 [02:34<14:17:27, 51.60s/it]Epoch 3 Valid AUC:(0.4946059882770657, 0.0)
Epoch 3 Test AUC:(0.4916443822245402, 0.0)
Epoch 3 a 0.5050012454900223 b 0.5050007670937889 c 0.5050007639756385
  0%|          | 4/1000 [03:25<14:13:09, 51.39s/it]Epoch 4 Valid AUC:(0.5052862913798525, 0.0)
Epoch 4 Test AUC:(0.5093385715234683, 0.0)
Epoch 4 a 0.5058834824403766 b 0.5058827211319561 c 0.5058827222712803
  0%|          | 5/1000 [04:17<14:11:26, 51.34s/it]Epoch 5 Valid AUC:(0.5038374340541627, 0.0)
Epoch 5 Test AUC:(0.5035077428717736, 0.0)
Epoch 5 a 0.5073721397450752 b 0.5073719247126244 c 0.507371920635043
  1%|          | 6/1000 [05:08<14:09:17, 51.27s/it]Epoch 6 Valid AUC:(0.5010063314114448, 0.0)
Epoch 6 Test AUC:(0.49532008437755765, 0.0)
Epoch 6 a 0.5061384855021893 b 0.5061381683503118 c 0.5061381721880355
  1%|          | 7/1000 [05:58<14:05:52, 51.11s/it]Epoch 7 Valid AUC:(0.5022909040640872, 0.0)
Epoch 7 Test AUC:(0.5034954509262588, 0.0)
Epoch 7 a 0.5059763776584411 b 0.5059757536685683 c 0.5059757528290663
  1%|          | 8/1000 [06:49<14:03:57, 51.05s/it]Epoch 8 Valid AUC:(0.5029299043893654, 0.0)
Epoch 8 Test AUC:(0.5128950054635881, 0.0)
Epoch 8 a 0.5055243876618398 b 0.5055241327530422 c 0.5055241347318684
  1%|          | 9/1000 [07:40<14:02:09, 50.99s/it]Epoch 9 Valid AUC:(0.49535028417398536, 0.0)
Epoch 9 Test AUC:(0.49519596779380304, 0.0)
Epoch 9 a 0.5053190778438714 b 0.5053188715662275 c 0.505318872045943
  1%|          | 10/1000 [08:31<13:59:04, 50.85s/it]  1%|          | 10/1000 [09:22<15:28:21, 56.26s/it]
[32m[I 2021-05-13 19:26:01,984][0m Trial 34 finished with value: 0.5052862913798525 and parameters: {'rank': 35.0, 'lambda': 1, 'batch_size': 512, 'learning_rate': 0.05, 'alpha': 0.11904095000331141, 'gamma': 0.0014806893053123406}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 19:26:02.696236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.773272533359985, 0.0)
Epoch 0 Test AUC:(0.7164621802125851, 0.0)
Epoch 0 a 0.4145730213380196 b 0.4939393632008996 c 0.4157504045987273
  0%|          | 1/1000 [00:51<14:21:38, 51.75s/it]Epoch 1 Valid AUC:(0.7737943833906704, 0.0)
Epoch 1 Test AUC:(0.7198425037082876, 0.0)
Epoch 1 a 0.38890733745256423 b 0.49042668512889315 c 0.3899505513174913
  0%|          | 2/1000 [01:43<14:18:31, 51.61s/it]Epoch 2 Valid AUC:(0.7808132713656761, 0.0)
Epoch 2 Test AUC:(0.7260413767237214, 0.0)
Epoch 2 a 0.3806558698115934 b 0.4956797928637422 c 0.3823846469462757
  0%|          | 3/1000 [02:34<14:17:05, 51.58s/it]Epoch 3 Valid AUC:(0.7831717588849111, 0.0)
Epoch 3 Test AUC:(0.7263580685456943, 0.0)
Epoch 3 a 0.374857779299949 b 0.4958926907607487 c 0.3768479186644257
  0%|          | 4/1000 [03:26<14:16:48, 51.61s/it]Epoch 4 Valid AUC:(0.7866508688791669, 0.0)
Epoch 4 Test AUC:(0.7271826079753674, 0.0)
Epoch 4 a 0.37080430049051943 b 0.49524034370838754 c 0.37177124061814737
  0%|          | 5/1000 [04:18<14:16:37, 51.66s/it]Epoch 5 Valid AUC:(0.7838089419132006, 0.0)
Epoch 5 Test AUC:(0.7239994216329665, 0.0)
Epoch 5 a 0.36749702038419557 b 0.49281214300535575 c 0.3674810004666058
  1%|          | 6/1000 [05:09<14:14:08, 51.56s/it]Epoch 6 Valid AUC:(0.7889127782133025, 0.0)
Epoch 6 Test AUC:(0.7251356078426272, 0.0)
Epoch 6 a 0.3659020359487361 b 0.4890713434464015 c 0.3644963306800221
  1%|          | 7/1000 [06:00<14:11:18, 51.44s/it]Epoch 7 Valid AUC:(0.7879743468101481, 0.0)
Epoch 7 Test AUC:(0.7239499802215115, 0.0)
Epoch 7 a 0.3644183046021452 b 0.4825462950787074 c 0.36124786854509855
  1%|          | 8/1000 [06:51<14:08:37, 51.33s/it]Epoch 8 Valid AUC:(0.7924603098236586, 0.0)
Epoch 8 Test AUC:(0.7255784556424453, 0.0)
Epoch 8 a 0.36270313717469843 b 0.4757502928106358 c 0.35770693721185987
  1%|          | 9/1000 [07:42<14:06:17, 51.24s/it]Epoch 9 Valid AUC:(0.789715223769084, 0.0)
Epoch 9 Test AUC:(0.7237650452290793, 0.0)
Epoch 9 a 0.36174043359411073 b 0.468334194819932 c 0.3543828298868068
  1%|          | 10/1000 [08:33<14:03:44, 51.14s/it]Epoch 10 Valid AUC:(0.7912471154191001, 0.0)
Epoch 10 Test AUC:(0.7215432985234415, 0.0)
Epoch 10 a 0.35993614241151023 b 0.45949226677777544 c 0.34984803463611563
  1%|          | 11/1000 [09:25<14:04:35, 51.24s/it]Epoch 11 Valid AUC:(0.7920208174368975, 0.0)
Epoch 11 Test AUC:(0.7239758168221188, 0.0)
Epoch 11 a 0.35947878397926236 b 0.448146935260032 c 0.34536109016215055
  1%|          | 12/1000 [10:16<14:03:54, 51.25s/it]Epoch 12 Valid AUC:(0.7924470299707697, 0.0)
Epoch 12 Test AUC:(0.723452684447387, 0.0)
Epoch 12 a 0.35912904623048886 b 0.4329797057678522 c 0.3409674644350286
  1%|▏         | 13/1000 [11:07<14:01:03, 51.13s/it]Epoch 13 Valid AUC:(0.792656172915465, 0.0)
Epoch 13 Test AUC:(0.7227282634483643, 0.0)
Epoch 13 a 0.35835027358901334 b 0.4156828857883361 c 0.3342222234972526
  1%|▏         | 14/1000 [11:56<13:52:31, 50.66s/it]Epoch 14 Valid AUC:(0.7940117739416652, 0.0)
Epoch 14 Test AUC:(0.726484617865796, 0.0)
Epoch 14 a 0.35735121687173366 b 0.40021461320355145 c 0.3282751133984004
  2%|▏         | 15/1000 [12:48<13:53:45, 50.79s/it]Epoch 15 Valid AUC:(0.793129724882459, 0.0)
Epoch 15 Test AUC:(0.7250386746291624, 0.0)
Epoch 15 a 0.35628211324363646 b 0.3840537300891799 c 0.3211417812816574
  2%|▏         | 16/1000 [13:38<13:53:03, 50.80s/it]Epoch 16 Valid AUC:(0.7912266624976318, 0.0)
Epoch 16 Test AUC:(0.727517517529458, 0.0)
Epoch 16 a 0.3545742845631221 b 0.36802015997754256 c 0.3138567306985798
  2%|▏         | 17/1000 [14:30<13:54:19, 50.93s/it]Epoch 17 Valid AUC:(0.7932187519294362, 0.0)
Epoch 17 Test AUC:(0.7332217669328358, 0.0)
Epoch 17 a 0.35250150971489413 b 0.35499767512382874 c 0.3078453604963943
  2%|▏         | 18/1000 [15:21<13:55:52, 51.07s/it]Epoch 18 Valid AUC:(0.796671525214865, 0.0)
Epoch 18 Test AUC:(0.7353389487301414, 0.0)
Epoch 18 a 0.3486819312845917 b 0.34587499751171596 c 0.3019779054991436
  2%|▏         | 19/1000 [16:13<13:58:18, 51.27s/it]Epoch 19 Valid AUC:(0.7971672282122906, 0.0)
Epoch 19 Test AUC:(0.7395656293243732, 0.0)
Epoch 19 a 0.3445223939850537 b 0.3365294442210399 c 0.295936034089123
  2%|▏         | 20/1000 [17:04<13:55:12, 51.14s/it]Epoch 20 Valid AUC:(0.796951055737283, 0.0)
Epoch 20 Test AUC:(0.7418183089781153, 0.0)
Epoch 20 a 0.340478230590072 b 0.3296777212643767 c 0.2910576236379938
  2%|▏         | 21/1000 [17:56<13:59:09, 51.43s/it]Epoch 21 Valid AUC:(0.8012155840603872, 0.0)
Epoch 21 Test AUC:(0.7460653407586604, 0.0)
Epoch 21 a 0.3367145518421887 b 0.3238283880879462 c 0.28548273926889395
  2%|▏         | 22/1000 [18:47<13:57:14, 51.36s/it]Epoch 22 Valid AUC:(0.7988326732486891, 0.0)
Epoch 22 Test AUC:(0.7456957786068663, 0.0)
Epoch 22 a 0.33396274696893136 b 0.3189746654129604 c 0.28004537426849724
  2%|▏         | 23/1000 [19:38<13:55:16, 51.30s/it]Epoch 23 Valid AUC:(0.7995739458708583, 0.0)
Epoch 23 Test AUC:(0.745295475902637, 0.0)
Epoch 23 a 0.33198934853436723 b 0.31489263783758076 c 0.27533043156447307
  2%|▏         | 24/1000 [20:30<13:55:54, 51.39s/it]Epoch 24 Valid AUC:(0.7992523265963921, 0.0)
Epoch 24 Test AUC:(0.7470303974339993, 0.0)
Epoch 24 a 0.33061021182618633 b 0.31065995232679955 c 0.2713303944354566
  2%|▎         | 25/1000 [21:21<13:53:23, 51.29s/it]Epoch 25 Valid AUC:(0.8017301033867178, 0.0)
Epoch 25 Test AUC:(0.7499119672239527, 0.0)
Epoch 25 a 0.32923631564952 b 0.3052614819955538 c 0.26681022079178024
  3%|▎         | 26/1000 [22:12<13:52:08, 51.26s/it]Epoch 26 Valid AUC:(0.799209681633559, 0.0)
Epoch 26 Test AUC:(0.7492729998301488, 0.0)
Epoch 26 a 0.32870283806827705 b 0.3009960188472295 c 0.2624808833512742
  3%|▎         | 27/1000 [23:04<13:53:48, 51.42s/it]Epoch 27 Valid AUC:(0.8000183570064504, 0.0)
Epoch 27 Test AUC:(0.7481660321094091, 0.0)
Epoch 27 a 0.32772391932591105 b 0.29617709895854505 c 0.25771175807630514
  3%|▎         | 28/1000 [23:55<13:50:59, 51.30s/it]Epoch 28 Valid AUC:(0.7988552689914302, 0.0)
Epoch 28 Test AUC:(0.7478479892422945, 0.0)
Epoch 28 a 0.32750293774384126 b 0.2933400573445038 c 0.25577805147804245
  3%|▎         | 29/1000 [24:46<13:48:09, 51.17s/it]Epoch 29 Valid AUC:(0.8018215257285269, 0.0)
Epoch 29 Test AUC:(0.7486963344294029, 0.0)
Epoch 29 a 0.3270072204846012 b 0.2897172506366457 c 0.2517490587244091
  3%|▎         | 30/1000 [25:36<13:43:48, 50.96s/it]Epoch 30 Valid AUC:(0.8029228166747913, 0.0)
Epoch 30 Test AUC:(0.7478998847673931, 0.0)
Epoch 30 a 0.32633410019414044 b 0.28600672684924705 c 0.2483891380624752
  3%|▎         | 31/1000 [26:28<13:47:02, 51.21s/it]Epoch 31 Valid AUC:(0.8040512145664765, 0.0)
Epoch 31 Test AUC:(0.7499186754196093, 0.0)
Epoch 31 a 0.325755140251317 b 0.28200506876172193 c 0.24449981023488151
  3%|▎         | 32/1000 [27:19<13:43:55, 51.07s/it]Epoch 32 Valid AUC:(0.8011597874038322, 0.0)
Epoch 32 Test AUC:(0.7464464038959969, 0.0)
Epoch 32 a 0.32540060528806997 b 0.2787569183818771 c 0.2418868935084199
  3%|▎         | 33/1000 [28:09<13:42:08, 51.01s/it]Epoch 33 Valid AUC:(0.8015519608629381, 0.0)
Epoch 33 Test AUC:(0.7501571177852998, 0.0)
Epoch 33 a 0.3253300167785084 b 0.27664074931346194 c 0.23988687965111954
  3%|▎         | 34/1000 [29:01<13:44:26, 51.21s/it]Epoch 34 Valid AUC:(0.7997553974643309, 0.0)
Epoch 34 Test AUC:(0.7479655387205497, 0.0)
Epoch 34 a 0.3256283644699235 b 0.2735521306754118 c 0.23734571018689116
  4%|▎         | 35/1000 [29:53<13:46:10, 51.37s/it]Epoch 35 Valid AUC:(0.8034398094730458, 0.0)
Epoch 35 Test AUC:(0.7543407402288258, 0.0)
Epoch 35 a 0.3244230885141092 b 0.27140855990065416 c 0.2352893697004203
  4%|▎         | 36/1000 [30:44<13:46:08, 51.42s/it]Epoch 36 Valid AUC:(0.8015508369070432, 0.0)
Epoch 36 Test AUC:(0.7518728125761472, 0.0)
Epoch 36 a 0.3241401097664171 b 0.26905720364639696 c 0.23290754986600856
  4%|▎         | 37/1000 [31:36<13:47:30, 51.56s/it]  4%|▎         | 37/1000 [32:27<14:05:00, 52.65s/it]
[32m[I 2021-05-13 19:58:50,006][0m Trial 35 finished with value: 0.8040512145664765 and parameters: {'rank': 25.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.14231267877168294, 'gamma': 0.002086753274473231}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 19:58:50.682218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7753129054763807, 0.0)
Epoch 0 Test AUC:(0.7176795873227484, 0.0)
Epoch 0 a 0.4191553464957646 b 0.4912767216593207 c 0.4182135108371136
  0%|          | 1/1000 [00:51<14:12:59, 51.23s/it]Epoch 1 Valid AUC:(0.773233492232929, 0.0)
Epoch 1 Test AUC:(0.7196492486720392, 0.0)
Epoch 1 a 0.3867094788992669 b 0.4861953097809728 c 0.3863797645333787
  0%|          | 2/1000 [01:43<14:18:23, 51.61s/it]Epoch 2 Valid AUC:(0.7751966868989322, 0.0)
Epoch 2 Test AUC:(0.7230354680261293, 0.0)
Epoch 2 a 0.38217421778490845 b 0.47987847075136136 c 0.38052231972845985
  0%|          | 3/1000 [02:34<14:12:33, 51.31s/it]Epoch 3 Valid AUC:(0.780776766508536, 0.0)
Epoch 3 Test AUC:(0.7231307979423531, 0.0)
Epoch 3 a 0.377045555313828 b 0.46770304237572957 c 0.3739428845809499
  0%|          | 4/1000 [03:25<14:12:52, 51.38s/it]Epoch 4 Valid AUC:(0.7853247931618698, 0.0)
Epoch 4 Test AUC:(0.7242246229011754, 0.0)
Epoch 4 a 0.37271090004765534 b 0.4635686618941171 c 0.3674819205008762
  0%|          | 5/1000 [04:16<14:07:28, 51.10s/it]Epoch 5 Valid AUC:(0.7793842159128861, 0.0)
Epoch 5 Test AUC:(0.7196678383691169, 0.0)
Epoch 5 a 0.3694077267853067 b 0.47166728859456253 c 0.3617648502110955
  1%|          | 6/1000 [05:08<14:13:07, 51.50s/it]Epoch 6 Valid AUC:(0.7869977508886403, 0.0)
Epoch 6 Test AUC:(0.7201563224216044, 0.0)
Epoch 6 a 0.3669732671748225 b 0.47107088313975803 c 0.35666112077068274
  1%|          | 7/1000 [05:58<14:03:44, 50.98s/it]Epoch 7 Valid AUC:(0.7852248930911607, 0.0)
Epoch 7 Test AUC:(0.7211267234210803, 0.0)
Epoch 7 a 0.36478875982209713 b 0.46581990594115535 c 0.35116956135636607
  1%|          | 8/1000 [06:49<14:06:23, 51.19s/it]Epoch 8 Valid AUC:(0.7911029440457282, 0.0)
Epoch 8 Test AUC:(0.7234876149499455, 0.0)
Epoch 8 a 0.36280170394861 b 0.46192959934413075 c 0.34594222495493515
  1%|          | 9/1000 [07:40<14:04:23, 51.12s/it]Epoch 9 Valid AUC:(0.7883879651426751, 0.0)
Epoch 9 Test AUC:(0.7194433040725601, 0.0)
Epoch 9 a 0.3611031234024516 b 0.45020216973254856 c 0.34006533080663237
  1%|          | 10/1000 [08:32<14:06:25, 51.30s/it]Epoch 10 Valid AUC:(0.7903944571016717, 0.0)
Epoch 10 Test AUC:(0.7193175029578376, 0.0)
Epoch 10 a 0.35860636716397476 b 0.4325303269224148 c 0.33337726271608226
  1%|          | 11/1000 [09:23<14:05:34, 51.30s/it]Epoch 11 Valid AUC:(0.7911900333260997, 0.0)
Epoch 11 Test AUC:(0.7271278307906942, 0.0)
Epoch 11 a 0.3565387220929566 b 0.4149501136011281 c 0.3274680476793101
  1%|          | 12/1000 [10:15<14:04:18, 51.27s/it]Epoch 12 Valid AUC:(0.7948623701780959, 0.0)
Epoch 12 Test AUC:(0.7298237344846735, 0.0)
Epoch 12 a 0.35225082810975655 b 0.4007931754622661 c 0.3220612403132786
  1%|▏         | 13/1000 [11:06<14:06:04, 51.43s/it]Epoch 13 Valid AUC:(0.797103621536096, 0.0)
Epoch 13 Test AUC:(0.7357157492345463, 0.0)
Epoch 13 a 0.34656312875824435 b 0.38293201834623003 c 0.3151618741167863
  1%|▏         | 14/1000 [11:58<14:04:24, 51.38s/it]Epoch 14 Valid AUC:(0.7965355073277003, 0.0)
Epoch 14 Test AUC:(0.7389609425633129, 0.0)
Epoch 14 a 0.34122910639889525 b 0.3725521638239893 c 0.30893736292178964
  2%|▏         | 15/1000 [12:49<14:02:12, 51.30s/it]Epoch 15 Valid AUC:(0.7983307993873705, 0.0)
Epoch 15 Test AUC:(0.7387712489846693, 0.0)
Epoch 15 a 0.3366724267092269 b 0.36004066701146437 c 0.3018819581215051
  2%|▏         | 16/1000 [13:40<14:00:43, 51.26s/it]Epoch 16 Valid AUC:(0.7970433072689029, 0.0)
Epoch 16 Test AUC:(0.7428413366062316, 0.0)
Epoch 16 a 0.332793576136921 b 0.3489489859978198 c 0.2957461832814533
  2%|▏         | 17/1000 [14:31<13:58:55, 51.21s/it]Epoch 17 Valid AUC:(0.7979639309557969, 0.0)
Epoch 17 Test AUC:(0.7449446317116999, 0.0)
Epoch 17 a 0.33022508396948846 b 0.33906407687265866 c 0.2910430946460432
  2%|▏         | 18/1000 [15:22<13:57:59, 51.20s/it]Epoch 18 Valid AUC:(0.8023478613300588, 0.0)
Epoch 18 Test AUC:(0.7451929845920698, 0.0)
Epoch 18 a 0.32742171388276864 b 0.33214564966244 c 0.28604130491884183
  2%|▏         | 19/1000 [16:14<13:57:18, 51.21s/it]Epoch 19 Valid AUC:(0.8015837776577479, 0.0)
Epoch 19 Test AUC:(0.7449289707042492, 0.0)
Epoch 19 a 0.3255453890478107 b 0.32532107734104515 c 0.28146107791655023
  2%|▏         | 20/1000 [17:04<13:54:45, 51.11s/it]Epoch 20 Valid AUC:(0.7973889064051143, 0.0)
Epoch 20 Test AUC:(0.745641954849619, 0.0)
Epoch 20 a 0.3241676088549961 b 0.31838261229651316 c 0.27752169510968017
  2%|▏         | 21/1000 [17:56<13:54:12, 51.13s/it]Epoch 21 Valid AUC:(0.8048950901361877, 0.0)
Epoch 21 Test AUC:(0.749539245507729, 0.0)
Epoch 21 a 0.3216923796674855 b 0.3131939702830324 c 0.27279055064592805
  2%|▏         | 22/1000 [18:47<13:54:34, 51.20s/it]Epoch 22 Valid AUC:(0.7999626141767456, 0.0)
Epoch 22 Test AUC:(0.7458247991424489, 0.0)
Epoch 22 a 0.3199029381965967 b 0.30765193832712157 c 0.2678427986156053
  2%|▏         | 23/1000 [19:37<13:50:14, 50.99s/it]Epoch 23 Valid AUC:(0.8013806658834536, 0.0)
Epoch 23 Test AUC:(0.7489764839006575, 0.0)
Epoch 23 a 0.3186655417534427 b 0.3035167079096589 c 0.26386908269384257
  2%|▏         | 24/1000 [20:28<13:49:12, 50.98s/it]Epoch 24 Valid AUC:(0.8023891055131962, 0.0)
Epoch 24 Test AUC:(0.7478361333936293, 0.0)
Epoch 24 a 0.31765847396802616 b 0.2990697388437912 c 0.26017200506069293
  2%|▎         | 25/1000 [21:20<13:49:21, 51.04s/it]Epoch 25 Valid AUC:(0.8021900986770222, 0.0)
Epoch 25 Test AUC:(0.7482128954189005, 0.0)
Epoch 25 a 0.31623434852546367 b 0.2947827609372091 c 0.2558094354822362
  3%|▎         | 26/1000 [22:11<13:49:25, 51.09s/it]Epoch 26 Valid AUC:(0.7995378152384859, 0.0)
Epoch 26 Test AUC:(0.7494190409692425, 0.0)
Epoch 26 a 0.315191505180758 b 0.291414249770838 c 0.2524715385866357
  3%|▎         | 27/1000 [23:02<13:50:29, 51.21s/it]  3%|▎         | 27/1000 [23:53<14:21:13, 53.11s/it]
[32m[I 2021-05-13 20:23:03,786][0m Trial 36 finished with value: 0.8048950901361877 and parameters: {'rank': 10.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.1273765562569885, 'gamma': 0.00159287265275085}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 20:23:04.553383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7537346875683537, 0.0)
Epoch 0 Test AUC:(0.7064867084798891, 0.0)
Epoch 0 a 0.4196093617310706 b 0.485091289464137 c 0.42579540058640647
  0%|          | 1/1000 [00:51<14:18:30, 51.56s/it]Epoch 1 Valid AUC:(0.7529686456239704, 0.0)
Epoch 1 Test AUC:(0.7069697028426234, 0.0)
Epoch 1 a 0.3997842269524242 b 0.4363116174636472 c 0.3968547020759621
  0%|          | 2/1000 [01:42<14:14:37, 51.38s/it]Epoch 2 Valid AUC:(0.7483071724759713, 0.0)
Epoch 2 Test AUC:(0.7070080708144667, 0.0)
Epoch 2 a 0.39811996015264717 b 0.4013440977759524 c 0.38464400382109093
  0%|          | 3/1000 [02:33<14:12:09, 51.28s/it]Epoch 3 Valid AUC:(0.7566512288013716, 0.0)
Epoch 3 Test AUC:(0.707753261994815, 0.0)
Epoch 3 a 0.39737171702221846 b 0.3861167632358175 c 0.3771297516117633
  0%|          | 4/1000 [03:25<14:12:16, 51.34s/it]Epoch 4 Valid AUC:(0.7548375523091893, 0.0)
Epoch 4 Test AUC:(0.7084371901187175, 0.0)
Epoch 4 a 0.39733443077901 b 0.3789449424690884 c 0.373489742487729
  0%|          | 5/1000 [04:16<14:09:02, 51.20s/it]Epoch 5 Valid AUC:(0.7562786816371064, 0.0)
Epoch 5 Test AUC:(0.7022147507715697, 0.0)
Epoch 5 a 0.3970763866810252 b 0.3741546932840251 c 0.3694268392485152
  1%|          | 6/1000 [05:08<14:10:54, 51.36s/it]Epoch 6 Valid AUC:(0.7605460679096356, 0.0)
Epoch 6 Test AUC:(0.7092037671465318, 0.0)
Epoch 6 a 0.39691968157257834 b 0.370321151896022 c 0.36680499246902387
  1%|          | 7/1000 [05:59<14:10:51, 51.41s/it]Epoch 7 Valid AUC:(0.7626967068917623, 0.0)
Epoch 7 Test AUC:(0.7102688994979282, 0.0)
Epoch 7 a 0.39696224864339924 b 0.3674299156881674 c 0.36481143333302657
  1%|          | 8/1000 [06:51<14:13:18, 51.61s/it]Epoch 8 Valid AUC:(0.7552779712867281, 0.0)
Epoch 8 Test AUC:(0.7090611763031008, 0.0)
Epoch 8 a 0.3965869361246136 b 0.3653736790900739 c 0.3633769098781724
  1%|          | 9/1000 [07:42<14:11:03, 51.53s/it]Epoch 9 Valid AUC:(0.7468276466616085, 0.0)
Epoch 9 Test AUC:(0.6972566759041813, 0.0)
Epoch 9 a 0.39704842412735614 b 0.3637503363956628 c 0.3617819053546284
  1%|          | 10/1000 [08:34<14:08:51, 51.45s/it]Epoch 10 Valid AUC:(0.7624076502984581, 0.0)
Epoch 10 Test AUC:(0.7076631267616522, 0.0)
Epoch 10 a 0.3968072174420539 b 0.36133003684596515 c 0.35980844899442355
  1%|          | 11/1000 [09:24<14:04:36, 51.24s/it]Epoch 11 Valid AUC:(0.7593802911152909, 0.0)
Epoch 11 Test AUC:(0.705297579257599, 0.0)
Epoch 11 a 0.39628291369923646 b 0.3599851840818432 c 0.35903124298368183
  1%|          | 12/1000 [10:15<14:02:31, 51.17s/it]Epoch 12 Valid AUC:(0.7466335470399406, 0.0)
Epoch 12 Test AUC:(0.7054377202628455, 0.0)
Epoch 12 a 0.39737242706105025 b 0.3587313868869958 c 0.35766413154256654
  1%|▏         | 13/1000 [11:07<14:01:29, 51.15s/it]  1%|▏         | 13/1000 [11:58<15:08:58, 55.26s/it]
[32m[I 2021-05-13 20:35:22,566][0m Trial 37 finished with value: 0.7626967068917623 and parameters: {'rank': 30.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.05, 'alpha': 0.10027663560026294, 'gamma': 0.001154197645436735}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 20:35:23.260019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7844797372462302, 0.0)
Epoch 0 Test AUC:(0.724282277469964, 0.0)
Epoch 0 a 0.4135844482885287 b 0.5140199042733079 c 0.41242360267104544
  0%|          | 1/1000 [02:59<49:40:29, 179.01s/it]Epoch 1 Valid AUC:(0.7876657074961199, 0.0)
Epoch 1 Test AUC:(0.7263192559260827, 0.0)
Epoch 1 a 0.37436463365068146 b 0.5119893027496674 c 0.37478210684520746
  0%|          | 2/1000 [05:57<49:35:35, 178.89s/it]Epoch 2 Valid AUC:(0.7818710394588132, 0.0)
Epoch 2 Test AUC:(0.7264249752084285, 0.0)
Epoch 2 a 0.3709366226567882 b 0.5085534607872644 c 0.37151099613349364
  0%|          | 3/1000 [08:55<49:26:53, 178.55s/it]Epoch 3 Valid AUC:(0.7870474176922356, 0.0)
Epoch 3 Test AUC:(0.7264517566855432, 0.0)
Epoch 3 a 0.3695373536654607 b 0.505151301682325 c 0.370138403996563
  0%|          | 4/1000 [11:53<49:18:21, 178.21s/it]Epoch 4 Valid AUC:(0.7880752990676185, 0.0)
Epoch 4 Test AUC:(0.7285573904672538, 0.0)
Epoch 4 a 0.3688545210568853 b 0.5028644067939051 c 0.36948132625832036
  0%|          | 5/1000 [14:50<49:09:03, 177.83s/it]Epoch 5 Valid AUC:(0.7865685714700511, 0.0)
Epoch 5 Test AUC:(0.7265678952622263, 0.0)
Epoch 5 a 0.3680966995570335 b 0.5018112488491803 c 0.3687450108574886
  1%|          | 6/1000 [17:48<49:06:50, 177.88s/it]Epoch 6 Valid AUC:(0.7888591410387122, 0.0)
Epoch 6 Test AUC:(0.7273791123606911, 0.0)
Epoch 6 a 0.3670860107607911 b 0.5011872719615593 c 0.3678021147629914
  1%|          | 7/1000 [20:46<49:03:24, 177.85s/it]Epoch 7 Valid AUC:(0.7938861933370643, 0.0)
Epoch 7 Test AUC:(0.7289670222236964, 0.0)
Epoch 7 a 0.36643546076501776 b 0.5019256850922749 c 0.36717302091101295
  1%|          | 8/1000 [23:43<48:57:40, 177.68s/it]Epoch 8 Valid AUC:(0.7908220306858978, 0.0)
Epoch 8 Test AUC:(0.7286735803494486, 0.0)
Epoch 8 a 0.3653679331713073 b 0.5020162254017523 c 0.36612045940230875
  1%|          | 9/1000 [26:42<48:58:28, 177.91s/it]Epoch 9 Valid AUC:(0.7863004919692083, 0.0)
Epoch 9 Test AUC:(0.7276060879445134, 0.0)
Epoch 9 a 0.3648887045902484 b 0.5035090248689033 c 0.36575590922881634
  1%|          | 10/1000 [29:39<48:54:01, 177.82s/it]Epoch 10 Valid AUC:(0.7927929892342404, 0.0)
Epoch 10 Test AUC:(0.7293053948998277, 0.0)
Epoch 10 a 0.3634339024997824 b 0.5049291400528242 c 0.36436772243109944
  1%|          | 11/1000 [32:37<48:47:33, 177.61s/it]Epoch 11 Valid AUC:(0.7941519223987836, 0.0)
Epoch 11 Test AUC:(0.729286018518237, 0.0)
Epoch 11 a 0.36328292430915565 b 0.5055876460999565 c 0.36419905621002163
  1%|          | 12/1000 [35:35<48:46:39, 177.73s/it]Epoch 12 Valid AUC:(0.7911701084203997, 0.0)
Epoch 12 Test AUC:(0.7290522577804904, 0.0)
Epoch 12 a 0.36310387318490317 b 0.5073016829050744 c 0.3641280273716314
  1%|▏         | 13/1000 [38:33<48:48:47, 178.04s/it]Epoch 13 Valid AUC:(0.7943127711245627, 0.0)
Epoch 13 Test AUC:(0.7296886898269238, 0.0)
Epoch 13 a 0.36256974190848146 b 0.5084135195698314 c 0.36364688887974916
  1%|▏         | 14/1000 [41:30<48:40:48, 177.74s/it]Epoch 14 Valid AUC:(0.7914974359041659, 0.0)
Epoch 14 Test AUC:(0.7286763936016742, 0.0)
Epoch 14 a 0.3621530549468678 b 0.5098609251254405 c 0.3632675248393466
  2%|▏         | 15/1000 [44:29<48:40:33, 177.90s/it]Epoch 15 Valid AUC:(0.7897674960485453, 0.0)
Epoch 15 Test AUC:(0.727774947209942, 0.0)
Epoch 15 a 0.36194834749922794 b 0.5111340264569221 c 0.36309256340583523
  2%|▏         | 16/1000 [47:27<48:39:40, 178.03s/it]Epoch 16 Valid AUC:(0.7873044793494879, 0.0)
Epoch 16 Test AUC:(0.7275056830580893, 0.0)
Epoch 16 a 0.3615527918375935 b 0.5120649061471508 c 0.36271816800742246
  2%|▏         | 17/1000 [50:26<48:43:43, 178.46s/it]Epoch 17 Valid AUC:(0.789546741883316, 0.0)
Epoch 17 Test AUC:(0.7279756244435517, 0.0)
Epoch 17 a 0.3614439956802648 b 0.5138934667293842 c 0.3626263633992218
  2%|▏         | 18/1000 [53:26<48:46:14, 178.79s/it]Epoch 18 Valid AUC:(0.791724159723396, 0.0)
Epoch 18 Test AUC:(0.7272035277977688, 0.0)
Epoch 18 a 0.36111462326011445 b 0.5149415266789522 c 0.36228673259716887
  2%|▏         | 19/1000 [56:26<48:49:44, 179.19s/it]  2%|▏         | 19/1000 [59:25<51:08:36, 187.68s/it]
[32m[I 2021-05-13 21:35:10,108][0m Trial 38 finished with value: 0.7943127711245627 and parameters: {'rank': 45.0, 'lambda': 0.0001, 'batch_size': 128, 'learning_rate': 0.001, 'alpha': 0.1188428569830992, 'gamma': 0.0027844199216446397}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 21:35:10.776192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.49696426048889997, 0.0)
Epoch 0 Test AUC:(0.4908004963414916, 0.0)
Epoch 0 a 0.5114860705310299 b 0.4383620784407662 c 0.43807999393151653
  0%|          | 1/1000 [00:30<8:34:59, 30.93s/it]Epoch 1 Valid AUC:(0.5043907048678317, 0.0)
Epoch 1 Test AUC:(0.498108337992622, 0.0)
Epoch 1 a 0.5014561254891657 b 0.37933006618292103 c 0.37933012831114954
  0%|          | 2/1000 [01:01<8:26:39, 30.46s/it]Epoch 2 Valid AUC:(0.49410578817446865, 0.0)
Epoch 2 Test AUC:(0.49157940379395454, 0.0)
Epoch 2 a 0.5015079149555776 b 0.3714827674050485 c 0.37148276331924623
  0%|          | 3/1000 [01:30<8:21:21, 30.17s/it]Epoch 3 Valid AUC:(0.5036640065061385, 0.0)
Epoch 3 Test AUC:(0.49749369368682983, 0.0)
Epoch 3 a 0.5014204614825787 b 0.3686070606833504 c 0.36860703965348585
  0%|          | 4/1000 [02:01<8:23:40, 30.34s/it]Epoch 4 Valid AUC:(0.5010266395130543, 0.0)
Epoch 4 Test AUC:(0.5036870599106731, 0.0)
Epoch 4 a 0.5014360119258204 b 0.36718676443542203 c 0.3671868334133779
  0%|          | 5/1000 [02:31<8:20:43, 30.19s/it]Epoch 5 Valid AUC:(0.49844940095637086, 0.0)
Epoch 5 Test AUC:(0.49794647337862386, 0.0)
Epoch 5 a 0.5015155396634533 b 0.3664609286333284 c 0.3664609137321672
  1%|          | 6/1000 [03:01<8:20:08, 30.19s/it]Epoch 6 Valid AUC:(0.5011745774843455, 0.0)
Epoch 6 Test AUC:(0.49972294809901513, 0.0)
Epoch 6 a 0.5014181326954595 b 0.364923317586222 c 0.36492336974028616
  1%|          | 7/1000 [03:31<8:18:37, 30.13s/it]  1%|          | 7/1000 [04:01<9:31:45, 34.55s/it]
[32m[I 2021-05-13 21:39:33,123][0m Trial 39 finished with value: 0.5043907048678317 and parameters: {'rank': 20.0, 'lambda': 0.01, 'batch_size': 1024, 'learning_rate': 0.01, 'alpha': 0.14948755680989775, 'gamma': 0.0012680477008157783}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 21:39:33.826702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.49988733655784534, 0.0)
Epoch 0 Test AUC:(0.5024506056292861, 0.0)
Epoch 0 a 0.5537727823661219 b 0.5537720375484035 c 0.5537719440556341
  0%|          | 1/1000 [00:18<5:06:38, 18.42s/it]Epoch 1 Valid AUC:(0.4852254075220573, 0.0)
Epoch 1 Test AUC:(0.49422155641349486, 0.0)
Epoch 1 a 0.5046542582492675 b 0.5046540900103508 c 0.5046540904910334
  0%|          | 2/1000 [00:36<5:06:48, 18.45s/it]Epoch 2 Valid AUC:(0.4851720279473927, 0.0)
Epoch 2 Test AUC:(0.494120326363424, 0.0)
Epoch 2 a 0.503690910435492 b 0.5036907912262024 c 0.5036907890631307
  0%|          | 3/1000 [00:56<5:13:21, 18.86s/it]Epoch 3 Valid AUC:(0.48540856875881827, 0.0)
Epoch 3 Test AUC:(0.49422155641349486, 0.0)
Epoch 3 a 0.5032821372151375 b 0.5032820470871464 c 0.5032820449240746
  0%|          | 4/1000 [01:15<5:16:37, 19.07s/it]Epoch 4 Valid AUC:(0.4848944262204387, 0.0)
Epoch 4 Test AUC:(0.49422177018646035, 0.0)
Epoch 4 a 0.5028887215641237 b 0.5028886554702636 c 0.5028886525861679
  0%|          | 5/1000 [01:35<5:18:31, 19.21s/it]Epoch 5 Valid AUC:(0.4852254075220573, 0.0)
Epoch 5 Test AUC:(0.49422155641349486, 0.0)
Epoch 5 a 0.5028649736796656 b 0.5028649176801404 c 0.50286491575741
  1%|          | 6/1000 [01:54<5:19:19, 19.28s/it]  1%|          | 6/1000 [02:14<6:10:14, 22.35s/it]
[32m[I 2021-05-13 21:42:07,701][0m Trial 40 finished with value: 0.49988733655784534 and parameters: {'rank': 40.0, 'lambda': 1, 'batch_size': 2048, 'learning_rate': 0.01, 'alpha': 0.11170473092220137, 'gamma': 0.0015688737823619369}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 21:42:08.427021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7774378421375571, 0.0)
Epoch 0 Test AUC:(0.7180650328058772, 0.0)
Epoch 0 a 0.4168031616230126 b 0.49254615559904147 c 0.41712876416787775
  0%|          | 1/1000 [00:51<14:18:04, 51.54s/it]Epoch 1 Valid AUC:(0.7730486751797299, 0.0)
Epoch 1 Test AUC:(0.7193151514552173, 0.0)
Epoch 1 a 0.38803893411663215 b 0.48666786236062615 c 0.38817463194580387
  0%|          | 2/1000 [01:42<14:16:24, 51.49s/it]Epoch 2 Valid AUC:(0.772775650016631, 0.0)
Epoch 2 Test AUC:(0.7226353491666504, 0.0)
Epoch 2 a 0.38333105501274706 b 0.47846795027884437 c 0.38224082807420007
  0%|          | 3/1000 [02:33<14:11:39, 51.25s/it]Epoch 3 Valid AUC:(0.7796941034972013, 0.0)
Epoch 3 Test AUC:(0.7239134464217118, 0.0)
Epoch 3 a 0.3786129381814953 b 0.4653860846875419 c 0.3765569066017926
  0%|          | 4/1000 [03:25<14:13:29, 51.42s/it]Epoch 4 Valid AUC:(0.7823925396149726, 0.0)
Epoch 4 Test AUC:(0.7244417264494523, 0.0)
Epoch 4 a 0.3750442213695534 b 0.4556027026003755 c 0.3702987728104505
  0%|          | 5/1000 [04:16<14:09:16, 51.21s/it]Epoch 5 Valid AUC:(0.7780448436820083, 0.0)
Epoch 5 Test AUC:(0.719923835770732, 0.0)
Epoch 5 a 0.37224125442370565 b 0.45021839370909833 c 0.3647649914805798
  1%|          | 6/1000 [05:07<14:10:04, 51.31s/it]Epoch 6 Valid AUC:(0.7861768401600714, 0.0)
Epoch 6 Test AUC:(0.7218042383560185, 0.0)
Epoch 6 a 0.37010532431679233 b 0.4428641762531979 c 0.3595106430216814
  1%|          | 7/1000 [05:59<14:09:05, 51.30s/it]Epoch 7 Valid AUC:(0.7835761702628778, 0.0)
Epoch 7 Test AUC:(0.7229794937128494, 0.0)
Epoch 7 a 0.36822693670539547 b 0.43338355170169346 c 0.35400917766319673
  1%|          | 8/1000 [06:50<14:06:17, 51.19s/it]Epoch 8 Valid AUC:(0.7898257136317657, 0.0)
Epoch 8 Test AUC:(0.7244171083547482, 0.0)
Epoch 8 a 0.36632399281985323 b 0.42455494811597244 c 0.3477144473395357
  1%|          | 9/1000 [07:41<14:06:56, 51.28s/it]Epoch 9 Valid AUC:(0.7890110096516566, 0.0)
Epoch 9 Test AUC:(0.7226057929164438, 0.0)
Epoch 9 a 0.36462465102523867 b 0.4109343103839598 c 0.3407371324792474
  1%|          | 10/1000 [08:32<14:04:00, 51.15s/it]Epoch 10 Valid AUC:(0.7908284373626582, 0.0)
Epoch 10 Test AUC:(0.7216021673226739, 0.0)
Epoch 10 a 0.3613381192717754 b 0.3918898176379367 c 0.3321780602576987
  1%|          | 11/1000 [09:24<14:05:47, 51.31s/it]Epoch 11 Valid AUC:(0.7915897066596609, 0.0)
Epoch 11 Test AUC:(0.72840299080521, 0.0)
Epoch 11 a 0.35785930377376873 b 0.37582696551528255 c 0.32424786992715876
  1%|          | 12/1000 [10:15<14:04:33, 51.29s/it]Epoch 12 Valid AUC:(0.7948149666653905, 0.0)
Epoch 12 Test AUC:(0.7337013238262852, 0.0)
Epoch 12 a 0.3512910387405687 b 0.3600177448880025 c 0.3158956595829555
  1%|▏         | 13/1000 [11:06<14:01:55, 51.18s/it]Epoch 13 Valid AUC:(0.7969384064274959, 0.0)
Epoch 13 Test AUC:(0.7384920144617069, 0.0)
Epoch 13 a 0.3442582052718226 b 0.3478217486524486 c 0.30752425744260103
  1%|▏         | 14/1000 [11:56<13:55:29, 50.84s/it]Epoch 14 Valid AUC:(0.7978938253282418, 0.0)
Epoch 14 Test AUC:(0.7422413870540863, 0.0)
Epoch 14 a 0.3385103140438586 b 0.34005980034709216 c 0.3014413279067103
  2%|▏         | 15/1000 [12:48<14:02:18, 51.31s/it]Epoch 15 Valid AUC:(0.7997848586936505, 0.0)
Epoch 15 Test AUC:(0.7417764308541788, 0.0)
Epoch 15 a 0.3345709236215058 b 0.3323155964164427 c 0.29391093866925844
  2%|▏         | 16/1000 [13:39<14:00:27, 51.25s/it]Epoch 16 Valid AUC:(0.79874015386441, 0.0)
Epoch 16 Test AUC:(0.7451090573258244, 0.0)
Epoch 16 a 0.33180283474730293 b 0.3242925025927469 c 0.2870194952132956
  2%|▏         | 17/1000 [14:31<14:01:20, 51.35s/it]Epoch 17 Valid AUC:(0.7995330284935969, 0.0)
Epoch 17 Test AUC:(0.7478870883176798, 0.0)
Epoch 17 a 0.32989695176512185 b 0.318237108124094 c 0.28175568247824845
  2%|▏         | 18/1000 [15:22<14:00:45, 51.37s/it]Epoch 18 Valid AUC:(0.8032338500020598, 0.0)
Epoch 18 Test AUC:(0.7476034329697915, 0.0)
Epoch 18 a 0.328144043444148 b 0.31177836020947464 c 0.2754617901275335
  2%|▏         | 19/1000 [16:14<14:00:00, 51.38s/it]Epoch 19 Valid AUC:(0.8024228869880367, 0.0)
Epoch 19 Test AUC:(0.7476350328895479, 0.0)
Epoch 19 a 0.32722353275632954 b 0.3054698181584088 c 0.27006158520518175
  2%|▏         | 20/1000 [17:05<13:57:06, 51.25s/it]Epoch 20 Valid AUC:(0.7995303896963475, 0.0)
Epoch 20 Test AUC:(0.748017913097091, 0.0)
Epoch 20 a 0.3266255601311114 b 0.2997681881700243 c 0.26533360767292546
  2%|▏         | 21/1000 [17:56<13:53:35, 51.09s/it]Epoch 21 Valid AUC:(0.8053980354081428, 0.0)
Epoch 21 Test AUC:(0.7513175971547571, 0.0)
Epoch 21 a 0.32516220967534565 b 0.29437290449857234 c 0.2604613956851019
  2%|▏         | 22/1000 [18:47<13:53:02, 51.11s/it]Epoch 22 Valid AUC:(0.8010707590752634, 0.0)
Epoch 22 Test AUC:(0.7476201029856392, 0.0)
Epoch 22 a 0.32400381679026413 b 0.2893187080170787 c 0.25594411262683947
  2%|▏         | 23/1000 [19:37<13:50:02, 50.97s/it]Epoch 23 Valid AUC:(0.8025102120812756, 0.0)
Epoch 23 Test AUC:(0.7485756510394739, 0.0)
Epoch 23 a 0.32346382023583 b 0.28510110266131894 c 0.25198585511573124
  2%|▏         | 24/1000 [20:29<13:51:24, 51.11s/it]Epoch 24 Valid AUC:(0.8034663973738403, 0.0)
Epoch 24 Test AUC:(0.748580392523848, 0.0)
Epoch 24 a 0.3230107599340934 b 0.28033967148250255 c 0.24800856720273884
  2%|▎         | 25/1000 [21:20<13:49:08, 51.02s/it]Epoch 25 Valid AUC:(0.8036725785601853, 0.0)
Epoch 25 Test AUC:(0.7503793860884225, 0.0)
Epoch 25 a 0.3212066626164995 b 0.2771562464400316 c 0.24490738769532208
  3%|▎         | 26/1000 [22:11<13:51:25, 51.22s/it]Epoch 26 Valid AUC:(0.7999436684070819, 0.0)
Epoch 26 Test AUC:(0.7516804895900283, 0.0)
Epoch 26 a 0.3199465936218469 b 0.2739223667853315 c 0.24182016610859386
  3%|▎         | 27/1000 [23:02<13:50:07, 51.19s/it]  3%|▎         | 27/1000 [23:54<14:21:28, 53.12s/it]
[32m[I 2021-05-13 22:06:22,596][0m Trial 41 finished with value: 0.8053980354081428 and parameters: {'rank': 15.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.13192114203462038, 'gamma': 0.0010029970702125392}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 22:06:23.441534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7754208872641632, 0.0)
Epoch 0 Test AUC:(0.7177319788011269, 0.0)
Epoch 0 a 0.4191673336854163 b 0.4904906938013656 c 0.41822223536205483
  0%|          | 1/1000 [00:49<13:45:39, 49.59s/it]Epoch 1 Valid AUC:(0.7731149693536572, 0.0)
Epoch 1 Test AUC:(0.7196202567824614, 0.0)
Epoch 1 a 0.3867942563125065 b 0.4844396189904549 c 0.38644522722338287
  0%|          | 2/1000 [01:40<13:57:47, 50.37s/it]Epoch 2 Valid AUC:(0.7751338017588482, 0.0)
Epoch 2 Test AUC:(0.7228657365670017, 0.0)
Epoch 2 a 0.38224687260881035 b 0.47510021091466936 c 0.3805234795005269
  0%|          | 3/1000 [02:31<14:00:29, 50.58s/it]Epoch 3 Valid AUC:(0.7809094138096075, 0.0)
Epoch 3 Test AUC:(0.723515319926271, 0.0)
Epoch 3 a 0.37712642508493344 b 0.4602931861426509 c 0.3738598548310623
  0%|          | 4/1000 [03:22<14:04:35, 50.88s/it]Epoch 4 Valid AUC:(0.7855897904347452, 0.0)
Epoch 4 Test AUC:(0.7241132984916748, 0.0)
Epoch 4 a 0.3727851309766712 b 0.45803895874522343 c 0.36733182293308575
  0%|          | 5/1000 [04:13<14:05:19, 50.97s/it]Epoch 5 Valid AUC:(0.7797761317720663, 0.0)
Epoch 5 Test AUC:(0.7202082307730809, 0.0)
Epoch 5 a 0.3693978694722926 b 0.46400409259306835 c 0.36148586887229134
  1%|          | 6/1000 [05:04<14:03:04, 50.89s/it]Epoch 6 Valid AUC:(0.7869883606664712, 0.0)
Epoch 6 Test AUC:(0.7203009740364226, 0.0)
Epoch 6 a 0.3669676070122172 b 0.45614820538871964 c 0.35634751345070315
  1%|          | 7/1000 [05:55<14:03:27, 50.96s/it]Epoch 7 Valid AUC:(0.7850731833955835, 0.0)
Epoch 7 Test AUC:(0.7216191494470512, 0.0)
Epoch 7 a 0.36488968265848143 b 0.44757390831797655 c 0.3509859659182474
  1%|          | 8/1000 [06:46<14:02:46, 50.97s/it]Epoch 8 Valid AUC:(0.7915678106659718, 0.0)
Epoch 8 Test AUC:(0.7238738385666686, 0.0)
Epoch 8 a 0.36280503395337693 b 0.4411314141822293 c 0.34571461286583177
  1%|          | 9/1000 [07:37<14:01:49, 50.97s/it]Epoch 9 Valid AUC:(0.7884490368305455, 0.0)
Epoch 9 Test AUC:(0.7211760964251863, 0.0)
Epoch 9 a 0.3609244483457485 b 0.42711904878827406 c 0.3396360864581716
  1%|          | 10/1000 [08:28<14:01:54, 51.02s/it]Epoch 10 Valid AUC:(0.7903464268906394, 0.0)
Epoch 10 Test AUC:(0.7221265951615764, 0.0)
Epoch 10 a 0.35785916681500746 b 0.4090080778123867 c 0.332648851562074
  1%|          | 11/1000 [09:19<14:00:13, 50.97s/it]Epoch 11 Valid AUC:(0.792263743138025, 0.0)
Epoch 11 Test AUC:(0.7303446436205643, 0.0)
Epoch 11 a 0.35450386743190543 b 0.39138220055722134 c 0.3265151532602982
  1%|          | 12/1000 [10:10<14:01:18, 51.09s/it]Epoch 12 Valid AUC:(0.7961938426779172, 0.0)
Epoch 12 Test AUC:(0.7332018945979653, 0.0)
Epoch 12 a 0.34906405936064616 b 0.37651128938020595 c 0.3205527340622255
  1%|▏         | 13/1000 [11:01<14:00:03, 51.07s/it]Epoch 13 Valid AUC:(0.79823210273124, 0.0)
Epoch 13 Test AUC:(0.7374067275951257, 0.0)
Epoch 13 a 0.34320044505524205 b 0.362140649940886 c 0.31363513322183545
  1%|▏         | 14/1000 [11:52<13:58:06, 51.00s/it]Epoch 14 Valid AUC:(0.7981968820289536, 0.0)
Epoch 14 Test AUC:(0.7405615975705199, 0.0)
Epoch 14 a 0.3381125495827174 b 0.3525770421119283 c 0.3071244411785118
  2%|▏         | 15/1000 [12:44<13:59:06, 51.11s/it]Epoch 15 Valid AUC:(0.7993164228406047, 0.0)
Epoch 15 Test AUC:(0.7410005504269069, 0.0)
Epoch 15 a 0.3342378616213079 b 0.3430671507204083 c 0.30063749792830086
  2%|▏         | 16/1000 [13:35<13:58:11, 51.11s/it]Epoch 16 Valid AUC:(0.7976388167808456, 0.0)
Epoch 16 Test AUC:(0.7435068845305626, 0.0)
Epoch 16 a 0.331022311624147 b 0.3338808634391493 c 0.29380607254188545
  2%|▏         | 17/1000 [14:25<13:51:20, 50.74s/it]Epoch 17 Valid AUC:(0.7990580462702986, 0.0)
Epoch 17 Test AUC:(0.7453166265998411, 0.0)
Epoch 17 a 0.32885383600200446 b 0.3260077307041982 c 0.28849572428994974
  2%|▏         | 18/1000 [15:15<13:49:28, 50.68s/it]Epoch 18 Valid AUC:(0.8031727193609726, 0.0)
Epoch 18 Test AUC:(0.7467092634098039, 0.0)
Epoch 18 a 0.32648596023649756 b 0.32000790635344967 c 0.283117446471268
  2%|▏         | 19/1000 [16:07<13:52:12, 50.90s/it]Epoch 19 Valid AUC:(0.8008874286684019, 0.0)
Epoch 19 Test AUC:(0.7458366336138176, 0.0)
Epoch 19 a 0.32483505537092566 b 0.31375968312353675 c 0.27863196842747195
  2%|▏         | 20/1000 [16:58<13:53:23, 51.02s/it]Epoch 20 Valid AUC:(0.7978574101825185, 0.0)
Epoch 20 Test AUC:(0.7469440887369185, 0.0)
Epoch 20 a 0.3236699507270061 b 0.3081019299490831 c 0.27446203884224535
  2%|▏         | 21/1000 [17:50<13:55:41, 51.22s/it]2021-05-13 22:25:14.422431: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 65736426 get requests, put_count=65736426 evicted_count=35000 eviction_rate=0.000532429 and unsatisfied allocation rate=0.000532627
Epoch 21 Valid AUC:(0.8053386208183022, 0.0)
Epoch 21 Test AUC:(0.7507765335036813, 0.0)
Epoch 21 a 0.3212930884519573 b 0.303775552472838 c 0.27022121378953307
  2%|▏         | 22/1000 [18:41<13:56:18, 51.31s/it]Epoch 22 Valid AUC:(0.8003705127656475, 0.0)
Epoch 22 Test AUC:(0.7463329118286264, 0.0)
Epoch 22 a 0.3194622553330312 b 0.30002377876333547 c 0.26594070079820736
  2%|▏         | 23/1000 [19:32<13:54:51, 51.27s/it]Epoch 23 Valid AUC:(0.8014505882433998, 0.0)
Epoch 23 Test AUC:(0.7503387777759009, 0.0)
Epoch 23 a 0.31824046996997396 b 0.29588545912828 c 0.26227218947060393
  2%|▏         | 24/1000 [20:23<13:52:46, 51.20s/it]Epoch 24 Valid AUC:(0.8020037975406686, 0.0)
Epoch 24 Test AUC:(0.7483098414587432, 0.0)
Epoch 24 a 0.3171431721456094 b 0.2924623342467026 c 0.258790769837272
  2%|▎         | 25/1000 [21:14<13:49:31, 51.05s/it]Epoch 25 Valid AUC:(0.8024156165184904, 0.0)
Epoch 25 Test AUC:(0.750413542732846, 0.0)
Epoch 25 a 0.3158083597059461 b 0.2897173372552668 c 0.2557630459487558
  3%|▎         | 26/1000 [22:05<13:47:29, 50.98s/it]Epoch 26 Valid AUC:(0.7992487407028983, 0.0)
Epoch 26 Test AUC:(0.7499189447735458, 0.0)
Epoch 26 a 0.3149316506966259 b 0.2868042147495377 c 0.2530127785035542
  3%|▎         | 27/1000 [22:56<13:48:30, 51.09s/it]  3%|▎         | 27/1000 [23:48<14:17:47, 52.90s/it]
[32m[I 2021-05-13 22:30:30,953][0m Trial 42 finished with value: 0.8053386208183022 and parameters: {'rank': 10.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.13078365799092495, 'gamma': 0.0010906753234216284}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 22:30:31.665029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7718195569986666, 0.0)
Epoch 0 Test AUC:(0.714844461847274, 0.0)
Epoch 0 a 0.4133101393519273 b 0.49360294157350565 c 0.41642195274172655
  0%|          | 1/1000 [00:51<14:24:08, 51.90s/it]Epoch 1 Valid AUC:(0.7768779313974437, 0.0)
Epoch 1 Test AUC:(0.7228577756617675, 0.0)
Epoch 1 a 0.3875947986210376 b 0.48841521749554023 c 0.3917831747344802
  0%|          | 2/1000 [01:44<14:26:26, 52.09s/it]Epoch 2 Valid AUC:(0.7831824947783341, 0.0)
Epoch 2 Test AUC:(0.7261490498909717, 0.0)
Epoch 2 a 0.377974505875432 b 0.4911652322506281 c 0.38324207930977433
  0%|          | 3/1000 [02:36<14:24:25, 52.02s/it]Epoch 3 Valid AUC:(0.7847508374586403, 0.0)
Epoch 3 Test AUC:(0.7263602704072386, 0.0)
Epoch 3 a 0.3732149526027127 b 0.48402265457799976 c 0.37766938280291723
  0%|          | 4/1000 [03:27<14:22:46, 51.97s/it]Epoch 4 Valid AUC:(0.787067041423893, 0.0)
Epoch 4 Test AUC:(0.7272221003930092, 0.0)
Epoch 4 a 0.37058518482166036 b 0.47723934246260874 c 0.37336633185025914
  0%|          | 5/1000 [04:20<14:22:42, 52.02s/it]Epoch 5 Valid AUC:(0.7867183126408226, 0.0)
Epoch 5 Test AUC:(0.7241732532575719, 0.0)
Epoch 5 a 0.36795040551325686 b 0.4671576887788907 c 0.368905823295505
  1%|          | 6/1000 [05:12<14:23:35, 52.13s/it]Epoch 6 Valid AUC:(0.7879213209547845, 0.0)
Epoch 6 Test AUC:(0.7239011074461447, 0.0)
Epoch 6 a 0.36572975435966937 b 0.4551058205920206 c 0.36480889947601486
  1%|          | 7/1000 [06:04<14:23:30, 52.18s/it]Epoch 7 Valid AUC:(0.7873401909013841, 0.0)
Epoch 7 Test AUC:(0.7237666228735645, 0.0)
Epoch 7 a 0.364065420519658 b 0.4416980962878022 c 0.359915302912714
  1%|          | 8/1000 [06:56<14:23:07, 52.21s/it]Epoch 8 Valid AUC:(0.791533252546579, 0.0)
Epoch 8 Test AUC:(0.7254652372044705, 0.0)
Epoch 8 a 0.36254557781296237 b 0.4263961719315297 c 0.35305905671906423
  1%|          | 9/1000 [07:48<14:21:18, 52.15s/it]Epoch 9 Valid AUC:(0.7879424441486964, 0.0)
Epoch 9 Test AUC:(0.7217581489046622, 0.0)
Epoch 9 a 0.3620198802569023 b 0.40795763043810424 c 0.34656663140060917
  1%|          | 10/1000 [08:41<14:21:12, 52.19s/it]Epoch 10 Valid AUC:(0.7925959944969889, 0.0)
Epoch 10 Test AUC:(0.7223801683777632, 0.0)
Epoch 10 a 0.3604992778008613 b 0.3882796668430689 c 0.337352960942017
  1%|          | 11/1000 [09:33<14:20:36, 52.21s/it]Epoch 11 Valid AUC:(0.7925917357678681, 0.0)
Epoch 11 Test AUC:(0.7224371816276554, 0.0)
Epoch 11 a 0.36017210106974396 b 0.37276010697996115 c 0.3298040696193035
  1%|          | 12/1000 [10:25<14:18:36, 52.14s/it]Epoch 12 Valid AUC:(0.7908631377387264, 0.0)
Epoch 12 Test AUC:(0.7216679922942029, 0.0)
Epoch 12 a 0.360009190482153 b 0.3601043610505655 c 0.3230798108357059
  1%|▏         | 13/1000 [11:17<14:16:28, 52.07s/it]Epoch 13 Valid AUC:(0.7926147236776604, 0.0)
Epoch 13 Test AUC:(0.7209532167313824, 0.0)
Epoch 13 a 0.3594245462710229 b 0.3473207088303518 c 0.3153377921288642
  1%|▏         | 14/1000 [12:09<14:15:49, 52.08s/it]Epoch 14 Valid AUC:(0.792759817797035, 0.0)
Epoch 14 Test AUC:(0.7230602443128279, 0.0)
Epoch 14 a 0.3588466116000469 b 0.33870209198842344 c 0.309329481731718
  2%|▏         | 15/1000 [13:01<14:16:44, 52.19s/it]Epoch 15 Valid AUC:(0.7916881521238239, 0.0)
Epoch 15 Test AUC:(0.7202718239548503, 0.0)
Epoch 15 a 0.35817101381913996 b 0.32998286322568743 c 0.30334754174264145
  2%|▏         | 16/1000 [13:53<14:13:54, 52.07s/it]Epoch 16 Valid AUC:(0.7904090211094142, 0.0)
Epoch 16 Test AUC:(0.7208377322999736, 0.0)
Epoch 16 a 0.35745101057787537 b 0.32154010065364647 c 0.29688241187355646
  2%|▏         | 17/1000 [14:45<14:11:19, 51.96s/it]Epoch 17 Valid AUC:(0.7920077900575677, 0.0)
Epoch 17 Test AUC:(0.7249879121007807, 0.0)
Epoch 17 a 0.35666952346652087 b 0.31491891323200893 c 0.2913711667060852
  2%|▏         | 18/1000 [15:37<14:11:22, 52.02s/it]Epoch 18 Valid AUC:(0.7942338545542734, 0.0)
Epoch 18 Test AUC:(0.7249027620531728, 0.0)
Epoch 18 a 0.35472363113637423 b 0.3082095190912665 c 0.2859773154349874
  2%|▏         | 19/1000 [16:29<14:10:17, 52.01s/it]Epoch 19 Valid AUC:(0.7938475559113847, 0.0)
Epoch 19 Test AUC:(0.7289598993084868, 0.0)
Epoch 19 a 0.3528753934611737 b 0.30307073606331825 c 0.28209171652554027
  2%|▏         | 20/1000 [17:20<14:05:51, 51.79s/it]Epoch 20 Valid AUC:(0.7937157339553489, 0.0)
Epoch 20 Test AUC:(0.7345508704174596, 0.0)
Epoch 20 a 0.3508531602935292 b 0.2989332163837594 c 0.27862256798346036
  2%|▏         | 21/1000 [18:12<14:05:30, 51.82s/it]Epoch 21 Valid AUC:(0.7975018351367447, 0.0)
Epoch 21 Test AUC:(0.7388184799836612, 0.0)
Epoch 21 a 0.3481399906832927 b 0.2945879933459898 c 0.2749522257918563
  2%|▏         | 22/1000 [19:04<14:06:39, 51.94s/it]Epoch 22 Valid AUC:(0.7973333276191432, 0.0)
Epoch 22 Test AUC:(0.7427007124740831, 0.0)
Epoch 22 a 0.34520414285736545 b 0.289218550806554 c 0.2701251206083797
  2%|▏         | 23/1000 [19:56<14:05:22, 51.92s/it]Epoch 23 Valid AUC:(0.7972659479370711, 0.0)
Epoch 23 Test AUC:(0.7444994324092616, 0.0)
Epoch 23 a 0.3421017404653177 b 0.28560474667870545 c 0.26825599471328243
  2%|▏         | 24/1000 [20:49<14:08:24, 52.16s/it]Epoch 24 Valid AUC:(0.7984474844641869, 0.0)
Epoch 24 Test AUC:(0.7450871712496191, 0.0)
Epoch 24 a 0.33861090425754214 b 0.2809244325343272 c 0.2644535129218994
  2%|▎         | 25/1000 [21:41<14:08:30, 52.22s/it]Epoch 25 Valid AUC:(0.8013444557923975, 0.0)
Epoch 25 Test AUC:(0.7485140459462833, 0.0)
Epoch 25 a 0.3351072200107383 b 0.277584280226552 c 0.2622960159476374
  3%|▎         | 26/1000 [22:33<14:06:08, 52.12s/it]Epoch 26 Valid AUC:(0.7971469700927563, 0.0)
Epoch 26 Test AUC:(0.7487781795469646, 0.0)
Epoch 26 a 0.3327854984483009 b 0.27495465956823206 c 0.25973933461446397
  3%|▎         | 27/1000 [23:25<14:04:10, 52.06s/it]Epoch 27 Valid AUC:(0.8006465330084802, 0.0)
Epoch 27 Test AUC:(0.7479013854536107, 0.0)
Epoch 27 a 0.33054635834166224 b 0.27076140570808466 c 0.25541948933356723
  3%|▎         | 28/1000 [24:17<14:02:07, 51.98s/it]Epoch 28 Valid AUC:(0.7997315060324109, 0.0)
Epoch 28 Test AUC:(0.7484170742536846, 0.0)
Epoch 28 a 0.3295811036343066 b 0.26754078415917676 c 0.2522911148771674
  3%|▎         | 29/1000 [25:09<14:01:43, 52.01s/it]Epoch 29 Valid AUC:(0.8014543740651943, 0.0)
Epoch 29 Test AUC:(0.7499175638001888, 0.0)
Epoch 29 a 0.3285717055111584 b 0.2654337387089758 c 0.24972791831857963
  3%|▎         | 30/1000 [26:01<13:59:23, 51.92s/it]Epoch 30 Valid AUC:(0.8024152102539309, 0.0)
Epoch 30 Test AUC:(0.7474131793059783, 0.0)
Epoch 30 a 0.32756674859365464 b 0.26252945945776207 c 0.24695631232060178
  3%|▎         | 31/1000 [26:53<13:57:30, 51.86s/it]Epoch 31 Valid AUC:(0.8030354339796458, 0.0)
Epoch 31 Test AUC:(0.7478915005916872, 0.0)
Epoch 31 a 0.3264274502424167 b 0.25999140133800164 c 0.24416821499465696
  3%|▎         | 32/1000 [27:44<13:56:12, 51.83s/it]Epoch 32 Valid AUC:(0.8005971327759523, 0.0)
Epoch 32 Test AUC:(0.746233870813722, 0.0)
Epoch 32 a 0.3256378567194795 b 0.2575112612434556 c 0.24177120718917616
  3%|▎         | 33/1000 [28:36<13:55:44, 51.86s/it]Epoch 33 Valid AUC:(0.8006937263401517, 0.0)
Epoch 33 Test AUC:(0.7478734068478895, 0.0)
Epoch 33 a 0.3247227413913374 b 0.255013410324302 c 0.23928095250422327
  3%|▎         | 34/1000 [29:28<13:53:21, 51.76s/it]Epoch 34 Valid AUC:(0.7999925944506917, 0.0)
Epoch 34 Test AUC:(0.747698027507014, 0.0)
Epoch 34 a 0.3240268001973749 b 0.2532591825759627 c 0.23718477635676233
  4%|▎         | 35/1000 [30:19<13:52:16, 51.75s/it]Epoch 35 Valid AUC:(0.8046768068796989, 0.0)
Epoch 35 Test AUC:(0.7559333445461529, 0.0)
Epoch 35 a 0.32157417526187554 b 0.2517354938106038 c 0.23515139595123843
  4%|▎         | 36/1000 [31:11<13:51:22, 51.75s/it]Epoch 36 Valid AUC:(0.8026897361608759, 0.0)
Epoch 36 Test AUC:(0.7528936853727717, 0.0)
Epoch 36 a 0.3197907253170397 b 0.2512154348299537 c 0.23407336059110745
  4%|▎         | 37/1000 [32:03<13:52:26, 51.87s/it]Epoch 37 Valid AUC:(0.803409827917508, 0.0)
Epoch 37 Test AUC:(0.7514308540718656, 0.0)
Epoch 37 a 0.31809558373102 b 0.2508600487015857 c 0.23351274145920753
  4%|▍         | 38/1000 [32:55<13:50:43, 51.81s/it]Epoch 38 Valid AUC:(0.8053093172247582, 0.0)
Epoch 38 Test AUC:(0.7543827081374077, 0.0)
Epoch 38 a 0.31652117159285054 b 0.24960533150245007 c 0.23109621712019746
  4%|▍         | 39/1000 [33:47<13:50:52, 51.88s/it]Epoch 39 Valid AUC:(0.8028076502841043, 0.0)
Epoch 39 Test AUC:(0.7532166193653363, 0.0)
Epoch 39 a 0.31498786741099366 b 0.24825226145251175 c 0.23003000593641154
  4%|▍         | 40/1000 [34:39<13:50:23, 51.90s/it]Epoch 40 Valid AUC:(0.8061774558879735, 0.0)
Epoch 40 Test AUC:(0.756057315764291, 0.0)
Epoch 40 a 0.31364419939412436 b 0.24633037729162566 c 0.22769153232065964
  4%|▍         | 41/1000 [35:31<13:51:03, 52.00s/it]Epoch 41 Valid AUC:(0.8023005885397038, 0.0)
Epoch 41 Test AUC:(0.7524060350348494, 0.0)
Epoch 41 a 0.31275005827487357 b 0.24571550132283262 c 0.22663321845248433
  4%|▍         | 42/1000 [36:23<13:49:55, 51.98s/it]Epoch 42 Valid AUC:(0.8023785208475902, 0.0)
Epoch 42 Test AUC:(0.7588712648898055, 0.0)
Epoch 42 a 0.31175594070787643 b 0.243047944376886 c 0.2244199627421991
  4%|▍         | 43/1000 [37:16<13:51:26, 52.13s/it]Epoch 43 Valid AUC:(0.8014556056747895, 0.0)
Epoch 43 Test AUC:(0.7556130784401973, 0.0)
Epoch 43 a 0.31122482524551376 b 0.24216126706038923 c 0.22305362001511173
  4%|▍         | 44/1000 [38:08<13:53:07, 52.29s/it]Epoch 44 Valid AUC:(0.804297621070581, 0.0)
Epoch 44 Test AUC:(0.759555013444417, 0.0)
Epoch 44 a 0.31072975572206124 b 0.2420480592210048 c 0.22335575793830442
  4%|▍         | 45/1000 [39:01<13:52:03, 52.28s/it]Epoch 45 Valid AUC:(0.800254819640784, 0.0)
Epoch 45 Test AUC:(0.7559972241836961, 0.0)
Epoch 45 a 0.31051106951845964 b 0.23969147113007558 c 0.22169847924344735
  5%|▍         | 46/1000 [39:53<13:52:46, 52.38s/it]  5%|▍         | 46/1000 [40:46<14:05:28, 53.17s/it]
[32m[I 2021-05-13 23:11:37,373][0m Trial 43 finished with value: 0.8061774558879735 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.01, 'alpha': 0.14008435441388123, 'gamma': 0.0010299693775371764}. Best is trial 23 with value: 0.806365133453781.[0m
2021-05-13 23:11:38.159628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7791611164348998, 0.0)
Epoch 0 Test AUC:(0.7193003626414658, 0.0)
Epoch 0 a 0.4127114003812763 b 0.500265277727269 c 0.414160078320225
  0%|          | 1/1000 [00:52<14:35:46, 52.60s/it]Epoch 1 Valid AUC:(0.7778740985053504, 0.0)
Epoch 1 Test AUC:(0.7214989748367799, 0.0)
Epoch 1 a 0.386135219568218 b 0.48463887449961074 c 0.38720617579742217
  0%|          | 2/1000 [01:44<14:30:17, 52.32s/it]Epoch 2 Valid AUC:(0.775095796157862, 0.0)
Epoch 2 Test AUC:(0.7238214684655867, 0.0)
Epoch 2 a 0.38154990650278703 b 0.48975179396884544 c 0.3830145853506008
  0%|          | 3/1000 [02:37<14:30:57, 52.41s/it]Epoch 3 Valid AUC:(0.7829026195077569, 0.0)
Epoch 3 Test AUC:(0.7254547238500285, 0.0)
Epoch 3 a 0.37621489826822185 b 0.4940086475440434 c 0.37883410559333786
  0%|          | 4/1000 [03:29<14:27:04, 52.23s/it]Epoch 4 Valid AUC:(0.7855645930609132, 0.0)
Epoch 4 Test AUC:(0.7283680560271921, 0.0)
Epoch 4 a 0.3719038757040227 b 0.49791449056544773 c 0.3749031931221845
  0%|          | 5/1000 [04:21<14:28:16, 52.36s/it]Epoch 5 Valid AUC:(0.7833836751939812, 0.0)
Epoch 5 Test AUC:(0.7266244168342978, 0.0)
Epoch 5 a 0.36878427389402024 b 0.4978954994702483 c 0.3717772938476002
  1%|          | 6/1000 [05:14<14:26:45, 52.32s/it]Epoch 6 Valid AUC:(0.7876454814163774, 0.0)
Epoch 6 Test AUC:(0.7272237250675468, 0.0)
Epoch 6 a 0.36627313956408436 b 0.49676300918072525 c 0.3687345927629912
  1%|          | 7/1000 [06:06<14:25:50, 52.32s/it]Epoch 7 Valid AUC:(0.7894967956927365, 0.0)
Epoch 7 Test AUC:(0.7262098127186782, 0.0)
Epoch 7 a 0.363358704616846 b 0.49560381918845764 c 0.36549947715141407
  1%|          | 8/1000 [06:58<14:22:52, 52.19s/it]Epoch 8 Valid AUC:(0.7929728695963251, 0.0)
Epoch 8 Test AUC:(0.7267577726856203, 0.0)
Epoch 8 a 0.3605843291316234 b 0.49655597694443027 c 0.36224234751772355
  1%|          | 9/1000 [07:50<14:23:12, 52.26s/it]Epoch 9 Valid AUC:(0.7914652846139302, 0.0)
Epoch 9 Test AUC:(0.7262873994787676, 0.0)
Epoch 9 a 0.3588795171417221 b 0.4967100604079379 c 0.36012559565499996
  1%|          | 10/1000 [08:42<14:22:13, 52.26s/it]Epoch 10 Valid AUC:(0.7923664742447339, 0.0)
Epoch 10 Test AUC:(0.7263576238979261, 0.0)
Epoch 10 a 0.3562108333441813 b 0.49690457117149767 c 0.35672248483183877
  1%|          | 11/1000 [09:35<14:22:08, 52.30s/it]Epoch 11 Valid AUC:(0.7930160605172097, 0.0)
Epoch 11 Test AUC:(0.7261888971717362, 0.0)
Epoch 11 a 0.3551884028513427 b 0.4933669273882085 c 0.35500952547464815
  1%|          | 12/1000 [10:27<14:21:56, 52.34s/it]Epoch 12 Valid AUC:(0.7935823189808668, 0.0)
Epoch 12 Test AUC:(0.7246232196971403, 0.0)
Epoch 12 a 0.3541403768407987 b 0.49091793203977513 c 0.35238354258853904
  1%|▏         | 13/1000 [11:19<14:20:26, 52.31s/it]Epoch 13 Valid AUC:(0.7930564703841697, 0.0)
Epoch 13 Test AUC:(0.7237394694314899, 0.0)
Epoch 13 a 0.3527202623590857 b 0.48547081424436817 c 0.34841746145810637
  1%|▏         | 14/1000 [12:12<14:21:59, 52.45s/it]Epoch 14 Valid AUC:(0.7943839430363876, 0.0)
Epoch 14 Test AUC:(0.725078620245491, 0.0)
Epoch 14 a 0.35121635376087856 b 0.4790455387751581 c 0.34317400523834307
  2%|▏         | 15/1000 [13:04<14:18:31, 52.30s/it]Epoch 15 Valid AUC:(0.7926665538079953, 0.0)
Epoch 15 Test AUC:(0.7231654163363821, 0.0)
Epoch 15 a 0.3498511813296159 b 0.4672306820420432 c 0.3372019601299969
  2%|▏         | 16/1000 [13:56<14:16:38, 52.23s/it]Epoch 16 Valid AUC:(0.7917826771990673, 0.0)
Epoch 16 Test AUC:(0.7247947810528523, 0.0)
Epoch 16 a 0.3483884307580215 b 0.4506641555000359 c 0.3304029907019325
  2%|▏         | 17/1000 [14:49<14:15:44, 52.23s/it]Epoch 17 Valid AUC:(0.7928203345557121, 0.0)
Epoch 17 Test AUC:(0.7258946002056265, 0.0)
Epoch 17 a 0.34680007449098277 b 0.4349698490300169 c 0.32390822515161466
  2%|▏         | 18/1000 [15:41<14:14:54, 52.23s/it]Epoch 18 Valid AUC:(0.7957925699179512, 0.0)
Epoch 18 Test AUC:(0.7285091034298123, 0.0)
Epoch 18 a 0.3445804483094206 b 0.4167457088618211 c 0.31580173543521334
  2%|▏         | 19/1000 [16:33<14:13:41, 52.21s/it]Epoch 19 Valid AUC:(0.7946075308008002, 0.0)
Epoch 19 Test AUC:(0.7307004729970562, 0.0)
Epoch 19 a 0.3422974164577077 b 0.39855003003143447 c 0.30871734292934117
  2%|▏         | 20/1000 [17:25<14:13:48, 52.27s/it]Epoch 20 Valid AUC:(0.7964065292235812, 0.0)
Epoch 20 Test AUC:(0.7353916608679681, 0.0)
Epoch 20 a 0.3386839932838916 b 0.3847417901579283 c 0.3032112945493318
  2%|▏         | 21/1000 [18:18<14:15:13, 52.41s/it]Epoch 21 Valid AUC:(0.8008322471758487, 0.0)
Epoch 21 Test AUC:(0.7414024863565924, 0.0)
Epoch 21 a 0.33417289417754237 b 0.37581656846242173 c 0.29709798979087615
  2%|▏         | 22/1000 [19:10<14:12:48, 52.32s/it]Epoch 22 Valid AUC:(0.8006071407253067, 0.0)
Epoch 22 Test AUC:(0.7430172760322766, 0.0)
Epoch 22 a 0.3293071061192864 b 0.36591158702339927 c 0.29138695021390437
  2%|▏         | 23/1000 [20:02<14:11:05, 52.27s/it]Epoch 23 Valid AUC:(0.8026241737757923, 0.0)
Epoch 23 Test AUC:(0.7426700659817527, 0.0)
Epoch 23 a 0.32510537466772604 b 0.35920462563963723 c 0.2861788323827433
  2%|▏         | 24/1000 [20:55<14:10:02, 52.26s/it]Epoch 24 Valid AUC:(0.8028865373777851, 0.0)
Epoch 24 Test AUC:(0.7450543271712036, 0.0)
Epoch 24 a 0.3210561475163734 b 0.35261887671722014 c 0.2798057886916147
  2%|▎         | 25/1000 [21:47<14:08:05, 52.19s/it]Epoch 25 Valid AUC:(0.8050852668057525, 0.0)
Epoch 25 Test AUC:(0.749282119384856, 0.0)
Epoch 25 a 0.3175622170839751 b 0.34721753840715114 c 0.2748432040694254
  3%|▎         | 26/1000 [22:38<14:05:27, 52.08s/it]Epoch 26 Valid AUC:(0.8021671889443218, 0.0)
Epoch 26 Test AUC:(0.7500889626884472, 0.0)
Epoch 26 a 0.3151637653349871 b 0.33993170414892 c 0.2691160415859529
  3%|▎         | 27/1000 [23:31<14:06:28, 52.20s/it]Epoch 27 Valid AUC:(0.8057064991441121, 0.0)
Epoch 27 Test AUC:(0.7481855453056977, 0.0)
Epoch 27 a 0.31288052936434985 b 0.3342804240748676 c 0.2634001814683438
  3%|▎         | 28/1000 [24:23<14:03:04, 52.04s/it]Epoch 28 Valid AUC:(0.8033208598237477, 0.0)
Epoch 28 Test AUC:(0.7494236627407561, 0.0)
Epoch 28 a 0.31126552454422657 b 0.3282643955957962 c 0.25922055548465467
  3%|▎         | 29/1000 [25:15<14:02:59, 52.09s/it]Epoch 29 Valid AUC:(0.8049547392573039, 0.0)
Epoch 29 Test AUC:(0.7513671326263168, 0.0)
Epoch 29 a 0.3089919468046914 b 0.3215113117301488 c 0.2532680872040735
  3%|▎         | 30/1000 [26:07<14:02:18, 52.10s/it]Epoch 30 Valid AUC:(0.8058682821502188, 0.0)
Epoch 30 Test AUC:(0.7518013953038415, 0.0)
Epoch 30 a 0.3057148207121452 b 0.31497744373392533 c 0.24868926079100526
  3%|▎         | 31/1000 [26:59<14:01:42, 52.12s/it]Epoch 31 Valid AUC:(0.8074767412129923, 0.0)
Epoch 31 Test AUC:(0.7528588147266434, 0.0)
Epoch 31 a 0.3020195752921958 b 0.3087839966328811 c 0.24272693570710763
  3%|▎         | 32/1000 [27:51<14:02:09, 52.20s/it]Epoch 32 Valid AUC:(0.804766584939395, 0.0)
Epoch 32 Test AUC:(0.7505562190854631, 0.0)
Epoch 32 a 0.2995065754987824 b 0.30352861123905334 c 0.23778752296023686
  3%|▎         | 33/1000 [28:44<14:01:53, 52.24s/it]Epoch 33 Valid AUC:(0.8054880172409145, 0.0)
Epoch 33 Test AUC:(0.7525801231870134, 0.0)
Epoch 33 a 0.2970550519000117 b 0.2980069391264522 c 0.23231176054573635
  3%|▎         | 34/1000 [29:36<14:00:05, 52.18s/it]Epoch 34 Valid AUC:(0.8020382082770193, 0.0)
Epoch 34 Test AUC:(0.7523491671505739, 0.0)
Epoch 34 a 0.2952227608059014 b 0.29270229861889807 c 0.2274578279652586
  4%|▎         | 35/1000 [30:28<13:57:45, 52.09s/it]Epoch 35 Valid AUC:(0.8061186000721013, 0.0)
Epoch 35 Test AUC:(0.7590442456980082, 0.0)
Epoch 35 a 0.29207969128605826 b 0.2863740171764938 c 0.22172799532562196
  4%|▎         | 36/1000 [31:20<13:56:51, 52.09s/it]Epoch 36 Valid AUC:(0.8048457168170848, 0.0)
Epoch 36 Test AUC:(0.7571118278747625, 0.0)
Epoch 36 a 0.28998535499726263 b 0.28272165232141255 c 0.2182833994598216
  4%|▎         | 37/1000 [32:12<13:57:24, 52.17s/it]  4%|▎         | 37/1000 [33:04<14:20:59, 53.64s/it]
[32m[I 2021-05-13 23:45:01,966][0m Trial 44 finished with value: 0.8074767412129923 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.13887818959201886, 'gamma': 0.0020018224626638602}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-13 23:45:02.760965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7791219279248018, 0.0)
Epoch 0 Test AUC:(0.7192946206996131, 0.0)
Epoch 0 a 0.4127112559269612 b 0.5000942147353765 c 0.4141658650677449
  0%|          | 1/1000 [00:51<14:22:07, 51.78s/it]Epoch 1 Valid AUC:(0.7778076210638142, 0.0)
Epoch 1 Test AUC:(0.7214878287143601, 0.0)
Epoch 1 a 0.3861422975298385 b 0.4844239457272428 c 0.38720746401330114
  0%|          | 2/1000 [01:43<14:22:27, 51.85s/it]Epoch 2 Valid AUC:(0.7751038714669772, 0.0)
Epoch 2 Test AUC:(0.723833739033805, 0.0)
Epoch 2 a 0.38155720033636037 b 0.4895597108652894 c 0.38300887002071865
  0%|          | 3/1000 [02:35<14:22:37, 51.91s/it]Epoch 3 Valid AUC:(0.7828525297789103, 0.0)
Epoch 3 Test AUC:(0.7254156162237246, 0.0)
Epoch 3 a 0.3762194060343852 b 0.4938270983321806 c 0.378830720960974
  0%|          | 4/1000 [03:27<14:19:27, 51.77s/it]Epoch 4 Valid AUC:(0.7856086951934755, 0.0)
Epoch 4 Test AUC:(0.7284307556379659, 0.0)
Epoch 4 a 0.37188921524005636 b 0.4977450306626633 c 0.3748820320941073
  0%|          | 5/1000 [04:19<14:19:17, 51.82s/it]Epoch 5 Valid AUC:(0.7833188740743499, 0.0)
Epoch 5 Test AUC:(0.7264273908429384, 0.0)
Epoch 5 a 0.36874932644352826 b 0.49754560539420223 c 0.37170639196392036
  1%|          | 6/1000 [05:10<14:18:25, 51.82s/it]Epoch 6 Valid AUC:(0.7878433412280064, 0.0)
Epoch 6 Test AUC:(0.7273086912704044, 0.0)
Epoch 6 a 0.3662022228691899 b 0.49630563983495085 c 0.3686107179408582
  1%|          | 7/1000 [06:03<14:19:43, 51.95s/it]Epoch 7 Valid AUC:(0.7896384205434592, 0.0)
Epoch 7 Test AUC:(0.7262333833258515, 0.0)
Epoch 7 a 0.36326329131241536 b 0.4950994449841904 c 0.36536150109360155
  1%|          | 8/1000 [06:55<14:19:18, 51.97s/it]Epoch 8 Valid AUC:(0.7928714059837781, 0.0)
Epoch 8 Test AUC:(0.7267857598422601, 0.0)
Epoch 8 a 0.36055569467650095 b 0.4960513958029104 c 0.3621471471469887
  1%|          | 9/1000 [07:47<14:18:53, 52.00s/it]Epoch 9 Valid AUC:(0.7914049331805786, 0.0)
Epoch 9 Test AUC:(0.7262563297159655, 0.0)
Epoch 9 a 0.3588810365804484 b 0.4960831837874783 c 0.36002972949918366
  1%|          | 10/1000 [08:38<14:15:57, 51.88s/it]Epoch 10 Valid AUC:(0.7925393020078564, 0.0)
Epoch 10 Test AUC:(0.726648526149344, 0.0)
Epoch 10 a 0.3562325550996562 b 0.49593465866697145 c 0.35659837458934823
  1%|          | 11/1000 [09:31<14:19:51, 52.17s/it]Epoch 11 Valid AUC:(0.793165133978721, 0.0)
Epoch 11 Test AUC:(0.7260450749960241, 0.0)
Epoch 11 a 0.3550973870384861 b 0.49209155451124104 c 0.35475512391604647
  1%|          | 12/1000 [10:23<14:16:03, 51.99s/it]Epoch 12 Valid AUC:(0.7941395383784724, 0.0)
Epoch 12 Test AUC:(0.7248917912245847, 0.0)
Epoch 12 a 0.3539463781135183 b 0.48958478223390023 c 0.35194909356729365
  1%|▏         | 13/1000 [11:14<14:12:39, 51.83s/it]Epoch 13 Valid AUC:(0.7929962060990517, 0.0)
Epoch 13 Test AUC:(0.723240758480334, 0.0)
Epoch 13 a 0.35242826544063194 b 0.4845897155988144 c 0.34774104942018597
  1%|▏         | 14/1000 [12:06<14:10:58, 51.78s/it]Epoch 14 Valid AUC:(0.7939277245967359, 0.0)
Epoch 14 Test AUC:(0.7245969341733055, 0.0)
Epoch 14 a 0.35081328124827305 b 0.47778169873734594 c 0.34234997558162006
  2%|▏         | 15/1000 [12:58<14:11:20, 51.86s/it]Epoch 15 Valid AUC:(0.7932579224972509, 0.0)
Epoch 15 Test AUC:(0.7229344688508612, 0.0)
Epoch 15 a 0.34942156316289 b 0.4653450010168241 c 0.33618362166991894
  2%|▏         | 16/1000 [13:50<14:12:10, 51.96s/it]Epoch 16 Valid AUC:(0.7917749312590112, 0.0)
Epoch 16 Test AUC:(0.7239385433678586, 0.0)
Epoch 16 a 0.34801966833396697 b 0.4482265586104671 c 0.32935247670716683
  2%|▏         | 17/1000 [14:42<14:09:43, 51.86s/it]Epoch 17 Valid AUC:(0.7923908142337385, 0.0)
Epoch 17 Test AUC:(0.7254805732770138, 0.0)
Epoch 17 a 0.34651427135860896 b 0.4319824641139455 c 0.322850932837492
  2%|▏         | 18/1000 [15:34<14:11:18, 52.02s/it]Epoch 18 Valid AUC:(0.7952217630854559, 0.0)
Epoch 18 Test AUC:(0.7277078994570504, 0.0)
Epoch 18 a 0.3445275965590832 b 0.4132757049571101 c 0.31485897992218526
  2%|▏         | 19/1000 [16:26<14:11:08, 52.06s/it]Epoch 19 Valid AUC:(0.7942337187055564, 0.0)
Epoch 19 Test AUC:(0.7291650401216156, 0.0)
Epoch 19 a 0.3426690530968864 b 0.3946162393275401 c 0.3077377747122191
  2%|▏         | 20/1000 [17:19<14:12:21, 52.19s/it]Epoch 20 Valid AUC:(0.7958239368740847, 0.0)
Epoch 20 Test AUC:(0.7347036283031285, 0.0)
Epoch 20 a 0.3399324438701453 b 0.37930143988828063 c 0.30202102151435145
  2%|▏         | 21/1000 [18:11<14:11:07, 52.16s/it]Epoch 21 Valid AUC:(0.8006438455107474, 0.0)
Epoch 21 Test AUC:(0.7400641778080754, 0.0)
Epoch 21 a 0.3356512561890201 b 0.36917401553399604 c 0.29616017342813056
  2%|▏         | 22/1000 [19:03<14:10:18, 52.17s/it]Epoch 22 Valid AUC:(0.8004979375806621, 0.0)
Epoch 22 Test AUC:(0.7423491799341971, 0.0)
Epoch 22 a 0.3308268092287858 b 0.3602895295356121 c 0.29080455442909264
  2%|▏         | 23/1000 [19:55<14:10:06, 52.21s/it]Epoch 23 Valid AUC:(0.8022163559271657, 0.0)
Epoch 23 Test AUC:(0.7423936233337194, 0.0)
Epoch 23 a 0.32667114647101586 b 0.35335782338196126 c 0.28557124889832386
  2%|▏         | 24/1000 [20:48<14:13:32, 52.47s/it]Epoch 24 Valid AUC:(0.8028459109218329, 0.0)
Epoch 24 Test AUC:(0.7447754988168757, 0.0)
Epoch 24 a 0.322496087738206 b 0.3467172968915291 c 0.27914159101859426
  2%|▎         | 25/1000 [21:41<14:11:05, 52.38s/it]Epoch 25 Valid AUC:(0.8050383323555985, 0.0)
Epoch 25 Test AUC:(0.7487672044429171, 0.0)
Epoch 25 a 0.31877824502211943 b 0.3418709571572617 c 0.27449152725083487
  3%|▎         | 26/1000 [22:33<14:09:25, 52.33s/it]Epoch 26 Valid AUC:(0.8018686895835899, 0.0)
Epoch 26 Test AUC:(0.7502093168680094, 0.0)
Epoch 26 a 0.3161542838967782 b 0.33463260321549965 c 0.268482619158219
  3%|▎         | 27/1000 [23:25<14:08:37, 52.33s/it]Epoch 27 Valid AUC:(0.8056555135826878, 0.0)
Epoch 27 Test AUC:(0.7485891700418105, 0.0)
Epoch 27 a 0.3136159375279962 b 0.3290560580115443 c 0.2631564956735557
  3%|▎         | 28/1000 [24:17<14:04:48, 52.15s/it]Epoch 28 Valid AUC:(0.8038370541903915, 0.0)
Epoch 28 Test AUC:(0.7498723935725841, 0.0)
Epoch 28 a 0.31184668116406417 b 0.32333194885695243 c 0.25899204494847616
  3%|▎         | 29/1000 [25:09<14:02:37, 52.07s/it]Epoch 29 Valid AUC:(0.805345834897815, 0.0)
Epoch 29 Test AUC:(0.7513911564321769, 0.0)
Epoch 29 a 0.3096991683575709 b 0.31637031565489665 c 0.25288372635241724
  3%|▎         | 30/1000 [26:01<14:01:35, 52.06s/it]Epoch 30 Valid AUC:(0.806313607060672, 0.0)
Epoch 30 Test AUC:(0.7512509470195814, 0.0)
Epoch 30 a 0.3070437078264877 b 0.3099686648224441 c 0.2487953676724098
  3%|▎         | 31/1000 [26:53<14:02:19, 52.16s/it]Epoch 31 Valid AUC:(0.8070531520972694, 0.0)
Epoch 31 Test AUC:(0.7510566530467208, 0.0)
Epoch 31 a 0.3037892251727087 b 0.30299932667067353 c 0.24281491830915033
  3%|▎         | 32/1000 [27:45<14:00:42, 52.11s/it]Epoch 32 Valid AUC:(0.8042932649404932, 0.0)
Epoch 32 Test AUC:(0.7489179742400071, 0.0)
Epoch 32 a 0.30129555743225145 b 0.29740068733212455 c 0.23792705419557675
  3%|▎         | 33/1000 [28:38<14:02:00, 52.24s/it]Epoch 33 Valid AUC:(0.8043877784814115, 0.0)
Epoch 33 Test AUC:(0.7515995294925437, 0.0)
Epoch 33 a 0.29861830237885595 b 0.29118921396358155 c 0.23194939000026082
  3%|▎         | 34/1000 [29:30<14:01:45, 52.28s/it]Epoch 34 Valid AUC:(0.801419312280275, 0.0)
Epoch 34 Test AUC:(0.7506028301428552, 0.0)
Epoch 34 a 0.2965362336733931 b 0.2859862864137415 c 0.22779337339238143
  4%|▎         | 35/1000 [30:23<14:03:32, 52.45s/it]Epoch 35 Valid AUC:(0.8058947893107381, 0.0)
Epoch 35 Test AUC:(0.7575776477174505, 0.0)
Epoch 35 a 0.2931016026967968 b 0.2801713313255272 c 0.22198668203243546
  4%|▎         | 36/1000 [31:15<14:00:10, 52.29s/it]Epoch 36 Valid AUC:(0.8036855995315567, 0.0)
Epoch 36 Test AUC:(0.7556097051028021, 0.0)
Epoch 36 a 0.2907490432862065 b 0.2755994575484178 c 0.21782280183893815
  4%|▎         | 37/1000 [32:07<13:57:00, 52.15s/it]  4%|▎         | 37/1000 [32:59<14:18:36, 53.50s/it]
[32m[I 2021-05-14 00:18:22,361][0m Trial 45 finished with value: 0.8070531520972694 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.14240563569838563, 'gamma': 0.0020357402889514603}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-14 00:18:23.060351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.4970460234742892, 0.0)
Epoch 0 Test AUC:(0.5027638215028403, 0.0)
Epoch 0 a 0.5084754558995935 b 0.49022056782989193 c 0.4902163129337357
  0%|          | 1/1000 [00:51<14:13:06, 51.24s/it]Epoch 1 Valid AUC:(0.502316708912371, 0.0)
Epoch 1 Test AUC:(0.5127681354840381, 0.0)
Epoch 1 a 0.5018576279852232 b 0.4633565632030518 c 0.4633565623635497
  0%|          | 2/1000 [01:43<14:21:15, 51.78s/it]Epoch 2 Valid AUC:(0.4936136287780118, 0.0)
Epoch 2 Test AUC:(0.5017654247958059, 0.0)
Epoch 2 a 0.5017217068485091 b 0.44880288425585635 c 0.44880288275674557
  0%|          | 3/1000 [02:35<14:24:05, 52.00s/it]Epoch 3 Valid AUC:(0.49930820963222566, 0.0)
Epoch 3 Test AUC:(0.5085855776298802, 0.0)
Epoch 3 a 0.5017511754688363 b 0.42265509737569323 c 0.42265509977427046
  0%|          | 4/1000 [03:27<14:25:17, 52.13s/it]Epoch 4 Valid AUC:(0.5015193384596043, 0.0)
Epoch 4 Test AUC:(0.49186838636414254, 0.0)
Epoch 4 a 0.5018040119882081 b 0.4044664418193656 c 0.4044664343837761
  0%|          | 5/1000 [04:20<14:24:19, 52.12s/it]Epoch 5 Valid AUC:(0.5002104168468158, 0.0)
Epoch 5 Test AUC:(0.500432699997147, 0.0)
Epoch 5 a 0.5017239218146748 b 0.3969212464643436 c 0.39692123860900314
  1%|          | 6/1000 [05:11<14:21:39, 52.01s/it]Epoch 6 Valid AUC:(0.4965760817510307, 0.0)
Epoch 6 Test AUC:(0.5025466367208367, 0.0)
Epoch 6 a 0.501826549619736 b 0.3896598731967765 c 0.3896598706183059
  1%|          | 7/1000 [06:04<14:22:55, 52.14s/it]Epoch 7 Valid AUC:(0.5064485348259617, 0.0)
Epoch 7 Test AUC:(0.5181766043369259, 0.0)
Epoch 7 a 0.5016029127526811 b 0.38726430093978254 c 0.3872642995606006
  1%|          | 8/1000 [06:56<14:23:04, 52.20s/it]Epoch 8 Valid AUC:(0.49755792579042885, 0.0)
Epoch 8 Test AUC:(0.5060565750409657, 0.0)
Epoch 8 a 0.5016008246712521 b 0.3841986656788609 c 0.38419862976016655
  1%|          | 9/1000 [07:48<14:20:25, 52.09s/it]Epoch 9 Valid AUC:(0.4996232312727725, 0.0)
Epoch 9 Test AUC:(0.5102151005383448, 0.0)
Epoch 9 a 0.5017854810600549 b 0.383878228410149 c 0.3838782226535636
  1%|          | 10/1000 [08:40<14:18:57, 52.06s/it]Epoch 10 Valid AUC:(0.49896549792204775, 0.0)
Epoch 10 Test AUC:(0.5049846789129417, 0.0)
Epoch 10 a 0.5018634495720777 b 0.37999318794945114 c 0.37999318968841966
  1%|          | 11/1000 [09:32<14:18:34, 52.09s/it]Epoch 11 Valid AUC:(0.5007185705073194, 0.0)
Epoch 11 Test AUC:(0.5019428392553127, 0.0)
Epoch 11 a 0.5016270765596232 b 0.37982064347631733 c 0.37982064401599724
  1%|          | 12/1000 [10:24<14:16:33, 52.02s/it]Epoch 12 Valid AUC:(0.5009542077966173, 0.0)
Epoch 12 Test AUC:(0.4945862530925947, 0.0)
Epoch 12 a 0.5017383339059664 b 0.37901864019438053 c 0.3790186269422412
  1%|▏         | 13/1000 [11:16<14:16:42, 52.08s/it]  1%|▏         | 13/1000 [12:08<15:22:08, 56.06s/it]
[32m[I 2021-05-14 00:30:50,992][0m Trial 46 finished with value: 0.5064485348259617 and parameters: {'rank': 65.0, 'lambda': 0.1, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1439408454992768, 'gamma': 0.0022724399909713443}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-14 00:30:51.670794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.4988612519739844, 0.0)
Epoch 0 Test AUC:(0.5108032498227961, 0.0)
Epoch 0 a 0.5067229187584499 b 0.4277980273638213 c 0.4275339745899561
  0%|          | 1/1000 [00:51<14:21:04, 51.72s/it]Epoch 1 Valid AUC:(0.5026238872118949, 0.0)
Epoch 1 Test AUC:(0.5073211917728243, 0.0)
Epoch 1 a 0.5015536844730377 b 0.3784306264019588 c 0.37843063347776174
  0%|          | 2/1000 [01:43<14:24:15, 51.96s/it]Epoch 2 Valid AUC:(0.49320383599662093, 0.0)
Epoch 2 Test AUC:(0.5082655979796984, 0.0)
Epoch 2 a 0.501547534101206 b 0.3713479738839915 c 0.37134795661423525
  0%|          | 3/1000 [02:36<14:27:29, 52.21s/it]Epoch 3 Valid AUC:(0.49082224778752676, 0.0)
Epoch 3 Test AUC:(0.49047298760746577, 0.0)
Epoch 3 a 0.5015333570704853 b 0.3682384901723152 c 0.3682384291884885
  0%|          | 4/1000 [03:28<14:23:02, 51.99s/it]Epoch 4 Valid AUC:(0.49041843363127846, 0.0)
Epoch 4 Test AUC:(0.4931000179274284, 0.0)
Epoch 4 a 0.5016268328641742 b 0.3674400042839933 c 0.36744008163810976
  0%|          | 5/1000 [04:20<14:25:34, 52.20s/it]Epoch 5 Valid AUC:(0.48960514452837356, 0.0)
Epoch 5 Test AUC:(0.49118578363262594, 0.0)
Epoch 5 a 0.5015314697499726 b 0.36576774308619125 c 0.3657677211991738
  1%|          | 6/1000 [05:12<14:21:38, 52.01s/it]Epoch 6 Valid AUC:(0.4968493991170305, 0.0)
Epoch 6 Test AUC:(0.5035458714178956, 0.0)
Epoch 6 a 0.501675760242301 b 0.36496710057709536 c 0.3649672166682345
  1%|          | 7/1000 [06:03<14:18:42, 51.89s/it]  1%|          | 7/1000 [06:55<16:22:53, 59.39s/it]
[32m[I 2021-05-14 00:38:06,291][0m Trial 47 finished with value: 0.5026238872118949 and parameters: {'rank': 60.0, 'lambda': 0.01, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.15204176269733988, 'gamma': 0.0020204803845871957}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-14 00:38:07.107571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7672778409027179, 0.0)
Epoch 0 Test AUC:(0.7161250303178164, 0.0)
Epoch 0 a 0.40923300057334955 b 0.5017518099526654 c 0.41219532360917904
  0%|          | 1/1000 [02:57<49:22:22, 177.92s/it]Epoch 1 Valid AUC:(0.791367943881787, 0.0)
Epoch 1 Test AUC:(0.7248440984759873, 0.0)
Epoch 1 a 0.38515566306656 b 0.4901226007380996 c 0.3890467979100075
  0%|          | 2/1000 [05:55<49:18:27, 177.86s/it]Epoch 2 Valid AUC:(0.7819618773948206, 0.0)
Epoch 2 Test AUC:(0.7211864857913084, 0.0)
Epoch 2 a 0.37440131600925586 b 0.49344862123240535 c 0.37833097888753303
  0%|          | 3/1000 [08:54<49:23:53, 178.37s/it]Epoch 3 Valid AUC:(0.7887322224524075, 0.0)
Epoch 3 Test AUC:(0.725254807648176, 0.0)
Epoch 3 a 0.3659738221918895 b 0.4983055817985007 c 0.36958900152468216
  0%|          | 4/1000 [11:52<49:17:45, 178.18s/it]Epoch 4 Valid AUC:(0.7919186950862319, 0.0)
Epoch 4 Test AUC:(0.7243009184725533, 0.0)
Epoch 4 a 0.3603413686223699 b 0.5096649681580852 c 0.3635774479852123
  0%|          | 5/1000 [14:52<49:26:17, 178.87s/it]Epoch 5 Valid AUC:(0.7904178089834983, 0.0)
Epoch 5 Test AUC:(0.7214048634264594, 0.0)
Epoch 5 a 0.3560558590099642 b 0.5263604236014708 c 0.3585920793857929
  1%|          | 6/1000 [17:54<49:38:30, 179.79s/it]Epoch 6 Valid AUC:(0.7918064840459369, 0.0)
Epoch 6 Test AUC:(0.7222990244355283, 0.0)
Epoch 6 a 0.3530962936928549 b 0.5613576018702391 c 0.35522406619808194
  1%|          | 7/1000 [20:53<49:32:52, 179.63s/it]Epoch 7 Valid AUC:(0.793552283598479, 0.0)
Epoch 7 Test AUC:(0.7229229849671559, 0.0)
Epoch 7 a 0.3512997640443843 b 0.5950501809892131 c 0.3529718602015302
  1%|          | 8/1000 [23:52<49:27:56, 179.51s/it]Epoch 8 Valid AUC:(0.7944342967731183, 0.0)
Epoch 8 Test AUC:(0.7255062901647603, 0.0)
Epoch 8 a 0.34850551811308644 b 0.636224145203634 c 0.34987519179504084
  1%|          | 9/1000 [26:51<49:20:50, 179.26s/it]Epoch 9 Valid AUC:(0.7883352148295207, 0.0)
Epoch 9 Test AUC:(0.7236939144125473, 0.0)
Epoch 9 a 0.3463208514311135 b 0.6792726075906979 c 0.3474410527566979
  1%|          | 10/1000 [29:50<49:14:36, 179.07s/it]Epoch 10 Valid AUC:(0.7926816471130979, 0.0)
Epoch 10 Test AUC:(0.722792634763728, 0.0)
Epoch 10 a 0.3431749592224757 b 0.7410362216921653 c 0.3445274290830541
  1%|          | 11/1000 [32:49<49:12:53, 179.14s/it]Epoch 11 Valid AUC:(0.7927825045327846, 0.0)
Epoch 11 Test AUC:(0.723146959178543, 0.0)
Epoch 11 a 0.3411521266428534 b 0.795910935476235 c 0.34269779038045683
  1%|          | 12/1000 [35:48<49:08:53, 179.08s/it]Epoch 12 Valid AUC:(0.7905155854568094, 0.0)
Epoch 12 Test AUC:(0.7198991920232721, 0.0)
Epoch 12 a 0.33902663612048073 b 0.8780958893731828 c 0.3401894448929063
  1%|▏         | 13/1000 [38:47<49:04:52, 179.02s/it]Epoch 13 Valid AUC:(0.793409811615662, 0.0)
Epoch 13 Test AUC:(0.7200596200829423, 0.0)
Epoch 13 a 0.3366184163297343 b 0.9812636562721881 c 0.33759169284274915
  1%|▏         | 14/1000 [41:47<49:05:40, 179.25s/it]  1%|▏         | 14/1000 [44:46<52:34:00, 191.93s/it]
[32m[I 2021-05-14 01:23:13,169][0m Trial 48 finished with value: 0.7944342967731183 and parameters: {'rank': 75.0, 'lambda': 0.0001, 'batch_size': 128, 'learning_rate': 0.005, 'alpha': 0.14039709451048535, 'gamma': 0.0026811578375896504}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-14 01:23:13.947901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7790483094544781, 0.0)
Epoch 0 Test AUC:(0.7192829529711575, 0.0)
Epoch 0 a 0.41270836246325454 b 0.5006570156431294 c 0.41417930747421694
  0%|          | 1/1000 [00:51<14:24:45, 51.94s/it]Epoch 1 Valid AUC:(0.7778170971526253, 0.0)
Epoch 1 Test AUC:(0.7215006080622361, 0.0)
Epoch 1 a 0.3861452321891094 b 0.48519674950922037 c 0.38723031705773814
  0%|          | 2/1000 [01:43<14:21:32, 51.80s/it]Epoch 2 Valid AUC:(0.7751347732053344, 0.0)
Epoch 2 Test AUC:(0.7238378520256606, 0.0)
Epoch 2 a 0.3815594416868759 b 0.4904827617663493 c 0.38302325950541966
  0%|          | 3/1000 [02:35<14:22:05, 51.88s/it]Epoch 3 Valid AUC:(0.7827964422010462, 0.0)
Epoch 3 Test AUC:(0.7253843027597419, 0.0)
Epoch 3 a 0.37621892182160194 b 0.4948446742845493 c 0.37883233604296834
  0%|          | 4/1000 [03:28<14:24:48, 52.10s/it]Epoch 4 Valid AUC:(0.7854344499899657, 0.0)
Epoch 4 Test AUC:(0.7284088439090047, 0.0)
Epoch 4 a 0.3718961402324124 b 0.498740145438154 c 0.3748790854419501
  0%|          | 5/1000 [04:19<14:20:35, 51.89s/it]Epoch 5 Valid AUC:(0.7831867342835799, 0.0)
Epoch 5 Test AUC:(0.7264495633749174, 0.0)
Epoch 5 a 0.3687062802569008 b 0.4989067731608807 c 0.3716497814031674
  1%|          | 6/1000 [05:11<14:17:39, 51.77s/it]Epoch 6 Valid AUC:(0.7876125944925229, 0.0)
Epoch 6 Test AUC:(0.7272176539153273, 0.0)
Epoch 6 a 0.3661474231742997 b 0.4981589750264972 c 0.3685485610899551
  1%|          | 7/1000 [06:03<14:19:04, 51.91s/it]Epoch 7 Valid AUC:(0.7894314204200369, 0.0)
Epoch 7 Test AUC:(0.7261143588141344, 0.0)
Epoch 7 a 0.3631563405515682 b 0.4979367776655815 c 0.3652476490263488
  1%|          | 8/1000 [06:55<14:18:06, 51.90s/it]Epoch 8 Valid AUC:(0.7928805027214548, 0.0)
Epoch 8 Test AUC:(0.7267560026454661, 0.0)
Epoch 8 a 0.36048775227736657 b 0.49986200925090185 c 0.36203765467378934
  1%|          | 9/1000 [07:47<14:18:35, 51.98s/it]Epoch 9 Valid AUC:(0.7913188255994266, 0.0)
Epoch 9 Test AUC:(0.726165078587923, 0.0)
Epoch 9 a 0.35886785819736766 b 0.5005262097722328 c 0.35995524450087213
  1%|          | 10/1000 [08:39<14:16:02, 51.88s/it]Epoch 10 Valid AUC:(0.7925071622519456, 0.0)
Epoch 10 Test AUC:(0.7262139983933422, 0.0)
Epoch 10 a 0.35618571340438104 b 0.5012030368239827 c 0.35645410340556677
  1%|          | 11/1000 [09:30<14:14:17, 51.83s/it]Epoch 11 Valid AUC:(0.7930551631606659, 0.0)
Epoch 11 Test AUC:(0.7262679846180432, 0.0)
Epoch 11 a 0.3550364845835227 b 0.4975696550888315 c 0.35455295221666455
  1%|          | 12/1000 [10:22<14:13:42, 51.84s/it]Epoch 12 Valid AUC:(0.7935317858213022, 0.0)
Epoch 12 Test AUC:(0.7245812560640176, 0.0)
Epoch 12 a 0.3538867698109126 b 0.49517927874981515 c 0.35167076368207184
  1%|▏         | 13/1000 [11:14<14:12:19, 51.81s/it]Epoch 13 Valid AUC:(0.7930982541174003, 0.0)
Epoch 13 Test AUC:(0.7235338839705929, 0.0)
Epoch 13 a 0.3524188444288204 b 0.49070297322522705 c 0.3472720558494629
  1%|▏         | 14/1000 [12:06<14:11:24, 51.81s/it]Epoch 14 Valid AUC:(0.794101813446062, 0.0)
Epoch 14 Test AUC:(0.7245971992517827, 0.0)
Epoch 14 a 0.3507347876277248 b 0.4852281175628754 c 0.34165922610812505
  2%|▏         | 15/1000 [12:58<14:13:23, 51.98s/it]Epoch 15 Valid AUC:(0.7931813012576433, 0.0)
Epoch 15 Test AUC:(0.7231600805631638, 0.0)
Epoch 15 a 0.34932472678257426 b 0.4742156143639409 c 0.33546572785742085
  2%|▏         | 16/1000 [13:50<14:13:57, 52.07s/it]Epoch 16 Valid AUC:(0.7914140517053135, 0.0)
Epoch 16 Test AUC:(0.7239391504830806, 0.0)
Epoch 16 a 0.34787575705670254 b 0.45874701923047995 c 0.3286072249023967
  2%|▏         | 17/1000 [14:42<14:10:12, 51.90s/it]Epoch 17 Valid AUC:(0.7926570200475591, 0.0)
Epoch 17 Test AUC:(0.7255096036457251, 0.0)
Epoch 17 a 0.34631787405407405 b 0.443219317876597 c 0.32203855229095674
  2%|▏         | 18/1000 [15:34<14:08:36, 51.85s/it]Epoch 18 Valid AUC:(0.7958560343374703, 0.0)
Epoch 18 Test AUC:(0.7280375929507834, 0.0)
Epoch 18 a 0.3442573534171106 b 0.42552701945995663 c 0.3140138436850887
  2%|▏         | 19/1000 [16:25<14:06:33, 51.78s/it]Epoch 19 Valid AUC:(0.7944565323886, 0.0)
Epoch 19 Test AUC:(0.7299739014420008, 0.0)
Epoch 19 a 0.3421960842441505 b 0.40754937633902016 c 0.30687826464113815
  2%|▏         | 20/1000 [17:17<14:06:52, 51.85s/it]Epoch 20 Valid AUC:(0.7966643521462857, 0.0)
Epoch 20 Test AUC:(0.7351754936452801, 0.0)
Epoch 20 a 0.33900996490983176 b 0.39326976530508734 c 0.30179478839729396
  2%|▏         | 21/1000 [18:08<14:03:15, 51.68s/it]Epoch 21 Valid AUC:(0.8008675575895521, 0.0)
Epoch 21 Test AUC:(0.7407995354320118, 0.0)
Epoch 21 a 0.3347558966225062 b 0.3846593041055399 c 0.29579579302482684
  2%|▏         | 22/1000 [19:01<14:06:21, 51.92s/it]Epoch 22 Valid AUC:(0.8010444531246363, 0.0)
Epoch 22 Test AUC:(0.7431448942172058, 0.0)
Epoch 22 a 0.3301369535851047 b 0.37509728155625416 c 0.29052329099394186
  2%|▏         | 23/1000 [19:53<14:03:51, 51.82s/it]Epoch 23 Valid AUC:(0.8026850327194455, 0.0)
Epoch 23 Test AUC:(0.7430220645467033, 0.0)
Epoch 23 a 0.32570446005289705 b 0.36961788820548797 c 0.28517542812426083
  2%|▏         | 24/1000 [20:45<14:04:13, 51.90s/it]Epoch 24 Valid AUC:(0.8030300064389216, 0.0)
Epoch 24 Test AUC:(0.7447171558991383, 0.0)
Epoch 24 a 0.3211744844433767 b 0.3643023780653894 c 0.27907177712955705
  2%|▎         | 25/1000 [21:36<14:02:49, 51.87s/it]Epoch 25 Valid AUC:(0.8047868289614208, 0.0)
Epoch 25 Test AUC:(0.7484331670825256, 0.0)
Epoch 25 a 0.31744392549008194 b 0.3614524867932801 c 0.27447098439608064
  3%|▎         | 26/1000 [22:28<14:01:48, 51.86s/it]Epoch 26 Valid AUC:(0.8020975203395262, 0.0)
Epoch 26 Test AUC:(0.749752304471499, 0.0)
Epoch 26 a 0.3150114223990642 b 0.3538633157429801 c 0.2688205420850988
  3%|▎         | 27/1000 [23:20<14:01:32, 51.89s/it]Epoch 27 Valid AUC:(0.8054988928278296, 0.0)
Epoch 27 Test AUC:(0.7483235528567488, 0.0)
Epoch 27 a 0.3128527944356623 b 0.3483864549300081 c 0.2635732185492813
  3%|▎         | 28/1000 [24:12<14:01:28, 51.94s/it]Epoch 28 Valid AUC:(0.8033116246741707, 0.0)
Epoch 28 Test AUC:(0.749795529365118, 0.0)
Epoch 28 a 0.31159866221953686 b 0.34311461430680107 c 0.2594835733923634
  3%|▎         | 29/1000 [25:04<13:58:11, 51.79s/it]Epoch 29 Valid AUC:(0.8047452861674244, 0.0)
Epoch 29 Test AUC:(0.7514410211141036, 0.0)
Epoch 29 a 0.3098716202756049 b 0.3357961770874154 c 0.2540079444586871
  3%|▎         | 30/1000 [25:56<13:59:55, 51.95s/it]Epoch 30 Valid AUC:(0.8062146707468991, 0.0)
Epoch 30 Test AUC:(0.7515269022652533, 0.0)
Epoch 30 a 0.30768482551968074 b 0.32709435162170075 c 0.24910677228894992
  3%|▎         | 31/1000 [26:48<13:59:21, 51.97s/it]Epoch 31 Valid AUC:(0.8071513399615067, 0.0)
Epoch 31 Test AUC:(0.7516736873342669, 0.0)
Epoch 31 a 0.3046871364956171 b 0.3187296739526438 c 0.24391042055858214
  3%|▎         | 32/1000 [27:40<13:58:44, 51.99s/it]Epoch 32 Valid AUC:(0.804481925487112, 0.0)
Epoch 32 Test AUC:(0.7498895467153337, 0.0)
Epoch 32 a 0.30201601808219847 b 0.3110123234135764 c 0.2390458454008793
  3%|▎         | 33/1000 [28:32<13:59:07, 52.07s/it]Epoch 33 Valid AUC:(0.805453352749413, 0.0)
Epoch 33 Test AUC:(0.7524168861505769, 0.0)
Epoch 33 a 0.29925340947730683 b 0.30276290823516233 c 0.23338302085457194
  3%|▎         | 34/1000 [29:25<13:59:34, 52.15s/it]Epoch 34 Valid AUC:(0.802156000649039, 0.0)
Epoch 34 Test AUC:(0.7515078251658144, 0.0)
Epoch 34 a 0.29685728377859355 b 0.29692662577753814 c 0.22888749151282628
  4%|▎         | 35/1000 [30:17<14:01:14, 52.30s/it]Epoch 35 Valid AUC:(0.8065739111448503, 0.0)
Epoch 35 Test AUC:(0.7589504463962172, 0.0)
Epoch 35 a 0.2934651531024238 b 0.2902597296885561 c 0.22243798969377215
  4%|▎         | 36/1000 [31:09<13:58:56, 52.22s/it]Epoch 36 Valid AUC:(0.8036822084399968, 0.0)
Epoch 36 Test AUC:(0.7564615005855733, 0.0)
Epoch 36 a 0.2911922011217121 b 0.28599695891321786 c 0.21844897276798725
  4%|▎         | 37/1000 [32:02<13:58:29, 52.24s/it]  4%|▎         | 37/1000 [32:53<14:16:15, 53.35s/it]
[32m[I 2021-05-14 01:56:26,913][0m Trial 49 finished with value: 0.8071513399615067 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.14736811500605712, 'gamma': 0.002459373398181877}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-14 01:56:27.695135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7726541333392171, 0.0)
Epoch 0 Test AUC:(0.7186555549702451, 0.0)
Epoch 0 a 0.41988259013141355 b 0.5047213156377116 c 0.4208739062230433
  0%|          | 1/1000 [00:30<8:34:02, 30.87s/it]Epoch 1 Valid AUC:(0.7766869011878264, 0.0)
Epoch 1 Test AUC:(0.721268138513201, 0.0)
Epoch 1 a 0.38606308436682146 b 0.48423135460865113 c 0.3864529734897998
  0%|          | 2/1000 [01:01<8:31:48, 30.77s/it]Epoch 2 Valid AUC:(0.7761663071169779, 0.0)
Epoch 2 Test AUC:(0.7240343008300133, 0.0)
Epoch 2 a 0.3819556634031957 b 0.49240842978319815 c 0.3823439677155787
  0%|          | 3/1000 [01:32<8:29:23, 30.66s/it]Epoch 3 Valid AUC:(0.7792380016823915, 0.0)
Epoch 3 Test AUC:(0.7237825874386261, 0.0)
Epoch 3 a 0.378252265554282 b 0.499522770845121 c 0.37894286551783163
  0%|          | 4/1000 [02:02<8:29:51, 30.71s/it]Epoch 4 Valid AUC:(0.7803342226520077, 0.0)
Epoch 4 Test AUC:(0.7273723314822262, 0.0)
Epoch 4 a 0.37538470147598174 b 0.5061505259044708 c 0.37669408453568337
  0%|          | 5/1000 [02:33<8:28:32, 30.67s/it]Epoch 5 Valid AUC:(0.7865835673741866, 0.0)
Epoch 5 Test AUC:(0.7273718953853766, 0.0)
Epoch 5 a 0.3724893708863566 b 0.5108330261803442 c 0.37404765020455083
  1%|          | 6/1000 [03:04<8:29:08, 30.73s/it]Epoch 6 Valid AUC:(0.7848274510086978, 0.0)
Epoch 6 Test AUC:(0.7269107956497664, 0.0)
Epoch 6 a 0.3700436797113188 b 0.515821331811528 c 0.37198364878854445
  1%|          | 7/1000 [03:34<8:27:51, 30.69s/it]Epoch 7 Valid AUC:(0.7877518073877219, 0.0)
Epoch 7 Test AUC:(0.7282815378326053, 0.0)
Epoch 7 a 0.36908193184964116 b 0.5187360101169155 c 0.37136384736626377
  1%|          | 8/1000 [04:05<8:26:27, 30.63s/it]Epoch 8 Valid AUC:(0.7909040256393794, 0.0)
Epoch 8 Test AUC:(0.729089881822414, 0.0)
Epoch 8 a 0.36808774235748476 b 0.5207060480550412 c 0.3705153228534806
  1%|          | 9/1000 [04:36<8:26:03, 30.64s/it]Epoch 9 Valid AUC:(0.7882420777180565, 0.0)
Epoch 9 Test AUC:(0.7306454820394175, 0.0)
Epoch 9 a 0.36715626404170065 b 0.5212347966528708 c 0.3691509499424888
  1%|          | 10/1000 [05:06<8:22:32, 30.46s/it]Epoch 10 Valid AUC:(0.7903202401280378, 0.0)
Epoch 10 Test AUC:(0.7296442079482678, 0.0)
Epoch 10 a 0.36549409226544444 b 0.522143574491624 c 0.3673456266762749
  1%|          | 11/1000 [05:36<8:19:21, 30.29s/it]Epoch 11 Valid AUC:(0.7891001904896342, 0.0)
Epoch 11 Test AUC:(0.7291959431415046, 0.0)
Epoch 11 a 0.3652616462880565 b 0.5207831388519656 c 0.3661888539791107
  1%|          | 12/1000 [06:06<8:20:30, 30.39s/it]Epoch 12 Valid AUC:(0.7893828826987032, 0.0)
Epoch 12 Test AUC:(0.7285946040650836, 0.0)
Epoch 12 a 0.36383926135397726 b 0.5186612344076557 c 0.3637735425464569
  1%|▏         | 13/1000 [06:37<8:22:02, 30.52s/it]Epoch 13 Valid AUC:(0.790284437583133, 0.0)
Epoch 13 Test AUC:(0.7282511777960485, 0.0)
Epoch 13 a 0.3612567409873009 b 0.5162155607775334 c 0.3604371693105467
  1%|▏         | 14/1000 [07:08<8:21:30, 30.52s/it]Epoch 14 Valid AUC:(0.7932541110436231, 0.0)
Epoch 14 Test AUC:(0.7283283327347476, 0.0)
Epoch 14 a 0.35857864986023597 b 0.5166875160028858 c 0.35726426469702877
  2%|▏         | 15/1000 [07:38<8:22:17, 30.60s/it]Epoch 15 Valid AUC:(0.7911053252430518, 0.0)
Epoch 15 Test AUC:(0.7251823343374206, 0.0)
Epoch 15 a 0.3569313137521667 b 0.5192098744934605 c 0.3544243822895711
  2%|▏         | 16/1000 [08:09<8:22:41, 30.65s/it]Epoch 16 Valid AUC:(0.791969397415897, 0.0)
Epoch 16 Test AUC:(0.724612428437843, 0.0)
Epoch 16 a 0.3555062801366852 b 0.5240899986557422 c 0.35238266952576175
  2%|▏         | 17/1000 [08:40<8:21:47, 30.63s/it]Epoch 17 Valid AUC:(0.7918383367253135, 0.0)
Epoch 17 Test AUC:(0.7240448612145077, 0.0)
Epoch 17 a 0.3542209107789301 b 0.5348634360538375 c 0.34963454222006185
  2%|▏         | 18/1000 [09:10<8:21:01, 30.61s/it]Epoch 18 Valid AUC:(0.7932552490970264, 0.0)
Epoch 18 Test AUC:(0.7232687969424857, 0.0)
Epoch 18 a 0.35294599674882426 b 0.5445310830348923 c 0.346042737364769
  2%|▏         | 19/1000 [09:41<8:22:56, 30.76s/it]Epoch 19 Valid AUC:(0.7940040818284594, 0.0)
Epoch 19 Test AUC:(0.7225568859374025, 0.0)
Epoch 19 a 0.35186483951345565 b 0.5479517478135324 c 0.34162297244033507
  2%|▏         | 20/1000 [10:12<8:22:10, 30.75s/it]Epoch 20 Valid AUC:(0.7919021561457252, 0.0)
Epoch 20 Test AUC:(0.7249194192426427, 0.0)
Epoch 20 a 0.35094068451754507 b 0.5498129399793763 c 0.33701220563342493
  2%|▏         | 21/1000 [10:43<8:21:53, 30.76s/it]Epoch 21 Valid AUC:(0.7954743263559451, 0.0)
Epoch 21 Test AUC:(0.725614480662587, 0.0)
Epoch 21 a 0.3494939544508534 b 0.5468941646958551 c 0.3315225858842173
  2%|▏         | 22/1000 [11:14<8:22:01, 30.80s/it]Epoch 22 Valid AUC:(0.795053895082098, 0.0)
Epoch 22 Test AUC:(0.7256640118586876, 0.0)
Epoch 22 a 0.34823152915604655 b 0.5453537052437183 c 0.326795669452798
  2%|▏         | 23/1000 [11:45<8:21:44, 30.81s/it]Epoch 23 Valid AUC:(0.7951077039899722, 0.0)
Epoch 23 Test AUC:(0.7250688850246433, 0.0)
Epoch 23 a 0.3466997551581552 b 0.5427468649802669 c 0.32177552532765175
  2%|▏         | 24/1000 [12:16<8:22:12, 30.87s/it]Epoch 24 Valid AUC:(0.7963480847986352, 0.0)
Epoch 24 Test AUC:(0.7272994049727841, 0.0)
Epoch 24 a 0.34529282621318297 b 0.5374030534538531 c 0.31689188641405874
  2%|▎         | 25/1000 [12:46<8:21:03, 30.83s/it]Epoch 25 Valid AUC:(0.7955820338831102, 0.0)
Epoch 25 Test AUC:(0.7319484154376079, 0.0)
Epoch 25 a 0.3435461589645955 b 0.5293492125647683 c 0.31174668958110197
  3%|▎         | 26/1000 [13:17<8:18:10, 30.69s/it]Epoch 26 Valid AUC:(0.7966433814617826, 0.0)
Epoch 26 Test AUC:(0.7359163409589699, 0.0)
Epoch 26 a 0.3414459943531021 b 0.5207968970700618 c 0.3065422792588511
  3%|▎         | 27/1000 [13:47<8:17:58, 30.71s/it]Epoch 27 Valid AUC:(0.7986886915508844, 0.0)
Epoch 27 Test AUC:(0.7359669324689792, 0.0)
Epoch 27 a 0.33809942475730376 b 0.5122514386330882 c 0.3004592044218894
  3%|▎         | 28/1000 [14:18<8:18:50, 30.79s/it]Epoch 28 Valid AUC:(0.8012734094765563, 0.0)
Epoch 28 Test AUC:(0.738508026056821, 0.0)
Epoch 28 a 0.33425879394335134 b 0.5076135464252964 c 0.2964994871327954
  3%|▎         | 29/1000 [14:49<8:17:36, 30.75s/it]Epoch 29 Valid AUC:(0.8001004621768156, 0.0)
Epoch 29 Test AUC:(0.7399583730165433, 0.0)
Epoch 29 a 0.3297705334280768 b 0.5038547946080085 c 0.2905006930232048
  3%|▎         | 30/1000 [15:20<8:16:34, 30.72s/it]Epoch 30 Valid AUC:(0.8034263578868731, 0.0)
Epoch 30 Test AUC:(0.7426556192047459, 0.0)
Epoch 30 a 0.32567962415276036 b 0.5000298703389783 c 0.2848075396351276
  3%|▎         | 31/1000 [15:50<8:14:26, 30.62s/it]Epoch 31 Valid AUC:(0.8052948865025492, 0.0)
Epoch 31 Test AUC:(0.743840686740692, 0.0)
Epoch 31 a 0.32260265177296055 b 0.49368723998627356 c 0.27940774889242265
  3%|▎         | 32/1000 [16:20<8:10:52, 30.43s/it]Epoch 32 Valid AUC:(0.8017318758279979, 0.0)
Epoch 32 Test AUC:(0.747795653344887, 0.0)
Epoch 32 a 0.32054395925614143 b 0.485840851861623 c 0.2752475629770948
  3%|▎         | 33/1000 [16:50<8:09:33, 30.38s/it]Epoch 33 Valid AUC:(0.8027258732012066, 0.0)
Epoch 33 Test AUC:(0.7446557132734015, 0.0)
Epoch 33 a 0.3185779881333151 b 0.4818891811995737 c 0.2699112598934481
  3%|▎         | 34/1000 [17:21<8:11:25, 30.52s/it]Epoch 34 Valid AUC:(0.803820114111692, 0.0)
Epoch 34 Test AUC:(0.7478264195500781, 0.0)
Epoch 34 a 0.31691916310979473 b 0.4709681804862715 c 0.26489001987201555
  4%|▎         | 35/1000 [17:51<8:08:45, 30.39s/it]Epoch 35 Valid AUC:(0.8047094144165693, 0.0)
Epoch 35 Test AUC:(0.7511057011159192, 0.0)
Epoch 35 a 0.3144854966911577 b 0.4647742039974659 c 0.2598733575714211
  4%|▎         | 36/1000 [18:22<8:07:42, 30.36s/it]Epoch 36 Valid AUC:(0.8059066389073227, 0.0)
Epoch 36 Test AUC:(0.7488970544176057, 0.0)
Epoch 36 a 0.3136689504308085 b 0.4587239796115506 c 0.2565143053690272
  4%|▎         | 37/1000 [18:52<8:07:42, 30.39s/it]Epoch 37 Valid AUC:(0.8056027824934086, 0.0)
Epoch 37 Test AUC:(0.7507734808257344, 0.0)
Epoch 37 a 0.31225120083939645 b 0.4490377650626244 c 0.25272663442357896
  4%|▍         | 38/1000 [19:22<8:06:58, 30.37s/it]Epoch 38 Valid AUC:(0.8051708579054613, 0.0)
Epoch 38 Test AUC:(0.7502117795325717, 0.0)
Epoch 38 a 0.3114994981836888 b 0.44394971670642974 c 0.24952002837052267
  4%|▍         | 39/1000 [19:53<8:06:40, 30.39s/it]Epoch 39 Valid AUC:(0.8041192132573256, 0.0)
Epoch 39 Test AUC:(0.7517689873222755, 0.0)
Epoch 39 a 0.3099255657965137 b 0.4343966638609286 c 0.2455000091464289
  4%|▍         | 40/1000 [20:23<8:05:45, 30.36s/it]Epoch 40 Valid AUC:(0.8034238485303824, 0.0)
Epoch 40 Test AUC:(0.7504130938096185, 0.0)
Epoch 40 a 0.30827888882448595 b 0.4289716639586033 c 0.24233941012813198
  4%|▍         | 41/1000 [20:53<8:05:31, 30.38s/it]Epoch 41 Valid AUC:(0.8029161177951301, 0.0)
Epoch 41 Test AUC:(0.7498859382276765, 0.0)
Epoch 41 a 0.3065964210658304 b 0.41900377912867454 c 0.23981395357799146
  4%|▍         | 42/1000 [21:24<8:07:04, 30.51s/it]  4%|▍         | 42/1000 [21:56<8:20:27, 31.34s/it]
[32m[I 2021-05-14 02:18:43,735][0m Trial 50 finished with value: 0.8059066389073227 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 1024, 'learning_rate': 0.005, 'alpha': 0.1562674971544388, 'gamma': 0.002995863184631848}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-14 02:18:44.423312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7781688530552212, 0.0)
Epoch 0 Test AUC:(0.7189628792608709, 0.0)
Epoch 0 a 0.41255941081574743 b 0.500976676912135 c 0.4142504401010287
  0%|          | 1/1000 [00:51<14:14:23, 51.31s/it]Epoch 1 Valid AUC:(0.7780909912348767, 0.0)
Epoch 1 Test AUC:(0.7222875662045789, 0.0)
Epoch 1 a 0.38624322054611604 b 0.4848487516284229 c 0.38760046585944574
  0%|          | 2/1000 [01:42<14:14:58, 51.40s/it]Epoch 2 Valid AUC:(0.7758580138327008, 0.0)
Epoch 2 Test AUC:(0.7247664860631421, 0.0)
Epoch 2 a 0.38119241613257576 b 0.49036306658501116 c 0.3828826719966213
  0%|          | 3/1000 [02:33<14:10:22, 51.18s/it]Epoch 3 Valid AUC:(0.7815330773273659, 0.0)
Epoch 3 Test AUC:(0.7255186376912461, 0.0)
Epoch 3 a 0.37738803340875404 b 0.4964524962652617 c 0.37980627198094574
  0%|          | 4/1000 [03:25<14:12:14, 51.34s/it]Epoch 4 Valid AUC:(0.7836171504381311, 0.0)
Epoch 4 Test AUC:(0.7281234741019332, 0.0)
Epoch 4 a 0.3746320198119526 b 0.4988861309450637 c 0.3770316450648624
  0%|          | 5/1000 [04:16<14:09:27, 51.22s/it]Epoch 5 Valid AUC:(0.7799435947924562, 0.0)
Epoch 5 Test AUC:(0.7242761934913665, 0.0)
Epoch 5 a 0.3715289834759365 b 0.4965547910878356 c 0.373330695168593
  1%|          | 6/1000 [05:08<14:13:33, 51.52s/it]Epoch 6 Valid AUC:(0.7860140664836034, 0.0)
Epoch 6 Test AUC:(0.7254292891425963, 0.0)
Epoch 6 a 0.36790011238524134 b 0.49676150173488515 c 0.3691161471593308
  1%|          | 7/1000 [05:59<14:12:53, 51.53s/it]Epoch 7 Valid AUC:(0.7892338310242503, 0.0)
Epoch 7 Test AUC:(0.7250826776563757, 0.0)
Epoch 7 a 0.3647374997076614 b 0.4964321864922522 c 0.3653402344681607
  1%|          | 8/1000 [06:51<14:14:17, 51.67s/it]Epoch 8 Valid AUC:(0.7928104727078082, 0.0)
Epoch 8 Test AUC:(0.7264322605910919, 0.0)
Epoch 8 a 0.361971028014208 b 0.4954384101828339 c 0.36162141049411933
  1%|          | 9/1000 [07:43<14:12:52, 51.64s/it]Epoch 9 Valid AUC:(0.790910836017516, 0.0)
Epoch 9 Test AUC:(0.7244794188987247, 0.0)
Epoch 9 a 0.3596822434747723 b 0.4954566859623316 c 0.35787723259906656
  1%|          | 10/1000 [08:35<14:13:27, 51.73s/it]Epoch 10 Valid AUC:(0.7944005063271361, 0.0)
Epoch 10 Test AUC:(0.7245834151709688, 0.0)
Epoch 10 a 0.3560881775989379 b 0.4946278097404081 c 0.3516291069912479
  1%|          | 11/1000 [09:26<14:10:59, 51.63s/it]Epoch 11 Valid AUC:(0.7934744525363345, 0.0)
Epoch 11 Test AUC:(0.7244065950003061, 0.0)
Epoch 11 a 0.3538386334235999 b 0.4899246696854981 c 0.34599884451035284
  1%|          | 12/1000 [10:18<14:09:41, 51.60s/it]Epoch 12 Valid AUC:(0.7942074858056546, 0.0)
Epoch 12 Test AUC:(0.7222940862800259, 0.0)
Epoch 12 a 0.35151631437556846 b 0.4870638158359758 c 0.3405295294415303
  1%|▏         | 13/1000 [11:09<14:07:20, 51.51s/it]Epoch 13 Valid AUC:(0.7942768032543324, 0.0)
Epoch 13 Test AUC:(0.7209608869053836, 0.0)
Epoch 13 a 0.349265241706875 b 0.4822578093175677 c 0.33460356885758447
  1%|▏         | 14/1000 [12:01<14:09:04, 51.67s/it]Epoch 14 Valid AUC:(0.7945704646065084, 0.0)
Epoch 14 Test AUC:(0.7210769827274736, 0.0)
Epoch 14 a 0.3475276158609141 b 0.47888961182513706 c 0.32975663379644243
  2%|▏         | 15/1000 [12:52<14:06:26, 51.56s/it]Epoch 15 Valid AUC:(0.7925508260801567, 0.0)
Epoch 15 Test AUC:(0.720721213207412, 0.0)
Epoch 15 a 0.34617536348596184 b 0.47337471959096805 c 0.32492950042968305
  2%|▏         | 16/1000 [13:44<14:06:57, 51.64s/it]Epoch 16 Valid AUC:(0.7914519342734995, 0.0)
Epoch 16 Test AUC:(0.7213583165009569, 0.0)
Epoch 16 a 0.34447412219805496 b 0.465537518382792 c 0.3203860719798796
  2%|▏         | 17/1000 [14:36<14:03:58, 51.51s/it]Epoch 17 Valid AUC:(0.7934484721099918, 0.0)
Epoch 17 Test AUC:(0.7245000522653523, 0.0)
Epoch 17 a 0.3417559504149186 b 0.45712540201258134 c 0.31581793158826693
  2%|▏         | 18/1000 [15:28<14:06:51, 51.74s/it]Epoch 18 Valid AUC:(0.7980553622687478, 0.0)
Epoch 18 Test AUC:(0.7304027471125804, 0.0)
Epoch 18 a 0.3364699695191873 b 0.44772308195380855 c 0.3101075808527004
  2%|▏         | 19/1000 [16:20<14:06:50, 51.79s/it]Epoch 19 Valid AUC:(0.797430405624994, 0.0)
Epoch 19 Test AUC:(0.73277599471885, 0.0)
Epoch 19 a 0.33101570390359736 b 0.4386498838723066 c 0.30512145239582483
  2%|▏         | 20/1000 [17:12<14:07:24, 51.88s/it]Epoch 20 Valid AUC:(0.7992961134574036, 0.0)
Epoch 20 Test AUC:(0.7364009728226196, 0.0)
Epoch 20 a 0.32618670084586804 b 0.42849235695372645 c 0.299193982717017
  2%|▏         | 21/1000 [18:04<14:05:45, 51.83s/it]Epoch 21 Valid AUC:(0.8013125134016041, 0.0)
Epoch 21 Test AUC:(0.7396661068936057, 0.0)
Epoch 21 a 0.32137469926350554 b 0.4164665122507084 c 0.29247330066183924
  2%|▏         | 22/1000 [18:56<14:07:14, 51.98s/it]Epoch 22 Valid AUC:(0.8004823495811748, 0.0)
Epoch 22 Test AUC:(0.7410548359337596, 0.0)
Epoch 22 a 0.3172825340413951 b 0.4045411910809262 c 0.2864053220876026
  2%|▏         | 23/1000 [19:48<14:07:24, 52.04s/it]Epoch 23 Valid AUC:(0.8011710410602901, 0.0)
Epoch 23 Test AUC:(0.7424592302568236, 0.0)
Epoch 23 a 0.31488234794115877 b 0.3927938691087412 c 0.2808579901154612
  2%|▏         | 24/1000 [20:41<14:10:13, 52.27s/it]Epoch 24 Valid AUC:(0.800909806540559, 0.0)
Epoch 24 Test AUC:(0.7432989518425047, 0.0)
Epoch 24 a 0.3125304068837847 b 0.38033364140531667 c 0.27446394610093156
  2%|▎         | 25/1000 [21:33<14:07:35, 52.16s/it]Epoch 25 Valid AUC:(0.803531122879563, 0.0)
Epoch 25 Test AUC:(0.7466094100576307, 0.0)
Epoch 25 a 0.31064626688448715 b 0.36989648511232265 c 0.2694724106512799
  3%|▎         | 26/1000 [22:25<14:08:30, 52.27s/it]Epoch 26 Valid AUC:(0.8013838826785463, 0.0)
Epoch 26 Test AUC:(0.7471333761469278, 0.0)
Epoch 26 a 0.30965859369492865 b 0.35894775402617884 c 0.26415392003908483
  3%|▎         | 27/1000 [23:17<14:06:59, 52.23s/it]Epoch 27 Valid AUC:(0.802344422819607, 0.0)
Epoch 27 Test AUC:(0.7454795472522886, 0.0)
Epoch 27 a 0.3085497045061238 b 0.34893379814667963 c 0.25840576247909897
  3%|▎         | 28/1000 [24:10<14:07:27, 52.31s/it]2021-05-14 02:43:56.059500: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 77977851 get requests, put_count=77977851 evicted_count=45000 eviction_rate=0.000577087 and unsatisfied allocation rate=0.000577254
Epoch 28 Valid AUC:(0.8011328304046367, 0.0)
Epoch 28 Test AUC:(0.7472654194322422, 0.0)
Epoch 28 a 0.30801065251141246 b 0.3396960216268927 c 0.25424572141837304
  3%|▎         | 29/1000 [25:02<14:07:25, 52.36s/it]Epoch 29 Valid AUC:(0.8025191896309268, 0.0)
Epoch 29 Test AUC:(0.7493365374309472, 0.0)
Epoch 29 a 0.3070789655329476 b 0.33070509252653757 c 0.24913568180091905
  3%|▎         | 30/1000 [25:56<14:10:30, 52.61s/it]Epoch 30 Valid AUC:(0.803424142014875, 0.0)
Epoch 30 Test AUC:(0.7493712370587031, 0.0)
Epoch 30 a 0.3059578761008664 b 0.3226373426511254 c 0.24494781667437832
  3%|▎         | 31/1000 [26:48<14:07:29, 52.48s/it]Epoch 31 Valid AUC:(0.8037083836682734, 0.0)
Epoch 31 Test AUC:(0.7492377144644676, 0.0)
Epoch 31 a 0.304538636500207 b 0.31585755971236007 c 0.24091036171020877
  3%|▎         | 32/1000 [27:40<14:06:25, 52.46s/it]Epoch 32 Valid AUC:(0.8008781358471997, 0.0)
Epoch 32 Test AUC:(0.7469040747132409, 0.0)
Epoch 32 a 0.3036339378932592 b 0.3092510346435685 c 0.23662831482872876
  3%|▎         | 33/1000 [28:33<14:06:09, 52.50s/it]Epoch 33 Valid AUC:(0.8009513147315804, 0.0)
Epoch 33 Test AUC:(0.7486837816808702, 0.0)
Epoch 33 a 0.30256811201092704 b 0.3029722524001085 c 0.23341453231316456
  3%|▎         | 34/1000 [29:26<14:06:24, 52.57s/it]Epoch 34 Valid AUC:(0.8000990537075698, 0.0)
Epoch 34 Test AUC:(0.7495287022250717, 0.0)
Epoch 34 a 0.301978621744294 b 0.2979318340359559 c 0.23048071611215412
  4%|▎         | 35/1000 [30:18<14:04:37, 52.52s/it]Epoch 35 Valid AUC:(0.803494912788507, 0.0)
Epoch 35 Test AUC:(0.7560430827602497, 0.0)
Epoch 35 a 0.30029357145249963 b 0.29240463146381457 c 0.2267876617925268
  4%|▎         | 36/1000 [31:09<13:58:52, 52.21s/it]Epoch 36 Valid AUC:(0.8002479208328221, 0.0)
Epoch 36 Test AUC:(0.7536832558207525, 0.0)
Epoch 36 a 0.2987891690472002 b 0.2880797346592909 c 0.22444137304241749
  4%|▎         | 37/1000 [32:01<13:57:23, 52.17s/it]  4%|▎         | 37/1000 [32:53<14:16:16, 53.35s/it]
[32m[I 2021-05-14 02:51:57,666][0m Trial 51 finished with value: 0.8037083836682734 and parameters: {'rank': 70.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.14724522171719867, 'gamma': 0.0024960673570754498}. Best is trial 44 with value: 0.8074767412129923.[0m
2021-05-14 02:51:58.342538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7791557222155591, 0.0)
Epoch 0 Test AUC:(0.7193000548083955, 0.0)
Epoch 0 a 0.41271119494313446 b 0.5010428446639231 c 0.4141652976243309
  0%|          | 1/1000 [00:51<14:23:26, 51.86s/it]Epoch 1 Valid AUC:(0.7779948308486621, 0.0)
Epoch 1 Test AUC:(0.7215178809178465, 0.0)
Epoch 1 a 0.3861318251016874 b 0.4856768820127491 c 0.387229338678076
  0%|          | 2/1000 [01:43<14:22:15, 51.84s/it]Epoch 2 Valid AUC:(0.7750892062134928, 0.0)
Epoch 2 Test AUC:(0.7238240038129572, 0.0)
Epoch 2 a 0.38154657997595715 b 0.49088085555214755 c 0.3830427071697995
  0%|          | 3/1000 [02:35<14:20:10, 51.77s/it]Epoch 3 Valid AUC:(0.7829365509288227, 0.0)
Epoch 3 Test AUC:(0.7254280065048035, 0.0)
Epoch 3 a 0.3762147660466507 b 0.49519712674305955 c 0.3788595335104576
  0%|          | 4/1000 [03:27<14:20:04, 51.81s/it]Epoch 4 Valid AUC:(0.7855345153860002, 0.0)
Epoch 4 Test AUC:(0.7283828875955368, 0.0)
Epoch 4 a 0.3719077619988194 b 0.4991566093275005 c 0.37493773869105745
  0%|          | 5/1000 [04:18<14:17:47, 51.73s/it]Epoch 5 Valid AUC:(0.7833066310291225, 0.0)
Epoch 5 Test AUC:(0.726595202620836, 0.0)
Epoch 5 a 0.3687994764364461 b 0.49964095960920246 c 0.3718316375129899
  1%|          | 6/1000 [05:10<14:17:54, 51.79s/it]Epoch 6 Valid AUC:(0.7876499657056322, 0.0)
Epoch 6 Test AUC:(0.7273530491607404, 0.0)
Epoch 6 a 0.3663293543595903 b 0.49918573327227617 c 0.3688438311069304
  1%|          | 7/1000 [06:02<14:18:53, 51.90s/it]Epoch 7 Valid AUC:(0.7892565754316252, 0.0)
Epoch 7 Test AUC:(0.7261729967385642, 0.0)
Epoch 7 a 0.36342971497618215 b 0.4987333860675574 c 0.365623608861171
  1%|          | 8/1000 [06:54<14:16:22, 51.80s/it]Epoch 8 Valid AUC:(0.7929140163436362, 0.0)
Epoch 8 Test AUC:(0.7267578795721029, 0.0)
Epoch 8 a 0.36062661640840754 b 0.5005360074806021 c 0.3623583307808314
  1%|          | 9/1000 [07:46<14:16:58, 51.89s/it]Epoch 9 Valid AUC:(0.7915442050289945, 0.0)
Epoch 9 Test AUC:(0.7263456141327257, 0.0)
Epoch 9 a 0.3589247113742099 b 0.5015809687090592 c 0.3602571532400081
  1%|          | 10/1000 [08:38<14:18:52, 52.05s/it]Epoch 10 Valid AUC:(0.7925240305615117, 0.0)
Epoch 10 Test AUC:(0.7267352324641406, 0.0)
Epoch 10 a 0.3562745327800812 b 0.5028396698550679 c 0.3568647510448932
  1%|          | 11/1000 [09:30<14:17:45, 52.04s/it]Epoch 11 Valid AUC:(0.793056768995029, 0.0)
Epoch 11 Test AUC:(0.7261610938598466, 0.0)
Epoch 11 a 0.3552649512857019 b 0.4999143930987813 c 0.3551507911212008
  1%|          | 12/1000 [10:22<14:16:31, 52.02s/it]Epoch 12 Valid AUC:(0.7937065757012721, 0.0)
Epoch 12 Test AUC:(0.7250488715996155, 0.0)
Epoch 12 a 0.3542179078523302 b 0.49749640056065153 c 0.352600313408274
  1%|▏         | 13/1000 [11:15<14:16:13, 52.05s/it]Epoch 13 Valid AUC:(0.7928889035548544, 0.0)
Epoch 13 Test AUC:(0.7235643166899579, 0.0)
Epoch 13 a 0.35287649308891605 b 0.4919174504232119 c 0.3488987648870863
  1%|▏         | 14/1000 [12:06<14:12:23, 51.87s/it]Epoch 14 Valid AUC:(0.7945091853007874, 0.0)
Epoch 14 Test AUC:(0.7252468980484533, 0.0)
Epoch 14 a 0.35137518131037354 b 0.48625081363818057 c 0.34374449952267544
  2%|▏         | 15/1000 [12:58<14:13:22, 51.98s/it]Epoch 15 Valid AUC:(0.7929408413388896, 0.0)
Epoch 15 Test AUC:(0.7233991941759659, 0.0)
Epoch 15 a 0.35013553458200375 b 0.47565353708248026 c 0.3377930885949125
  2%|▏         | 16/1000 [13:50<14:13:12, 52.03s/it]Epoch 16 Valid AUC:(0.792040957649998, 0.0)
Epoch 16 Test AUC:(0.724222309877689, 0.0)
Epoch 16 a 0.3487430743768182 b 0.46073366009013755 c 0.3312756494137363
  2%|▏         | 17/1000 [14:43<14:13:57, 52.12s/it]Epoch 17 Valid AUC:(0.792973072087809, 0.0)
Epoch 17 Test AUC:(0.726053403590759, 0.0)
Epoch 17 a 0.34735062622448326 b 0.44626138177915836 c 0.3250784259326981
  2%|▏         | 18/1000 [15:35<14:14:03, 52.18s/it]Epoch 18 Valid AUC:(0.7955493353532311, 0.0)
Epoch 18 Test AUC:(0.7284761823931293, 0.0)
Epoch 18 a 0.34514994436586405 b 0.42884739903616953 c 0.3170435354863134
  2%|▏         | 19/1000 [16:27<14:11:58, 52.11s/it]Epoch 19 Valid AUC:(0.7947431142283886, 0.0)
Epoch 19 Test AUC:(0.7316293037056658, 0.0)
Epoch 19 a 0.34286706368448266 b 0.4112807428333121 c 0.3100497315467243
  2%|▏         | 20/1000 [17:19<14:13:02, 52.23s/it]Epoch 20 Valid AUC:(0.7968682239044406, 0.0)
Epoch 20 Test AUC:(0.7366200687349347, 0.0)
Epoch 20 a 0.3390885960887855 b 0.3996831292597581 c 0.3047458820299843
  2%|▏         | 21/1000 [18:12<14:13:47, 52.33s/it]Epoch 21 Valid AUC:(0.8005858240110526, 0.0)
Epoch 21 Test AUC:(0.7418381556602299, 0.0)
Epoch 21 a 0.33469210496131085 b 0.39252125755162304 c 0.29841112958593385
  2%|▏         | 22/1000 [19:04<14:12:29, 52.30s/it]Epoch 22 Valid AUC:(0.8003733912205393, 0.0)
Epoch 22 Test AUC:(0.7424785168537686, 0.0)
Epoch 22 a 0.3301199740567198 b 0.3837373257282994 c 0.2926265090344178
  2%|▏         | 23/1000 [19:56<14:07:30, 52.05s/it]Epoch 23 Valid AUC:(0.8024551882244979, 0.0)
Epoch 23 Test AUC:(0.7426100299821287, 0.0)
Epoch 23 a 0.3261994942572995 b 0.3778735440022029 c 0.2873961793884665
  2%|▏         | 24/1000 [20:48<14:06:25, 52.03s/it]Epoch 24 Valid AUC:(0.8020065862841435, 0.0)
Epoch 24 Test AUC:(0.7442406303063394, 0.0)
Epoch 24 a 0.32256264879669944 b 0.3713438939040815 c 0.2811672719011844
  2%|▎         | 25/1000 [21:40<14:05:06, 52.01s/it]Epoch 25 Valid AUC:(0.8047504189420643, 0.0)
Epoch 25 Test AUC:(0.748469615373139, 0.0)
Epoch 25 a 0.31923290805317744 b 0.367036682559211 c 0.27670680834973604
  3%|▎         | 26/1000 [22:32<14:05:55, 52.11s/it]Epoch 26 Valid AUC:(0.8018322834090084, 0.0)
Epoch 26 Test AUC:(0.7487129574151982, 0.0)
Epoch 26 a 0.3170038714135437 b 0.3591677531510052 c 0.27112300640020814
  3%|▎         | 27/1000 [23:24<14:04:07, 52.05s/it]Epoch 27 Valid AUC:(0.8044794943077131, 0.0)
Epoch 27 Test AUC:(0.7471861994466966, 0.0)
Epoch 27 a 0.3148432802746234 b 0.35368063878005657 c 0.26598388727162203
  3%|▎         | 28/1000 [24:15<14:00:16, 51.87s/it]Epoch 28 Valid AUC:(0.8033661397390552, 0.0)
Epoch 28 Test AUC:(0.7488908378997697, 0.0)
Epoch 28 a 0.3134230899379047 b 0.3477942728900334 c 0.262080662567131
  3%|▎         | 29/1000 [25:07<13:59:14, 51.86s/it]Epoch 29 Valid AUC:(0.8045215292329112, 0.0)
Epoch 29 Test AUC:(0.7502835602189187, 0.0)
Epoch 29 a 0.3117881421471985 b 0.34142659253757485 c 0.25620263958840783
  3%|▎         | 30/1000 [25:58<13:52:04, 51.47s/it]Epoch 30 Valid AUC:(0.805625143704874, 0.0)
Epoch 30 Test AUC:(0.7503314624650224, 0.0)
Epoch 30 a 0.30975285418316634 b 0.3333874494137179 c 0.25141289575358994
  3%|▎         | 31/1000 [26:48<13:43:39, 51.00s/it]Epoch 31 Valid AUC:(0.8075322610457464, 0.0)
Epoch 31 Test AUC:(0.7516627849130277, 0.0)
Epoch 31 a 0.30688647922855505 b 0.3258779949585437 c 0.2455948618516116
  3%|▎         | 32/1000 [27:39<13:45:28, 51.17s/it]Epoch 32 Valid AUC:(0.8041669909947987, 0.0)
Epoch 32 Test AUC:(0.7493945810665329, 0.0)
Epoch 32 a 0.3038132588568348 b 0.32085367161743117 c 0.2415060021088157
  3%|▎         | 33/1000 [28:30<13:43:50, 51.12s/it]Epoch 33 Valid AUC:(0.8059534721117347, 0.0)
Epoch 33 Test AUC:(0.7521829030889462, 0.0)
Epoch 33 a 0.30042145915434393 b 0.31498450052810145 c 0.23632587654369938
  3%|▎         | 34/1000 [29:21<13:42:30, 51.09s/it]Epoch 34 Valid AUC:(0.802366712261939, 0.0)
Epoch 34 Test AUC:(0.7522713837193562, 0.0)
Epoch 34 a 0.29782828967456126 b 0.3099524754753535 c 0.23156509010244902
  4%|▎         | 35/1000 [30:13<13:43:58, 51.23s/it]Epoch 35 Valid AUC:(0.8064394375756485, 0.0)
Epoch 35 Test AUC:(0.7594664216520649, 0.0)
Epoch 35 a 0.2943527256279164 b 0.3031776524945284 c 0.22632874725330285
  4%|▎         | 36/1000 [31:04<13:43:08, 51.23s/it]Epoch 36 Valid AUC:(0.804531585882749, 0.0)
Epoch 36 Test AUC:(0.757444304692506, 0.0)
Epoch 36 a 0.29177631344833604 b 0.29801918866049115 c 0.22258199901288184
  4%|▎         | 37/1000 [31:55<13:42:57, 51.28s/it]  4%|▎         | 37/1000 [32:47<14:13:19, 53.17s/it]
[32m[I 2021-05-14 03:25:04,713][0m Trial 52 finished with value: 0.8075322610457464 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.137682004064161, 'gamma': 0.002311893139422969}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 03:25:05.506105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.778238248680991, 0.0)
Epoch 0 Test AUC:(0.7200677990366013, 0.0)
Epoch 0 a 0.41268952355778193 b 0.5025366079999167 c 0.41442861241593926
  0%|          | 1/1000 [00:52<14:28:42, 52.17s/it]Epoch 1 Valid AUC:(0.778757475293527, 0.0)
Epoch 1 Test AUC:(0.7221575024569248, 0.0)
Epoch 1 a 0.3862521897859017 b 0.48610755705257774 c 0.3875404050052766
  0%|          | 2/1000 [01:44<14:27:44, 52.17s/it]Epoch 2 Valid AUC:(0.7766102312477353, 0.0)
Epoch 2 Test AUC:(0.7242231820713881, 0.0)
Epoch 2 a 0.38173917055849577 b 0.49097642248545137 c 0.38323390609781505
  0%|          | 3/1000 [02:36<14:28:06, 52.24s/it]Epoch 3 Valid AUC:(0.7814180801067794, 0.0)
Epoch 3 Test AUC:(0.7251951179607561, 0.0)
Epoch 3 a 0.37766962284053596 b 0.4965082749994228 c 0.37985610086433363
  0%|          | 4/1000 [03:29<14:30:06, 52.42s/it]Epoch 4 Valid AUC:(0.7833887605497294, 0.0)
Epoch 4 Test AUC:(0.7277421074069857, 0.0)
Epoch 4 a 0.3745638527860584 b 0.500324375192884 c 0.3769094144674374
  0%|          | 5/1000 [04:21<14:28:30, 52.37s/it]Epoch 5 Valid AUC:(0.7803799870089666, 0.0)
Epoch 5 Test AUC:(0.724613035553065, 0.0)
Epoch 5 a 0.3713352454740037 b 0.4978484809398651 c 0.3733144997950771
  1%|          | 6/1000 [05:14<14:29:50, 52.51s/it]Epoch 6 Valid AUC:(0.7866980865610801, 0.0)
Epoch 6 Test AUC:(0.7256137452835858, 0.0)
Epoch 6 a 0.36774535492152516 b 0.49752897240026617 c 0.3691877533852215
  1%|          | 7/1000 [06:06<14:29:06, 52.51s/it]Epoch 7 Valid AUC:(0.7886766821141866, 0.0)
Epoch 7 Test AUC:(0.7248769810335366, 0.0)
Epoch 7 a 0.36463630163453714 b 0.49673113748581116 c 0.36559296283923404
  1%|          | 8/1000 [06:58<14:24:11, 52.27s/it]Epoch 8 Valid AUC:(0.7923234537755414, 0.0)
Epoch 8 Test AUC:(0.7265855871128489, 0.0)
Epoch 8 a 0.3622019788029208 b 0.4954332606173617 c 0.3622981376451266
  1%|          | 9/1000 [07:52<14:28:51, 52.61s/it]Epoch 9 Valid AUC:(0.7904068257428828, 0.0)
Epoch 9 Test AUC:(0.7246378460434381, 0.0)
Epoch 9 a 0.36036802075758306 b 0.492439350191976 c 0.35967531848241624
  1%|          | 10/1000 [08:44<14:26:44, 52.53s/it]Epoch 10 Valid AUC:(0.7934181291456031, 0.0)
Epoch 10 Test AUC:(0.7251383826157191, 0.0)
Epoch 10 a 0.3572541194662482 b 0.4920598856759983 c 0.3552869102005028
  1%|          | 11/1000 [09:36<14:24:42, 52.46s/it]Epoch 11 Valid AUC:(0.7939195454786953, 0.0)
Epoch 11 Test AUC:(0.7254308368588664, 0.0)
Epoch 11 a 0.35569884911389416 b 0.49182220837719726 c 0.3520610480001515
  1%|          | 12/1000 [10:29<14:25:40, 52.57s/it]Epoch 12 Valid AUC:(0.7942610204529112, 0.0)
Epoch 12 Test AUC:(0.7250101188364343, 0.0)
Epoch 12 a 0.3541011586035761 b 0.4876338048600095 c 0.3474867928555794
  1%|▏         | 13/1000 [11:22<14:25:11, 52.60s/it]Epoch 13 Valid AUC:(0.7947758986249096, 0.0)
Epoch 13 Test AUC:(0.7235419346604727, 0.0)
Epoch 13 a 0.35207397039507476 b 0.47852493609700886 c 0.3408949956807572
  1%|▏         | 14/1000 [12:14<14:23:31, 52.55s/it]Epoch 14 Valid AUC:(0.7950214400546364, 0.0)
Epoch 14 Test AUC:(0.7246975314553985, 0.0)
Epoch 14 a 0.35014822221617825 b 0.4688868664160101 c 0.33391689888428394
  2%|▏         | 15/1000 [13:06<14:21:18, 52.47s/it]Epoch 15 Valid AUC:(0.7929196745708611, 0.0)
Epoch 15 Test AUC:(0.7250203286332654, 0.0)
Epoch 15 a 0.3482347633877031 b 0.4575460941738766 c 0.32662608973696916
  2%|▏         | 16/1000 [13:59<14:20:30, 52.47s/it]Epoch 16 Valid AUC:(0.7923054807339555, 0.0)
Epoch 16 Test AUC:(0.7262109585417732, 0.0)
Epoch 16 a 0.34581684862344075 b 0.44404202219945804 c 0.319293593257006
  2%|▏         | 17/1000 [14:51<14:19:21, 52.45s/it]Epoch 17 Valid AUC:(0.7954873588616415, 0.0)
Epoch 17 Test AUC:(0.7308764765549909, 0.0)
Epoch 17 a 0.3418047809504887 b 0.43433283926015887 c 0.3136504465785305
  2%|▏         | 18/1000 [15:44<14:19:30, 52.52s/it]Epoch 18 Valid AUC:(0.7992359593891692, 0.0)
Epoch 18 Test AUC:(0.7347162152553356, 0.0)
Epoch 18 a 0.33612320360763215 b 0.4292931776171479 c 0.30828417984532636
  2%|▏         | 19/1000 [16:36<14:17:55, 52.47s/it]Epoch 19 Valid AUC:(0.7987488968827856, 0.0)
Epoch 19 Test AUC:(0.7358095784645525, 0.0)
Epoch 19 a 0.3310192046271004 b 0.4248650798975102 c 0.3034519299235142
  2%|▏         | 20/1000 [17:29<14:17:25, 52.50s/it]Epoch 20 Valid AUC:(0.7992867193904594, 0.0)
Epoch 20 Test AUC:(0.7385567748438678, 0.0)
Epoch 20 a 0.32696089034589004 b 0.4199803523734302 c 0.29918591480259926
  2%|▏         | 21/1000 [18:21<14:16:18, 52.48s/it]Epoch 21 Valid AUC:(0.8020421632689142, 0.0)
Epoch 21 Test AUC:(0.7407394524023355, 0.0)
Epoch 21 a 0.3233152193202819 b 0.4152261394130392 c 0.2940074786753722
  2%|▏         | 22/1000 [19:14<14:14:03, 52.40s/it]Epoch 22 Valid AUC:(0.8005551862805796, 0.0)
Epoch 22 Test AUC:(0.7421135850244068, 0.0)
Epoch 22 a 0.3200966364421115 b 0.40799311481011463 c 0.2891113260982022
  2%|▏         | 23/1000 [20:05<14:10:10, 52.21s/it]Epoch 23 Valid AUC:(0.8016982007252661, 0.0)
Epoch 23 Test AUC:(0.7430135478317588, 0.0)
Epoch 23 a 0.3183196615165388 b 0.400371195384914 c 0.28446060446066634
  2%|▏         | 24/1000 [20:57<14:07:55, 52.13s/it]Epoch 24 Valid AUC:(0.8006349000008879, 0.0)
Epoch 24 Test AUC:(0.7440379692596101, 0.0)
Epoch 24 a 0.31645456430178054 b 0.39360732157945155 c 0.2795447080547901
  2%|▎         | 25/1000 [21:50<14:09:00, 52.25s/it]Epoch 25 Valid AUC:(0.8038012772773202, 0.0)
Epoch 25 Test AUC:(0.7469214159762003, 0.0)
Epoch 25 a 0.3145004794511277 b 0.38544551809308997 c 0.2754450199049963
  3%|▎         | 26/1000 [22:42<14:10:19, 52.38s/it]Epoch 26 Valid AUC:(0.8014065476272376, 0.0)
Epoch 26 Test AUC:(0.7473689368530436, 0.0)
Epoch 26 a 0.31359332500089343 b 0.3745988211041725 c 0.27017808644104774
  3%|▎         | 27/1000 [23:35<14:09:10, 52.36s/it]Epoch 27 Valid AUC:(0.8030760988833482, 0.0)
Epoch 27 Test AUC:(0.7460892534025784, 0.0)
Epoch 27 a 0.3123165076407388 b 0.3655659691308826 c 0.26513567572868085
  3%|▎         | 28/1000 [24:27<14:06:45, 52.27s/it]Epoch 28 Valid AUC:(0.8017008369593321, 0.0)
Epoch 28 Test AUC:(0.7474121232675288, 0.0)
Epoch 28 a 0.3115899319380102 b 0.3562006086290962 c 0.26136761385070484
  3%|▎         | 29/1000 [25:19<14:07:46, 52.39s/it]Epoch 29 Valid AUC:(0.8032004581310871, 0.0)
Epoch 29 Test AUC:(0.749210505441422, 0.0)
Epoch 29 a 0.31065217296122544 b 0.3478846322122954 c 0.256980855160316
  3%|▎         | 30/1000 [26:12<14:08:34, 52.49s/it]Epoch 30 Valid AUC:(0.8037727080358033, 0.0)
Epoch 30 Test AUC:(0.7490946233922975, 0.0)
Epoch 30 a 0.3094036681671258 b 0.34052757130302413 c 0.25250561235536273
  3%|▎         | 31/1000 [27:05<14:07:54, 52.50s/it]Epoch 31 Valid AUC:(0.8052466076627329, 0.0)
Epoch 31 Test AUC:(0.7500440276111043, 0.0)
Epoch 31 a 0.30773924761854665 b 0.3331782307543265 c 0.24877508401391013
  3%|▎         | 32/1000 [27:57<14:06:33, 52.47s/it]Epoch 32 Valid AUC:(0.802523353522264, 0.0)
Epoch 32 Test AUC:(0.7484438813835552, 0.0)
Epoch 32 a 0.30639480453141976 b 0.3264426731727493 c 0.24487084237262757
  3%|▎         | 33/1000 [28:50<14:05:39, 52.47s/it]Epoch 33 Valid AUC:(0.8028928338376619, 0.0)
Epoch 33 Test AUC:(0.7500338263651919, 0.0)
Epoch 33 a 0.304662626693906 b 0.32060336209159024 c 0.24156880192833408
  3%|▎         | 34/1000 [29:42<14:04:41, 52.47s/it]Epoch 34 Valid AUC:(0.8009495384455253, 0.0)
Epoch 34 Test AUC:(0.749328978418888, 0.0)
Epoch 34 a 0.30295108969302725 b 0.3159695502138234 c 0.23753100723567863
  4%|▎         | 35/1000 [30:34<14:03:33, 52.45s/it]Epoch 35 Valid AUC:(0.8040789917843412, 0.0)
Epoch 35 Test AUC:(0.755463740921976, 0.0)
Epoch 35 a 0.3003534297168375 b 0.3090552347946455 c 0.23264457297397093
  4%|▎         | 36/1000 [31:27<14:01:36, 52.38s/it]Epoch 36 Valid AUC:(0.8012718523426767, 0.0)
Epoch 36 Test AUC:(0.753172270025919, 0.0)
Epoch 36 a 0.2980350199599621 b 0.30398363762458325 c 0.22865771116984923
  4%|▎         | 37/1000 [32:19<14:00:05, 52.34s/it]  4%|▎         | 37/1000 [33:11<14:23:58, 53.83s/it]
[32m[I 2021-05-14 03:58:36,443][0m Trial 53 finished with value: 0.8052466076627329 and parameters: {'rank': 65.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.13800886431288995, 'gamma': 0.0022650204974307715}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 03:58:37.203472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7790061002328129, 0.0)
Epoch 0 Test AUC:(0.7192766167404608, 0.0)
Epoch 0 a 0.4127087905493301 b 0.4991320364432076 c 0.4141753544989726
  0%|          | 1/1000 [00:51<14:13:21, 51.25s/it]Epoch 1 Valid AUC:(0.777508236123238, 0.0)
Epoch 1 Test AUC:(0.7214475367858274, 0.0)
Epoch 1 a 0.3861650477952401 b 0.4831833179807759 c 0.38719487160264365
  0%|          | 2/1000 [01:42<14:11:51, 51.21s/it]Epoch 2 Valid AUC:(0.7751594758847816, 0.0)
Epoch 2 Test AUC:(0.7238533334638203, 0.0)
Epoch 2 a 0.38157784609007883 b 0.4883313065683338 c 0.38296534837611484
  0%|          | 3/1000 [02:35<14:22:43, 51.92s/it]Epoch 3 Valid AUC:(0.7826917861436482, 0.0)
Epoch 3 Test AUC:(0.7254016440227011, 0.0)
Epoch 3 a 0.3762299242753618 b 0.49257338100995574 c 0.3787710257099428
  0%|          | 4/1000 [03:27<14:22:37, 51.97s/it]Epoch 4 Valid AUC:(0.7857285445201263, 0.0)
Epoch 4 Test AUC:(0.7285914487761133, 0.0)
Epoch 4 a 0.37188358020254786 b 0.49618059642597945 c 0.37478723288541826
  0%|          | 5/1000 [04:19<14:22:59, 52.04s/it]Epoch 5 Valid AUC:(0.7834835611671819, 0.0)
Epoch 5 Test AUC:(0.7264890215888847, 0.0)
Epoch 5 a 0.3686296269447511 b 0.4952262621410416 c 0.37146949917977484
  1%|          | 6/1000 [05:11<14:21:26, 52.00s/it]Epoch 6 Valid AUC:(0.7876642810845907, 0.0)
Epoch 6 Test AUC:(0.7270414707881017, 0.0)
Epoch 6 a 0.3659520197202502 b 0.49288778063996697 c 0.36818639739178555
  1%|          | 7/1000 [06:03<14:20:27, 51.99s/it]Epoch 7 Valid AUC:(0.7896922576463501, 0.0)
Epoch 7 Test AUC:(0.7262053705164557, 0.0)
Epoch 7 a 0.3629201365788458 b 0.49116566249542315 c 0.3648462602550115
  1%|          | 8/1000 [06:55<14:19:56, 52.01s/it]Epoch 8 Valid AUC:(0.7927539622046929, 0.0)
Epoch 8 Test AUC:(0.7267419534861751, 0.0)
Epoch 8 a 0.36036514594281466 b 0.4912800787680106 c 0.361668678056786
  1%|          | 9/1000 [07:47<14:19:36, 52.04s/it]Epoch 9 Valid AUC:(0.7912139644873614, 0.0)
Epoch 9 Test AUC:(0.7260966584125932, 0.0)
Epoch 9 a 0.3587896979190934 b 0.48973353066194947 c 0.3595249968275458
  1%|          | 10/1000 [08:39<14:20:35, 52.16s/it]Epoch 10 Valid AUC:(0.7924124000822433, 0.0)
Epoch 10 Test AUC:(0.7262187527040944, 0.0)
Epoch 10 a 0.35618705882632756 b 0.48816520191534185 c 0.35600437676642743
  1%|          | 11/1000 [09:32<14:20:28, 52.20s/it]Epoch 11 Valid AUC:(0.7931911182498387, 0.0)
Epoch 11 Test AUC:(0.7262319211187677, 0.0)
Epoch 11 a 0.35509420364675387 b 0.48433145544898343 c 0.35403318826101676
  1%|          | 12/1000 [10:24<14:18:06, 52.11s/it]Epoch 12 Valid AUC:(0.7937181869218061, 0.0)
Epoch 12 Test AUC:(0.7245774509052321, 0.0)
Epoch 12 a 0.3539325947492895 b 0.48313469660114233 c 0.35076933175745145
  1%|▏         | 13/1000 [11:16<14:17:39, 52.14s/it]Epoch 13 Valid AUC:(0.7930926022981338, 0.0)
Epoch 13 Test AUC:(0.7232950824663205, 0.0)
Epoch 13 a 0.3523643241082159 b 0.4769202316071186 c 0.34586654150749835
  1%|▏         | 14/1000 [12:08<14:17:01, 52.15s/it]Epoch 14 Valid AUC:(0.7940053890519632, 0.0)
Epoch 14 Test AUC:(0.7244205971295447, 0.0)
Epoch 14 a 0.35057965382723744 b 0.4681110219576469 c 0.33980370167515406
  2%|▏         | 15/1000 [13:04<14:34:22, 53.26s/it]Epoch 15 Valid AUC:(0.7928825776183692, 0.0)
Epoch 15 Test AUC:(0.723165745546749, 0.0)
Epoch 15 a 0.3490492622377407 b 0.4536156521836517 c 0.3331230158057491
  2%|▏         | 16/1000 [13:56<14:27:53, 52.92s/it]Epoch 16 Valid AUC:(0.7916484022765743, 0.0)
Epoch 16 Test AUC:(0.7238989226864375, 0.0)
Epoch 16 a 0.3475223076895209 b 0.43438701694400256 c 0.32546515579914426
  2%|▏         | 17/1000 [14:48<14:22:47, 52.66s/it]Epoch 17 Valid AUC:(0.7923681185268471, 0.0)
Epoch 17 Test AUC:(0.7258444533433854, 0.0)
Epoch 17 a 0.345970809699544 b 0.41371423977481525 c 0.317979320613911
  2%|▏         | 18/1000 [15:40<14:19:09, 52.49s/it]Epoch 18 Valid AUC:(0.7955363694903016, 0.0)
Epoch 18 Test AUC:(0.7284624538932865, 0.0)
Epoch 18 a 0.34393196446555 b 0.3934523808044687 c 0.3097019650686675
  2%|▏         | 19/1000 [16:33<14:18:17, 52.49s/it]Epoch 19 Valid AUC:(0.7946375636200047, 0.0)
Epoch 19 Test AUC:(0.730516021131526, 0.0)
Epoch 19 a 0.3416646216476947 b 0.37584853687996356 c 0.30272272564995456
  2%|▏         | 20/1000 [17:24<14:10:01, 52.04s/it]Epoch 20 Valid AUC:(0.7964862455070728, 0.0)
Epoch 20 Test AUC:(0.7357078182575273, 0.0)
Epoch 20 a 0.33820855833395147 b 0.3645067449426747 c 0.29792965672745314
  2%|▏         | 21/1000 [18:16<14:10:48, 52.14s/it]Epoch 21 Valid AUC:(0.8007332634431841, 0.0)
Epoch 21 Test AUC:(0.7417234408114969, 0.0)
Epoch 21 a 0.3340034034530402 b 0.3556986563882118 c 0.291748585265647
  2%|▏         | 22/1000 [19:08<14:07:14, 51.98s/it]Epoch 22 Valid AUC:(0.8005587529501984, 0.0)
Epoch 22 Test AUC:(0.743027973231469, 0.0)
Epoch 22 a 0.3292026092228995 b 0.3482857100080916 c 0.2863718128839969
  2%|▏         | 23/1000 [19:59<14:02:05, 51.72s/it]Epoch 23 Valid AUC:(0.8023290719145788, 0.0)
Epoch 23 Test AUC:(0.7436036210728992, 0.0)
Epoch 23 a 0.3249817845567131 b 0.3428733573113409 c 0.28078787364590335
  2%|▏         | 24/1000 [20:50<13:58:59, 51.58s/it]Epoch 24 Valid AUC:(0.8024702277027502, 0.0)
Epoch 24 Test AUC:(0.745143213970248, 0.0)
Epoch 24 a 0.3211426191646568 b 0.3367982796979862 c 0.2750055312630636
  2%|▎         | 25/1000 [21:41<13:54:54, 51.38s/it]Epoch 25 Valid AUC:(0.8051314438352293, 0.0)
Epoch 25 Test AUC:(0.7494125123428769, 0.0)
Epoch 25 a 0.3179684011509241 b 0.33233577600667175 c 0.27092821506307396
  3%|▎         | 26/1000 [22:32<13:51:43, 51.24s/it]Epoch 26 Valid AUC:(0.8026427171256716, 0.0)
Epoch 26 Test AUC:(0.7502403096725438, 0.0)
Epoch 26 a 0.3158199007602285 b 0.3251910056146817 c 0.2649967082189602
  3%|▎         | 27/1000 [23:22<13:48:26, 51.09s/it]Epoch 27 Valid AUC:(0.8039808141728373, 0.0)
Epoch 27 Test AUC:(0.7482175086394954, 0.0)
Epoch 27 a 0.31378497791961885 b 0.3202971161850981 c 0.2593130904064332
  3%|▎         | 28/1000 [24:13<13:45:51, 50.98s/it]Epoch 28 Valid AUC:(0.8034948384561902, 0.0)
Epoch 28 Test AUC:(0.7502596005449483, 0.0)
Epoch 28 a 0.3125295862705415 b 0.31637955161647296 c 0.2558088354481538
  3%|▎         | 29/1000 [25:04<13:44:21, 50.94s/it]Epoch 29 Valid AUC:(0.8051814682029007, 0.0)
Epoch 29 Test AUC:(0.7522133956647415, 0.0)
Epoch 29 a 0.31094027075249425 b 0.31034309913215025 c 0.2495818162108331
  3%|▎         | 30/1000 [25:55<13:41:46, 50.83s/it]Epoch 30 Valid AUC:(0.8059548511043721, 0.0)
Epoch 30 Test AUC:(0.7516099145832065, 0.0)
Epoch 30 a 0.3089330119626143 b 0.30542317752387205 c 0.24560951748844123
  3%|▎         | 31/1000 [26:46<13:41:11, 50.85s/it]Epoch 31 Valid AUC:(0.807489986462906, 0.0)
Epoch 31 Test AUC:(0.7526113511418099, 0.0)
Epoch 31 a 0.3066385608443792 b 0.3011420079520051 c 0.24057326578278418
  3%|▎         | 32/1000 [27:36<13:39:51, 50.82s/it]Epoch 32 Valid AUC:(0.8032170675591357, 0.0)
Epoch 32 Test AUC:(0.7507663365332282, 0.0)
Epoch 32 a 0.30459142112036347 b 0.2979926019007531 c 0.23672020435333252
  3%|▎         | 33/1000 [28:27<13:39:14, 50.83s/it]Epoch 33 Valid AUC:(0.8042095244591565, 0.0)
Epoch 33 Test AUC:(0.7517378833557989, 0.0)
Epoch 33 a 0.30228351743168513 b 0.2954559760314358 c 0.2322201046725394
  3%|▎         | 34/1000 [29:18<13:37:45, 50.79s/it]Epoch 34 Valid AUC:(0.8022383236899883, 0.0)
Epoch 34 Test AUC:(0.7529480050832988, 0.0)
Epoch 34 a 0.3003013908143494 b 0.2942735895484506 c 0.22892656769431094
  4%|▎         | 35/1000 [30:08<13:31:56, 50.48s/it]Epoch 35 Valid AUC:(0.8053027170276555, 0.0)
Epoch 35 Test AUC:(0.7565536880392046, 0.0)
Epoch 35 a 0.2975029103173097 b 0.2906595141115323 c 0.22347815028978305
  4%|▎         | 36/1000 [30:59<13:33:21, 50.62s/it]Epoch 36 Valid AUC:(0.8025289156301136, 0.0)
Epoch 36 Test AUC:(0.7539812125800311, 0.0)
Epoch 36 a 0.295286427950955 b 0.2908960436011704 c 0.2204171002690701
  4%|▎         | 37/1000 [31:49<13:33:23, 50.68s/it]  4%|▎         | 37/1000 [32:40<14:10:28, 52.99s/it]
[32m[I 2021-05-14 04:31:37,061][0m Trial 54 finished with value: 0.807489986462906 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.15414754948908016, 'gamma': 0.0019420287195190326}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 04:31:37.726682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7780371387528858, 0.0)
Epoch 0 Test AUC:(0.7230411372851737, 0.0)
Epoch 0 a 0.4339151156525458 b 0.5473968814457616 c 0.43500903224752796
  0%|          | 1/1000 [00:20<5:34:05, 20.07s/it]Epoch 1 Valid AUC:(0.7870852297728796, 0.0)
Epoch 1 Test AUC:(0.7254002972530187, 0.0)
Epoch 1 a 0.37593808289497127 b 0.5161505550626786 c 0.37617904813058917
  0%|          | 2/1000 [00:39<5:31:44, 19.94s/it]Epoch 2 Valid AUC:(0.7827711897187722, 0.0)
Epoch 2 Test AUC:(0.7256364821761937, 0.0)
Epoch 2 a 0.37285558398692836 b 0.5042224322115222 c 0.3733806184703304
  0%|          | 3/1000 [00:59<5:31:14, 19.93s/it]Epoch 3 Valid AUC:(0.779241791348961, 0.0)
Epoch 3 Test AUC:(0.7240634551870447, 0.0)
Epoch 3 a 0.3712832872425356 b 0.49505962359328426 c 0.37173199317147654
  0%|          | 4/1000 [01:19<5:29:51, 19.87s/it]Epoch 4 Valid AUC:(0.7836965488868884, 0.0)
Epoch 4 Test AUC:(0.7275701527090171, 0.0)
Epoch 4 a 0.3705439435378198 b 0.49497108065312906 c 0.37101560783001686
  0%|          | 5/1000 [01:39<5:30:19, 19.92s/it]Epoch 5 Valid AUC:(0.7849508118965254, 0.0)
Epoch 5 Test AUC:(0.7263669572255987, 0.0)
Epoch 5 a 0.3689546789373121 b 0.5011356679662582 c 0.36902632035555377
  1%|          | 6/1000 [01:59<5:30:47, 19.97s/it]Epoch 6 Valid AUC:(0.7898355293423693, 0.0)
Epoch 6 Test AUC:(0.7271668529078119, 0.0)
Epoch 6 a 0.3652811048011626 b 0.509826747880828 c 0.3654980200432962
  1%|          | 7/1000 [02:19<5:29:45, 19.92s/it]Epoch 7 Valid AUC:(0.7849314701150355, 0.0)
Epoch 7 Test AUC:(0.7204066377377973, 0.0)
Epoch 7 a 0.36162319010303867 b 0.5212419078715386 c 0.3620231113126201
  1%|          | 8/1000 [02:39<5:29:45, 19.94s/it]Epoch 8 Valid AUC:(0.7843982779980668, 0.0)
Epoch 8 Test AUC:(0.7209389110445328, 0.0)
Epoch 8 a 0.3578454626183356 b 0.5348070172532913 c 0.3579822853207588
  1%|          | 9/1000 [02:59<5:29:00, 19.92s/it]Epoch 9 Valid AUC:(0.784412202491566, 0.0)
Epoch 9 Test AUC:(0.7226584580242181, 0.0)
Epoch 9 a 0.35499464792589985 b 0.5486654365254987 c 0.3548720082448375
  1%|          | 10/1000 [03:19<5:27:42, 19.86s/it]Epoch 10 Valid AUC:(0.7884082745258761, 0.0)
Epoch 10 Test AUC:(0.7202826451423627, 0.0)
Epoch 10 a 0.35201437002228153 b 0.5629950223430511 c 0.3517449779375907
  1%|          | 11/1000 [03:38<5:26:48, 19.83s/it]Epoch 11 Valid AUC:(0.7886834309759231, 0.0)
Epoch 11 Test AUC:(0.7193038599671809, 0.0)
Epoch 11 a 0.35029516633479824 b 0.5767515897750854 c 0.3499815915861437
  1%|          | 12/1000 [03:58<5:27:56, 19.92s/it]  1%|          | 12/1000 [04:18<5:55:19, 21.58s/it]
[32m[I 2021-05-14 04:36:16,070][0m Trial 55 finished with value: 0.7898355293423693 and parameters: {'rank': 50.0, 'lambda': 1e-05, 'batch_size': 2048, 'learning_rate': 0.005, 'alpha': 0.1557997184146238, 'gamma': 0.001954962706204875}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 04:36:16.759869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.4913601856384509, 0.0)
Epoch 0 Test AUC:(0.5021115830833397, 0.0)
Epoch 0 a 0.5174444003604067 b 0.517442809683936 c 0.5174427373668318
  0%|          | 1/1000 [00:52<14:39:01, 52.79s/it]Epoch 1 Valid AUC:(0.4906907423846336, 0.0)
Epoch 1 Test AUC:(0.49290295773239456, 0.0)
Epoch 1 a 0.503172812087675 b 0.5031670493259276 c 0.5031670504652518
  0%|          | 2/1000 [01:44<14:29:58, 52.30s/it]Epoch 2 Valid AUC:(0.4976876625968168, 0.0)
Epoch 2 Test AUC:(0.5088889171924296, 0.0)
Epoch 2 a 0.502532680269698 b 0.5025234336344528 c 0.5025234331547375
  0%|          | 3/1000 [02:37<14:29:53, 52.35s/it]Epoch 3 Valid AUC:(0.49550688314178526, 0.0)
Epoch 3 Test AUC:(0.5039791721170757, 0.0)
Epoch 3 a 0.5028754980031633 b 0.502865406708938 c 0.5028654064091158
  0%|          | 4/1000 [03:29<14:25:58, 52.17s/it]Epoch 4 Valid AUC:(0.49574014692330953, 0.0)
Epoch 4 Test AUC:(0.48438645656084817, 0.0)
Epoch 4 a 0.5027982237593269 b 0.5027894633156913 c 0.5027894618165805
  0%|          | 5/1000 [04:21<14:28:43, 52.39s/it]Epoch 5 Valid AUC:(0.4933965386833682, 0.0)
Epoch 5 Test AUC:(0.49955434536114524, 0.0)
Epoch 5 a 0.5026115058533382 b 0.5026054820664212 c 0.5026054820664212
  1%|          | 6/1000 [05:14<14:27:27, 52.36s/it]Epoch 6 Valid AUC:(0.49919850538523797, 0.0)
Epoch 6 Test AUC:(0.4994400324055873, 0.0)
Epoch 6 a 0.5032116048172925 b 0.5032066322668217 c 0.5032066310675332
  1%|          | 7/1000 [06:05<14:22:30, 52.12s/it]Epoch 7 Valid AUC:(0.4963739119466141, 0.0)
Epoch 7 Test AUC:(0.4980706156151343, 0.0)
Epoch 7 a 0.5029405973087134 b 0.5029372718612433 c 0.5029372719212077
  1%|          | 8/1000 [06:57<14:20:30, 52.05s/it]Epoch 8 Valid AUC:(0.4880781895694719, 0.0)
Epoch 8 Test AUC:(0.4987435002276404, 0.0)
Epoch 8 a 0.5026972433570884 b 0.502695017717254 c 0.5026950163380721
  1%|          | 9/1000 [07:49<14:20:16, 52.09s/it]Epoch 9 Valid AUC:(0.4975831436697276, 0.0)
Epoch 9 Test AUC:(0.4999683637388394, 0.0)
Epoch 9 a 0.5023927245461485 b 0.5023912794033526 c 0.5023912774844909
  1%|          | 10/1000 [08:42<14:21:32, 52.21s/it]Epoch 10 Valid AUC:(0.49502534814027616, 0.0)
Epoch 10 Test AUC:(0.49247183751746243, 0.0)
Epoch 10 a 0.5032805811831169 b 0.5032797088805339 c 0.5032797078011741
  1%|          | 11/1000 [09:34<14:21:20, 52.25s/it]Epoch 11 Valid AUC:(0.4941271523076145, 0.0)
Epoch 11 Test AUC:(0.4958742779641728, 0.0)
Epoch 11 a 0.5025697566373967 b 0.5025691594516247 c 0.5025691585521583
  1%|          | 12/1000 [10:27<14:20:53, 52.28s/it]  1%|          | 12/1000 [11:19<15:32:06, 56.61s/it]
[32m[I 2021-05-14 04:47:56,323][0m Trial 56 finished with value: 0.49919850538523797 and parameters: {'rank': 85.0, 'lambda': 1, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1648353675689862, 'gamma': 0.002352064240201444}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 04:47:57.028569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7781156234267822, 0.0)
Epoch 0 Test AUC:(0.7188927189736021, 0.0)
Epoch 0 a 0.412557904149445 b 0.49964206763196517 c 0.4142777818429398
  0%|          | 1/1000 [00:52<14:38:29, 52.76s/it]Epoch 1 Valid AUC:(0.7776079375472382, 0.0)
Epoch 1 Test AUC:(0.7221347185342645, 0.0)
Epoch 1 a 0.3862710569945859 b 0.4831950149425798 c 0.38755285829845326
  0%|          | 2/1000 [01:45<14:33:31, 52.52s/it]Epoch 2 Valid AUC:(0.7757795496642712, 0.0)
Epoch 2 Test AUC:(0.7248923855134287, 0.0)
Epoch 2 a 0.3812194381441389 b 0.48879533850211254 c 0.3827951926460688
  0%|          | 3/1000 [02:37<14:29:23, 52.32s/it]Epoch 3 Valid AUC:(0.7815425072788768, 0.0)
Epoch 3 Test AUC:(0.7256254600420938, 0.0)
Epoch 3 a 0.37739665257618943 b 0.49467800428689845 c 0.3796599979251923
  0%|          | 4/1000 [03:29<14:26:32, 52.20s/it]Epoch 4 Valid AUC:(0.7830075690496473, 0.0)
Epoch 4 Test AUC:(0.7279694592312274, 0.0)
Epoch 4 a 0.37451626039606706 b 0.4959152675490504 c 0.37669149892670767
  0%|          | 5/1000 [04:21<14:24:35, 52.14s/it]Epoch 5 Valid AUC:(0.7801734277530789, 0.0)
Epoch 5 Test AUC:(0.7242853515252075, 0.0)
Epoch 5 a 0.3712427277919992 b 0.4919427626689435 c 0.3727296168655457
  1%|          | 6/1000 [05:13<14:24:11, 52.16s/it]Epoch 6 Valid AUC:(0.7863333686403294, 0.0)
Epoch 6 Test AUC:(0.7255671727053276, 0.0)
Epoch 6 a 0.36753264363382904 b 0.49095029604267065 c 0.36832838734870466
  1%|          | 7/1000 [06:05<14:23:32, 52.18s/it]Epoch 7 Valid AUC:(0.7895483246490289, 0.0)
Epoch 7 Test AUC:(0.725304347395195, 0.0)
Epoch 7 a 0.3644491424502981 b 0.48896184983387797 c 0.36430637523441967
  1%|          | 8/1000 [06:57<14:21:38, 52.11s/it]Epoch 8 Valid AUC:(0.7929263055261638, 0.0)
Epoch 8 Test AUC:(0.7267552715419242, 0.0)
Epoch 8 a 0.3617593687424957 b 0.48775241138709624 c 0.3602477515367435
  1%|          | 9/1000 [07:49<14:20:33, 52.10s/it]Epoch 9 Valid AUC:(0.7910112166851014, 0.0)
Epoch 9 Test AUC:(0.7244144276417611, 0.0)
Epoch 9 a 0.3596137941363352 b 0.4870653199837721 c 0.355842590152138
  1%|          | 10/1000 [08:40<14:14:43, 51.80s/it]Epoch 10 Valid AUC:(0.7944338700030921, 0.0)
Epoch 10 Test AUC:(0.7246269821013326, 0.0)
Epoch 10 a 0.3560818490727806 b 0.48310907481901605 c 0.34907410718065873
  1%|          | 11/1000 [09:33<14:16:07, 51.94s/it]Epoch 11 Valid AUC:(0.793437042875475, 0.0)
Epoch 11 Test AUC:(0.723543832964406, 0.0)
Epoch 11 a 0.35390155787918887 b 0.4756363076223454 c 0.3433563296104101
  1%|          | 12/1000 [10:25<14:15:40, 51.96s/it]Epoch 12 Valid AUC:(0.7943405009235355, 0.0)
Epoch 12 Test AUC:(0.7222242124485307, 0.0)
Epoch 12 a 0.35163611545409235 b 0.4708063444741055 c 0.33811316068023745
  1%|▏         | 13/1000 [11:17<14:15:29, 52.01s/it]Epoch 13 Valid AUC:(0.7942490567946678, 0.0)
Epoch 13 Test AUC:(0.7211682637837313, 0.0)
Epoch 13 a 0.34944888793486706 b 0.46514684189733124 c 0.332400261876089
  1%|▏         | 14/1000 [12:09<14:15:58, 52.09s/it]Epoch 14 Valid AUC:(0.7945418453829163, 0.0)
Epoch 14 Test AUC:(0.7209849320885402, 0.0)
Epoch 14 a 0.34780873097404386 b 0.45969566235120146 c 0.3276574112160105
  2%|▏         | 15/1000 [13:01<14:14:19, 52.04s/it]Epoch 15 Valid AUC:(0.792313978968322, 0.0)
Epoch 15 Test AUC:(0.7205301343799521, 0.0)
Epoch 15 a 0.34641784999212266 b 0.45180258064922435 c 0.32271898518385783
  2%|▏         | 16/1000 [13:53<14:14:07, 52.08s/it]Epoch 16 Valid AUC:(0.7914224909864632, 0.0)
Epoch 16 Test AUC:(0.7219955993637929, 0.0)
Epoch 16 a 0.3447158295863591 b 0.44114957195172605 c 0.3178661006317292
  2%|▏         | 17/1000 [14:46<14:16:16, 52.26s/it]Epoch 17 Valid AUC:(0.7939663158851155, 0.0)
Epoch 17 Test AUC:(0.7246806604929633, 0.0)
Epoch 17 a 0.342440766108108 b 0.4294759737893609 c 0.31280705374731144
  2%|▏         | 18/1000 [15:38<14:13:10, 52.13s/it]Epoch 18 Valid AUC:(0.7983723357734087, 0.0)
Epoch 18 Test AUC:(0.7296407063470933, 0.0)
Epoch 18 a 0.3374433092907881 b 0.41757474698770936 c 0.30733360305158663
  2%|▏         | 19/1000 [16:30<14:11:22, 52.07s/it]Epoch 19 Valid AUC:(0.797707101266637, 0.0)
Epoch 19 Test AUC:(0.7320786373772564, 0.0)
Epoch 19 a 0.3317623816625453 b 0.40732664937224666 c 0.30273663997650146
  2%|▏         | 20/1000 [17:21<14:09:17, 52.00s/it]Epoch 20 Valid AUC:(0.7994357441514872, 0.0)
Epoch 20 Test AUC:(0.7368743730546633, 0.0)
Epoch 20 a 0.32668737374560936 b 0.3951719270145869 c 0.2965954472901116
  2%|▏         | 21/1000 [18:14<14:10:05, 52.10s/it]Epoch 21 Valid AUC:(0.8015860973386714, 0.0)
Epoch 21 Test AUC:(0.7402533583316019, 0.0)
Epoch 21 a 0.3219174223406694 b 0.38237838552031717 c 0.2896043177041969
  2%|▏         | 22/1000 [19:06<14:09:55, 52.14s/it]Epoch 22 Valid AUC:(0.8011097873864025, 0.0)
Epoch 22 Test AUC:(0.741399053162767, 0.0)
Epoch 22 a 0.31817703353807003 b 0.3691714454584678 c 0.2835747718930964
  2%|▏         | 23/1000 [19:58<14:10:43, 52.25s/it]Epoch 23 Valid AUC:(0.8018210118102671, 0.0)
Epoch 23 Test AUC:(0.7431696320247705, 0.0)
Epoch 23 a 0.3161612767089061 b 0.35898569741959063 c 0.2778710744210652
  2%|▏         | 24/1000 [20:51<14:09:00, 52.19s/it]Epoch 24 Valid AUC:(0.8007933521502433, 0.0)
Epoch 24 Test AUC:(0.7439238743524769, 0.0)
Epoch 24 a 0.31394546246624566 b 0.3477973916401086 c 0.2715343483976675
  2%|▎         | 25/1000 [21:43<14:07:23, 52.15s/it]Epoch 25 Valid AUC:(0.8039580889893374, 0.0)
Epoch 25 Test AUC:(0.7472307454572422, 0.0)
Epoch 25 a 0.31197726210837873 b 0.3387508967392881 c 0.2666764048863225
  3%|▎         | 26/1000 [22:34<14:02:02, 51.87s/it]Epoch 26 Valid AUC:(0.8017123302734324, 0.0)
Epoch 26 Test AUC:(0.7475579549091164, 0.0)
Epoch 26 a 0.31090728066097084 b 0.32925853486991746 c 0.26109481433507664
  3%|▎         | 27/1000 [23:26<14:01:18, 51.88s/it]Epoch 27 Valid AUC:(0.8026268548655668, 0.0)
Epoch 27 Test AUC:(0.7466386370974704, 0.0)
Epoch 27 a 0.3095466945492766 b 0.3216000207113308 c 0.25597973632620613
  3%|▎         | 28/1000 [24:18<14:02:31, 52.01s/it]Epoch 28 Valid AUC:(0.8015388758119831, 0.0)
Epoch 28 Test AUC:(0.7486180293921495, 0.0)
Epoch 28 a 0.3089148491561053 b 0.31492908505846556 c 0.25307675062770574
  3%|▎         | 29/1000 [25:10<14:03:48, 52.14s/it]Epoch 29 Valid AUC:(0.8027796231558639, 0.0)
Epoch 29 Test AUC:(0.7501868450538787, 0.0)
Epoch 29 a 0.3076735667179768 b 0.30835412331749973 c 0.24826889186797726
  3%|▎         | 30/1000 [26:02<14:02:25, 52.11s/it]Epoch 30 Valid AUC:(0.8036567919139891, 0.0)
Epoch 30 Test AUC:(0.7497640577091408, 0.0)
Epoch 30 a 0.3060242768744348 b 0.3031193118699839 c 0.24511407078871544
  3%|▎         | 31/1000 [26:55<14:03:57, 52.26s/it]Epoch 31 Valid AUC:(0.8043486873722804, 0.0)
Epoch 31 Test AUC:(0.75046614798419, 0.0)
Epoch 31 a 0.3041094566734744 b 0.2976189191552475 c 0.2410235627436302
  3%|▎         | 32/1000 [27:47<14:01:42, 52.17s/it]Epoch 32 Valid AUC:(0.8005211382346716, 0.0)
Epoch 32 Test AUC:(0.7480817414291224, 0.0)
Epoch 32 a 0.30259350457901446 b 0.2932847970028518 c 0.23754795429332395
  3%|▎         | 33/1000 [28:39<14:00:44, 52.17s/it]Epoch 33 Valid AUC:(0.8008133372907517, 0.0)
Epoch 33 Test AUC:(0.7498193436734718, 0.0)
Epoch 33 a 0.30101289313803736 b 0.2893434241264159 c 0.23511758452689863
  3%|▎         | 34/1000 [29:31<13:58:20, 52.07s/it]Epoch 34 Valid AUC:(0.8003681879583574, 0.0)
Epoch 34 Test AUC:(0.7502357819611352, 0.0)
Epoch 34 a 0.3000597258808627 b 0.2861745109260682 c 0.23207418542632635
  4%|▎         | 35/1000 [30:23<13:57:41, 52.08s/it]Epoch 35 Valid AUC:(0.8031219952442491, 0.0)
Epoch 35 Test AUC:(0.7561395456731905, 0.0)
Epoch 35 a 0.2981649793429634 b 0.2815132147709369 c 0.22827794725146572
  4%|▎         | 36/1000 [31:15<13:56:57, 52.09s/it]Epoch 36 Valid AUC:(0.801208250792849, 0.0)
Epoch 36 Test AUC:(0.7541331110983788, 0.0)
Epoch 36 a 0.2966577379516433 b 0.27856372455715894 c 0.22570772208198456
  4%|▎         | 37/1000 [32:08<13:57:32, 52.18s/it]  4%|▎         | 37/1000 [33:00<14:18:59, 53.52s/it]
[32m[I 2021-05-14 05:21:17,080][0m Trial 57 finished with value: 0.8043486873722804 and parameters: {'rank': 70.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.16907263633050715, 'gamma': 0.002612456208951179}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 05:21:17.842378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.4950863429326463, 0.0)
Epoch 0 Test AUC:(0.5052469655152012, 0.0)
Epoch 0 a 0.5085947721057255 b 0.4910829737032923 c 0.4910757959608581
  0%|          | 1/1000 [00:51<14:21:47, 51.76s/it]Epoch 1 Valid AUC:(0.4963036294594084, 0.0)
Epoch 1 Test AUC:(0.5004749500860434, 0.0)
Epoch 1 a 0.5018123755272725 b 0.4638267297380167 c 0.46382673111719863
  0%|          | 2/1000 [01:43<14:21:01, 51.76s/it]Epoch 2 Valid AUC:(0.5095048579808804, 0.0)
Epoch 2 Test AUC:(0.5084987473267637, 0.0)
Epoch 2 a 0.5016557041188361 b 0.44841007309660347 c 0.4484100728567457
  0%|          | 3/1000 [02:34<14:15:49, 51.50s/it]Epoch 3 Valid AUC:(0.4957440327092542, 0.0)
Epoch 3 Test AUC:(0.49166736709378805, 0.0)
Epoch 3 a 0.5017161271581707 b 0.42322626781895367 c 0.42322626661966506
  0%|          | 4/1000 [03:26<14:15:08, 51.51s/it]Epoch 4 Valid AUC:(0.5080797472672518, 0.0)
Epoch 4 Test AUC:(0.49980680268245226, 0.0)
Epoch 4 a 0.501781088725422 b 0.40610779291187493 c 0.4061077926720172
  0%|          | 5/1000 [04:18<14:17:41, 51.72s/it]Epoch 5 Valid AUC:(0.49421020713740754, 0.0)
Epoch 5 Test AUC:(0.5023081045705007, 0.0)
Epoch 5 a 0.5016590672839335 b 0.39730844213449257 c 0.39730844207452815
  1%|          | 6/1000 [05:10<14:19:18, 51.87s/it]Epoch 6 Valid AUC:(0.5010354312319133, 0.0)
Epoch 6 Test AUC:(0.49810236945142594, 0.0)
Epoch 6 a 0.5017743193407653 b 0.3906526960117716 c 0.39065266590962705
  1%|          | 7/1000 [06:02<14:17:16, 51.80s/it]Epoch 7 Valid AUC:(0.5022748149622567, 0.0)
Epoch 7 Test AUC:(0.4981721150191417, 0.0)
Epoch 7 a 0.5015698390707404 b 0.3880487857330253 c 0.3880488013837419
  1%|          | 8/1000 [06:54<14:16:44, 51.82s/it]  1%|          | 8/1000 [07:46<16:03:26, 58.27s/it]
[32m[I 2021-05-14 05:29:23,204][0m Trial 58 finished with value: 0.5095048579808804 and parameters: {'rank': 55.0, 'lambda': 0.1, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.14731246428971032, 'gamma': 0.0028922046846820465}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 05:29:23.904470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7798050893358593, 0.0)
Epoch 0 Test AUC:(0.7195261026175478, 0.0)
Epoch 0 a 0.4121085706970821 b 0.49937363439642446 c 0.4138608361993517
  0%|          | 1/1000 [00:52<14:40:17, 52.87s/it]Epoch 1 Valid AUC:(0.7773859991913054, 0.0)
Epoch 1 Test AUC:(0.7218757796166443, 0.0)
Epoch 1 a 0.3863438775002117 b 0.48312865914233494 c 0.387762024189145
  0%|          | 2/1000 [01:44<14:31:53, 52.42s/it]Epoch 2 Valid AUC:(0.7784549030344666, 0.0)
Epoch 2 Test AUC:(0.725419904509412, 0.0)
Epoch 2 a 0.3807646273007575 b 0.48812722140394704 c 0.3828921660451102
  0%|          | 3/1000 [02:37<14:29:47, 52.34s/it]Epoch 3 Valid AUC:(0.7829277322965387, 0.0)
Epoch 3 Test AUC:(0.7256187005409256, 0.0)
Epoch 3 a 0.37550945253199497 b 0.49341435937334593 c 0.3787540528975742
  0%|          | 4/1000 [03:29<14:28:33, 52.32s/it]Epoch 4 Valid AUC:(0.7865628325025509, 0.0)
Epoch 4 Test AUC:(0.728822533076332, 0.0)
Epoch 4 a 0.37175705405308207 b 0.4949015259622808 c 0.37503878649331673
  0%|          | 5/1000 [04:21<14:26:18, 52.24s/it]Epoch 5 Valid AUC:(0.7843140966491955, 0.0)
Epoch 5 Test AUC:(0.72628063570214, 0.0)
Epoch 5 a 0.3682902757550629 b 0.4921236436971476 c 0.3710078785357101
  1%|          | 6/1000 [05:13<14:25:52, 52.27s/it]Epoch 6 Valid AUC:(0.7872534220189301, 0.0)
Epoch 6 Test AUC:(0.7261067185683484, 0.0)
Epoch 6 a 0.3650018608785971 b 0.48975467358076835 c 0.3672845418184576
  1%|          | 7/1000 [06:06<14:24:56, 52.26s/it]Epoch 7 Valid AUC:(0.7900790407308903, 0.0)
Epoch 7 Test AUC:(0.7253072119529324, 0.0)
Epoch 7 a 0.36219297820173757 b 0.487393803639671 c 0.3636403635474038
  1%|          | 8/1000 [06:58<14:23:03, 52.20s/it]Epoch 8 Valid AUC:(0.7924730244946208, 0.0)
Epoch 8 Test AUC:(0.7263203632700438, 0.0)
Epoch 8 a 0.35999181045133105 b 0.4838186983371405 c 0.36062184557828386
  1%|          | 9/1000 [07:50<14:21:44, 52.17s/it]Epoch 9 Valid AUC:(0.7908725138633872, 0.0)
Epoch 9 Test AUC:(0.7244899835586784, 0.0)
Epoch 9 a 0.3584506765337777 b 0.47861569478238375 c 0.3583434871744582
  1%|          | 10/1000 [08:42<14:18:23, 52.02s/it]Epoch 10 Valid AUC:(0.792741626884865, 0.0)
Epoch 10 Test AUC:(0.7247914119909165, 0.0)
Epoch 10 a 0.3560983683141904 b 0.47490502093399556 c 0.3550913850186576
  1%|          | 11/1000 [09:34<14:17:15, 52.01s/it]Epoch 11 Valid AUC:(0.792365715542465, 0.0)
Epoch 11 Test AUC:(0.7247368101000748, 0.0)
Epoch 11 a 0.3550792259109812 b 0.47022858208094087 c 0.35291333265707525
  1%|          | 12/1000 [10:26<14:18:47, 52.15s/it]Epoch 12 Valid AUC:(0.7935105665080152, 0.0)
Epoch 12 Test AUC:(0.7243519289775749, 0.0)
Epoch 12 a 0.3541652930814256 b 0.46140205008643015 c 0.34937077173044984
  1%|▏         | 13/1000 [11:18<14:19:11, 52.23s/it]Epoch 13 Valid AUC:(0.7933406171997845, 0.0)
Epoch 13 Test AUC:(0.7236647044745448, 0.0)
Epoch 13 a 0.35281468415164374 b 0.44752963525908335 c 0.3442311379871138
  1%|▏         | 14/1000 [12:11<14:19:49, 52.32s/it]Epoch 14 Valid AUC:(0.7941349246484589, 0.0)
Epoch 14 Test AUC:(0.724367983327282, 0.0)
Epoch 14 a 0.3514595922809731 b 0.43177799241883413 c 0.3392599409135055
  2%|▏         | 15/1000 [13:04<14:20:28, 52.42s/it]Epoch 15 Valid AUC:(0.7931255046010884, 0.0)
Epoch 15 Test AUC:(0.7223203033965117, 0.0)
Epoch 15 a 0.3501982986327388 b 0.4155111333254118 c 0.334056578051876
  2%|▏         | 16/1000 [13:56<14:18:49, 52.37s/it]Epoch 16 Valid AUC:(0.7914376445263742, 0.0)
Epoch 16 Test AUC:(0.7223073658566411, 0.0)
Epoch 16 a 0.34906719759916155 b 0.40054239959304244 c 0.3281353517197507
  2%|▏         | 17/1000 [14:48<14:17:56, 52.37s/it]Epoch 17 Valid AUC:(0.7919962441982089, 0.0)
Epoch 17 Test AUC:(0.723858938590975, 0.0)
Epoch 17 a 0.3479154381593708 b 0.3870240065533391 c 0.32231048331174333
  2%|▏         | 18/1000 [15:40<14:15:35, 52.28s/it]Epoch 18 Valid AUC:(0.7947047395290013, 0.0)
Epoch 18 Test AUC:(0.7233417491046835, 0.0)
Epoch 18 a 0.3462949585266996 b 0.3740023349972078 c 0.3163253869449109
  2%|▏         | 19/1000 [16:32<14:13:36, 52.21s/it]Epoch 19 Valid AUC:(0.7943767674046249, 0.0)
Epoch 19 Test AUC:(0.7250817370553276, 0.0)
Epoch 19 a 0.3436256045067094 b 0.36119795649104436 c 0.311222630427397
  2%|▏         | 20/1000 [17:25<14:14:21, 52.31s/it]Epoch 20 Valid AUC:(0.7960687388254177, 0.0)
Epoch 20 Test AUC:(0.7304231239516493, 0.0)
Epoch 20 a 0.3394351418109487 b 0.3513032701653494 c 0.3066531860492599
  2%|▏         | 21/1000 [18:18<14:16:17, 52.48s/it]Epoch 21 Valid AUC:(0.7998121565962303, 0.0)
Epoch 21 Test AUC:(0.7350906514307425, 0.0)
Epoch 21 a 0.3344325798618002 b 0.3416565222519504 c 0.30029671676681796
  2%|▏         | 22/1000 [19:10<14:14:51, 52.44s/it]Epoch 22 Valid AUC:(0.7981529644455917, 0.0)
Epoch 22 Test AUC:(0.7362160677584026, 0.0)
Epoch 22 a 0.330031534375799 b 0.33336825437948736 c 0.29430016299608486
  2%|▏         | 23/1000 [20:02<14:12:25, 52.35s/it]Epoch 23 Valid AUC:(0.7992881804049637, 0.0)
Epoch 23 Test AUC:(0.7361890767837818, 0.0)
Epoch 23 a 0.32686140665585844 b 0.3251732495469107 c 0.2874795509056306
  2%|▏         | 24/1000 [20:55<14:11:25, 52.34s/it]Epoch 24 Valid AUC:(0.7987106644400738, 0.0)
Epoch 24 Test AUC:(0.736258206685357, 0.0)
Epoch 24 a 0.3236424323898446 b 0.3191774880862092 c 0.28150395725214744
  2%|▎         | 25/1000 [21:47<14:13:27, 52.52s/it]Epoch 25 Valid AUC:(0.8001700500413359, 0.0)
Epoch 25 Test AUC:(0.7391442144020737, 0.0)
Epoch 25 a 0.32095473812859304 b 0.3134490674290379 c 0.2755129621842018
  3%|▎         | 26/1000 [22:39<14:07:16, 52.19s/it]Epoch 26 Valid AUC:(0.7987002604788933, 0.0)
Epoch 26 Test AUC:(0.7403101663594471, 0.0)
Epoch 26 a 0.31919491464942995 b 0.3077925969537355 c 0.2689830790942823
  3%|▎         | 27/1000 [23:31<14:06:27, 52.20s/it]Epoch 27 Valid AUC:(0.7991099161299754, 0.0)
Epoch 27 Test AUC:(0.7389025013100115, 0.0)
Epoch 27 a 0.31723991300258597 b 0.3029917675244736 c 0.2628450316022819
  3%|▎         | 28/1000 [24:24<14:06:37, 52.26s/it]Epoch 28 Valid AUC:(0.7988568338148598, 0.0)
Epoch 28 Test AUC:(0.7403337711702949, 0.0)
Epoch 28 a 0.3159746170283803 b 0.29936326371592054 c 0.25846052712477907
  3%|▎         | 29/1000 [25:16<14:07:08, 52.35s/it]Epoch 29 Valid AUC:(0.7998658757926875, 0.0)
Epoch 29 Test AUC:(0.7423123340258679, 0.0)
Epoch 29 a 0.31459410923347625 b 0.29327174835281833 c 0.2519971776296435
  3%|▎         | 30/1000 [26:08<14:05:48, 52.32s/it]Epoch 30 Valid AUC:(0.7998250583795764, 0.0)
Epoch 30 Test AUC:(0.7376056604413371, 0.0)
Epoch 30 a 0.31306986825566896 b 0.28950796238853177 c 0.24768545432109948
  3%|▎         | 31/1000 [27:01<14:05:40, 52.36s/it]Epoch 31 Valid AUC:(0.8013249615014989, 0.0)
Epoch 31 Test AUC:(0.739968894921904, 0.0)
Epoch 31 a 0.31156339539848343 b 0.28428630731715043 c 0.2423977292099709
  3%|▎         | 32/1000 [27:54<14:07:19, 52.52s/it]Epoch 32 Valid AUC:(0.7992398528646639, 0.0)
Epoch 32 Test AUC:(0.7384587214600639, 0.0)
Epoch 32 a 0.31008364161255375 b 0.2809434857526775 c 0.23905871451740535
  3%|▎         | 33/1000 [28:46<14:05:43, 52.47s/it]Epoch 33 Valid AUC:(0.7997611530925227, 0.0)
Epoch 33 Test AUC:(0.7430581365968975, 0.0)
Epoch 33 a 0.30834895372390747 b 0.27718942805794883 c 0.23532057429103545
  3%|▎         | 34/1000 [29:38<14:03:15, 52.38s/it]Epoch 34 Valid AUC:(0.7987520073057697, 0.0)
Epoch 34 Test AUC:(0.7424347062222243, 0.0)
Epoch 34 a 0.3071859325441556 b 0.2748858892102117 c 0.23266983748801517
  4%|▎         | 35/1000 [30:31<14:02:37, 52.39s/it]Epoch 35 Valid AUC:(0.8015388117323996, 0.0)
Epoch 35 Test AUC:(0.7465947537831177, 0.0)
Epoch 35 a 0.3047884167200123 b 0.27105726991261037 c 0.22786587104950873
  4%|▎         | 36/1000 [31:23<14:01:04, 52.35s/it]Epoch 36 Valid AUC:(0.8001443630994858, 0.0)
Epoch 36 Test AUC:(0.7471774946115425, 0.0)
Epoch 36 a 0.3029326052373084 b 0.26991479197738155 c 0.2263647584128428
  4%|▎         | 37/1000 [32:15<13:59:59, 52.34s/it]Epoch 37 Valid AUC:(0.8010955604372693, 0.0)
Epoch 37 Test AUC:(0.7446740678202173, 0.0)
Epoch 37 a 0.3014406567847945 b 0.2674563896787958 c 0.22384170522272467
  4%|▍         | 38/1000 [33:07<13:57:28, 52.23s/it]Epoch 38 Valid AUC:(0.8029714684577837, 0.0)
Epoch 38 Test AUC:(0.7470411459387034, 0.0)
Epoch 38 a 0.2999570570601304 b 0.2652673664347267 c 0.22078197082163584
  4%|▍         | 39/1000 [34:00<14:00:21, 52.47s/it]Epoch 39 Valid AUC:(0.8000244086823181, 0.0)
Epoch 39 Test AUC:(0.7468687337665887, 0.0)
Epoch 39 a 0.2978233908503588 b 0.26374448940787515 c 0.21831327880652138
  4%|▍         | 40/1000 [34:53<13:59:42, 52.48s/it]Epoch 40 Valid AUC:(0.8028199945750737, 0.0)
Epoch 40 Test AUC:(0.7493957781951396, 0.0)
Epoch 40 a 0.2961711074324921 b 0.26166675160348535 c 0.21623102193267293
  4%|▍         | 41/1000 [35:45<13:59:41, 52.53s/it]Epoch 41 Valid AUC:(0.8006575405993375, 0.0)
Epoch 41 Test AUC:(0.7441213492670637, 0.0)
Epoch 41 a 0.295165666152294 b 0.26020338510723423 c 0.2129500623739941
  4%|▍         | 42/1000 [36:37<13:53:57, 52.23s/it]Epoch 42 Valid AUC:(0.8010909377361141, 0.0)
Epoch 42 Test AUC:(0.7473007774807316, 0.0)
Epoch 42 a 0.29310901762853925 b 0.25790169412341396 c 0.21083095052112755
  4%|▍         | 43/1000 [37:29<13:52:57, 52.22s/it]Epoch 43 Valid AUC:(0.8015581893984564, 0.0)
Epoch 43 Test AUC:(0.7481479298146927, 0.0)
Epoch 43 a 0.2923521656445574 b 0.2557113020712701 c 0.2085955765405651
  4%|▍         | 44/1000 [38:21<13:52:16, 52.24s/it]  4%|▍         | 44/1000 [39:14<14:12:30, 53.50s/it]
[32m[I 2021-05-14 06:08:57,819][0m Trial 59 finished with value: 0.8029714684577837 and parameters: {'rank': 75.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.15482733792638653, 'gamma': 0.0019031339545065933}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 06:08:58.502756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7791225700022287, 0.0)
Epoch 0 Test AUC:(0.719297656275723, 0.0)
Epoch 0 a 0.41270829296447864 b 0.5032165063698767 c 0.414190034571308
  0%|          | 1/1000 [00:52<14:32:43, 52.42s/it]Epoch 1 Valid AUC:(0.7782972018978301, 0.0)
Epoch 1 Test AUC:(0.7215749112695758, 0.0)
Epoch 1 a 0.38611905957371656 b 0.4886034886601945 c 0.38729930409723123
  0%|          | 2/1000 [01:44<14:24:50, 51.99s/it]Epoch 2 Valid AUC:(0.7751027346951657, 0.0)
Epoch 2 Test AUC:(0.7238152348459135, 0.0)
Epoch 2 a 0.3815338447899886 b 0.4941325047366336 c 0.38312413604926293
  0%|          | 3/1000 [02:36<14:23:58, 51.99s/it]Epoch 3 Valid AUC:(0.7830245450129136, 0.0)
Epoch 3 Test AUC:(0.7253997670960644, 0.0)
Epoch 3 a 0.3762174115574336 b 0.49855573676241716 c 0.37892585123328854
  0%|          | 4/1000 [03:28<14:23:38, 52.03s/it]Epoch 4 Valid AUC:(0.7854056782569648, 0.0)
Epoch 4 Test AUC:(0.7282952620569887, 0.0)
Epoch 4 a 0.37191778211526466 b 0.5025025973137716 c 0.37501792960483543
  0%|          | 5/1000 [04:19<14:21:20, 51.94s/it]Epoch 5 Valid AUC:(0.7829145383102917, 0.0)
Epoch 5 Test AUC:(0.7264300758313847, 0.0)
Epoch 5 a 0.36883260960310277 b 0.5039880230153351 c 0.37197278437000403
  1%|          | 6/1000 [05:12<14:20:58, 51.97s/it]Epoch 6 Valid AUC:(0.787525070752575, 0.0)
Epoch 6 Test AUC:(0.727460435872217, 0.0)
Epoch 6 a 0.3664244415174787 b 0.505025999466898 c 0.3690692607305899
  1%|          | 7/1000 [06:03<14:19:08, 51.91s/it]Epoch 7 Valid AUC:(0.7892578365178289, 0.0)
Epoch 7 Test AUC:(0.7263200597124329, 0.0)
Epoch 7 a 0.3635556132380871 b 0.5062825180874984 c 0.36591466997470895
  1%|          | 8/1000 [06:56<14:20:31, 52.05s/it]Epoch 8 Valid AUC:(0.7928168088970268, 0.0)
Epoch 8 Test AUC:(0.7267969358928952, 0.0)
Epoch 8 a 0.36070162495616936 b 0.5094519547773319 c 0.3626291336907707
  1%|          | 9/1000 [07:48<14:20:21, 52.09s/it]Epoch 9 Valid AUC:(0.7915767074753479, 0.0)
Epoch 9 Test AUC:(0.7263467214766869, 0.0)
Epoch 9 a 0.3589528381704565 b 0.5120591389341373 c 0.36046606188328933
  1%|          | 10/1000 [08:40<14:21:04, 52.19s/it]Epoch 10 Valid AUC:(0.7923167792461219, 0.0)
Epoch 10 Test AUC:(0.7268751725227997, 0.0)
Epoch 10 a 0.35633712509268484 b 0.5157249767175862 c 0.3571841284422807
  1%|          | 11/1000 [09:32<14:18:37, 52.09s/it]Epoch 11 Valid AUC:(0.7928665718199973, 0.0)
Epoch 11 Test AUC:(0.7264043546681789, 0.0)
Epoch 11 a 0.3552621376946179 b 0.5154414587097629 c 0.3555081394356741
  1%|          | 12/1000 [10:24<14:16:46, 52.03s/it]Epoch 12 Valid AUC:(0.7937003958662373, 0.0)
Epoch 12 Test AUC:(0.7249150711005249, 0.0)
Epoch 12 a 0.3542125055967442 b 0.5152129821134525 c 0.35319531875357063
  1%|▏         | 13/1000 [11:16<14:16:29, 52.07s/it]Epoch 13 Valid AUC:(0.7932498100219771, 0.0)
Epoch 13 Test AUC:(0.723987356286795, 0.0)
Epoch 13 a 0.3526793061127845 b 0.5109953279466456 c 0.350022495032796
  1%|▏         | 14/1000 [12:08<14:17:02, 52.15s/it]Epoch 14 Valid AUC:(0.7942725650306783, 0.0)
Epoch 14 Test AUC:(0.7249091795175964, 0.0)
Epoch 14 a 0.35102445936538806 b 0.5061085263728136 c 0.34557226863905216
  2%|▏         | 15/1000 [13:01<14:15:52, 52.13s/it]Epoch 15 Valid AUC:(0.7930712304754379, 0.0)
Epoch 15 Test AUC:(0.7230637972195141, 0.0)
Epoch 15 a 0.3496890135214362 b 0.49934659583467833 c 0.34024104505957253
  2%|▏         | 16/1000 [13:52<14:13:53, 52.07s/it]Epoch 16 Valid AUC:(0.7913573976639311, 0.0)
Epoch 16 Test AUC:(0.723735078534779, 0.0)
Epoch 16 a 0.3484237652189535 b 0.48970468663113936 c 0.33437543723664775
  2%|▏         | 17/1000 [14:44<14:12:43, 52.05s/it]Epoch 17 Valid AUC:(0.7929155888566158, 0.0)
Epoch 17 Test AUC:(0.7257510516593102, 0.0)
Epoch 17 a 0.34713710067977366 b 0.48006199687059736 c 0.32846782486923265
  2%|▏         | 18/1000 [15:36<14:09:54, 51.93s/it]Epoch 18 Valid AUC:(0.7957157436236765, 0.0)
Epoch 18 Test AUC:(0.7275944244915171, 0.0)
Epoch 18 a 0.3451947924236896 b 0.4667081888053019 c 0.3207605074588922
  2%|▏         | 19/1000 [16:28<14:07:11, 51.82s/it]Epoch 19 Valid AUC:(0.794348653128151, 0.0)
Epoch 19 Test AUC:(0.7303945638834619, 0.0)
Epoch 19 a 0.34287401344214885 b 0.4533400613537257 c 0.31373492207085824
  2%|▏         | 20/1000 [17:20<14:07:57, 51.92s/it]Epoch 20 Valid AUC:(0.7965547427370816, 0.0)
Epoch 20 Test AUC:(0.7356186065235754, 0.0)
Epoch 20 a 0.3391341821888323 b 0.4457144365464178 c 0.30842721378299554
  2%|▏         | 21/1000 [18:12<14:07:11, 51.92s/it]Epoch 21 Valid AUC:(0.8005138267541919, 0.0)
Epoch 21 Test AUC:(0.7405575444350945, 0.0)
Epoch 21 a 0.3348216817412578 b 0.4437835244105855 c 0.3020331804421346
  2%|▏         | 22/1000 [19:03<14:00:33, 51.57s/it]Epoch 22 Valid AUC:(0.7984772994128075, 0.0)
Epoch 22 Test AUC:(0.7410854439469563, 0.0)
Epoch 22 a 0.3303154558842811 b 0.4403592608344387 c 0.29589131960206827
  2%|▏         | 23/1000 [19:54<14:01:14, 51.66s/it]Epoch 23 Valid AUC:(0.8012522042607776, 0.0)
Epoch 23 Test AUC:(0.7409395396225605, 0.0)
Epoch 23 a 0.3264378684027574 b 0.43964811553897515 c 0.2902105321406838
  2%|▏         | 24/1000 [20:46<14:00:59, 51.70s/it]Epoch 24 Valid AUC:(0.8006363328203754, 0.0)
Epoch 24 Test AUC:(0.7422192872049155, 0.0)
Epoch 24 a 0.3226804872393848 b 0.43728421541526763 c 0.2839700696573891
  2%|▎         | 25/1000 [21:38<14:02:33, 51.85s/it]Epoch 25 Valid AUC:(0.8028000722325571, 0.0)
Epoch 25 Test AUC:(0.7459537512706825, 0.0)
Epoch 25 a 0.3192548061040805 b 0.43523958835083715 c 0.2786163358501266
  3%|▎         | 26/1000 [22:30<14:02:46, 51.92s/it]Epoch 26 Valid AUC:(0.8005753905732638, 0.0)
Epoch 26 Test AUC:(0.7460542972472639, 0.0)
Epoch 26 a 0.31703033803454345 b 0.4300795115935251 c 0.27283779545209297
  3%|▎         | 27/1000 [23:23<14:03:23, 52.01s/it]Epoch 27 Valid AUC:(0.802532366956482, 0.0)
Epoch 27 Test AUC:(0.7447359379918849, 0.0)
Epoch 27 a 0.314828580054239 b 0.42528190045529446 c 0.2672701213561313
  3%|▎         | 28/1000 [24:14<14:01:01, 51.92s/it]Epoch 28 Valid AUC:(0.801349723134163, 0.0)
Epoch 28 Test AUC:(0.7459550381839347, 0.0)
Epoch 28 a 0.3135443951042605 b 0.420823523036431 c 0.26357866248014705
  3%|▎         | 29/1000 [25:05<13:55:35, 51.63s/it]Epoch 29 Valid AUC:(0.8031417496982569, 0.0)
Epoch 29 Test AUC:(0.747164958964847, 0.0)
Epoch 29 a 0.312345270779531 b 0.4147601690090878 c 0.25776061553590496
  3%|▎         | 30/1000 [25:57<13:55:45, 51.70s/it]Epoch 30 Valid AUC:(0.8039793480319662, 0.0)
Epoch 30 Test AUC:(0.7450708218932196, 0.0)
Epoch 30 a 0.3109475491752087 b 0.4075057642080894 c 0.25324380895501414
  3%|▎         | 31/1000 [26:49<13:56:24, 51.79s/it]Epoch 31 Valid AUC:(0.805228972961348, 0.0)
Epoch 31 Test AUC:(0.7468740738152663, 0.0)
Epoch 31 a 0.30960705726439325 b 0.40134018539662814 c 0.24750983715057373
  3%|▎         | 32/1000 [27:41<13:57:06, 51.89s/it]Epoch 32 Valid AUC:(0.803481338169534, 0.0)
Epoch 32 Test AUC:(0.7448566940646223, 0.0)
Epoch 32 a 0.30888543507342847 b 0.3922453820705414 c 0.2436008893807889
  3%|▎         | 33/1000 [28:33<13:56:19, 51.89s/it]Epoch 33 Valid AUC:(0.8034060600379971, 0.0)
Epoch 33 Test AUC:(0.7467017984578496, 0.0)
Epoch 33 a 0.3076838863567567 b 0.3842912631735236 c 0.23842790360062174
  3%|▎         | 34/1000 [29:25<13:56:39, 51.97s/it]Epoch 34 Valid AUC:(0.8017689522750231, 0.0)
Epoch 34 Test AUC:(0.7474131664796003, 0.0)
Epoch 34 a 0.30685691538471094 b 0.3790708873233565 c 0.23518929925842785
  4%|▎         | 35/1000 [30:18<13:57:05, 52.05s/it]Epoch 35 Valid AUC:(0.8057844455495068, 0.0)
Epoch 35 Test AUC:(0.7536006496714337, 0.0)
Epoch 35 a 0.30436218957186223 b 0.37087040995688025 c 0.23057576861060122
  4%|▎         | 36/1000 [31:10<13:57:14, 52.11s/it]Epoch 36 Valid AUC:(0.8026705622678948, 0.0)
Epoch 36 Test AUC:(0.7517670804674235, 0.0)
Epoch 36 a 0.30258989115236273 b 0.3658378951146569 c 0.2265646080495846
  4%|▎         | 37/1000 [32:02<13:55:51, 52.08s/it]Epoch 37 Valid AUC:(0.8051022337978772, 0.0)
Epoch 37 Test AUC:(0.750487781808296, 0.0)
Epoch 37 a 0.3008303435395661 b 0.36042978867918435 c 0.22363807872627342
  4%|▍         | 38/1000 [32:54<13:54:12, 52.03s/it]Epoch 38 Valid AUC:(0.8059918147713303, 0.0)
Epoch 38 Test AUC:(0.752111742344199, 0.0)
Epoch 38 a 0.2988964076972823 b 0.35598155334441955 c 0.22099858297548544
  4%|▍         | 39/1000 [33:46<13:53:30, 52.04s/it]Epoch 39 Valid AUC:(0.8045465305232177, 0.0)
Epoch 39 Test AUC:(0.7512628156946245, 0.0)
Epoch 39 a 0.29649452796164655 b 0.3506836407861 c 0.21638827718479534
  4%|▍         | 40/1000 [34:38<13:52:24, 52.03s/it]Epoch 40 Valid AUC:(0.8060908689915368, 0.0)
Epoch 40 Test AUC:(0.7530303162259252, 0.0)
Epoch 40 a 0.29476046703111236 b 0.3455913216175448 c 0.21332499924559947
  4%|▍         | 41/1000 [35:30<13:52:32, 52.09s/it]Epoch 41 Valid AUC:(0.8035859134866566, 0.0)
Epoch 41 Test AUC:(0.7503336942547819, 0.0)
Epoch 41 a 0.29320153878848076 b 0.3416798688036575 c 0.21023780257409247
  4%|▍         | 42/1000 [36:22<13:52:21, 52.13s/it]Epoch 42 Valid AUC:(0.8040476132938827, 0.0)
Epoch 42 Test AUC:(0.7527966794764985, 0.0)
Epoch 42 a 0.2909839588931389 b 0.339021226110113 c 0.2073717378454669
  4%|▍         | 43/1000 [37:15<13:53:58, 52.29s/it]Epoch 43 Valid AUC:(0.8028907909805392, 0.0)
Epoch 43 Test AUC:(0.7540274773252191, 0.0)
Epoch 43 a 0.28954595180464465 b 0.33459743143806997 c 0.2041972462739983
  4%|▍         | 44/1000 [38:08<13:55:30, 52.44s/it]Epoch 44 Valid AUC:(0.8024263101193884, 0.0)
Epoch 44 Test AUC:(0.7537007723775434, 0.0)
Epoch 44 a 0.2879824569407603 b 0.33463837131408136 c 0.20313710972696722
  4%|▍         | 45/1000 [39:00<13:51:30, 52.24s/it]Epoch 45 Valid AUC:(0.8016674425251761, 0.0)
Epoch 45 Test AUC:(0.7538579938427314, 0.0)
Epoch 45 a 0.2858803996018001 b 0.3330812752846501 c 0.2004441176381869
  5%|▍         | 46/1000 [39:52<13:51:27, 52.29s/it]  5%|▍         | 46/1000 [40:44<14:05:00, 53.15s/it]
[32m[I 2021-05-14 06:50:02,417][0m Trial 60 finished with value: 0.8060908689915368 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1361373451753438, 'gamma': 0.0032388268357054725}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 06:50:03.105186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7792837506602504, 0.0)
Epoch 0 Test AUC:(0.7201460741456396, 0.0)
Epoch 0 a 0.4129918028771038 b 0.4985525909683834 c 0.4142112460894364
  0%|          | 1/1000 [00:52<14:25:51, 52.00s/it]Epoch 1 Valid AUC:(0.7792926244009764, 0.0)
Epoch 1 Test AUC:(0.7222030018948964, 0.0)
Epoch 1 a 0.3859757261137128 b 0.4836147721984257 c 0.38692162838020555
  0%|          | 2/1000 [01:44<14:26:23, 52.09s/it]Epoch 2 Valid AUC:(0.7754714037630361, 0.0)
Epoch 2 Test AUC:(0.7246653885523098, 0.0)
Epoch 2 a 0.3817313278105177 b 0.488802413405547 c 0.38274212964103976
  0%|          | 3/1000 [02:35<14:22:18, 51.89s/it]Epoch 3 Valid AUC:(0.7818358507963186, 0.0)
Epoch 3 Test AUC:(0.7252226818469244, 0.0)
Epoch 3 a 0.37758698405874086 b 0.49385744585117825 c 0.3795489973465442
  0%|          | 4/1000 [03:27<14:18:24, 51.71s/it]Epoch 4 Valid AUC:(0.7844331936815357, 0.0)
Epoch 4 Test AUC:(0.7282710928855122, 0.0)
Epoch 4 a 0.3740300860563274 b 0.4978457679091325 c 0.3762784369994457
  0%|          | 5/1000 [04:18<14:14:19, 51.52s/it]Epoch 5 Valid AUC:(0.7808213505195665, 0.0)
Epoch 5 Test AUC:(0.7255395788909441, 0.0)
Epoch 5 a 0.37063931663271404 b 0.4947544336918614 c 0.37261175791502477
  1%|          | 6/1000 [05:10<14:15:03, 51.61s/it]Epoch 6 Valid AUC:(0.7872571078765742, 0.0)
Epoch 6 Test AUC:(0.7263401928503213, 0.0)
Epoch 6 a 0.3672647421029012 b 0.4929444759304615 c 0.36888826439078426
  1%|          | 7/1000 [06:02<14:16:06, 51.73s/it]Epoch 7 Valid AUC:(0.7893171498619275, 0.0)
Epoch 7 Test AUC:(0.7254876149584965, 0.0)
Epoch 7 a 0.3637871195372921 b 0.49124879940174954 c 0.3649439299610299
  1%|          | 8/1000 [06:53<14:14:02, 51.66s/it]Epoch 8 Valid AUC:(0.7928904081434754, 0.0)
Epoch 8 Test AUC:(0.7267688033706388, 0.0)
Epoch 8 a 0.36114848919317755 b 0.48913976394194714 c 0.36161962553289095
  1%|          | 9/1000 [07:45<14:13:29, 51.67s/it]Epoch 9 Valid AUC:(0.7909579409193622, 0.0)
Epoch 9 Test AUC:(0.7250424712370293, 0.0)
Epoch 9 a 0.359541440094021 b 0.48607022955384055 c 0.359454823931458
  1%|          | 10/1000 [08:37<14:13:01, 51.70s/it]Epoch 10 Valid AUC:(0.7931569971532055, 0.0)
Epoch 10 Test AUC:(0.7258452314769798, 0.0)
Epoch 10 a 0.3569487422045088 b 0.48466776542260614 c 0.3559738518726418
  1%|          | 11/1000 [09:28<14:10:42, 51.61s/it]Epoch 11 Valid AUC:(0.7929138869028775, 0.0)
Epoch 11 Test AUC:(0.7250256515801057, 0.0)
Epoch 11 a 0.35571673248615304 b 0.48364034774797543 c 0.35344379744539317
  1%|          | 12/1000 [10:20<14:09:25, 51.58s/it]Epoch 12 Valid AUC:(0.7942837328204944, 0.0)
Epoch 12 Test AUC:(0.7251231876333332, 0.0)
Epoch 12 a 0.3544992327810053 b 0.4803752868588062 c 0.3492337813679601
  1%|▏         | 13/1000 [11:11<14:10:08, 51.68s/it]Epoch 13 Valid AUC:(0.7946751514221064, 0.0)
Epoch 13 Test AUC:(0.7236084479809505, 0.0)
Epoch 13 a 0.3527622661840028 b 0.47051635924239515 c 0.34377437110398135
  1%|▏         | 14/1000 [12:03<14:06:07, 51.49s/it]Epoch 14 Valid AUC:(0.7950547076112171, 0.0)
Epoch 14 Test AUC:(0.7234946267032131, 0.0)
Epoch 14 a 0.35112872623821617 b 0.4598147497330633 c 0.33882860590514524
  2%|▏         | 15/1000 [12:55<14:08:52, 51.71s/it]2021-05-14 07:03:58.373757: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 89965022 get requests, put_count=89965022 evicted_count=55000 eviction_rate=0.000611349 and unsatisfied allocation rate=0.000611493
Epoch 15 Valid AUC:(0.7927644264006818, 0.0)
Epoch 15 Test AUC:(0.7220143985583767, 0.0)
Epoch 15 a 0.3497420187207535 b 0.44761867488413987 c 0.33382411088262287
  2%|▏         | 16/1000 [13:47<14:10:24, 51.85s/it]Epoch 16 Valid AUC:(0.7913477806000363, 0.0)
Epoch 16 Test AUC:(0.7217163562899118, 0.0)
Epoch 16 a 0.348377202598142 b 0.4352553730279627 c 0.328031441335467
  2%|▏         | 17/1000 [14:39<14:09:40, 51.86s/it]Epoch 17 Valid AUC:(0.7919580296977804, 0.0)
Epoch 17 Test AUC:(0.7225635898575998, 0.0)
Epoch 17 a 0.3472104346608252 b 0.4239321723430449 c 0.32254725466791534
  2%|▏         | 18/1000 [15:31<14:09:36, 51.91s/it]Epoch 18 Valid AUC:(0.7942892411014938, 0.0)
Epoch 18 Test AUC:(0.7214774051445636, 0.0)
Epoch 18 a 0.345707788973507 b 0.41066629144267536 c 0.3165004566401783
  2%|▏         | 19/1000 [16:22<14:06:31, 51.78s/it]Epoch 19 Valid AUC:(0.7924158488454284, 0.0)
Epoch 19 Test AUC:(0.720947479064989, 0.0)
Epoch 19 a 0.34424102648163224 b 0.3962011439819451 c 0.31105899373050666
  2%|▏         | 20/1000 [17:14<14:03:00, 51.61s/it]  2%|▏         | 20/1000 [18:05<14:46:42, 54.29s/it]
[32m[I 2021-05-14 07:08:27,976][0m Trial 61 finished with value: 0.7950547076112171 and parameters: {'rank': 55.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.14127225783557784, 'gamma': 0.0017289764256475917}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 07:08:28.754256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7665392519335066, 0.0)
Epoch 0 Test AUC:(0.7134695297143118, 0.0)
Epoch 0 a 0.4601583402281556 b 0.5254479046438781 c 0.45149689463062787
  0%|          | 1/1000 [00:52<14:26:57, 52.07s/it]Epoch 1 Valid AUC:(0.7863668515043107, 0.0)
Epoch 1 Test AUC:(0.7263217442434008, 0.0)
Epoch 1 a 0.37458911406202333 b 0.5230797849430645 c 0.3734972185532092
  0%|          | 2/1000 [01:43<14:19:28, 51.67s/it]Epoch 2 Valid AUC:(0.788301570484989, 0.0)
Epoch 2 Test AUC:(0.7280090927390264, 0.0)
Epoch 2 a 0.36761103483512847 b 0.5255890764460956 c 0.36755726149144546
  0%|          | 3/1000 [02:35<14:21:03, 51.82s/it]Epoch 3 Valid AUC:(0.7903083187623196, 0.0)
Epoch 3 Test AUC:(0.72839104089644, 0.0)
Epoch 3 a 0.3657913512627124 b 0.5206714375637906 c 0.3659323122299893
  0%|          | 4/1000 [03:27<14:23:07, 52.00s/it]Epoch 4 Valid AUC:(0.7903041036073155, 0.0)
Epoch 4 Test AUC:(0.7295188814095286, 0.0)
Epoch 4 a 0.36525910523096083 b 0.5150157206614973 c 0.36552078215409095
  0%|          | 5/1000 [04:19<14:18:17, 51.76s/it]Epoch 5 Valid AUC:(0.7902576882017881, 0.0)
Epoch 5 Test AUC:(0.7285545088076791, 0.0)
Epoch 5 a 0.36474687526643396 b 0.5097519529297558 c 0.3650214179180997
  1%|          | 6/1000 [05:10<14:16:46, 51.72s/it]Epoch 6 Valid AUC:(0.7890808230763109, 0.0)
Epoch 6 Test AUC:(0.7280677135616188, 0.0)
Epoch 6 a 0.3642714533887399 b 0.5054160953767343 c 0.36458078344583034
  1%|          | 7/1000 [06:02<14:14:55, 51.66s/it]Epoch 7 Valid AUC:(0.7899068319765447, 0.0)
Epoch 7 Test AUC:(0.7277660628054968, 0.0)
Epoch 7 a 0.3644260959006411 b 0.5022440877119061 c 0.3647140275304706
  1%|          | 8/1000 [06:53<14:11:30, 51.50s/it]Epoch 8 Valid AUC:(0.7913897168426757, 0.0)
Epoch 8 Test AUC:(0.7291748138215971, 0.0)
Epoch 8 a 0.3639926117670608 b 0.5000176781140103 c 0.36432785707220466
  1%|          | 9/1000 [07:44<14:10:17, 51.48s/it]Epoch 9 Valid AUC:(0.7892635049977872, 0.0)
Epoch 9 Test AUC:(0.729452949551517, 0.0)
Epoch 9 a 0.364185302790022 b 0.49752091725827224 c 0.36452990920251044
  1%|          | 10/1000 [08:36<14:09:28, 51.48s/it]Epoch 10 Valid AUC:(0.7903308158225021, 0.0)
Epoch 10 Test AUC:(0.7286681590670442, 0.0)
Epoch 10 a 0.36338906904581325 b 0.49638400147378564 c 0.3637201205585564
  1%|          | 11/1000 [09:28<14:12:48, 51.74s/it]Epoch 11 Valid AUC:(0.7907979752102441, 0.0)
Epoch 11 Test AUC:(0.7294144789686501, 0.0)
Epoch 11 a 0.3637445161879902 b 0.49528345147848607 c 0.36409055113312705
  1%|          | 12/1000 [10:20<14:10:32, 51.65s/it]Epoch 12 Valid AUC:(0.7913175235022895, 0.0)
Epoch 12 Test AUC:(0.7300294995148615, 0.0)
Epoch 12 a 0.36402561619008333 b 0.49472652894390423 c 0.3643883824108592
  1%|▏         | 13/1000 [11:11<14:08:10, 51.56s/it]Epoch 13 Valid AUC:(0.7923574761896159, 0.0)
Epoch 13 Test AUC:(0.7299152635175711, 0.0)
Epoch 13 a 0.36387879046156135 b 0.49418603222614804 c 0.36420323413382594
  1%|▏         | 14/1000 [12:03<14:07:39, 51.58s/it]Epoch 14 Valid AUC:(0.7922980949211589, 0.0)
Epoch 14 Test AUC:(0.7296684583534713, 0.0)
Epoch 14 a 0.36361415777168044 b 0.4935433064068347 c 0.36389150777812934
  2%|▏         | 15/1000 [12:54<14:07:42, 51.64s/it]Epoch 15 Valid AUC:(0.7910060236756529, 0.0)
Epoch 15 Test AUC:(0.7287255314555182, 0.0)
Epoch 15 a 0.3636478766109382 b 0.4933689594628585 c 0.363927181098063
  2%|▏         | 16/1000 [13:46<14:05:40, 51.57s/it]Epoch 16 Valid AUC:(0.7886867528615328, 0.0)
Epoch 16 Test AUC:(0.7283595564140849, 0.0)
Epoch 16 a 0.3633994530863925 b 0.4934081514356602 c 0.36369098863851135
  2%|▏         | 17/1000 [14:37<14:05:41, 51.62s/it]Epoch 17 Valid AUC:(0.789987494074689, 0.0)
Epoch 17 Test AUC:(0.7284540654421212, 0.0)
Epoch 17 a 0.36338448914243904 b 0.4935696346299269 c 0.3637033347152848
  2%|▏         | 18/1000 [15:30<14:06:53, 51.74s/it]Epoch 18 Valid AUC:(0.792150415831385, 0.0)
Epoch 18 Test AUC:(0.7275354530812613, 0.0)
Epoch 18 a 0.36329772810580985 b 0.49368054190391986 c 0.3635211287130053
  2%|▏         | 19/1000 [16:21<14:05:00, 51.68s/it]  2%|▏         | 19/1000 [17:13<14:49:13, 54.39s/it]
[32m[I 2021-05-14 07:26:01,767][0m Trial 62 finished with value: 0.7923574761896159 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.0005, 'alpha': 0.14473393830194303, 'gamma': 0.0022126833461071052}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 07:26:02.561676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807358850158413, 0.0)
Epoch 0 Test AUC:(0.7200569735736297, 0.0)
Epoch 0 a 0.4133384993498474 b 0.5012067207388236 c 0.41449133209299516
  0%|          | 1/1000 [00:51<14:22:49, 51.82s/it]Epoch 1 Valid AUC:(0.7797389668952158, 0.0)
Epoch 1 Test AUC:(0.7225524351842614, 0.0)
Epoch 1 a 0.3856727586425766 b 0.4865434886943886 c 0.3864720556697615
  0%|          | 2/1000 [01:42<14:15:34, 51.44s/it]Epoch 2 Valid AUC:(0.776009377498527, 0.0)
Epoch 2 Test AUC:(0.7244495077853955, 0.0)
Epoch 2 a 0.3813587143507522 b 0.4914788237399978 c 0.38251318370312515
  0%|          | 3/1000 [02:34<14:16:22, 51.54s/it]Epoch 3 Valid AUC:(0.7824150802492719, 0.0)
Epoch 3 Test AUC:(0.7258198609014372, 0.0)
Epoch 3 a 0.3763779984033803 b 0.49501542066424425 c 0.3786164668484233
  0%|          | 4/1000 [03:25<14:12:19, 51.34s/it]Epoch 4 Valid AUC:(0.7848082117545414, 0.0)
Epoch 4 Test AUC:(0.7277611545782094, 0.0)
Epoch 4 a 0.3723359509133237 b 0.4993579028477851 c 0.3749288566995195
  0%|          | 5/1000 [04:17<14:12:28, 51.41s/it]Epoch 5 Valid AUC:(0.7834149844784895, 0.0)
Epoch 5 Test AUC:(0.726327216831317, 0.0)
Epoch 5 a 0.36964846065106766 b 0.5014523510002274 c 0.3724105675335621
  1%|          | 6/1000 [05:09<14:14:41, 51.59s/it]Epoch 6 Valid AUC:(0.7867396959978434, 0.0)
Epoch 6 Test AUC:(0.7272307154435178, 0.0)
Epoch 6 a 0.3677311068929177 b 0.5034485416153307 c 0.37051368209437824
  1%|          | 7/1000 [06:00<14:12:35, 51.52s/it]Epoch 7 Valid AUC:(0.7889236473922593, 0.0)
Epoch 7 Test AUC:(0.7271513500923557, 0.0)
Epoch 7 a 0.3662218065928645 b 0.5021291039359401 c 0.3684945103508126
  1%|          | 8/1000 [06:51<14:11:07, 51.48s/it]Epoch 8 Valid AUC:(0.7916223475179147, 0.0)
Epoch 8 Test AUC:(0.7276326641995813, 0.0)
Epoch 8 a 0.36371439413525447 b 0.5021408896451025 c 0.365461720966957
  1%|          | 9/1000 [07:43<14:13:05, 51.65s/it]Epoch 9 Valid AUC:(0.7909104220634064, 0.0)
Epoch 9 Test AUC:(0.7287178270778425, 0.0)
Epoch 9 a 0.3612170526439275 b 0.503528021950597 c 0.36270840912757507
  1%|          | 10/1000 [08:35<14:13:16, 51.71s/it]Epoch 10 Valid AUC:(0.7920065123106722, 0.0)
Epoch 10 Test AUC:(0.7279935215162212, 0.0)
Epoch 10 a 0.3580268122540633 b 0.5065328503398588 c 0.3589385592601669
  1%|          | 11/1000 [09:27<14:13:31, 51.78s/it]Epoch 11 Valid AUC:(0.7926530471133808, 0.0)
Epoch 11 Test AUC:(0.7267974104688786, 0.0)
Epoch 11 a 0.35658065018279694 b 0.5054177475167472 c 0.3568926445795017
  1%|          | 12/1000 [10:19<14:13:02, 51.80s/it]Epoch 12 Valid AUC:(0.793336878796882, 0.0)
Epoch 12 Test AUC:(0.7251557452559749, 0.0)
Epoch 12 a 0.35546705138755275 b 0.5068009216900563 c 0.3545064526784348
  1%|▏         | 13/1000 [11:11<14:11:59, 51.79s/it]Epoch 13 Valid AUC:(0.7933069959239029, 0.0)
Epoch 13 Test AUC:(0.7241178988858918, 0.0)
Epoch 13 a 0.354116612756756 b 0.5035891719387331 c 0.35099771091156085
  1%|▏         | 14/1000 [12:03<14:11:10, 51.80s/it]Epoch 14 Valid AUC:(0.7949565492235882, 0.0)
Epoch 14 Test AUC:(0.7259238144190883, 0.0)
Epoch 14 a 0.3528262498513074 b 0.4985683927953363 c 0.3465198207669095
  2%|▏         | 15/1000 [12:54<14:10:00, 51.78s/it]Epoch 15 Valid AUC:(0.7933192274348053, 0.0)
Epoch 15 Test AUC:(0.722618448276, 0.0)
Epoch 15 a 0.35165852230319555 b 0.4927813271041847 c 0.34119460496384374
  2%|▏         | 16/1000 [13:46<14:07:39, 51.69s/it]Epoch 16 Valid AUC:(0.792540092749917, 0.0)
Epoch 16 Test AUC:(0.7232119632618845, 0.0)
Epoch 16 a 0.35057872527801776 b 0.48673228460778173 c 0.33666483659139823
  2%|▏         | 17/1000 [14:37<14:04:48, 51.56s/it]Epoch 17 Valid AUC:(0.7939592274015864, 0.0)
Epoch 17 Test AUC:(0.7262802936653953, 0.0)
Epoch 17 a 0.34957620873297723 b 0.48205823107984225 c 0.33266225888935375
  2%|▏         | 18/1000 [15:29<14:02:51, 51.50s/it]Epoch 18 Valid AUC:(0.7964217904171925, 0.0)
Epoch 18 Test AUC:(0.7259373291459655, 0.0)
Epoch 18 a 0.34748278699170654 b 0.4754069370762923 c 0.3275204900524746
  2%|▏         | 19/1000 [16:20<14:01:15, 51.45s/it]Epoch 19 Valid AUC:(0.7954853070333772, 0.0)
Epoch 19 Test AUC:(0.7276099187560547, 0.0)
Epoch 19 a 0.3449487103302954 b 0.468362502948619 c 0.3226045012713918
  2%|▏         | 20/1000 [17:11<13:58:49, 51.36s/it]Epoch 20 Valid AUC:(0.7974112650533963, 0.0)
Epoch 20 Test AUC:(0.7320825579734432, 0.0)
Epoch 20 a 0.34120042888931107 b 0.4678881654677017 c 0.31788670668899416
  2%|▏         | 21/1000 [18:02<13:56:32, 51.27s/it]Epoch 21 Valid AUC:(0.8009779564592251, 0.0)
Epoch 21 Test AUC:(0.7370140651366824, 0.0)
Epoch 21 a 0.3366509484093434 b 0.46657186836543935 c 0.31184729759841856
  2%|▏         | 22/1000 [18:54<13:56:55, 51.35s/it]Epoch 22 Valid AUC:(0.7989309456979766, 0.0)
Epoch 22 Test AUC:(0.737233238007265, 0.0)
Epoch 22 a 0.3319116875199485 b 0.4653936913555537 c 0.30641617771365515
  2%|▏         | 23/1000 [19:45<13:58:03, 51.47s/it]Epoch 23 Valid AUC:(0.8000960137721276, 0.0)
Epoch 23 Test AUC:(0.7374345351824746, 0.0)
Epoch 23 a 0.3280625073482813 b 0.46382075428243136 c 0.3015171457944022
  2%|▏         | 24/1000 [20:37<13:57:06, 51.46s/it]Epoch 24 Valid AUC:(0.7991037068183322, 0.0)
Epoch 24 Test AUC:(0.7381764727382883, 0.0)
Epoch 24 a 0.3247673785542578 b 0.460720057338776 c 0.29632829402534056
  2%|▎         | 25/1000 [21:28<13:55:29, 51.42s/it]Epoch 25 Valid AUC:(0.801467059259548, 0.0)
Epoch 25 Test AUC:(0.7417333727034728, 0.0)
Epoch 25 a 0.3220998680207811 b 0.45446911849965993 c 0.2921096319763713
  3%|▎         | 26/1000 [22:20<13:55:00, 51.44s/it]Epoch 26 Valid AUC:(0.7993006592630585, 0.0)
Epoch 26 Test AUC:(0.7418804057491263, 0.0)
Epoch 26 a 0.32018300243306685 b 0.44927768580150795 c 0.2876410423450067
  3%|▎         | 27/1000 [23:11<13:56:28, 51.58s/it]Epoch 27 Valid AUC:(0.801151517292783, 0.0)
Epoch 27 Test AUC:(0.7417247277247491, 0.0)
Epoch 27 a 0.31823174778364555 b 0.44234317619076197 c 0.28250829779526115
  3%|▎         | 28/1000 [24:03<13:57:12, 51.68s/it]Epoch 28 Valid AUC:(0.7995481089827826, 0.0)
Epoch 28 Test AUC:(0.7428129133527421, 0.0)
Epoch 28 a 0.31698665772405427 b 0.43320220498971534 c 0.2790208962002031
  3%|▎         | 29/1000 [24:55<13:55:20, 51.62s/it]Epoch 29 Valid AUC:(0.8015422182030596, 0.0)
Epoch 29 Test AUC:(0.7448255900981456, 0.0)
Epoch 29 a 0.3156016877959192 b 0.42389740652481556 c 0.27399182550504175
  3%|▎         | 30/1000 [25:46<13:53:23, 51.55s/it]Epoch 30 Valid AUC:(0.8024870101456744, 0.0)
Epoch 30 Test AUC:(0.7429368289899092, 0.0)
Epoch 30 a 0.31426897615014426 b 0.4152204879452765 c 0.26961676671471396
  3%|▎         | 31/1000 [26:38<13:52:19, 51.54s/it]Epoch 31 Valid AUC:(0.80334384004399, 0.0)
Epoch 31 Test AUC:(0.7442293088900878, 0.0)
Epoch 31 a 0.3127986984833385 b 0.40586737901631975 c 0.2647795788419079
  3%|▎         | 32/1000 [27:29<13:50:32, 51.48s/it]Epoch 32 Valid AUC:(0.8015829792261372, 0.0)
Epoch 32 Test AUC:(0.7423495476236978, 0.0)
Epoch 32 a 0.31190308526727994 b 0.39660011900502673 c 0.2602964794371929
  3%|▎         | 33/1000 [28:21<13:49:44, 51.48s/it]Epoch 33 Valid AUC:(0.8021614384424967, 0.0)
Epoch 33 Test AUC:(0.7453383801368078, 0.0)
Epoch 33 a 0.3107956952492236 b 0.38815018588628325 c 0.2566568046148634
  3%|▎         | 34/1000 [29:12<13:49:42, 51.54s/it]Epoch 34 Valid AUC:(0.8010494077580341, 0.0)
Epoch 34 Test AUC:(0.7449474107602511, 0.0)
Epoch 34 a 0.3103888198523454 b 0.3787191970727333 c 0.2518058351467793
  4%|▎         | 35/1000 [30:04<13:48:35, 51.52s/it]Epoch 35 Valid AUC:(0.8041502469996248, 0.0)
Epoch 35 Test AUC:(0.7511889656859716, 0.0)
Epoch 35 a 0.3085513137715683 b 0.37026670934928496 c 0.2468800387032315
  4%|▎         | 36/1000 [30:55<13:46:47, 51.46s/it]Epoch 36 Valid AUC:(0.8021146142092263, 0.0)
Epoch 36 Test AUC:(0.750278134661055, 0.0)
Epoch 36 a 0.30701261749809655 b 0.363911261381038 c 0.24343254277763712
  4%|▎         | 37/1000 [31:46<13:45:27, 51.43s/it]Epoch 37 Valid AUC:(0.8037659553292918, 0.0)
Epoch 37 Test AUC:(0.7498660787191839, 0.0)
Epoch 37 a 0.3050199041903858 b 0.3576285051747827 c 0.23997734151255917
  4%|▍         | 38/1000 [32:38<13:46:37, 51.56s/it]Epoch 38 Valid AUC:(0.8058128930398151, 0.0)
Epoch 38 Test AUC:(0.7521218196017915, 0.0)
Epoch 38 a 0.3020356427615797 b 0.3534070590971941 c 0.23683978137475864
  4%|▍         | 39/1000 [33:30<13:44:22, 51.47s/it]Epoch 39 Valid AUC:(0.8045512390910148, 0.0)
Epoch 39 Test AUC:(0.7526704465403857, 0.0)
Epoch 39 a 0.2977197673958792 b 0.34738751298465 c 0.23313076455348455
  4%|▍         | 40/1000 [34:21<13:45:10, 51.57s/it]Epoch 40 Valid AUC:(0.8066324760394133, 0.0)
Epoch 40 Test AUC:(0.7555708796568127, 0.0)
Epoch 40 a 0.2947274994262507 b 0.34364297998023463 c 0.22947836635817945
  4%|▍         | 41/1000 [35:13<13:44:33, 51.59s/it]Epoch 41 Valid AUC:(0.8037569572741738, 0.0)
Epoch 41 Test AUC:(0.7532145799712457, 0.0)
Epoch 41 a 0.2923648426050631 b 0.3377001085271778 c 0.2261528222853509
  4%|▍         | 42/1000 [36:05<13:45:07, 51.68s/it]Epoch 42 Valid AUC:(0.8051434805441978, 0.0)
Epoch 42 Test AUC:(0.7576762227072902, 0.0)
Epoch 42 a 0.29000114779956865 b 0.33343478476617416 c 0.2221560483307426
  4%|▍         | 43/1000 [36:57<13:44:10, 51.67s/it]Epoch 43 Valid AUC:(0.8045640908922858, 0.0)
Epoch 43 Test AUC:(0.7579673729353481, 0.0)
Epoch 43 a 0.28854158997415774 b 0.32718240501175466 c 0.21891636447887305
  4%|▍         | 44/1000 [37:48<13:42:37, 51.63s/it]Epoch 44 Valid AUC:(0.8051494873643571, 0.0)
Epoch 44 Test AUC:(0.7577216323606163, 0.0)
Epoch 44 a 0.2870498601819428 b 0.32464431717961845 c 0.2171807543372724
  4%|▍         | 45/1000 [38:39<13:40:26, 51.55s/it]Epoch 45 Valid AUC:(0.802913158599963, 0.0)
Epoch 45 Test AUC:(0.7567905527604099, 0.0)
Epoch 45 a 0.28539346080550726 b 0.3216456636576585 c 0.21469300979339861
  5%|▍         | 46/1000 [39:31<13:41:59, 51.70s/it]  5%|▍         | 46/1000 [40:23<13:57:51, 52.70s/it]
[32m[I 2021-05-14 08:06:46,139][0m Trial 63 finished with value: 0.8066324760394133 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1295118958268836, 'gamma': 0.002385600569231635}. Best is trial 52 with value: 0.8075322610457464.[0m
2021-05-14 08:06:46.809796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807323978049062, 0.0)
Epoch 0 Test AUC:(0.7200566144350478, 0.0)
Epoch 0 a 0.41333952684037883 b 0.5013669753818205 c 0.414494835574862
  0%|          | 1/1000 [00:52<14:28:03, 52.14s/it]Epoch 1 Valid AUC:(0.7797481623154511, 0.0)
Epoch 1 Test AUC:(0.7225543591409506, 0.0)
Epoch 1 a 0.3856723369127308 b 0.48676438722572096 c 0.3864770078922901
  0%|          | 2/1000 [01:43<14:20:04, 51.71s/it]Epoch 2 Valid AUC:(0.7760013150053284, 0.0)
Epoch 2 Test AUC:(0.7244467030840884, 0.0)
Epoch 2 a 0.38135748627919785 b 0.4917296086038862 c 0.3825183827992176
  0%|          | 3/1000 [02:35<14:18:18, 51.65s/it]Epoch 3 Valid AUC:(0.7823908274085009, 0.0)
Epoch 3 Test AUC:(0.7258103565553923, 0.0)
Epoch 3 a 0.37637287600179553 b 0.4952764322820084 c 0.37861813943630734
  0%|          | 4/1000 [03:26<14:15:55, 51.56s/it]Epoch 4 Valid AUC:(0.7847951305483615, 0.0)
Epoch 4 Test AUC:(0.7277509918114309, 0.0)
Epoch 4 a 0.37233391284223055 b 0.49961079953901727 c 0.37493037967614723
  0%|          | 5/1000 [04:17<14:10:07, 51.26s/it]Epoch 5 Valid AUC:(0.7835512292073799, 0.0)
Epoch 5 Test AUC:(0.726296412146992, 0.0)
Epoch 5 a 0.3696422649461259 b 0.5017083822121803 c 0.3724047565004475
  1%|          | 6/1000 [05:08<14:11:11, 51.38s/it]Epoch 6 Valid AUC:(0.78682963553809, 0.0)
Epoch 6 Test AUC:(0.7272823758183544, 0.0)
Epoch 6 a 0.36771967011678147 b 0.5038464800932517 c 0.3705313504341862
  1%|          | 7/1000 [06:00<14:09:13, 51.31s/it]Epoch 7 Valid AUC:(0.7889997867533988, 0.0)
Epoch 7 Test AUC:(0.7272562869656479, 0.0)
Epoch 7 a 0.36627397049120974 b 0.5026308659096839 c 0.36856232826378743
  1%|          | 8/1000 [06:51<14:11:23, 51.50s/it]Epoch 8 Valid AUC:(0.7915440448300356, 0.0)
Epoch 8 Test AUC:(0.7275645347554845, 0.0)
Epoch 8 a 0.3637750771203991 b 0.5026819392948803 c 0.3655181588901121
  1%|          | 9/1000 [07:43<14:11:22, 51.55s/it]Epoch 9 Valid AUC:(0.7910543166129775, 0.0)
Epoch 9 Test AUC:(0.7287465196852686, 0.0)
Epoch 9 a 0.3612545832421938 b 0.5041998262016826 c 0.3627602432815122
  1%|          | 10/1000 [08:34<14:09:32, 51.49s/it]Epoch 10 Valid AUC:(0.7920070300737071, 0.0)
Epoch 10 Test AUC:(0.7280226758732526, 0.0)
Epoch 10 a 0.3580139098872601 b 0.5072879509426939 c 0.3589648435293309
  1%|          | 11/1000 [09:26<14:07:47, 51.43s/it]Epoch 11 Valid AUC:(0.7927064625726121, 0.0)
Epoch 11 Test AUC:(0.7268427132357219, 0.0)
Epoch 11 a 0.3565096719044315 b 0.5064889309511817 c 0.3569289302562084
  1%|          | 12/1000 [10:17<14:08:06, 51.50s/it]Epoch 12 Valid AUC:(0.7934817383849808, 0.0)
Epoch 12 Test AUC:(0.7255095908193473, 0.0)
Epoch 12 a 0.35536467795160936 b 0.508082328248072 c 0.35450511079438973
  1%|▏         | 13/1000 [11:09<14:08:32, 51.58s/it]Epoch 13 Valid AUC:(0.7935985580289227, 0.0)
Epoch 13 Test AUC:(0.7242770443077692, 0.0)
Epoch 13 a 0.3540108482122901 b 0.5049537158228262 c 0.3511254893582112
  1%|▏         | 14/1000 [12:00<14:06:03, 51.48s/it]Epoch 14 Valid AUC:(0.7949596622097557, 0.0)
Epoch 14 Test AUC:(0.7258183345624638, 0.0)
Epoch 14 a 0.35272556915129694 b 0.500111848955423 c 0.346676690837507
  2%|▏         | 15/1000 [12:52<14:06:41, 51.57s/it]Epoch 15 Valid AUC:(0.7933406056654595, 0.0)
Epoch 15 Test AUC:(0.7227613939825536, 0.0)
Epoch 15 a 0.3515462469407011 b 0.49475667917992266 c 0.34136057895433974
  2%|▏         | 16/1000 [13:44<14:05:36, 51.56s/it]Epoch 16 Valid AUC:(0.7925071814758207, 0.0)
Epoch 16 Test AUC:(0.7233775860046158, 0.0)
Epoch 16 a 0.35039626370733173 b 0.488387976793696 c 0.33674780529749465
  2%|▏         | 17/1000 [14:36<14:06:58, 51.70s/it]Epoch 17 Valid AUC:(0.7939248717736775, 0.0)
Epoch 17 Test AUC:(0.7261059917402658, 0.0)
Epoch 17 a 0.34928387475445477 b 0.4837677092019701 c 0.33271579453403083
  2%|▏         | 18/1000 [15:28<14:07:57, 51.81s/it]Epoch 18 Valid AUC:(0.7964098152246242, 0.0)
Epoch 18 Test AUC:(0.7258066753849267, 0.0)
Epoch 18 a 0.34706010023353084 b 0.477383823941651 c 0.3274762327042624
  2%|▏         | 19/1000 [16:19<14:05:05, 51.69s/it]Epoch 19 Valid AUC:(0.7951746940681765, 0.0)
Epoch 19 Test AUC:(0.7270126114377626, 0.0)
Epoch 19 a 0.34440980806676913 b 0.4709017877007874 c 0.3225831664064281
  2%|▏         | 20/1000 [17:11<14:03:46, 51.66s/it]Epoch 20 Valid AUC:(0.7974603679566566, 0.0)
Epoch 20 Test AUC:(0.7315268465987731, 0.0)
Epoch 20 a 0.3406240875932053 b 0.47033044450000017 c 0.3176053726457254
  2%|▏         | 21/1000 [18:02<14:00:26, 51.51s/it]Epoch 21 Valid AUC:(0.8013382746757711, 0.0)
Epoch 21 Test AUC:(0.7366093971884982, 0.0)
Epoch 21 a 0.33639151259687106 b 0.4686805379222816 c 0.3114966589440282
  2%|▏         | 22/1000 [18:53<13:58:44, 51.46s/it]Epoch 22 Valid AUC:(0.799883484862239, 0.0)
Epoch 22 Test AUC:(0.7373588167981034, 0.0)
Epoch 22 a 0.3324357429500557 b 0.46625186817746767 c 0.3062927838062616
  2%|▏         | 23/1000 [19:45<13:58:06, 51.47s/it]Epoch 23 Valid AUC:(0.8006658043024283, 0.0)
Epoch 23 Test AUC:(0.7377449292528846, 0.0)
Epoch 23 a 0.32898470639462923 b 0.4630805823644642 c 0.30142141201006817
  2%|▏         | 24/1000 [20:37<13:59:35, 51.61s/it]Epoch 24 Valid AUC:(0.7997514642594944, 0.0)
Epoch 24 Test AUC:(0.7399164991680661, 0.0)
Epoch 24 a 0.32587585620717024 b 0.46028528702810734 c 0.29664578407223313
  2%|▎         | 25/1000 [21:28<13:57:05, 51.51s/it]Epoch 25 Valid AUC:(0.8024719129957968, 0.0)
Epoch 25 Test AUC:(0.7430059417896472, 0.0)
Epoch 25 a 0.32313237673559897 b 0.4556774107863006 c 0.2926405013746899
  3%|▎         | 26/1000 [22:20<13:57:19, 51.58s/it]Epoch 26 Valid AUC:(0.8011913171221078, 0.0)
Epoch 26 Test AUC:(0.7436606428737099, 0.0)
Epoch 26 a 0.3210854437389604 b 0.451393771579328 c 0.28796109083432786
  3%|▎         | 27/1000 [23:12<13:58:33, 51.71s/it]Epoch 27 Valid AUC:(0.802285391425676, 0.0)
Epoch 27 Test AUC:(0.7430838021791324, 0.0)
Epoch 27 a 0.3188438312988166 b 0.4468644864002704 c 0.2827056726999206
  3%|▎         | 28/1000 [24:04<14:00:11, 51.86s/it]Epoch 28 Valid AUC:(0.8011321870456181, 0.0)
Epoch 28 Test AUC:(0.7445319900319034, 0.0)
Epoch 28 a 0.3173314617793085 b 0.4397045325945081 c 0.27877338131668583
  3%|▎         | 29/1000 [24:56<13:59:56, 51.90s/it]Epoch 29 Valid AUC:(0.8029267434716695, 0.0)
Epoch 29 Test AUC:(0.7468064274980715, 0.0)
Epoch 29 a 0.3155761421686207 b 0.43250624838489404 c 0.27326990942839885
  3%|▎         | 30/1000 [25:47<13:56:17, 51.73s/it]Epoch 30 Valid AUC:(0.8037442144081949, 0.0)
Epoch 30 Test AUC:(0.7447888339744619, 0.0)
Epoch 30 a 0.3138620157237024 b 0.4256515347022166 c 0.26857179430289047
  3%|▎         | 31/1000 [26:39<13:54:46, 51.69s/it]Epoch 31 Valid AUC:(0.8044139485833214, 0.0)
Epoch 31 Test AUC:(0.7458325291728805, 0.0)
Epoch 31 a 0.3119740209708991 b 0.4182750482554407 c 0.2635094607979719
  3%|▎         | 32/1000 [27:31<13:54:22, 51.72s/it]Epoch 32 Valid AUC:(0.8031685670039604, 0.0)
Epoch 32 Test AUC:(0.7445970325943788, 0.0)
Epoch 32 a 0.3104784928816905 b 0.40973464967739176 c 0.2587815925508917
  3%|▎         | 33/1000 [28:23<13:53:54, 51.74s/it]Epoch 33 Valid AUC:(0.8039722544220705, 0.0)
Epoch 33 Test AUC:(0.746917102037757, 0.0)
Epoch 33 a 0.3078710183171439 b 0.402600514516984 c 0.25497189419010513
  3%|▎         | 34/1000 [29:14<13:52:38, 51.72s/it]Epoch 34 Valid AUC:(0.8020871343206292, 0.0)
Epoch 34 Test AUC:(0.747659954541863, 0.0)
Epoch 34 a 0.3052108719555185 b 0.3932116264308722 c 0.251004749410589
  4%|▎         | 35/1000 [30:06<13:50:21, 51.63s/it]Epoch 35 Valid AUC:(0.8056423016541575, 0.0)
Epoch 35 Test AUC:(0.754930629625216, 0.0)
Epoch 35 a 0.30111864580954584 b 0.3841547211051227 c 0.24630921719299714
  4%|▎         | 36/1000 [30:57<13:47:33, 51.51s/it]Epoch 36 Valid AUC:(0.8044052337599625, 0.0)
Epoch 36 Test AUC:(0.7542452521206076, 0.0)
Epoch 36 a 0.2980356810378357 b 0.3764773207890915 c 0.24239691813107228
  4%|▎         | 37/1000 [31:48<13:44:00, 51.34s/it]Epoch 37 Valid AUC:(0.8053504165880367, 0.0)
Epoch 37 Test AUC:(0.7547994286053855, 0.0)
Epoch 37 a 0.2961208881506738 b 0.36931201263932395 c 0.23872342633769306
  4%|▍         | 38/1000 [32:39<13:44:08, 51.40s/it]Epoch 38 Valid AUC:(0.8071463994256173, 0.0)
Epoch 38 Test AUC:(0.7573621218136589, 0.0)
Epoch 38 a 0.2946304814736368 b 0.3618020401514272 c 0.23500241330212032
  4%|▍         | 39/1000 [33:31<13:46:06, 51.58s/it]Epoch 39 Valid AUC:(0.8055712860965164, 0.0)
Epoch 39 Test AUC:(0.757291268901982, 0.0)
Epoch 39 a 0.2924662736999677 b 0.35373389523034127 c 0.23099662303564775
  4%|▍         | 40/1000 [34:23<13:46:56, 51.68s/it]Epoch 40 Valid AUC:(0.8082948619164947, 0.0)
Epoch 40 Test AUC:(0.7590358187677092, 0.0)
Epoch 40 a 0.2911455601273888 b 0.3494819442271227 c 0.22745129660941227
  4%|▍         | 41/1000 [35:15<13:46:52, 51.73s/it]Epoch 41 Valid AUC:(0.8044704642128034, 0.0)
Epoch 41 Test AUC:(0.7561024560636807, 0.0)
Epoch 41 a 0.2899023259069838 b 0.34180096325500153 c 0.22408074956064972
  4%|▍         | 42/1000 [36:06<13:44:17, 51.63s/it]Epoch 42 Valid AUC:(0.8056101888116719, 0.0)
Epoch 42 Test AUC:(0.7600323770272406, 0.0)
Epoch 42 a 0.28805921306192755 b 0.33774801321192766 c 0.22077110814496545
  4%|▍         | 43/1000 [36:58<13:43:45, 51.65s/it]Epoch 43 Valid AUC:(0.8065509911594166, 0.0)
Epoch 43 Test AUC:(0.76005460941565, 0.0)
Epoch 43 a 0.2867738034883495 b 0.33104942238306856 c 0.2168459746259559
  4%|▍         | 44/1000 [37:50<13:43:57, 51.71s/it]Epoch 44 Valid AUC:(0.8057171517340765, 0.0)
Epoch 44 Test AUC:(0.7589215186385292, 0.0)
Epoch 44 a 0.2854518255357531 b 0.3269534025873457 c 0.21583279850377404
  4%|▍         | 45/1000 [38:42<13:41:53, 51.64s/it]Epoch 45 Valid AUC:(0.8035674124293025, 0.0)
Epoch 45 Test AUC:(0.7574683541511219, 0.0)
Epoch 45 a 0.28404952144958606 b 0.32301950130903984 c 0.21264268802685038
  5%|▍         | 46/1000 [39:34<13:42:47, 51.75s/it]  5%|▍         | 46/1000 [40:25<13:58:32, 52.74s/it]
[32m[I 2021-05-14 08:47:33,365][0m Trial 64 finished with value: 0.8082948619164947 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12986630701529273, 'gamma': 0.0024682913265314465}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 08:47:34.069316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807428491849785, 0.0)
Epoch 0 Test AUC:(0.7200597483467216, 0.0)
Epoch 0 a 0.41333613405285224 b 0.5013583430222103 c 0.4144891271408895
  0%|          | 1/1000 [00:51<14:19:41, 51.63s/it]Epoch 1 Valid AUC:(0.7797704158732162, 0.0)
Epoch 1 Test AUC:(0.7225581728506547, 0.0)
Epoch 1 a 0.3856707090583126 b 0.48675061861274227 c 0.38647637664672113
  0%|          | 2/1000 [01:43<14:22:49, 51.87s/it]Epoch 2 Valid AUC:(0.7759953735463444, 0.0)
Epoch 2 Test AUC:(0.7244300287927814, 0.0)
Epoch 2 a 0.38135906874054154 b 0.49169069024878487 c 0.3825235546714583
  0%|          | 3/1000 [02:35<14:18:11, 51.65s/it]Epoch 3 Valid AUC:(0.7825063628975889, 0.0)
Epoch 3 Test AUC:(0.725842927004412, 0.0)
Epoch 3 a 0.37638565963902465 b 0.4951586557825806 c 0.378607077557796
  0%|          | 4/1000 [03:26<14:18:25, 51.71s/it]Epoch 4 Valid AUC:(0.7850296861742896, 0.0)
Epoch 4 Test AUC:(0.7277966750941528, 0.0)
Epoch 4 a 0.3723355914865221 b 0.4995029676008512 c 0.3749488137617437
  0%|          | 5/1000 [04:18<14:15:34, 51.59s/it]Epoch 5 Valid AUC:(0.7835300483418428, 0.0)
Epoch 5 Test AUC:(0.7263516681831079, 0.0)
Epoch 5 a 0.3696530802508955 b 0.5016735741190268 c 0.37243938937753257
  1%|          | 6/1000 [05:09<14:11:50, 51.42s/it]Epoch 6 Valid AUC:(0.7866151022188289, 0.0)
Epoch 6 Test AUC:(0.7270943240160856, 0.0)
Epoch 6 a 0.3677081994007771 b 0.5037729712559184 c 0.3705241439687894
  1%|          | 7/1000 [06:01<14:13:09, 51.55s/it]Epoch 7 Valid AUC:(0.788926183662175, 0.0)
Epoch 7 Test AUC:(0.727225135969119, 0.0)
Epoch 7 a 0.3662721235267593 b 0.5025544923316065 c 0.3685648626005146
  1%|          | 8/1000 [06:52<14:10:10, 51.42s/it]Epoch 8 Valid AUC:(0.7914923813066178, 0.0)
Epoch 8 Test AUC:(0.727646349944831, 0.0)
Epoch 8 a 0.36378516067921274 b 0.5024667547142482 c 0.36552486069485457
  1%|          | 9/1000 [07:43<14:09:15, 51.42s/it]Epoch 9 Valid AUC:(0.7907257459852911, 0.0)
Epoch 9 Test AUC:(0.7285739450457002, 0.0)
Epoch 9 a 0.3612530883289199 b 0.5038254617805212 c 0.3627652037191679
  1%|          | 10/1000 [08:35<14:11:56, 51.63s/it]Epoch 10 Valid AUC:(0.7922030559276557, 0.0)
Epoch 10 Test AUC:(0.7279383809175066, 0.0)
Epoch 10 a 0.35803344509970975 b 0.5069268793767127 c 0.35899595085763836
  1%|          | 11/1000 [09:27<14:09:18, 51.53s/it]Epoch 11 Valid AUC:(0.7924672227291287, 0.0)
Epoch 11 Test AUC:(0.7268538679090604, 0.0)
Epoch 11 a 0.3564975163946209 b 0.5062721189958469 c 0.35697439660728575
  1%|          | 12/1000 [10:18<14:10:02, 51.62s/it]Epoch 12 Valid AUC:(0.7934613226296711, 0.0)
Epoch 12 Test AUC:(0.725461457698441, 0.0)
Epoch 12 a 0.35535023132080523 b 0.5079725834445454 c 0.3546389034936126
  1%|▏         | 13/1000 [11:11<14:11:24, 51.76s/it]Epoch 13 Valid AUC:(0.7934929843518888, 0.0)
Epoch 13 Test AUC:(0.723767071796792, 0.0)
Epoch 13 a 0.35402383572858587 b 0.5047297979624459 c 0.35134437008642816
  1%|▏         | 14/1000 [12:02<14:11:09, 51.79s/it]Epoch 14 Valid AUC:(0.794787227895276, 0.0)
Epoch 14 Test AUC:(0.7255600668919552, 0.0)
Epoch 14 a 0.3527092868893199 b 0.498765149826495 c 0.3468826568462479
  2%|▏         | 15/1000 [12:55<14:12:19, 51.92s/it]Epoch 15 Valid AUC:(0.7935295532886124, 0.0)
Epoch 15 Test AUC:(0.722900179667199, 0.0)
Epoch 15 a 0.35159498806930406 b 0.49394228472796003 c 0.34176433134366807
  2%|▏         | 16/1000 [13:46<14:06:46, 51.63s/it]Epoch 16 Valid AUC:(0.7923660577274411, 0.0)
Epoch 16 Test AUC:(0.7235575315360337, 0.0)
Epoch 16 a 0.3505257237365308 b 0.4882372102027448 c 0.3372524516803158
  2%|▏         | 17/1000 [14:38<14:08:43, 51.80s/it]Epoch 17 Valid AUC:(0.7936120083335036, 0.0)
Epoch 17 Test AUC:(0.7264594738895969, 0.0)
Epoch 17 a 0.3494498424486855 b 0.48319415697149587 c 0.33318598745334554
  2%|▏         | 18/1000 [15:30<14:08:45, 51.86s/it]Epoch 18 Valid AUC:(0.7963058653242366, 0.0)
Epoch 18 Test AUC:(0.7262592327528367, 0.0)
Epoch 18 a 0.3473330754749252 b 0.4763355920132497 c 0.32817244421788144
  2%|▏         | 19/1000 [16:22<14:10:41, 52.03s/it]Epoch 19 Valid AUC:(0.7957525688787342, 0.0)
Epoch 19 Test AUC:(0.727871482805691, 0.0)
Epoch 19 a 0.34481774633319323 b 0.46884944327400485 c 0.323391906752193
  2%|▏         | 20/1000 [17:14<14:09:46, 52.03s/it]Epoch 20 Valid AUC:(0.7975436175883837, 0.0)
Epoch 20 Test AUC:(0.732486969394069, 0.0)
Epoch 20 a 0.3411172316587667 b 0.4676607509014352 c 0.31865931300809924
  2%|▏         | 21/1000 [18:06<14:10:02, 52.10s/it]Epoch 21 Valid AUC:(0.8012651842212156, 0.0)
Epoch 21 Test AUC:(0.7374843100797558, 0.0)
Epoch 21 a 0.3366603502925013 b 0.46555748240089034 c 0.3126266302477186
  2%|▏         | 22/1000 [18:58<14:05:33, 51.87s/it]Epoch 22 Valid AUC:(0.7992532185841947, 0.0)
Epoch 22 Test AUC:(0.7379594247709825, 0.0)
Epoch 22 a 0.3319186052566083 b 0.4638956583721537 c 0.30702462258713104
  2%|▏         | 23/1000 [19:49<14:01:48, 51.70s/it]Epoch 23 Valid AUC:(0.8004268938280042, 0.0)
Epoch 23 Test AUC:(0.7377690642206867, 0.0)
Epoch 23 a 0.3279099897959343 b 0.462355124098914 c 0.30194575841757854
  2%|▏         | 24/1000 [20:41<14:01:39, 51.74s/it]Epoch 24 Valid AUC:(0.7993067852712431, 0.0)
Epoch 24 Test AUC:(0.7391211611254769, 0.0)
Epoch 24 a 0.32449445320327036 b 0.4597167817039989 c 0.2967993908784759
  2%|▎         | 25/1000 [21:33<14:01:36, 51.79s/it]Epoch 25 Valid AUC:(0.801768933051148, 0.0)
Epoch 25 Test AUC:(0.7423585773937594, 0.0)
Epoch 25 a 0.3216056817134381 b 0.4551986060751756 c 0.29280902715156254
  3%|▎         | 26/1000 [22:25<14:00:06, 51.75s/it]Epoch 26 Valid AUC:(0.7999439221622325, 0.0)
Epoch 26 Test AUC:(0.7424281262903469, 0.0)
Epoch 26 a 0.31968332914039643 b 0.45036070495544067 c 0.28795286710233514
  3%|▎         | 27/1000 [23:16<13:59:16, 51.75s/it]Epoch 27 Valid AUC:(0.801238678342288, 0.0)
Epoch 27 Test AUC:(0.74179642290191, 0.0)
Epoch 27 a 0.3175506580403633 b 0.44398608443962495 c 0.2827478057481873
  3%|▎         | 28/1000 [24:08<13:59:11, 51.80s/it]Epoch 28 Valid AUC:(0.7995841358062298, 0.0)
Epoch 28 Test AUC:(0.7429869459239351, 0.0)
Epoch 28 a 0.31622564672704195 b 0.4354426143035083 c 0.2790897232545933
  3%|▎         | 29/1000 [25:00<13:57:58, 51.78s/it]Epoch 29 Valid AUC:(0.8016021659350351, 0.0)
Epoch 29 Test AUC:(0.7454548693011542, 0.0)
Epoch 29 a 0.31480216967987584 b 0.4262622426333322 c 0.27391941482632215
  3%|▎         | 30/1000 [25:52<13:58:25, 51.86s/it]Epoch 30 Valid AUC:(0.8025891260883815, 0.0)
Epoch 30 Test AUC:(0.7428301178010035, 0.0)
Epoch 30 a 0.3134101715605983 b 0.418341601098807 c 0.2693968201187295
  3%|▎         | 31/1000 [26:44<13:58:22, 51.91s/it]Epoch 31 Valid AUC:(0.8032849573146926, 0.0)
Epoch 31 Test AUC:(0.7443231637728498, 0.0)
Epoch 31 a 0.31194653405509964 b 0.40897496155569973 c 0.26417967395283565
  3%|▎         | 32/1000 [27:36<13:56:42, 51.86s/it]Epoch 32 Valid AUC:(0.8007911375598368, 0.0)
Epoch 32 Test AUC:(0.7423510483099154, 0.0)
Epoch 32 a 0.3110389585346283 b 0.3995227865290114 c 0.2596257117012857
  3%|▎         | 33/1000 [28:27<13:55:01, 51.81s/it]Epoch 33 Valid AUC:(0.8019737365264473, 0.0)
Epoch 33 Test AUC:(0.7450218422313701, 0.0)
Epoch 33 a 0.30986562521165045 b 0.3914852619051214 c 0.2558583619009321
  3%|▎         | 34/1000 [29:19<13:53:02, 51.74s/it]Epoch 34 Valid AUC:(0.8011762186906386, 0.0)
Epoch 34 Test AUC:(0.74512623612133, 0.0)
Epoch 34 a 0.3092503506892644 b 0.38262725817845383 c 0.2511022230029346
  4%|▎         | 35/1000 [30:11<13:54:08, 51.86s/it]Epoch 35 Valid AUC:(0.8044794802102048, 0.0)
Epoch 35 Test AUC:(0.7515967889231263, 0.0)
Epoch 35 a 0.306641468519656 b 0.37423182960966944 c 0.24677706523320564
  4%|▎         | 36/1000 [31:03<13:52:57, 51.84s/it]Epoch 36 Valid AUC:(0.8031732537846992, 0.0)
Epoch 36 Test AUC:(0.751448293670389, 0.0)
Epoch 36 a 0.3033761761977639 b 0.3704895044956169 c 0.24397002577301963
  4%|▎         | 37/1000 [31:55<13:52:17, 51.86s/it]Epoch 37 Valid AUC:(0.8042085132833285, 0.0)
Epoch 37 Test AUC:(0.7520751786161842, 0.0)
Epoch 37 a 0.29970945762676493 b 0.3638725688519852 c 0.24079402942412817
  4%|▍         | 38/1000 [32:46<13:49:30, 51.74s/it]Epoch 38 Valid AUC:(0.8067818352958671, 0.0)
Epoch 38 Test AUC:(0.7554859519330889, 0.0)
Epoch 38 a 0.29620754754759177 b 0.3591963416134088 c 0.23717287824427338
  4%|▍         | 39/1000 [33:38<13:48:08, 51.70s/it]Epoch 39 Valid AUC:(0.8041973659989793, 0.0)
Epoch 39 Test AUC:(0.7548175907565322, 0.0)
Epoch 39 a 0.2926317661161154 b 0.35254775014681594 c 0.23277659144559856
  4%|▍         | 40/1000 [34:30<13:48:50, 51.80s/it]Epoch 40 Valid AUC:(0.8071794516747973, 0.0)
Epoch 40 Test AUC:(0.7582293175008629, 0.0)
Epoch 40 a 0.29050078331464735 b 0.3492969880761275 c 0.22974022227513718
  4%|▍         | 41/1000 [35:22<13:46:49, 51.73s/it]Epoch 41 Valid AUC:(0.8043723212042746, 0.0)
Epoch 41 Test AUC:(0.7553320311224878, 0.0)
Epoch 41 a 0.288453620984041 b 0.34366999089837796 c 0.22649003865133588
  4%|▍         | 42/1000 [36:13<13:46:53, 51.79s/it]Epoch 42 Valid AUC:(0.8051252191444861, 0.0)
Epoch 42 Test AUC:(0.759511720143449, 0.0)
Epoch 42 a 0.28623454800434034 b 0.34025344852230677 c 0.2227115995087614
  4%|▍         | 43/1000 [37:06<13:47:17, 51.87s/it]Epoch 43 Valid AUC:(0.8055638746518864, 0.0)
Epoch 43 Test AUC:(0.7600745287805729, 0.0)
Epoch 43 a 0.28480246099427914 b 0.3345029637127575 c 0.21984761974341432
  4%|▍         | 44/1000 [37:58<13:47:16, 51.92s/it]Epoch 44 Valid AUC:(0.8051533808398519, 0.0)
Epoch 44 Test AUC:(0.7587998476174996, 0.0)
Epoch 44 a 0.2834371728616461 b 0.3305113671770998 c 0.21832034612445525
  4%|▍         | 45/1000 [38:50<13:47:30, 51.99s/it]Epoch 45 Valid AUC:(0.8030444448506805, 0.0)
Epoch 45 Test AUC:(0.7579915036276909, 0.0)
Epoch 45 a 0.281989370493342 b 0.3271095452893908 c 0.2158976335160929
  5%|▍         | 46/1000 [39:42<13:47:10, 52.02s/it]  5%|▍         | 46/1000 [40:34<14:01:27, 52.92s/it]
[32m[I 2021-05-14 09:28:28,126][0m Trial 65 finished with value: 0.8071794516747973 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1282372025069287, 'gamma': 0.0024085972975275223}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 09:28:28.836380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.49575510822447, 0.0)
Epoch 0 Test AUC:(0.49930662952421245, 0.0)
Epoch 0 a 0.5071175619510098 b 0.43369280752281786 c 0.433327222014337
  0%|          | 1/1000 [00:51<14:24:34, 51.93s/it]Epoch 1 Valid AUC:(0.5109187329803344, 0.0)
Epoch 1 Test AUC:(0.5155900027601937, 0.0)
Epoch 1 a 0.5015306326465108 b 0.38063792233735744 c 0.38063790608699655
  0%|          | 2/1000 [01:43<14:20:54, 51.76s/it]Epoch 2 Valid AUC:(0.4996257034631047, 0.0)
Epoch 2 Test AUC:(0.4931088638527398, 0.0)
Epoch 2 a 0.5015164944727416 b 0.3722658997450316 c 0.3722658635864795
  0%|          | 3/1000 [02:35<14:17:40, 51.61s/it]Epoch 3 Valid AUC:(0.4932678758508, 0.0)
Epoch 3 Test AUC:(0.4951330458591452, 0.0)
Epoch 3 a 0.5015344991530452 b 0.3686565887520251 c 0.36865662856840753
  0%|          | 4/1000 [03:27<14:19:59, 51.81s/it]Epoch 4 Valid AUC:(0.49846034574923626, 0.0)
Epoch 4 Test AUC:(0.5051808540878986, 0.0)
Epoch 4 a 0.5015625485951751 b 0.36756884188239486 c 0.36756881867615987
  0%|          | 5/1000 [04:18<14:17:00, 51.68s/it]Epoch 5 Valid AUC:(0.48890304119242733, 0.0)
Epoch 5 Test AUC:(0.49825365230363305, 0.0)
Epoch 5 a 0.501510156592133 b 0.3657812319650976 c 0.365781236882181
  1%|          | 6/1000 [05:10<14:14:49, 51.60s/it]Epoch 6 Valid AUC:(0.4914648096560571, 0.0)
Epoch 6 Test AUC:(0.5032264646792614, 0.0)
Epoch 6 a 0.501626743457207 b 0.3651237357070508 c 0.3651237866768175
  1%|          | 7/1000 [06:00<14:09:31, 51.33s/it]  1%|          | 7/1000 [06:52<16:14:28, 58.88s/it]
[32m[I 2021-05-14 09:35:41,877][0m Trial 66 finished with value: 0.5109187329803344 and parameters: {'rank': 45.0, 'lambda': 0.01, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12723931521575393, 'gamma': 0.0025185303604312336}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 09:35:42.543270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7730027954795207, 0.0)
Epoch 0 Test AUC:(0.7189326731408493, 0.0)
Epoch 0 a 0.4198433456401671 b 0.5042322512355543 c 0.4210138635769967
  0%|          | 1/1000 [00:30<8:33:04, 30.82s/it]Epoch 1 Valid AUC:(0.777132873302073, 0.0)
Epoch 1 Test AUC:(0.7211525685726061, 0.0)
Epoch 1 a 0.38580888461682106 b 0.48249279347158247 c 0.386250598776725
  0%|          | 2/1000 [01:01<8:32:19, 30.80s/it]Epoch 2 Valid AUC:(0.7754643588536239, 0.0)
Epoch 2 Test AUC:(0.7233249037950041, 0.0)
Epoch 2 a 0.3822134370284696 b 0.4904725635724683 c 0.38252165733325866
  0%|          | 3/1000 [01:31<8:23:36, 30.31s/it]Epoch 3 Valid AUC:(0.7780956357230904, 0.0)
Epoch 3 Test AUC:(0.7247676746408301, 0.0)
Epoch 3 a 0.3794330949744871 b 0.4972860406964056 c 0.37983897688888735
  0%|          | 4/1000 [02:01<8:21:29, 30.21s/it]Epoch 4 Valid AUC:(0.7777186516884622, 0.0)
Epoch 4 Test AUC:(0.7266140274681757, 0.0)
Epoch 4 a 0.3772014410745713 b 0.5044056883742732 c 0.37825564980026216
  0%|          | 5/1000 [02:31<8:19:43, 30.13s/it]Epoch 5 Valid AUC:(0.7842269766106239, 0.0)
Epoch 5 Test AUC:(0.7258729535551426, 0.0)
Epoch 5 a 0.37459533481347945 b 0.5097094488240057 c 0.37590715132894054
  1%|          | 6/1000 [03:01<8:19:17, 30.14s/it]Epoch 6 Valid AUC:(0.7842633763772471, 0.0)
Epoch 6 Test AUC:(0.7265815681810981, 0.0)
Epoch 6 a 0.37228981465581923 b 0.5144454227580179 c 0.37369496495493
  1%|          | 7/1000 [03:31<8:19:10, 30.16s/it]Epoch 7 Valid AUC:(0.7863791650370802, 0.0)
Epoch 7 Test AUC:(0.7279578257064462, 0.0)
Epoch 7 a 0.37119546124050695 b 0.517215003169352 c 0.3726871731060167
  1%|          | 8/1000 [04:01<8:15:39, 29.98s/it]Epoch 8 Valid AUC:(0.7898976596249595, 0.0)
Epoch 8 Test AUC:(0.7284209477343099, 0.0)
Epoch 8 a 0.3698443016938625 b 0.5162807002423271 c 0.37123306684436336
  1%|          | 9/1000 [04:31<8:14:43, 29.95s/it]Epoch 9 Valid AUC:(0.7866948108127705, 0.0)
Epoch 9 Test AUC:(0.7302238063141001, 0.0)
Epoch 9 a 0.3687066873235087 b 0.5129122174074573 c 0.36954313901162916
  1%|          | 10/1000 [05:01<8:13:43, 29.92s/it]Epoch 10 Valid AUC:(0.7901247640769158, 0.0)
Epoch 10 Test AUC:(0.7294126790002808, 0.0)
Epoch 10 a 0.3659161359312073 b 0.5070001886736962 c 0.36560911480938235
  1%|          | 11/1000 [05:31<8:13:16, 29.93s/it]Epoch 11 Valid AUC:(0.78911352160619, 0.0)
Epoch 11 Test AUC:(0.7266150236501948, 0.0)
Epoch 11 a 0.36354170583428874 b 0.4977536105340527 c 0.36241747595129475
  1%|          | 12/1000 [06:00<8:12:30, 29.91s/it]Epoch 12 Valid AUC:(0.7895340079884787, 0.0)
Epoch 12 Test AUC:(0.7273332580595967, 0.0)
Epoch 12 a 0.36146043853894355 b 0.49485127026996306 c 0.35964361373935977
  1%|▏         | 13/1000 [06:30<8:11:16, 29.86s/it]Epoch 13 Valid AUC:(0.7910068733709303, 0.0)
Epoch 13 Test AUC:(0.7262431484749143, 0.0)
Epoch 13 a 0.35941680100175644 b 0.49198564346278867 c 0.35682090311761827
  1%|▏         | 14/1000 [07:00<8:09:57, 29.81s/it]Epoch 14 Valid AUC:(0.7931014991075098, 0.0)
Epoch 14 Test AUC:(0.7260554686376055, 0.0)
Epoch 14 a 0.3572441094344662 b 0.49299938423979667 c 0.35378569749093824
  2%|▏         | 15/1000 [07:30<8:12:44, 30.01s/it]Epoch 15 Valid AUC:(0.7908804289735437, 0.0)
Epoch 15 Test AUC:(0.7238218874605991, 0.0)
Epoch 15 a 0.3557502098621861 b 0.49939866400053423 c 0.3510943116439927
  2%|▏         | 16/1000 [08:01<8:13:23, 30.08s/it]Epoch 16 Valid AUC:(0.7918282031799755, 0.0)
Epoch 16 Test AUC:(0.7242153408790145, 0.0)
Epoch 16 a 0.35456865184730096 b 0.5066493256918846 c 0.34875909827889934
  2%|▏         | 17/1000 [08:31<8:12:46, 30.08s/it]Epoch 17 Valid AUC:(0.7907582779082529, 0.0)
Epoch 17 Test AUC:(0.7230893943944, 0.0)
Epoch 17 a 0.35342312219642824 b 0.5146766374668768 c 0.3454581127772408
  2%|▏         | 18/1000 [09:00<8:10:57, 30.00s/it]Epoch 18 Valid AUC:(0.7942187356173375, 0.0)
Epoch 18 Test AUC:(0.7222478471875937, 0.0)
Epoch 18 a 0.3517294186017206 b 0.5178302819690397 c 0.34074737888670736
  2%|▏         | 19/1000 [09:30<8:09:45, 29.96s/it]Epoch 19 Valid AUC:(0.7942496424820612, 0.0)
Epoch 19 Test AUC:(0.7223585559309537, 0.0)
Epoch 19 a 0.35057419274122487 b 0.5142076988854716 c 0.33638781633588577
  2%|▏         | 20/1000 [10:01<8:10:34, 30.03s/it]Epoch 20 Valid AUC:(0.7916020624849553, 0.0)
Epoch 20 Test AUC:(0.7229445845875874, 0.0)
Epoch 20 a 0.34963124017080954 b 0.5140266531417447 c 0.3322032035118149
  2%|▏         | 21/1000 [10:31<8:11:15, 30.11s/it]Epoch 21 Valid AUC:(0.7954569851390526, 0.0)
Epoch 21 Test AUC:(0.7236040186051058, 0.0)
Epoch 21 a 0.3482148424992638 b 0.5051608956869571 c 0.3270219725466544
  2%|▏         | 22/1000 [11:01<8:10:25, 30.09s/it]Epoch 22 Valid AUC:(0.7957978859602002, 0.0)
Epoch 22 Test AUC:(0.7237518597125688, 0.0)
Epoch 22 a 0.3469399898763626 b 0.4947253995605053 c 0.32246630566735424
  2%|▏         | 23/1000 [11:31<8:08:44, 30.01s/it]Epoch 23 Valid AUC:(0.7946395500870939, 0.0)
Epoch 23 Test AUC:(0.7223374992938545, 0.0)
Epoch 23 a 0.34565328602348605 b 0.4873457977608327 c 0.3173489070707752
  2%|▏         | 24/1000 [12:01<8:07:42, 29.98s/it]Epoch 24 Valid AUC:(0.7960337872573822, 0.0)
Epoch 24 Test AUC:(0.7235213953539499, 0.0)
Epoch 24 a 0.3443066888759213 b 0.4781363850399371 c 0.31230316707684147
  2%|▎         | 25/1000 [12:31<8:08:58, 30.09s/it]Epoch 25 Valid AUC:(0.7952439141158875, 0.0)
Epoch 25 Test AUC:(0.7289086451022846, 0.0)
Epoch 25 a 0.3422759910745005 b 0.46571580296562565 c 0.30827909215323385
  3%|▎         | 26/1000 [13:01<8:08:47, 30.11s/it]Epoch 26 Valid AUC:(0.7961134215190069, 0.0)
Epoch 26 Test AUC:(0.7335981869213622, 0.0)
Epoch 26 a 0.3390534226932833 b 0.4524339456712046 c 0.30361728934991744
  3%|▎         | 27/1000 [13:31<8:07:25, 30.06s/it]Epoch 27 Valid AUC:(0.7994805075853515, 0.0)
Epoch 27 Test AUC:(0.7363171225146419, 0.0)
Epoch 27 a 0.3338946379240482 b 0.4398356637647075 c 0.2996743786479196
  3%|▎         | 28/1000 [14:01<8:06:29, 30.03s/it]Epoch 28 Valid AUC:(0.8004365711267075, 0.0)
Epoch 28 Test AUC:(0.739265979483208, 0.0)
Epoch 28 a 0.3296258058999815 b 0.4287112805872194 c 0.29658476768001435
  3%|▎         | 29/1000 [14:31<8:05:17, 29.99s/it]Epoch 29 Valid AUC:(0.8005136652736414, 0.0)
Epoch 29 Test AUC:(0.7396870010632511, 0.0)
Epoch 29 a 0.32533874903475085 b 0.4159709462715733 c 0.2913492797843872
  3%|▎         | 30/1000 [15:01<8:07:47, 30.17s/it]Epoch 30 Valid AUC:(0.8043018349439933, 0.0)
Epoch 30 Test AUC:(0.7418657409236947, 0.0)
Epoch 30 a 0.3219769885463099 b 0.40643217078139704 c 0.2854971995036448
  3%|▎         | 31/1000 [15:32<8:09:57, 30.34s/it]Epoch 31 Valid AUC:(0.8060093290030982, 0.0)
Epoch 31 Test AUC:(0.7444592430917524, 0.0)
Epoch 31 a 0.319145685722751 b 0.3971506825858547 c 0.2805587513552558
  3%|▎         | 32/1000 [16:02<8:05:17, 30.08s/it]Epoch 32 Valid AUC:(0.8019865639774766, 0.0)
Epoch 32 Test AUC:(0.7477793809467551, 0.0)
Epoch 32 a 0.31757636584581866 b 0.3874551387083146 c 0.2761755197519256
  3%|▎         | 33/1000 [16:32<8:03:39, 30.01s/it]Epoch 33 Valid AUC:(0.8028064801909092, 0.0)
Epoch 33 Test AUC:(0.743952498552554, 0.0)
Epoch 33 a 0.31596123727579273 b 0.37784155926877455 c 0.2707201738751704
  3%|▎         | 34/1000 [17:01<7:59:07, 29.76s/it]Epoch 34 Valid AUC:(0.8039942183401182, 0.0)
Epoch 34 Test AUC:(0.7465317890938669, 0.0)
Epoch 34 a 0.31451625112564335 b 0.3663897437434043 c 0.26552009288101425
  4%|▎         | 35/1000 [17:30<7:56:10, 29.61s/it]Epoch 35 Valid AUC:(0.8056350504084864, 0.0)
Epoch 35 Test AUC:(0.750508103066394, 0.0)
Epoch 35 a 0.3125938094191013 b 0.3586130455857323 c 0.25987165727682654
  4%|▎         | 36/1000 [18:00<7:56:52, 29.68s/it]Epoch 36 Valid AUC:(0.8060520034425398, 0.0)
Epoch 36 Test AUC:(0.7481260052593537, 0.0)
Epoch 36 a 0.31179393659676274 b 0.34996127469405053 c 0.2555337731516169
  4%|▎         | 37/1000 [18:29<7:56:24, 29.68s/it]Epoch 37 Valid AUC:(0.8061717861264236, 0.0)
Epoch 37 Test AUC:(0.7497684101267178, 0.0)
Epoch 37 a 0.3109707549935387 b 0.34102738192004545 c 0.25084986171174434
  4%|▍         | 38/1000 [18:59<7:55:26, 29.65s/it]Epoch 38 Valid AUC:(0.8058317824194453, 0.0)
Epoch 38 Test AUC:(0.7503061987759625, 0.0)
Epoch 38 a 0.31031184595438743 b 0.3334853259786483 c 0.24681421657723765
  4%|▍         | 39/1000 [19:29<7:55:48, 29.71s/it]Epoch 39 Valid AUC:(0.8043456384656965, 0.0)
Epoch 39 Test AUC:(0.7505426787058299, 0.0)
Epoch 39 a 0.309218893007886 b 0.323661107209421 c 0.24106873379599664
  4%|▍         | 40/1000 [19:59<7:56:42, 29.79s/it]Epoch 40 Valid AUC:(0.8036437555635176, 0.0)
Epoch 40 Test AUC:(0.7499268714751056, 0.0)
Epoch 40 a 0.30815030598352033 b 0.318634360427818 c 0.23821080361883487
  4%|▍         | 41/1000 [20:29<7:56:23, 29.81s/it]Epoch 41 Valid AUC:(0.8017292472834819, 0.0)
Epoch 41 Test AUC:(0.7495455133310767, 0.0)
Epoch 41 a 0.30755715853264254 b 0.3105070754404991 c 0.23368696489882085
  4%|▍         | 42/1000 [20:59<7:56:36, 29.85s/it]Epoch 42 Valid AUC:(0.8058610001463475, 0.0)
Epoch 42 Test AUC:(0.7532974939536348, 0.0)
Epoch 42 a 0.3059655072227601 b 0.3035038079946272 c 0.2297010705355675
  4%|▍         | 43/1000 [21:28<7:55:51, 29.83s/it]  4%|▍         | 43/1000 [21:58<8:09:12, 30.67s/it]
[32m[I 2021-05-14 09:58:01,523][0m Trial 67 finished with value: 0.8061717861264236 and parameters: {'rank': 65.0, 'lambda': 0.0001, 'batch_size': 1024, 'learning_rate': 0.005, 'alpha': 0.15069585391671594, 'gamma': 0.0020027320037099517}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 09:58:02.196469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7848156885603467, 0.0)
Epoch 0 Test AUC:(0.723759072412424, 0.0)
Epoch 0 a 0.41070342093886025 b 0.5274583878411614 c 0.4120718691670439
  0%|          | 1/1000 [00:50<13:54:17, 50.11s/it]Epoch 1 Valid AUC:(0.7871258344417734, 0.0)
Epoch 1 Test AUC:(0.7248348763102567, 0.0)
Epoch 1 a 0.3780078413021157 b 0.5067903552376768 c 0.3795544335419983
  0%|          | 2/1000 [01:40<13:53:26, 50.11s/it]Epoch 2 Valid AUC:(0.778626447924327, 0.0)
Epoch 2 Test AUC:(0.7250734426642672, 0.0)
Epoch 2 a 0.3746805752906761 b 0.5012123693282935 c 0.3764937322744181
  0%|          | 3/1000 [02:31<14:01:05, 50.62s/it]Epoch 3 Valid AUC:(0.7840606977809373, 0.0)
Epoch 3 Test AUC:(0.7248279500661754, 0.0)
Epoch 3 a 0.3719600179425667 b 0.5012065345492641 c 0.3734654908928593
  0%|          | 4/1000 [03:21<13:59:15, 50.56s/it]Epoch 4 Valid AUC:(0.7875582562872888, 0.0)
Epoch 4 Test AUC:(0.7264601451367084, 0.0)
Epoch 4 a 0.3674503121697447 b 0.5077103103550387 c 0.3684557498820591
  0%|          | 5/1000 [04:12<13:59:09, 50.60s/it]Epoch 5 Valid AUC:(0.7882410139969701, 0.0)
Epoch 5 Test AUC:(0.7211109084970945, 0.0)
Epoch 5 a 0.35992588729445846 b 0.5128644434978784 c 0.3609131067931292
  1%|          | 6/1000 [05:03<13:59:14, 50.66s/it]Epoch 6 Valid AUC:(0.7855557898077291, 0.0)
Epoch 6 Test AUC:(0.7196737385029639, 0.0)
Epoch 6 a 0.3532766311221439 b 0.5190455629312296 c 0.3543328429371778
  1%|          | 7/1000 [05:53<13:57:33, 50.61s/it]Epoch 7 Valid AUC:(0.7968444657580543, 0.0)
Epoch 7 Test AUC:(0.7204832496931641, 0.0)
Epoch 7 a 0.3472779440568007 b 0.5354370149208506 c 0.348680636292732
  1%|          | 8/1000 [06:44<13:55:13, 50.52s/it]Epoch 8 Valid AUC:(0.7907161955641631, 0.0)
Epoch 8 Test AUC:(0.7192322246464504, 0.0)
Epoch 8 a 0.3407861646152358 b 0.5634668284738568 c 0.34253828386425733
  1%|          | 9/1000 [07:34<13:54:13, 50.51s/it]Epoch 9 Valid AUC:(0.7899136346651313, 0.0)
Epoch 9 Test AUC:(0.7166494667076375, 0.0)
Epoch 9 a 0.33399090044934987 b 0.6221427755576504 c 0.3364157213771367
  1%|          | 10/1000 [08:25<13:53:26, 50.51s/it]Epoch 10 Valid AUC:(0.7941618073153376, 0.0)
Epoch 10 Test AUC:(0.7164806245440463, 0.0)
Epoch 10 a 0.3260070345171501 b 0.8440625741927916 c 0.3303027989518954
  1%|          | 11/1000 [09:15<13:51:34, 50.45s/it]Epoch 11 Valid AUC:(0.7947093660749315, 0.0)
Epoch 11 Test AUC:(0.7179731018798045, 0.0)
Epoch 11 a 0.318018109925556 b 1.2015205681683792 c 0.3246480169550514
  1%|          | 12/1000 [10:05<13:50:14, 50.42s/it]Epoch 12 Valid AUC:(0.7890979566753528, 0.0)
Epoch 12 Test AUC:(0.7156137580672092, 0.0)
Epoch 12 a 0.30875972692875314 b 1.6670479529820217 c 0.3171567077368078
  1%|▏         | 13/1000 [10:56<13:50:27, 50.48s/it]  1%|▏         | 13/1000 [11:46<14:54:30, 54.38s/it]
[32m[I 2021-05-14 10:10:08,158][0m Trial 68 finished with value: 0.7968444657580543 and parameters: {'rank': 55.0, 'lambda': 1e-05, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12171302739225534, 'gamma': 0.0028383647213044297}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 10:10:08.825749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7714408415336916, 0.0)
Epoch 0 Test AUC:(0.7198532222847764, 0.0)
Epoch 0 a 0.43899746816004476 b 0.5136766330369057 c 0.4390718461044373
  0%|          | 1/1000 [00:19<5:16:36, 19.02s/it]Epoch 1 Valid AUC:(0.7793587686286783, 0.0)
Epoch 1 Test AUC:(0.7227506155496343, 0.0)
Epoch 1 a 0.3851689814079192 b 0.47876884812308895 c 0.38441898457465634
  0%|          | 2/1000 [00:38<5:17:12, 19.07s/it]Epoch 2 Valid AUC:(0.7760276273639137, 0.0)
Epoch 2 Test AUC:(0.7237479091881669, 0.0)
Epoch 2 a 0.3815043167241158 b 0.4903667540319504 c 0.38090574476988087
  0%|          | 3/1000 [00:57<5:16:52, 19.07s/it]Epoch 3 Valid AUC:(0.7751401956196919, 0.0)
Epoch 3 Test AUC:(0.722644986051934, 0.0)
Epoch 3 a 0.3788604813237344 b 0.5019894886401391 c 0.3785771854942845
  0%|          | 4/1000 [01:16<5:18:47, 19.20s/it]Epoch 4 Valid AUC:(0.7832773581937784, 0.0)
Epoch 4 Test AUC:(0.7273191832475498, 0.0)
Epoch 4 a 0.37708434198171864 b 0.5113402537761196 c 0.37689186752803866
  0%|          | 5/1000 [01:35<5:15:19, 19.01s/it]Epoch 5 Valid AUC:(0.7806427812257606, 0.0)
Epoch 5 Test AUC:(0.7245411095011014, 0.0)
Epoch 5 a 0.3749772454461744 b 0.5181336073625472 c 0.37509564166107484
  1%|          | 6/1000 [01:54<5:16:58, 19.13s/it]Epoch 6 Valid AUC:(0.7815369977162857, 0.0)
Epoch 6 Test AUC:(0.726483899588632, 0.0)
Epoch 6 a 0.3727419455685923 b 0.5237254430690119 c 0.37302370633809795
  1%|          | 7/1000 [02:13<5:15:35, 19.07s/it]Epoch 7 Valid AUC:(0.7844217541942856, 0.0)
Epoch 7 Test AUC:(0.7259564917545908, 0.0)
Epoch 7 a 0.37167404207491106 b 0.5253584022002835 c 0.3723953462416126
  1%|          | 8/1000 [02:32<5:15:43, 19.10s/it]Epoch 8 Valid AUC:(0.7854618350407792, 0.0)
Epoch 8 Test AUC:(0.7276218643893655, 0.0)
Epoch 8 a 0.36995130248608127 b 0.528971208920402 c 0.37078826417846067
  1%|          | 9/1000 [02:52<5:16:25, 19.16s/it]Epoch 9 Valid AUC:(0.7839371344016258, 0.0)
Epoch 9 Test AUC:(0.7283362081307957, 0.0)
Epoch 9 a 0.3692408165624065 b 0.5316119040212324 c 0.3700544180408601
  1%|          | 10/1000 [03:11<5:15:55, 19.15s/it]Epoch 10 Valid AUC:(0.7884660473967869, 0.0)
Epoch 10 Test AUC:(0.7284298064859992, 0.0)
Epoch 10 a 0.3677567450269576 b 0.534105789757544 c 0.3687710009755627
  1%|          | 11/1000 [03:30<5:14:25, 19.08s/it]Epoch 11 Valid AUC:(0.7875300215411979, 0.0)
Epoch 11 Test AUC:(0.7285200101265109, 0.0)
Epoch 11 a 0.3675541933025083 b 0.5352981424620075 c 0.3685318669003825
  1%|          | 12/1000 [03:49<5:14:59, 19.13s/it]Epoch 12 Valid AUC:(0.7874655408194842, 0.0)
Epoch 12 Test AUC:(0.7290923102833018, 0.0)
Epoch 12 a 0.36728399511306514 b 0.5392510520835077 c 0.3683086499091118
  1%|▏         | 13/1000 [04:08<5:13:11, 19.04s/it]Epoch 13 Valid AUC:(0.7879261897215405, 0.0)
Epoch 13 Test AUC:(0.7293622670595625, 0.0)
Epoch 13 a 0.36700048153438874 b 0.539313887876849 c 0.36831819242046726
  1%|▏         | 14/1000 [04:27<5:13:23, 19.07s/it]Epoch 14 Valid AUC:(0.7902378837657051, 0.0)
Epoch 14 Test AUC:(0.7279100217959068, 0.0)
Epoch 14 a 0.36621121629591913 b 0.5414395817825871 c 0.36726722265443495
  2%|▏         | 15/1000 [04:46<5:12:38, 19.04s/it]Epoch 15 Valid AUC:(0.786126104509023, 0.0)
Epoch 15 Test AUC:(0.7277311921593685, 0.0)
Epoch 15 a 0.3665185748569427 b 0.5429728886773509 c 0.3677552063618937
  2%|▏         | 16/1000 [05:05<5:11:39, 19.00s/it]Epoch 16 Valid AUC:(0.7871495515772262, 0.0)
Epoch 16 Test AUC:(0.7281194466192638, 0.0)
Epoch 16 a 0.36612721460480846 b 0.545131859279448 c 0.3673415558953439
  2%|▏         | 17/1000 [05:24<5:12:12, 19.06s/it]Epoch 17 Valid AUC:(0.7864117994873756, 0.0)
Epoch 17 Test AUC:(0.7275106810700221, 0.0)
Epoch 17 a 0.3659641004858478 b 0.5463717671171311 c 0.36718534870493796
  2%|▏         | 18/1000 [05:43<5:12:19, 19.08s/it]Epoch 18 Valid AUC:(0.7887871758216433, 0.0)
Epoch 18 Test AUC:(0.7271585670676701, 0.0)
Epoch 18 a 0.36597194738926425 b 0.5478586857357333 c 0.36705653513631514
  2%|▏         | 19/1000 [06:02<5:13:55, 19.20s/it]Epoch 19 Valid AUC:(0.7878995236436541, 0.0)
Epoch 19 Test AUC:(0.728462406863234, 0.0)
Epoch 19 a 0.3654020556038426 b 0.5501228844927203 c 0.36636038581209796
  2%|▏         | 20/1000 [06:22<5:13:09, 19.17s/it]  2%|▏         | 20/1000 [06:41<5:27:57, 20.08s/it]
[32m[I 2021-05-14 10:17:09,278][0m Trial 69 finished with value: 0.7902378837657051 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 2048, 'learning_rate': 0.005, 'alpha': 0.1352550618763157, 'gamma': 0.002431782416756924}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 10:17:10.013597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]2021-05-14 10:18:46.967916: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 98812282 get requests, put_count=98812282 evicted_count=65000 eviction_rate=0.000657813 and unsatisfied allocation rate=0.000657945
Epoch 0 Valid AUC:(0.7759325255724188, 0.0)
Epoch 0 Test AUC:(0.7189731018840799, 0.0)
Epoch 0 a 0.4094914244394187 b 0.5007653963757712 c 0.4115227057600405
  0%|          | 1/1000 [01:30<25:01:04, 90.15s/it]Epoch 1 Valid AUC:(0.7794378236108679, 0.0)
Epoch 1 Test AUC:(0.721648970775735, 0.0)
Epoch 1 a 0.38665562178527324 b 0.4871424459055876 c 0.38934084901987187
  0%|          | 2/1000 [03:01<25:15:57, 91.14s/it]Epoch 2 Valid AUC:(0.7757769236829385, 0.0)
Epoch 2 Test AUC:(0.7243057198133579, 0.0)
Epoch 2 a 0.38059639783812244 b 0.4863857363371302 c 0.38339223540284983
  0%|          | 3/1000 [04:34<25:24:57, 91.77s/it]Epoch 3 Valid AUC:(0.7873556443337459, 0.0)
Epoch 3 Test AUC:(0.7247232526186045, 0.0)
Epoch 3 a 0.3737909703307468 b 0.4825932015355684 c 0.376090677751142
  0%|          | 4/1000 [06:06<25:24:26, 91.83s/it]Epoch 4 Valid AUC:(0.7886409090458902, 0.0)
Epoch 4 Test AUC:(0.726123773375534, 0.0)
Epoch 4 a 0.3689276948121472 b 0.48098726234805417 c 0.3703144285640486
  0%|          | 5/1000 [07:38<25:25:31, 91.99s/it]Epoch 5 Valid AUC:(0.7867374173278535, 0.0)
Epoch 5 Test AUC:(0.7224786022774456, 0.0)
Epoch 5 a 0.36538237195379536 b 0.47543886960512194 c 0.36586829846054014
  1%|          | 6/1000 [09:10<25:25:33, 92.09s/it]Epoch 6 Valid AUC:(0.7889191695109629, 0.0)
Epoch 6 Test AUC:(0.7229532252908519, 0.0)
Epoch 6 a 0.36213929234615994 b 0.46718144491764624 c 0.3618868865537452
  1%|          | 7/1000 [10:43<25:24:57, 92.14s/it]Epoch 7 Valid AUC:(0.7920119616384549, 0.0)
Epoch 7 Test AUC:(0.7235931931421342, 0.0)
Epoch 7 a 0.359774300090264 b 0.45581700258571617 c 0.35862419752767627
  1%|          | 8/1000 [12:14<25:21:01, 92.00s/it]Epoch 8 Valid AUC:(0.7944807442184375, 0.0)
Epoch 8 Test AUC:(0.7252824228398559, 0.0)
Epoch 8 a 0.35687254585130834 b 0.4458288001702345 c 0.3535090134117445
  1%|          | 9/1000 [13:47<25:20:25, 92.05s/it]Epoch 9 Valid AUC:(0.791847500105757, 0.0)
Epoch 9 Test AUC:(0.7232260166966349, 0.0)
Epoch 9 a 0.3548214004133309 b 0.43467817933746505 c 0.34777317104684996
  1%|          | 10/1000 [15:18<25:17:25, 91.96s/it]Epoch 10 Valid AUC:(0.7956468631977582, 0.0)
Epoch 10 Test AUC:(0.7236449347506977, 0.0)
Epoch 10 a 0.3517640226743591 b 0.4176772596610624 c 0.3396744263364036
  1%|          | 11/1000 [16:51<25:19:32, 92.19s/it]Epoch 11 Valid AUC:(0.7970978069546875, 0.0)
Epoch 11 Test AUC:(0.7257927886930895, 0.0)
Epoch 11 a 0.3492979393818489 b 0.40159588476541774 c 0.33280833976969154
  1%|          | 12/1000 [18:23<25:17:10, 92.14s/it]Epoch 12 Valid AUC:(0.7966030895012564, 0.0)
Epoch 12 Test AUC:(0.7286031122291096, 0.0)
Epoch 12 a 0.3455500661787133 b 0.38858973533214936 c 0.32632642351765506
  1%|▏         | 13/1000 [19:54<25:11:57, 91.91s/it]Epoch 13 Valid AUC:(0.7984407894293006, 0.0)
Epoch 13 Test AUC:(0.7301875333173183, 0.0)
Epoch 13 a 0.340349560862096 b 0.37565348400796206 c 0.31898306223228423
  1%|▏         | 14/1000 [21:26<25:08:37, 91.80s/it]Epoch 14 Valid AUC:(0.8003466751605778, 0.0)
Epoch 14 Test AUC:(0.7331205625355208, 0.0)
Epoch 14 a 0.3353673533294762 b 0.3660019149542814 c 0.3128133304342178
  2%|▏         | 15/1000 [22:58<25:10:24, 92.01s/it]Epoch 15 Valid AUC:(0.7982971909274055, 0.0)
Epoch 15 Test AUC:(0.7317670547291585, 0.0)
Epoch 15 a 0.33167787372946017 b 0.3562622141670173 c 0.3056385455356997
  2%|▏         | 16/1000 [24:30<25:08:16, 91.97s/it]Epoch 16 Valid AUC:(0.798343936983584, 0.0)
Epoch 16 Test AUC:(0.7349169395189977, 0.0)
Epoch 16 a 0.3282627418367436 b 0.3472265103753184 c 0.29896311445435286
  2%|▏         | 17/1000 [26:02<25:05:29, 91.89s/it]Epoch 17 Valid AUC:(0.7983236288819745, 0.0)
Epoch 17 Test AUC:(0.7356163619074378, 0.0)
Epoch 17 a 0.32598817045659845 b 0.3393244388057912 c 0.2933843018603277
  2%|▏         | 18/1000 [27:34<25:06:24, 92.04s/it]Epoch 18 Valid AUC:(0.8010630733700158, 0.0)
Epoch 18 Test AUC:(0.7361839804362849, 0.0)
Epoch 18 a 0.3232149533042965 b 0.3317609519605905 c 0.2876386207414105
  2%|▏         | 19/1000 [29:07<25:05:07, 92.06s/it]Epoch 19 Valid AUC:(0.7986310212073073, 0.0)
Epoch 19 Test AUC:(0.7350727244298578, 0.0)
Epoch 19 a 0.3206874058999766 b 0.3253340757708674 c 0.2827086754787856
  2%|▏         | 20/1000 [30:39<25:04:04, 92.09s/it]Epoch 20 Valid AUC:(0.7989064006543048, 0.0)
Epoch 20 Test AUC:(0.7385695328144474, 0.0)
Epoch 20 a 0.3181514003926839 b 0.32045174989721903 c 0.2782464588671863
  2%|▏         | 21/1000 [32:10<24:59:05, 91.88s/it]Epoch 21 Valid AUC:(0.8018834701803249, 0.0)
Epoch 21 Test AUC:(0.7383282087891823, 0.0)
Epoch 21 a 0.3147575966339236 b 0.314344947756656 c 0.2733291486199473
  2%|▏         | 22/1000 [33:40<24:49:55, 91.41s/it]Epoch 22 Valid AUC:(0.8000489614155399, 0.0)
Epoch 22 Test AUC:(0.7406546828706061, 0.0)
Epoch 22 a 0.31143957617836937 b 0.3104485009517708 c 0.2689018962638719
  2%|▏         | 23/1000 [35:11<24:45:56, 91.26s/it]Epoch 23 Valid AUC:(0.7987773802576607, 0.0)
Epoch 23 Test AUC:(0.7421321661705659, 0.0)
Epoch 23 a 0.30857463434368554 b 0.30795874846893057 c 0.26533829581209833
  2%|▏         | 24/1000 [36:42<24:40:18, 91.00s/it]Epoch 24 Valid AUC:(0.8004568202751001, 0.0)
Epoch 24 Test AUC:(0.7427726727297211, 0.0)
Epoch 24 a 0.30542512623297136 b 0.3052621028223028 c 0.2608328437961083
  2%|▎         | 25/1000 [38:15<24:50:44, 91.74s/it]Epoch 25 Valid AUC:(0.8009798673124057, 0.0)
Epoch 25 Test AUC:(0.7447149668639719, 0.0)
Epoch 25 a 0.30246484862786666 b 0.3023611776215929 c 0.25720550527634994
  3%|▎         | 26/1000 [39:49<24:58:52, 92.33s/it]Epoch 26 Valid AUC:(0.801174611574684, 0.0)
Epoch 26 Test AUC:(0.7467805353164931, 0.0)
Epoch 26 a 0.30023306671162725 b 0.30076328024897775 c 0.2533655969999446
  3%|▎         | 27/1000 [41:23<25:04:08, 92.75s/it]Epoch 27 Valid AUC:(0.802393523159684, 0.0)
Epoch 27 Test AUC:(0.7448304854990551, 0.0)
Epoch 27 a 0.29698903447905295 b 0.2984091661555666 c 0.24956405287237474
  3%|▎         | 28/1000 [42:56<25:07:16, 93.04s/it]Epoch 28 Valid AUC:(0.8005458921777857, 0.0)
Epoch 28 Test AUC:(0.7473154423061632, 0.0)
Epoch 28 a 0.29439269312070887 b 0.2966293993160518 c 0.24675409473343873
  3%|▎         | 29/1000 [44:30<25:07:47, 93.17s/it]Epoch 29 Valid AUC:(0.8040218186983322, 0.0)
Epoch 29 Test AUC:(0.7487199606175472, 0.0)
Epoch 29 a 0.29201522880276926 b 0.29534930912721563 c 0.24323528766692046
  3%|▎         | 30/1000 [46:04<25:11:05, 93.47s/it]Epoch 30 Valid AUC:(0.8039980567071711, 0.0)
Epoch 30 Test AUC:(0.7481534066780682, 0.0)
Epoch 30 a 0.28968661728219486 b 0.29331157007207814 c 0.23921897950426674
  3%|▎         | 31/1000 [47:35<24:55:40, 92.61s/it]Epoch 31 Valid AUC:(0.8048548186811282, 0.0)
Epoch 31 Test AUC:(0.7478353638109536, 0.0)
Epoch 31 a 0.2878956979429218 b 0.29224221438349374 c 0.23593893695165455
  3%|▎         | 32/1000 [49:09<25:01:10, 93.05s/it]Epoch 32 Valid AUC:(0.8008186071957004, 0.0)
Epoch 32 Test AUC:(0.7483488037194307, 0.0)
Epoch 32 a 0.2863851535008467 b 0.290564524830587 c 0.23304031399534023
  3%|▎         | 33/1000 [50:42<25:01:23, 93.16s/it]Epoch 33 Valid AUC:(0.8023709479224097, 0.0)
Epoch 33 Test AUC:(0.7490012516364374, 0.0)
Epoch 33 a 0.28502576487884673 b 0.28816973966671905 c 0.2296063264221013
  3%|▎         | 34/1000 [52:16<25:02:03, 93.30s/it]Epoch 34 Valid AUC:(0.8007587978756254, 0.0)
Epoch 34 Test AUC:(0.7494657204339836, 0.0)
Epoch 34 a 0.2841803506016731 b 0.28677408779470975 c 0.22722616611831864
  4%|▎         | 35/1000 [53:47<24:48:29, 92.55s/it]Epoch 35 Valid AUC:(0.803187315408507, 0.0)
Epoch 35 Test AUC:(0.7516922813068039, 0.0)
Epoch 35 a 0.2824863131707103 b 0.2835474302711141 c 0.22290507048908134
  4%|▎         | 36/1000 [55:20<24:50:40, 92.78s/it]Epoch 36 Valid AUC:(0.8023139811726596, 0.0)
Epoch 36 Test AUC:(0.7504949560290174, 0.0)
Epoch 36 a 0.2813104923432262 b 0.2810241686296415 c 0.2202030535884786
  4%|▎         | 37/1000 [56:54<24:53:28, 93.05s/it]  4%|▎         | 37/1000 [58:27<25:21:27, 94.79s/it]
[32m[I 2021-05-14 11:15:56,367][0m Trial 70 finished with value: 0.8048548186811282 and parameters: {'rank': 70.0, 'lambda': 0.0001, 'batch_size': 256, 'learning_rate': 0.005, 'alpha': 0.1483203799187417, 'gamma': 0.002563124815331597}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 11:15:57.032729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807441781955407, 0.0)
Epoch 0 Test AUC:(0.7200587307874059, 0.0)
Epoch 0 a 0.4133383919535508 b 0.501319584952034 c 0.4144908990898363
  0%|          | 1/1000 [00:50<13:57:13, 50.28s/it]Epoch 1 Valid AUC:(0.779768997151237, 0.0)
Epoch 1 Test AUC:(0.7225621704051091, 0.0)
Epoch 1 a 0.3856703807530509 b 0.4866889805141349 c 0.38647420239640434
  0%|          | 2/1000 [01:41<14:00:43, 50.54s/it]Epoch 2 Valid AUC:(0.7760073641180129, 0.0)
Epoch 2 Test AUC:(0.7244444370906544, 0.0)
Epoch 2 a 0.38135629736441723 b 0.4916260289234415 c 0.3825180148574668
  0%|          | 3/1000 [02:31<14:02:41, 50.71s/it]Epoch 3 Valid AUC:(0.7824101397133824, 0.0)
Epoch 3 Test AUC:(0.725817205841206, 0.0)
Epoch 3 a 0.3763758201354466 b 0.4951357012783258 c 0.37862393967582425
  0%|          | 4/1000 [03:22<14:03:51, 50.83s/it]Epoch 4 Valid AUC:(0.7848710392230003, 0.0)
Epoch 4 Test AUC:(0.7277464127945104, 0.0)
Epoch 4 a 0.37232986212496305 b 0.4994750082852615 c 0.3749293260411238
  0%|          | 5/1000 [04:13<14:02:10, 50.78s/it]Epoch 5 Valid AUC:(0.7835057826851551, 0.0)
Epoch 5 Test AUC:(0.7263608646960826, 0.0)
Epoch 5 a 0.369652722922849 b 0.5015543080431595 c 0.3724159900571259
  1%|          | 6/1000 [05:04<14:04:11, 50.96s/it]Epoch 6 Valid AUC:(0.786658202146705, 0.0)
Epoch 6 Test AUC:(0.7271845875130277, 0.0)
Epoch 6 a 0.36772890284027854 b 0.5036828065782006 c 0.370554934924757
  1%|          | 7/1000 [05:55<14:02:06, 50.88s/it]Epoch 7 Valid AUC:(0.7889586630398784, 0.0)
Epoch 7 Test AUC:(0.7272663385704845, 0.0)
Epoch 7 a 0.3662830491660826 b 0.5024505801483898 c 0.36857253426996994
  1%|          | 8/1000 [06:44<13:52:24, 50.35s/it]Epoch 8 Valid AUC:(0.7915072247013445, 0.0)
Epoch 8 Test AUC:(0.7275946681926978, 0.0)
Epoch 8 a 0.3637984017251243 b 0.5023882930547419 c 0.36555337570082974
  1%|          | 9/1000 [07:36<13:56:03, 50.62s/it]Epoch 9 Valid AUC:(0.7908895692853372, 0.0)
Epoch 9 Test AUC:(0.7285502119710732, 0.0)
Epoch 9 a 0.36128808596964096 b 0.5037354668021442 c 0.36279166260475604
  1%|          | 10/1000 [08:26<13:54:41, 50.59s/it]Epoch 10 Valid AUC:(0.7921720849833485, 0.0)
Epoch 10 Test AUC:(0.7281177278846213, 0.0)
Epoch 10 a 0.35805453291121625 b 0.5067979958455567 c 0.3590228931764722
  1%|          | 11/1000 [09:17<13:54:19, 50.62s/it]Epoch 11 Valid AUC:(0.7926355341632046, 0.0)
Epoch 11 Test AUC:(0.7269426478216221, 0.0)
Epoch 11 a 0.35659242269978436 b 0.5061689347208626 c 0.35700022172879886
  1%|          | 12/1000 [10:08<13:54:58, 50.71s/it]Epoch 12 Valid AUC:(0.7935294610140121, 0.0)
Epoch 12 Test AUC:(0.7253530063975964, 0.0)
Epoch 12 a 0.35542866797514366 b 0.507778533267783 c 0.3546403934898031
  1%|▏         | 13/1000 [10:59<13:56:34, 50.86s/it]Epoch 13 Valid AUC:(0.7935853396924339, 0.0)
Epoch 13 Test AUC:(0.7241421279137987, 0.0)
Epoch 13 a 0.35404104342163206 b 0.5045085199761918 c 0.35127546495834827
  1%|▏         | 14/1000 [11:50<13:55:16, 50.83s/it]Epoch 14 Valid AUC:(0.7952107247363986, 0.0)
Epoch 14 Test AUC:(0.7257140048043935, 0.0)
Epoch 14 a 0.35271173337815515 b 0.49865850806236267 c 0.3467222379606734
  2%|▏         | 15/1000 [12:40<13:53:54, 50.80s/it]Epoch 15 Valid AUC:(0.7938707668181275, 0.0)
Epoch 15 Test AUC:(0.722867493780778, 0.0)
Epoch 15 a 0.3515457438990863 b 0.4943212599941422 c 0.34149364890227135
  2%|▏         | 16/1000 [13:31<13:53:31, 50.82s/it]Epoch 16 Valid AUC:(0.7924120976266091, 0.0)
Epoch 16 Test AUC:(0.7232619433812125, 0.0)
Epoch 16 a 0.35045591602383 b 0.488549658530195 c 0.3369985946587154
  2%|▏         | 17/1000 [14:22<13:53:09, 50.85s/it]Epoch 17 Valid AUC:(0.7937192942170093, 0.0)
Epoch 17 Test AUC:(0.7260571873722479, 0.0)
Epoch 17 a 0.3493837952254044 b 0.4835478380412403 c 0.33296462977436225
  2%|▏         | 18/1000 [15:13<13:53:20, 50.92s/it]Epoch 18 Valid AUC:(0.796185926286169, 0.0)
Epoch 18 Test AUC:(0.7255299462811198, 0.0)
Epoch 18 a 0.3472730759643693 b 0.4765944747737716 c 0.32791014174580335
  2%|▏         | 19/1000 [16:04<13:53:47, 51.00s/it]Epoch 19 Valid AUC:(0.7951880149319989, 0.0)
Epoch 19 Test AUC:(0.7268133921357774, 0.0)
Epoch 19 a 0.34475629376453654 b 0.46898585102207946 c 0.3230977571706177
  2%|▏         | 20/1000 [16:55<13:52:16, 50.96s/it]Epoch 20 Valid AUC:(0.7971342618297524, 0.0)
Epoch 20 Test AUC:(0.7312188168573613, 0.0)
Epoch 20 a 0.34100900593417993 b 0.46718260423998 c 0.3182896066239662
  2%|▏         | 21/1000 [17:46<13:51:49, 50.98s/it]Epoch 21 Valid AUC:(0.8012430690753509, 0.0)
Epoch 21 Test AUC:(0.7364886624930573, 0.0)
Epoch 21 a 0.33657968679903977 b 0.46467146475310295 c 0.312191388136904
  2%|▏         | 22/1000 [18:37<13:48:48, 50.85s/it]Epoch 22 Valid AUC:(0.7991128176535172, 0.0)
Epoch 22 Test AUC:(0.7374658999519691, 0.0)
Epoch 22 a 0.3322690781093459 b 0.46247998677508934 c 0.30676485070400317
  2%|▏         | 23/1000 [19:28<13:49:12, 50.92s/it]Epoch 23 Valid AUC:(0.8002470480688946, 0.0)
Epoch 23 Test AUC:(0.737285856084987, 0.0)
Epoch 23 a 0.32859883989606586 b 0.4601506562659918 c 0.30174457679092287
  2%|▏         | 24/1000 [20:19<13:49:41, 51.01s/it]Epoch 24 Valid AUC:(0.7993087537960489, 0.0)
Epoch 24 Test AUC:(0.7388341580929492, 0.0)
Epoch 24 a 0.32502556986492165 b 0.4579895635246031 c 0.2966438462916514
  2%|▎         | 25/1000 [21:10<13:49:00, 51.02s/it]Epoch 25 Valid AUC:(0.8016135310899682, 0.0)
Epoch 25 Test AUC:(0.7416117957425481, 0.0)
Epoch 25 a 0.3219575676280008 b 0.454620576240647 c 0.2927383859632481
  3%|▎         | 26/1000 [22:01<13:49:20, 51.09s/it]Epoch 26 Valid AUC:(0.7997202011122863, 0.0)
Epoch 26 Test AUC:(0.7421251287645425, 0.0)
Epoch 26 a 0.319646175238688 b 0.4509134061139834 c 0.2878216341347762
  3%|▎         | 27/1000 [22:53<13:49:02, 51.12s/it]Epoch 27 Valid AUC:(0.801168626541583, 0.0)
Epoch 27 Test AUC:(0.741582564427249, 0.0)
Epoch 27 a 0.317358590047844 b 0.4461886598550578 c 0.28262219291697566
  3%|▎         | 28/1000 [23:44<13:49:41, 51.22s/it]Epoch 28 Valid AUC:(0.799121085201383, 0.0)
Epoch 28 Test AUC:(0.7424122985399833, 0.0)
Epoch 28 a 0.31576260042862153 b 0.4395687975274245 c 0.2785937101908133
  3%|▎         | 29/1000 [24:35<13:47:28, 51.13s/it]Epoch 29 Valid AUC:(0.8014684279994521, 0.0)
Epoch 29 Test AUC:(0.744785298169613, 0.0)
Epoch 29 a 0.31421804631979655 b 0.4322934127309673 c 0.2732776968891712
  3%|▎         | 30/1000 [25:26<13:46:06, 51.10s/it]Epoch 30 Valid AUC:(0.8024627778103701, 0.0)
Epoch 30 Test AUC:(0.7425004243072705, 0.0)
Epoch 30 a 0.31269128545669 b 0.42563924313311124 c 0.2686496726883729
  3%|▎         | 31/1000 [26:17<13:43:58, 51.02s/it]Epoch 31 Valid AUC:(0.8034702242065681, 0.0)
Epoch 31 Test AUC:(0.7439491807961298, 0.0)
Epoch 31 a 0.3110903600451932 b 0.41856794529997365 c 0.2636435727478273
  3%|▎         | 32/1000 [27:06<13:36:05, 50.58s/it]Epoch 32 Valid AUC:(0.8019129877996779, 0.0)
Epoch 32 Test AUC:(0.7423931530331953, 0.0)
Epoch 32 a 0.30983567723565897 b 0.41022141076909224 c 0.2591858667507018
  3%|▎         | 33/1000 [27:56<13:30:27, 50.29s/it]Epoch 33 Valid AUC:(0.8029248339000805, 0.0)
Epoch 33 Test AUC:(0.7455547867852171, 0.0)
Epoch 33 a 0.3076289822637915 b 0.40527365666999665 c 0.2558843432597711
  3%|▎         | 34/1000 [28:45<13:24:40, 49.98s/it]Epoch 34 Valid AUC:(0.8013541779468093, 0.0)
Epoch 34 Test AUC:(0.7462848684923656, 0.0)
Epoch 34 a 0.30493411691615757 b 0.3989469649446322 c 0.25222676581660025
  4%|▎         | 35/1000 [29:35<13:21:43, 49.85s/it]Epoch 35 Valid AUC:(0.8054034283458918, 0.0)
Epoch 35 Test AUC:(0.7541624877792943, 0.0)
Epoch 35 a 0.3001303911448964 b 0.39195100312501613 c 0.24805123309494265
  4%|▎         | 36/1000 [30:25<13:20:18, 49.81s/it]Epoch 36 Valid AUC:(0.8045580264005013, 0.0)
Epoch 36 Test AUC:(0.7539099577751791, 0.0)
Epoch 36 a 0.2966456030695971 b 0.3857520091941419 c 0.24481744374667616
  4%|▎         | 37/1000 [31:14<13:16:18, 49.61s/it]Epoch 37 Valid AUC:(0.8054442226903529, 0.0)
Epoch 37 Test AUC:(0.7545978920044546, 0.0)
Epoch 37 a 0.294452597857481 b 0.3778065091047728 c 0.2413202555666507
  4%|▍         | 38/1000 [32:03<13:13:57, 49.52s/it]Epoch 38 Valid AUC:(0.8078338016235121, 0.0)
Epoch 38 Test AUC:(0.7574892098416336, 0.0)
Epoch 38 a 0.29295669016343967 b 0.37220972740434305 c 0.23747455666002854
  4%|▍         | 39/1000 [32:53<13:13:29, 49.54s/it]Epoch 39 Valid AUC:(0.8057451557936669, 0.0)
Epoch 39 Test AUC:(0.7568569078888933, 0.0)
Epoch 39 a 0.29089689209787417 b 0.3642299417518754 c 0.23331417140346658
  4%|▍         | 40/1000 [33:42<13:12:40, 49.54s/it]Epoch 40 Valid AUC:(0.8080732465216628, 0.0)
Epoch 40 Test AUC:(0.7587656695957795, 0.0)
Epoch 40 a 0.28980959670044765 b 0.3590860955072361 c 0.23057747525828226
  4%|▍         | 41/1000 [34:32<13:13:11, 49.63s/it]Epoch 41 Valid AUC:(0.8046608856663773, 0.0)
Epoch 41 Test AUC:(0.7558926934790382, 0.0)
Epoch 41 a 0.2887193002631247 b 0.35288062685692095 c 0.22774941496685958
  4%|▍         | 42/1000 [35:22<13:13:49, 49.72s/it]Epoch 42 Valid AUC:(0.8054388630739873, 0.0)
Epoch 42 Test AUC:(0.760478516930727, 0.0)
Epoch 42 a 0.28729807401087204 b 0.34789736380039804 c 0.22386684480087618
  4%|▍         | 43/1000 [36:12<13:14:36, 49.82s/it]Epoch 43 Valid AUC:(0.8062501144461361, 0.0)
Epoch 43 Test AUC:(0.7600886677245093, 0.0)
Epoch 43 a 0.2863405152885487 b 0.34169321790547436 c 0.22143951247275714
  4%|▍         | 44/1000 [37:02<13:14:40, 49.87s/it]Epoch 44 Valid AUC:(0.8060553535231663, 0.0)
Epoch 44 Test AUC:(0.7594190837665902, 0.0)
Epoch 44 a 0.2853015986846486 b 0.33779703227567 c 0.22053995974346904
  4%|▍         | 45/1000 [37:51<13:11:06, 49.70s/it]Epoch 45 Valid AUC:(0.8035491343688991, 0.0)
Epoch 45 Test AUC:(0.757573303850792, 0.0)
Epoch 45 a 0.28386518284228723 b 0.33481654302934766 c 0.21807012711492343
  5%|▍         | 46/1000 [38:41<13:11:50, 49.80s/it]  5%|▍         | 46/1000 [39:32<13:40:06, 51.58s/it]
[32m[I 2021-05-14 11:55:48,633][0m Trial 71 finished with value: 0.8080732465216628 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12812078803661953, 'gamma': 0.0023840277078161715}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 11:55:49.297042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7793621469043215, 0.0)
Epoch 0 Test AUC:(0.7201547062979854, 0.0)
Epoch 0 a 0.41299110015393264 b 0.5003527709895697 c 0.4142151343630593
  0%|          | 1/1000 [00:48<13:26:14, 48.42s/it]Epoch 1 Valid AUC:(0.779537769818877, 0.0)
Epoch 1 Test AUC:(0.7222357561886664, 0.0)
Epoch 1 a 0.38595920891109364 b 0.48591054301386627 c 0.38695973133896916
  0%|          | 2/1000 [01:38<13:42:31, 49.45s/it]Epoch 2 Valid AUC:(0.7754019068915244, 0.0)
Epoch 2 Test AUC:(0.7246280894452938, 0.0)
Epoch 2 a 0.3817299199655982 b 0.4912523082204508 c 0.38281148090448897
  0%|          | 3/1000 [02:28<13:46:42, 49.75s/it]Epoch 3 Valid AUC:(0.7818849947105123, 0.0)
Epoch 3 Test AUC:(0.7252219892225162, 0.0)
Epoch 3 a 0.3776015880362129 b 0.4965170055807716 c 0.37963655890833203
  0%|          | 4/1000 [03:18<13:47:30, 49.85s/it]Epoch 4 Valid AUC:(0.7844333115879694, 0.0)
Epoch 4 Test AUC:(0.7282421822296613, 0.0)
Epoch 4 a 0.3741073634782787 b 0.5009657953466687 c 0.37644275872999994
  0%|          | 5/1000 [04:09<13:50:18, 50.07s/it]Epoch 5 Valid AUC:(0.7806085768256689, 0.0)
Epoch 5 Test AUC:(0.725485314761388, 0.0)
Epoch 5 a 0.37081187159962337 b 0.49998125469900473 c 0.3729839520435218
  1%|          | 6/1000 [05:00<13:55:17, 50.42s/it]Epoch 6 Valid AUC:(0.7872737262757645, 0.0)
Epoch 6 Test AUC:(0.7264263305290296, 0.0)
Epoch 6 a 0.3675607595765135 b 0.5005082560616959 c 0.36945211305704634
  1%|          | 7/1000 [05:50<13:56:00, 50.51s/it]Epoch 7 Valid AUC:(0.7893896097733811, 0.0)
Epoch 7 Test AUC:(0.7257070614584749, 0.0)
Epoch 7 a 0.3640329593743837 b 0.501391058896389 c 0.3655241519152758
  1%|          | 8/1000 [06:41<13:55:59, 50.56s/it]Epoch 8 Valid AUC:(0.7929839617722325, 0.0)
Epoch 8 Test AUC:(0.7268574336421245, 0.0)
Epoch 8 a 0.3612500778746077 b 0.5026434632973892 c 0.3621720769395771
  1%|          | 9/1000 [07:32<13:58:40, 50.78s/it]Epoch 9 Valid AUC:(0.7910149884093874, 0.0)
Epoch 9 Test AUC:(0.7250849308234318, 0.0)
Epoch 9 a 0.3595705290795332 b 0.502358624992716 c 0.36010263071693405
  1%|          | 10/1000 [08:23<13:57:00, 50.73s/it]Epoch 10 Valid AUC:(0.7932739846856562, 0.0)
Epoch 10 Test AUC:(0.7255483093788541, 0.0)
Epoch 10 a 0.35686507053538347 b 0.5031851830496874 c 0.3567504135056041
  1%|          | 11/1000 [09:14<13:55:41, 50.70s/it]Epoch 11 Valid AUC:(0.7928523243653973, 0.0)
Epoch 11 Test AUC:(0.7247824848318782, 0.0)
Epoch 11 a 0.35560174661143207 b 0.5036650881680924 c 0.35480569264058853
  1%|          | 12/1000 [10:04<13:55:01, 50.71s/it]Epoch 12 Valid AUC:(0.7945570091755607, 0.0)
Epoch 12 Test AUC:(0.7245433754945354, 0.0)
Epoch 12 a 0.35445772498186445 b 0.5025231916779723 c 0.3517536601909929
  1%|▏         | 13/1000 [10:55<13:55:18, 50.78s/it]Epoch 13 Valid AUC:(0.7953055035667926, 0.0)
Epoch 13 Test AUC:(0.7236701043796527, 0.0)
Epoch 13 a 0.3528102880392516 b 0.49816811318608595 c 0.34712895661052806
  1%|▏         | 14/1000 [11:46<13:51:58, 50.63s/it]Epoch 14 Valid AUC:(0.7949858066798321, 0.0)
Epoch 14 Test AUC:(0.7232394715670818, 0.0)
Epoch 14 a 0.3512724401125726 b 0.49393044577038264 c 0.34227742263728705
  2%|▏         | 15/1000 [12:36<13:51:10, 50.63s/it]Epoch 15 Valid AUC:(0.7935290393703526, 0.0)
Epoch 15 Test AUC:(0.7220170707204451, 0.0)
Epoch 15 a 0.3499811316280058 b 0.4879798879565847 c 0.3372507477310342
  2%|▏         | 16/1000 [13:27<13:49:55, 50.61s/it]Epoch 16 Valid AUC:(0.7918513948628434, 0.0)
Epoch 16 Test AUC:(0.7216456359174735, 0.0)
Epoch 16 a 0.3485908695389807 b 0.4802646793470057 c 0.33195880025445335
  2%|▏         | 17/1000 [14:17<13:48:50, 50.59s/it]Epoch 17 Valid AUC:(0.7918841228693307, 0.0)
Epoch 17 Test AUC:(0.7232451066224518, 0.0)
Epoch 17 a 0.3473364215501597 b 0.4741588991652552 c 0.32681634170668467
  2%|▏         | 18/1000 [15:08<13:49:34, 50.69s/it]Epoch 18 Valid AUC:(0.7949984905925942, 0.0)
Epoch 18 Test AUC:(0.722494340243164, 0.0)
Epoch 18 a 0.3454028794942967 b 0.46456397185383186 c 0.3207948552650705
  2%|▏         | 19/1000 [15:59<13:47:37, 50.62s/it]  2%|▏         | 19/1000 [16:49<14:28:50, 53.14s/it]
[32m[I 2021-05-14 12:12:58,034][0m Trial 72 finished with value: 0.7953055035667926 and parameters: {'rank': 55.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12983655830230484, 'gamma': 0.002198095518498617}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 12:12:58.801508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7797030528518357, 0.0)
Epoch 0 Test AUC:(0.7201377327245267, 0.0)
Epoch 0 a 0.4135219805557243 b 0.4999698833440631 c 0.41444832866100717
  0%|          | 1/1000 [00:48<13:26:58, 48.47s/it]Epoch 1 Valid AUC:(0.7803106195782136, 0.0)
Epoch 1 Test AUC:(0.7220876500027262, 0.0)
Epoch 1 a 0.38536490437010645 b 0.48562391237233965 c 0.3861299093580342
  0%|          | 2/1000 [01:38<13:42:11, 49.43s/it]Epoch 2 Valid AUC:(0.7750966727665646, 0.0)
Epoch 2 Test AUC:(0.7240276054607346, 0.0)
Epoch 2 a 0.38172377846850236 b 0.4905111915628675 c 0.3825804586981384
  0%|          | 3/1000 [02:29<13:53:11, 50.14s/it]Epoch 3 Valid AUC:(0.7817221774599276, 0.0)
Epoch 3 Test AUC:(0.7254664685367517, 0.0)
Epoch 3 a 0.3776542013679712 b 0.49434504038851024 c 0.3791781273526205
  0%|          | 4/1000 [03:19<13:53:49, 50.23s/it]Epoch 4 Valid AUC:(0.7834978675749987, 0.0)
Epoch 4 Test AUC:(0.7281991796599264, 0.0)
Epoch 4 a 0.3743841178580309 b 0.499501593995622 c 0.376135013892617
  0%|          | 5/1000 [04:10<13:52:11, 50.18s/it]Epoch 5 Valid AUC:(0.7805386237075225, 0.0)
Epoch 5 Test AUC:(0.7255604174796185, 0.0)
Epoch 5 a 0.37203259529242333 b 0.5019088962548216 c 0.37401510322357806
  1%|          | 6/1000 [05:00<13:53:54, 50.34s/it]Epoch 6 Valid AUC:(0.7866822319905253, 0.0)
Epoch 6 Test AUC:(0.7274712570597293, 0.0)
Epoch 6 a 0.3699035971337401 b 0.5007556651079919 c 0.3715175806996328
  1%|          | 7/1000 [05:51<13:54:42, 50.44s/it]Epoch 7 Valid AUC:(0.7870322462100412, 0.0)
Epoch 7 Test AUC:(0.726032971170719, 0.0)
Epoch 7 a 0.36718494407607755 b 0.49818448065751997 c 0.36832200881221167
  1%|          | 8/1000 [06:42<13:55:31, 50.54s/it]Epoch 8 Valid AUC:(0.7911929540735165, 0.0)
Epoch 8 Test AUC:(0.7269319420715111, 0.0)
Epoch 8 a 0.36385197958476106 b 0.4984287710736695 c 0.3644448296884656
  1%|          | 9/1000 [07:32<13:55:56, 50.61s/it]Epoch 9 Valid AUC:(0.7901158890545982, 0.0)
Epoch 9 Test AUC:(0.7268379632004291, 0.0)
Epoch 9 a 0.3616021425431403 b 0.4987064087294957 c 0.3618767449193797
  1%|          | 10/1000 [08:23<13:54:32, 50.58s/it]Epoch 10 Valid AUC:(0.7913886031395141, 0.0)
Epoch 10 Test AUC:(0.7264359802406912, 0.0)
Epoch 10 a 0.3583220542676492 b 0.49870953569469795 c 0.3581474562525989
  1%|          | 11/1000 [09:13<13:52:54, 50.53s/it]Epoch 11 Valid AUC:(0.7926267732025456, 0.0)
Epoch 11 Test AUC:(0.7257966750856019, 0.0)
Epoch 11 a 0.3564601996295169 b 0.49912480551232274 c 0.35621156718889235
  1%|          | 12/1000 [10:04<13:52:53, 50.58s/it]Epoch 12 Valid AUC:(0.7924868759373946, 0.0)
Epoch 12 Test AUC:(0.7240156983065577, 0.0)
Epoch 12 a 0.35492162991097753 b 0.5015514492988586 c 0.35422638256545036
  1%|▏         | 13/1000 [10:55<13:52:48, 50.63s/it]Epoch 13 Valid AUC:(0.7920973387123547, 0.0)
Epoch 13 Test AUC:(0.7234272753927107, 0.0)
Epoch 13 a 0.3532026202625912 b 0.5015544234147254 c 0.35154132044291353
  1%|▏         | 14/1000 [11:45<13:51:05, 50.57s/it]Epoch 14 Valid AUC:(0.7933382565079277, 0.0)
Epoch 14 Test AUC:(0.7246722891436352, 0.0)
Epoch 14 a 0.3515386094509716 b 0.4961464272538421 c 0.3476527393823658
  2%|▏         | 15/1000 [12:36<13:51:53, 50.67s/it]Epoch 15 Valid AUC:(0.7920510219893858, 0.0)
Epoch 15 Test AUC:(0.7223689966025875, 0.0)
Epoch 15 a 0.3500796779540463 b 0.48978010221746127 c 0.3430896187931959
  2%|▏         | 16/1000 [13:27<13:50:47, 50.66s/it]Epoch 16 Valid AUC:(0.7902432062159124, 0.0)
Epoch 16 Test AUC:(0.7221899446421652, 0.0)
Epoch 16 a 0.34878740500156546 b 0.48038296230602073 c 0.3385161362903219
  2%|▏         | 17/1000 [14:17<13:49:19, 50.62s/it]Epoch 17 Valid AUC:(0.7922251134018953, 0.0)
Epoch 17 Test AUC:(0.7239883268160583, 0.0)
Epoch 17 a 0.3475468709795048 b 0.47067165392745186 c 0.3339962951494175
  2%|▏         | 18/1000 [15:08<13:48:29, 50.62s/it]Epoch 18 Valid AUC:(0.7943225201923995, 0.0)
Epoch 18 Test AUC:(0.7234131492751521, 0.0)
Epoch 18 a 0.34591200773864683 b 0.45694931921824605 c 0.3286077296230155
  2%|▏         | 19/1000 [15:58<13:47:52, 50.63s/it]Epoch 19 Valid AUC:(0.792210871073662, 0.0)
Epoch 19 Test AUC:(0.722983106475966, 0.0)
Epoch 19 a 0.3445391462482437 b 0.44201652936532465 c 0.32271351852647256
  2%|▏         | 20/1000 [16:49<13:45:32, 50.54s/it]Epoch 20 Valid AUC:(0.7934062821122017, 0.0)
Epoch 20 Test AUC:(0.7253916779270507, 0.0)
Epoch 20 a 0.34313993009043414 b 0.4276157272773489 c 0.3168231396368092
  2%|▏         | 21/1000 [17:40<13:45:57, 50.62s/it]Epoch 21 Valid AUC:(0.7973695120783658, 0.0)
Epoch 21 Test AUC:(0.7293231423314214, 0.0)
Epoch 21 a 0.3404897214541253 b 0.4131644663196694 c 0.31004141753828024
  2%|▏         | 22/1000 [18:30<13:44:23, 50.58s/it]Epoch 22 Valid AUC:(0.796376479743685, 0.0)
Epoch 22 Test AUC:(0.732069983847614, 0.0)
Epoch 22 a 0.33667440571535523 b 0.400261351819969 c 0.3045579942779042
  2%|▏         | 23/1000 [19:20<13:41:42, 50.46s/it]Epoch 23 Valid AUC:(0.7975458706265403, 0.0)
Epoch 23 Test AUC:(0.7323894333408415, 0.0)
Epoch 23 a 0.3327166278597335 b 0.39504577102555594 c 0.29909335481568844
  2%|▏         | 24/1000 [20:11<13:41:39, 50.51s/it]Epoch 24 Valid AUC:(0.7962980078857054, 0.0)
Epoch 24 Test AUC:(0.7344426029613652, 0.0)
Epoch 24 a 0.32816768598028834 b 0.389191395020341 c 0.29288624376958045
  2%|▎         | 25/1000 [21:02<13:41:36, 50.56s/it]Epoch 25 Valid AUC:(0.7994553063667444, 0.0)
Epoch 25 Test AUC:(0.7388452144307235, 0.0)
Epoch 25 a 0.32438043485464946 b 0.38343563561948013 c 0.2878052278063907
  3%|▎         | 26/1000 [21:52<13:41:21, 50.60s/it]Epoch 26 Valid AUC:(0.7969011415864953, 0.0)
Epoch 26 Test AUC:(0.7393904124509516, 0.0)
Epoch 26 a 0.3209379501266019 b 0.37425351784502714 c 0.2817088416824398
  3%|▎         | 27/1000 [22:43<13:41:18, 50.65s/it]Epoch 27 Valid AUC:(0.7982119573917728, 0.0)
Epoch 27 Test AUC:(0.7394078263967191, 0.0)
Epoch 27 a 0.31705400581570936 b 0.36458393889413754 c 0.2768383282470991
  3%|▎         | 28/1000 [23:34<13:41:50, 50.73s/it]Epoch 28 Valid AUC:(0.799163217527548, 0.0)
Epoch 28 Test AUC:(0.7430902239190152, 0.0)
Epoch 28 a 0.31277872127306533 b 0.355766442520038 c 0.2735194042474931
  3%|▎         | 29/1000 [24:25<13:40:09, 50.68s/it]Epoch 29 Valid AUC:(0.8022224434876001, 0.0)
Epoch 29 Test AUC:(0.7461924074093385, 0.0)
Epoch 29 a 0.3075755624104314 b 0.34944244559621906 c 0.2686132227391064
  3%|▎         | 30/1000 [25:16<13:41:47, 50.83s/it]Epoch 30 Valid AUC:(0.8030130240676969, 0.0)
Epoch 30 Test AUC:(0.7437578026865183, 0.0)
Epoch 30 a 0.303013440828688 b 0.3438639635411307 c 0.26451080845635183
  3%|▎         | 31/1000 [26:07<13:42:06, 50.90s/it]Epoch 31 Valid AUC:(0.8057138439459752, 0.0)
Epoch 31 Test AUC:(0.7467331119218322, 0.0)
Epoch 31 a 0.2993221209202734 b 0.33953612263293814 c 0.2601149254581578
  3%|▎         | 32/1000 [26:57<13:39:18, 50.78s/it]Epoch 32 Valid AUC:(0.8034078030026688, 0.0)
Epoch 32 Test AUC:(0.746939052245852, 0.0)
Epoch 32 a 0.2969953864213207 b 0.3342194221389126 c 0.2550678183315266
  3%|▎         | 33/1000 [27:48<13:38:49, 50.81s/it]Epoch 33 Valid AUC:(0.8038882435248914, 0.0)
Epoch 33 Test AUC:(0.7473454474795973, 0.0)
Epoch 33 a 0.29468496380677406 b 0.3303959396643418 c 0.25056300556635713
  3%|▎         | 34/1000 [28:39<13:37:18, 50.76s/it]Epoch 34 Valid AUC:(0.8017519493983317, 0.0)
Epoch 34 Test AUC:(0.7488356630973807, 0.0)
Epoch 34 a 0.29337463880208897 b 0.32623965273680583 c 0.24730597640307136
  4%|▎         | 35/1000 [29:29<13:34:11, 50.62s/it]Epoch 35 Valid AUC:(0.8050314643058367, 0.0)
Epoch 35 Test AUC:(0.752990417639649, 0.0)
Epoch 35 a 0.2911035911418063 b 0.32110709509619284 c 0.24171753962275008
  4%|▎         | 36/1000 [30:20<13:34:25, 50.69s/it]Epoch 36 Valid AUC:(0.8042638524116572, 0.0)
Epoch 36 Test AUC:(0.7518348251201824, 0.0)
Epoch 36 a 0.2901203715705296 b 0.31833494369172954 c 0.23804083928255967
  4%|▎         | 37/1000 [31:11<13:33:39, 50.70s/it]  4%|▎         | 37/1000 [32:01<13:53:30, 51.93s/it]
[32m[I 2021-05-14 12:45:19,376][0m Trial 73 finished with value: 0.8057138439459752 and parameters: {'rank': 45.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.13817287998521333, 'gamma': 0.002321948594269754}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 12:45:20.033413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7784192606885206, 0.0)
Epoch 0 Test AUC:(0.7201063722304916, 0.0)
Epoch 0 a 0.412697111217069 b 0.5032154712038981 c 0.41440142460272344
  0%|          | 1/1000 [00:47<13:16:50, 47.86s/it]Epoch 1 Valid AUC:(0.7789868725129816, 0.0)
Epoch 1 Test AUC:(0.7221517818923686, 0.0)
Epoch 1 a 0.38624095431036154 b 0.48695309840937256 c 0.387528504164406
  0%|          | 2/1000 [01:37<13:36:57, 49.12s/it]Epoch 2 Valid AUC:(0.7766285182792805, 0.0)
Epoch 2 Test AUC:(0.7242867709776982, 0.0)
Epoch 2 a 0.3817322894001391 b 0.4917776506071839 c 0.3832619459456361
  0%|          | 3/1000 [02:28<13:46:54, 49.76s/it]Epoch 3 Valid AUC:(0.7815801501894203, 0.0)
Epoch 3 Test AUC:(0.7252617424431759, 0.0)
Epoch 3 a 0.3776827831743229 b 0.49727600099335256 c 0.37991376476028793
  0%|          | 4/1000 [03:18<13:46:35, 49.79s/it]Epoch 4 Valid AUC:(0.7832456298287939, 0.0)
Epoch 4 Test AUC:(0.7276446226592699, 0.0)
Epoch 4 a 0.37461926129982026 b 0.501440906968395 c 0.3770501557250378
  0%|          | 5/1000 [04:07<13:45:18, 49.77s/it]Epoch 5 Valid AUC:(0.7802604760225169, 0.0)
Epoch 5 Test AUC:(0.7248721454890575, 0.0)
Epoch 5 a 0.37148249059375865 b 0.49956049195957375 c 0.3735886179585332
  1%|          | 6/1000 [04:58<13:46:20, 49.88s/it]Epoch 6 Valid AUC:(0.7866977277154124, 0.0)
Epoch 6 Test AUC:(0.7255273425264003, 0.0)
Epoch 6 a 0.36790127203737943 b 0.49962601707255094 c 0.3695420071752498
  1%|          | 7/1000 [05:47<13:44:23, 49.81s/it]Epoch 7 Valid AUC:(0.7892646084482153, 0.0)
Epoch 7 Test AUC:(0.7249283549525996, 0.0)
Epoch 7 a 0.3646841371802977 b 0.4996470016852711 c 0.36598531964799047
  1%|          | 8/1000 [06:37<13:42:57, 49.78s/it]Epoch 8 Valid AUC:(0.792222306716137, 0.0)
Epoch 8 Test AUC:(0.7263265370332868, 0.0)
Epoch 8 a 0.36216318697276967 b 0.49928257876718546 c 0.36277588164542524
  1%|          | 9/1000 [07:27<13:45:22, 49.97s/it]Epoch 9 Valid AUC:(0.7904646088665269, 0.0)
Epoch 9 Test AUC:(0.724349940888996, 0.0)
Epoch 9 a 0.3602940457567603 b 0.4967377209807306 c 0.36024205779405666
  1%|          | 10/1000 [08:18<13:47:10, 50.13s/it]Epoch 10 Valid AUC:(0.7929812140396911, 0.0)
Epoch 10 Test AUC:(0.7251159450052629, 0.0)
Epoch 10 a 0.3572200229110372 b 0.4962678643419469 c 0.35635980699863473
  1%|          | 11/1000 [09:08<13:44:52, 50.04s/it]Epoch 11 Valid AUC:(0.7936073894771235, 0.0)
Epoch 11 Test AUC:(0.7256792709729631, 0.0)
Epoch 11 a 0.35568241748051865 b 0.4949386011306909 c 0.35376268685223833
  1%|          | 12/1000 [09:57<13:42:48, 49.97s/it]Epoch 12 Valid AUC:(0.7945958695981911, 0.0)
Epoch 12 Test AUC:(0.7245974643302598, 0.0)
Epoch 12 a 0.3539225889043789 b 0.493122058135403 c 0.3502046321959083
  1%|▏         | 13/1000 [10:47<13:41:15, 49.92s/it]Epoch 13 Valid AUC:(0.794868412882822, 0.0)
Epoch 13 Test AUC:(0.7235353376267581, 0.0)
Epoch 13 a 0.3517056536866386 b 0.48616624664013053 c 0.34435947728109073
  1%|▏         | 14/1000 [11:37<13:39:57, 49.90s/it]Epoch 14 Valid AUC:(0.7948866909432254, 0.0)
Epoch 14 Test AUC:(0.72373934544317, 0.0)
Epoch 14 a 0.3495871780264066 b 0.4786326006144825 c 0.3375429404933208
  2%|▏         | 15/1000 [12:27<13:41:08, 50.02s/it]Epoch 15 Valid AUC:(0.7930951885501247, 0.0)
Epoch 15 Test AUC:(0.7238060084047235, 0.0)
Epoch 15 a 0.3478131973647496 b 0.4676239405959185 c 0.330199962890364
  2%|▏         | 16/1000 [13:17<13:39:55, 50.00s/it]Epoch 16 Valid AUC:(0.7918783236670222, 0.0)
Epoch 16 Test AUC:(0.7241116780925965, 0.0)
Epoch 16 a 0.34595447275000557 b 0.45420133276004904 c 0.3228789847981282
  2%|▏         | 17/1000 [14:07<13:37:25, 49.89s/it]Epoch 17 Valid AUC:(0.793706537253522, 0.0)
Epoch 17 Test AUC:(0.7273938413180122, 0.0)
Epoch 17 a 0.34332898427063313 b 0.44286953023741665 c 0.3162564694041937
  2%|▏         | 18/1000 [14:57<13:37:09, 49.93s/it]Epoch 18 Valid AUC:(0.7975398048531641, 0.0)
Epoch 18 Test AUC:(0.7311052350053453, 0.0)
Epoch 18 a 0.3385600769663721 b 0.43477084669069027 c 0.31093401478329896
  2%|▏         | 19/1000 [15:47<13:36:30, 49.94s/it]Epoch 19 Valid AUC:(0.7973328137008834, 0.0)
Epoch 19 Test AUC:(0.7332520115319912, 0.0)
Epoch 19 a 0.33364110753329945 b 0.42736379121630724 c 0.3061940667015206
  2%|▏         | 20/1000 [16:37<13:35:14, 49.91s/it]Epoch 20 Valid AUC:(0.7982453889920872, 0.0)
Epoch 20 Test AUC:(0.7368712947239605, 0.0)
Epoch 20 a 0.32949387127724694 b 0.42159776164732227 c 0.3020119187637594
  2%|▏         | 21/1000 [17:27<13:36:16, 50.03s/it]Epoch 21 Valid AUC:(0.8009460012525149, 0.0)
Epoch 21 Test AUC:(0.7395252219584392, 0.0)
Epoch 21 a 0.32532193075483234 b 0.4146106454807988 c 0.29652210656306155
  2%|▏         | 22/1000 [18:17<13:35:15, 50.02s/it]Epoch 22 Valid AUC:(0.7999846844669019, 0.0)
Epoch 22 Test AUC:(0.7405167608287412, 0.0)
Epoch 22 a 0.32166869761478495 b 0.40586437917571194 c 0.29152158010653567
  2%|▏         | 23/1000 [19:07<13:33:09, 49.94s/it]Epoch 23 Valid AUC:(0.8012287331909256, 0.0)
Epoch 23 Test AUC:(0.7415757707224063, 0.0)
Epoch 23 a 0.31937897361260303 b 0.39702588883444095 c 0.2867463764170526
  2%|▏         | 24/1000 [19:57<13:35:22, 50.13s/it]Epoch 24 Valid AUC:(0.7996530521167148, 0.0)
Epoch 24 Test AUC:(0.7418952629702268, 0.0)
Epoch 24 a 0.31709201493013794 b 0.39073687378069766 c 0.28206085628067223
  2%|▎         | 25/1000 [20:47<13:32:24, 49.99s/it]Epoch 25 Valid AUC:(0.8029894953262198, 0.0)
Epoch 25 Test AUC:(0.7452848214580378, 0.0)
Epoch 25 a 0.31467074911359333 b 0.38075012472313896 c 0.277978639427565
  3%|▎         | 26/1000 [21:37<13:30:53, 49.95s/it]Epoch 26 Valid AUC:(0.8011621903882142, 0.0)
Epoch 26 Test AUC:(0.7458014252064039, 0.0)
Epoch 26 a 0.3132945802849783 b 0.37152109413559525 c 0.2734567921466271
  3%|▎         | 27/1000 [22:27<13:29:56, 49.95s/it]Epoch 27 Valid AUC:(0.8027147528302824, 0.0)
Epoch 27 Test AUC:(0.7447147872946809, 0.0)
Epoch 27 a 0.3115097277121285 b 0.3653126913656891 c 0.2690844616779619
  3%|▎         | 28/1000 [23:17<13:29:59, 50.00s/it]Epoch 28 Valid AUC:(0.8009807631449833, 0.0)
Epoch 28 Test AUC:(0.7456277902529267, 0.0)
Epoch 28 a 0.3103268526689387 b 0.3567755702635652 c 0.26605789252450046
  3%|▎         | 29/1000 [24:07<13:28:12, 49.94s/it]Epoch 29 Valid AUC:(0.8020731982928051, 0.0)
Epoch 29 Test AUC:(0.7475298822432902, 0.0)
Epoch 29 a 0.3092230658535986 b 0.34880741639156454 c 0.2613140078377676
  3%|▎         | 30/1000 [24:57<13:27:50, 49.97s/it]Epoch 30 Valid AUC:(0.8030853263433751, 0.0)
Epoch 30 Test AUC:(0.7470417060238729, 0.0)
Epoch 30 a 0.3076175742705823 b 0.34216421980493267 c 0.257230180489945
  3%|▎         | 31/1000 [25:47<13:27:05, 49.97s/it]Epoch 31 Valid AUC:(0.8044750459030252, 0.0)
Epoch 31 Test AUC:(0.7486751324266872, 0.0)
Epoch 31 a 0.30606338915450715 b 0.3355031691686488 c 0.25277404735985415
  3%|▎         | 32/1000 [26:37<13:26:07, 49.97s/it]Epoch 32 Valid AUC:(0.8013332136702647, 0.0)
Epoch 32 Test AUC:(0.7470260065372885, 0.0)
Epoch 32 a 0.30470313398650956 b 0.329276527737228 c 0.2491373452442273
  3%|▎         | 33/1000 [27:27<13:26:48, 50.06s/it]Epoch 33 Valid AUC:(0.8017707272794866, 0.0)
Epoch 33 Test AUC:(0.749233259435867, 0.0)
Epoch 33 a 0.3030497705792517 b 0.32349503508036287 c 0.2452689675797879
  3%|▎         | 34/1000 [28:17<13:23:41, 49.92s/it]Epoch 34 Valid AUC:(0.8000938747956297, 0.0)
Epoch 34 Test AUC:(0.7482366755235799, 0.0)
Epoch 34 a 0.30146893972842026 b 0.31856638636867285 c 0.24182587685119697
  4%|▎         | 35/1000 [29:07<13:23:16, 49.94s/it]Epoch 35 Valid AUC:(0.8033769884125453, 0.0)
Epoch 35 Test AUC:(0.7542480397200773, 0.0)
Epoch 35 a 0.2989232828259708 b 0.3120843008970111 c 0.23723559396367677
  4%|▎         | 36/1000 [29:57<13:23:10, 49.99s/it]Epoch 36 Valid AUC:(0.8010102256558945, 0.0)
Epoch 36 Test AUC:(0.7527340354466958, 0.0)
Epoch 36 a 0.29667131251972206 b 0.3083817151410719 c 0.23374976028858777
  4%|▎         | 37/1000 [30:47<13:23:09, 50.04s/it]  4%|▎         | 37/1000 [31:37<13:42:57, 51.28s/it]
[32m[I 2021-05-14 13:17:16,018][0m Trial 74 finished with value: 0.8044750459030252 and parameters: {'rank': 65.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12348151861629743, 'gamma': 0.0020906176070894546}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 13:17:16.759343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.753913080002509, 0.0)
Epoch 0 Test AUC:(0.7104671867497838, 0.0)
Epoch 0 a 0.4622386006762084 b 0.4947725891827098 c 0.4473488699622317
  0%|          | 1/1000 [00:47<13:09:22, 47.41s/it]Epoch 1 Valid AUC:(0.7769816147267637, 0.0)
Epoch 1 Test AUC:(0.7247525224130372, 0.0)
Epoch 1 a 0.3854240133488922 b 0.4775986143760758 c 0.3800774497285455
  0%|          | 2/1000 [01:36<13:28:36, 48.61s/it]Epoch 2 Valid AUC:(0.7776656976022323, 0.0)
Epoch 2 Test AUC:(0.7272414810500591, 0.0)
Epoch 2 a 0.3791612091678489 b 0.48963305384100564 c 0.3760793046572319
  0%|          | 3/1000 [02:26<13:32:43, 48.91s/it]Epoch 3 Valid AUC:(0.7807822824790855, 0.0)
Epoch 3 Test AUC:(0.7271627313650376, 0.0)
Epoch 3 a 0.3772703097379903 b 0.4933265964509975 c 0.3743805232302284
  0%|          | 4/1000 [03:15<13:34:35, 49.07s/it]Epoch 4 Valid AUC:(0.7816573122607128, 0.0)
Epoch 4 Test AUC:(0.7292983061882925, 0.0)
Epoch 4 a 0.37589664640321097 b 0.4952455504199629 c 0.37326447608725166
  0%|          | 5/1000 [04:04<13:33:02, 49.03s/it]Epoch 5 Valid AUC:(0.7830922566272285, 0.0)
Epoch 5 Test AUC:(0.7274608976218223, 0.0)
Epoch 5 a 0.37440278910295344 b 0.49619489476474476 c 0.37179815205529904
  1%|          | 6/1000 [04:53<13:33:16, 49.09s/it]Epoch 6 Valid AUC:(0.7828655315264066, 0.0)
Epoch 6 Test AUC:(0.7282632516931385, 0.0)
Epoch 6 a 0.3728917360425715 b 0.4977015085983085 c 0.3704949156259387
  1%|          | 7/1000 [05:43<13:34:17, 49.20s/it]Epoch 7 Valid AUC:(0.7840684603816851, 0.0)
Epoch 7 Test AUC:(0.7279759793066743, 0.0)
Epoch 7 a 0.37197543365854613 b 0.49773114835712273 c 0.3696032922032853
  1%|          | 8/1000 [06:32<13:33:16, 49.19s/it]Epoch 8 Valid AUC:(0.7882022484121233, 0.0)
Epoch 8 Test AUC:(0.7303568372305149, 0.0)
Epoch 8 a 0.3705372319255077 b 0.4983927006692714 c 0.3682721411918011
  1%|          | 9/1000 [07:21<13:32:53, 49.22s/it]Epoch 9 Valid AUC:(0.7856078634404814, 0.0)
Epoch 9 Test AUC:(0.730548788251674, 0.0)
Epoch 9 a 0.36989346770213644 b 0.49843405340039276 c 0.367801919729417
  1%|          | 10/1000 [08:11<13:34:37, 49.37s/it]Epoch 10 Valid AUC:(0.787644996974726, 0.0)
Epoch 10 Test AUC:(0.7297729420280767, 0.0)
Epoch 10 a 0.36842093735153764 b 0.49908225319275196 c 0.3663356888821907
  1%|          | 11/1000 [09:00<13:33:40, 49.36s/it]Epoch 11 Valid AUC:(0.78818631822766, 0.0)
Epoch 11 Test AUC:(0.7303132916774477, 0.0)
Epoch 11 a 0.36814967793238235 b 0.4997908980313921 c 0.3661794822580618
  1%|          | 12/1000 [09:49<13:33:05, 49.38s/it]Epoch 12 Valid AUC:(0.7887074403142766, 0.0)
Epoch 12 Test AUC:(0.7315475569236684, 0.0)
Epoch 12 a 0.36792536538611476 b 0.5005379102719382 c 0.36604565465953987
  1%|▏         | 13/1000 [10:39<13:32:07, 49.37s/it]Epoch 13 Valid AUC:(0.78950368809274, 0.0)
Epoch 13 Test AUC:(0.731129818896375, 0.0)
Epoch 13 a 0.36738240688859336 b 0.5007509929193578 c 0.3654215811363888
  1%|▏         | 14/1000 [11:28<13:31:32, 49.38s/it]Epoch 14 Valid AUC:(0.7904655995368881, 0.0)
Epoch 14 Test AUC:(0.7310648190884926, 0.0)
Epoch 14 a 0.36675862257389474 b 0.5005547520020598 c 0.3648862674442575
  2%|▏         | 15/1000 [12:18<13:31:20, 49.42s/it]Epoch 15 Valid AUC:(0.7886804717807561, 0.0)
Epoch 15 Test AUC:(0.730620692926341, 0.0)
Epoch 15 a 0.3664622540085368 b 0.5009537658221285 c 0.36461111513421807
  2%|▏         | 16/1000 [13:07<13:30:45, 49.44s/it]Epoch 16 Valid AUC:(0.786314561282566, 0.0)
Epoch 16 Test AUC:(0.729898974017602, 0.0)
Epoch 16 a 0.36599085970183975 b 0.5009218171328846 c 0.364231977244498
  2%|▏         | 17/1000 [13:57<13:29:52, 49.43s/it]Epoch 17 Valid AUC:(0.7885243841680326, 0.0)
Epoch 17 Test AUC:(0.7304251248666062, 0.0)
Epoch 17 a 0.3656664351582287 b 0.5014642290546141 c 0.36385794472646427
  2%|▏         | 18/1000 [14:46<13:28:29, 49.40s/it]Epoch 18 Valid AUC:(0.78989040197133, 0.0)
Epoch 18 Test AUC:(0.7291887475434867, 0.0)
Epoch 18 a 0.36547299811777695 b 0.501041778976049 c 0.36362337400495887
  2%|▏         | 19/1000 [15:35<13:26:43, 49.34s/it]Epoch 19 Valid AUC:(0.7878178721567402, 0.0)
Epoch 19 Test AUC:(0.7305742443364027, 0.0)
Epoch 19 a 0.36529577426027726 b 0.5015018789221344 c 0.3635440017855623
  2%|▏         | 20/1000 [16:24<13:25:35, 49.32s/it]  2%|▏         | 20/1000 [17:13<14:04:21, 51.70s/it]
[32m[I 2021-05-14 13:34:50,470][0m Trial 75 finished with value: 0.7904655995368881 and parameters: {'rank': 40.0, 'lambda': 0.001, 'batch_size': 512, 'learning_rate': 0.001, 'alpha': 0.1448700275538177, 'gamma': 0.0018801512584601182}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 13:34:51.213658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807149848188802, 0.0)
Epoch 0 Test AUC:(0.7200519670107783, 0.0)
Epoch 0 a 0.4133402407169342 b 0.49921103514416115 c 0.4144733497194601
  0%|          | 1/1000 [00:48<13:19:12, 48.00s/it]Epoch 1 Valid AUC:(0.779488634875825, 0.0)
Epoch 1 Test AUC:(0.7225007662585061, 0.0)
Epoch 1 a 0.38568795938606953 b 0.4838443539991705 c 0.3864186231039419
  0%|          | 2/1000 [01:37<13:35:55, 49.05s/it]Epoch 2 Valid AUC:(0.7760149998411852, 0.0)
Epoch 2 Test AUC:(0.7244741643592334, 0.0)
Epoch 2 a 0.38137293761404945 b 0.4885181701279262 c 0.3824353691197977
  0%|          | 3/1000 [02:27<13:41:15, 49.42s/it]Epoch 3 Valid AUC:(0.7823529627825984, 0.0)
Epoch 3 Test AUC:(0.7258221183439526, 0.0)
Epoch 3 a 0.3763813461576189 b 0.49198727042862106 c 0.37856765813990617
  0%|          | 4/1000 [03:17<13:42:15, 49.53s/it]Epoch 4 Valid AUC:(0.7849415447071566, 0.0)
Epoch 4 Test AUC:(0.7278701958924388, 0.0)
Epoch 4 a 0.3723206064950532 b 0.4963942120972294 c 0.37485670281847716
  0%|          | 5/1000 [04:06<13:41:34, 49.54s/it]Epoch 5 Valid AUC:(0.7835711412971631, 0.0)
Epoch 5 Test AUC:(0.7263189737457683, 0.0)
Epoch 5 a 0.3696320224815691 b 0.4982134651849927 c 0.3723193284131632
  1%|          | 6/1000 [04:57<13:44:12, 49.75s/it]Epoch 6 Valid AUC:(0.7866633028815533, 0.0)
Epoch 6 Test AUC:(0.7274028112316436, 0.0)
Epoch 6 a 0.3676528519308063 b 0.49929908043901683 c 0.37034820610848473
  1%|          | 7/1000 [05:46<13:42:33, 49.70s/it]Epoch 7 Valid AUC:(0.7890617670897635, 0.0)
Epoch 7 Test AUC:(0.7270886846852564, 0.0)
Epoch 7 a 0.3660965174496534 b 0.4961314775814233 c 0.368205066118202
  1%|          | 8/1000 [06:36<13:42:52, 49.77s/it]Epoch 8 Valid AUC:(0.7915359733656954, 0.0)
Epoch 8 Test AUC:(0.7274338467907712, 0.0)
Epoch 8 a 0.3634734599882928 b 0.49450948996323213 c 0.36502485957663783
  1%|          | 9/1000 [07:26<13:42:06, 49.77s/it]Epoch 9 Valid AUC:(0.7910362320729163, 0.0)
Epoch 9 Test AUC:(0.7285667237949264, 0.0)
Epoch 9 a 0.3610204445044519 b 0.4944905837776675 c 0.36227774146337144
  1%|          | 10/1000 [08:16<13:41:07, 49.76s/it]Epoch 10 Valid AUC:(0.7924306255973883, 0.0)
Epoch 10 Test AUC:(0.7279989941041374, 0.0)
Epoch 10 a 0.35784166475656765 b 0.4952421311281576 c 0.3584491278324089
  1%|          | 11/1000 [09:05<13:39:54, 49.74s/it]Epoch 11 Valid AUC:(0.7925449717694063, 0.0)
Epoch 11 Test AUC:(0.7265960534372387, 0.0)
Epoch 11 a 0.35638136061384407 b 0.4920278209555797 c 0.3560976318310444
  1%|          | 12/1000 [09:55<13:39:07, 49.74s/it]Epoch 12 Valid AUC:(0.7934549018554024, 0.0)
Epoch 12 Test AUC:(0.7252938083879971, 0.0)
Epoch 12 a 0.3552688842927906 b 0.4923086474599013 c 0.3532966652986269
  1%|▏         | 13/1000 [10:45<13:39:31, 49.82s/it]Epoch 13 Valid AUC:(0.7932590015974373, 0.0)
Epoch 13 Test AUC:(0.7232833548814345, 0.0)
Epoch 13 a 0.3539816905075396 b 0.4877068011213836 c 0.3491117313234379
  1%|▏         | 14/1000 [11:35<13:37:21, 49.74s/it]Epoch 14 Valid AUC:(0.7950515946250496, 0.0)
Epoch 14 Test AUC:(0.7251766180483239, 0.0)
Epoch 14 a 0.35260526377190526 b 0.4806247027347265 c 0.3440104204284353
  2%|▏         | 15/1000 [12:25<13:39:47, 49.94s/it]Epoch 15 Valid AUC:(0.7938439802706242, 0.0)
Epoch 15 Test AUC:(0.7223646057058767, 0.0)
Epoch 15 a 0.3513612143350559 b 0.4734352375539975 c 0.33893186117801627
  2%|▏         | 16/1000 [13:15<13:38:01, 49.88s/it]Epoch 16 Valid AUC:(0.7922987498145024, 0.0)
Epoch 16 Test AUC:(0.7232799900949579, 0.0)
Epoch 16 a 0.3500727403091953 b 0.46558559306670483 c 0.3344513958008956
  2%|▏         | 17/1000 [14:04<13:35:58, 49.81s/it]Epoch 17 Valid AUC:(0.7935870070431972, 0.0)
Epoch 17 Test AUC:(0.7254106609663848, 0.0)
Epoch 17 a 0.348850203172062 b 0.4590019915905037 c 0.33015446092041445
  2%|▏         | 18/1000 [14:55<13:39:51, 50.09s/it]Epoch 18 Valid AUC:(0.7959348355645093, 0.0)
Epoch 18 Test AUC:(0.724658470859147, 0.0)
Epoch 18 a 0.3467675342526234 b 0.45040938911783385 c 0.3248347141733112
  2%|▏         | 19/1000 [15:45<13:37:35, 50.01s/it]Epoch 19 Valid AUC:(0.7950413329205446, 0.0)
Epoch 19 Test AUC:(0.7253787361117209, 0.0)
Epoch 19 a 0.3446360836686263 b 0.4407598134017806 c 0.31922459272551584
  2%|▏         | 20/1000 [16:35<13:34:35, 49.87s/it]Epoch 20 Valid AUC:(0.7961937619376419, 0.0)
Epoch 20 Test AUC:(0.7291552877989307, 0.0)
Epoch 20 a 0.34121931972398123 b 0.43596373861224597 c 0.3142871516091483
  2%|▏         | 21/1000 [17:24<13:33:58, 49.89s/it]Epoch 21 Valid AUC:(0.800218477545786, 0.0)
Epoch 21 Test AUC:(0.7346114365740378, 0.0)
Epoch 21 a 0.33672889473452655 b 0.4301103268350874 c 0.3082838011699423
  2%|▏         | 22/1000 [18:14<13:31:23, 49.78s/it]Epoch 22 Valid AUC:(0.7989162099569502, 0.0)
Epoch 22 Test AUC:(0.7363882490557145, 0.0)
Epoch 22 a 0.3323590037688403 b 0.42404009182928076 c 0.3031775593997487
  2%|▏         | 23/1000 [19:04<13:31:38, 49.85s/it]Epoch 23 Valid AUC:(0.7996394864688834, 0.0)
Epoch 23 Test AUC:(0.7354397170306068, 0.0)
Epoch 23 a 0.3284074968735217 b 0.4199050278131151 c 0.29791911411093513
  2%|▏         | 24/1000 [19:54<13:32:04, 49.92s/it]Epoch 24 Valid AUC:(0.7986551843366614, 0.0)
Epoch 24 Test AUC:(0.7381565362715281, 0.0)
Epoch 24 a 0.3246127894107005 b 0.41396070959822273 c 0.2929130704769906
  2%|▎         | 25/1000 [20:44<13:29:27, 49.81s/it]Epoch 25 Valid AUC:(0.8012357768187462, 0.0)
Epoch 25 Test AUC:(0.7407922201211332, 0.0)
Epoch 25 a 0.3214289168836605 b 0.4069646806784079 c 0.28828245761169036
  3%|▎         | 26/1000 [21:34<13:29:39, 49.88s/it]Epoch 26 Valid AUC:(0.7997070019996726, 0.0)
Epoch 26 Test AUC:(0.7418172785924216, 0.0)
Epoch 26 a 0.31910241705550996 b 0.3998102888135123 c 0.2834214364558878
  3%|▎         | 27/1000 [22:24<13:29:16, 49.90s/it]Epoch 27 Valid AUC:(0.8013172206878095, 0.0)
Epoch 27 Test AUC:(0.741666637059111, 0.0)
Epoch 27 a 0.31690976917144037 b 0.39185937765378587 c 0.27775947653671623
  3%|▎         | 28/1000 [23:14<13:29:23, 49.96s/it]Epoch 28 Valid AUC:(0.7998265860368475, 0.0)
Epoch 28 Test AUC:(0.7429043269482384, 0.0)
Epoch 28 a 0.3155154978005699 b 0.38235557750916815 c 0.27352927199431826
  3%|▎         | 29/1000 [24:03<13:27:44, 49.91s/it]Epoch 29 Valid AUC:(0.8014051494107252, 0.0)
Epoch 29 Test AUC:(0.7451384511085772, 0.0)
Epoch 29 a 0.3141831318497418 b 0.3732747597473728 c 0.2675122045115446
  3%|▎         | 30/1000 [24:53<13:26:15, 49.87s/it]Epoch 30 Valid AUC:(0.8020220961065389, 0.0)
Epoch 30 Test AUC:(0.7433925288204116, 0.0)
Epoch 30 a 0.31277902583241224 b 0.3637200031481998 c 0.26196044278696506
  3%|▎         | 31/1000 [25:43<13:26:45, 49.95s/it]Epoch 31 Valid AUC:(0.8039229016084345, 0.0)
Epoch 31 Test AUC:(0.7454286650110463, 0.0)
Epoch 31 a 0.31128971725402466 b 0.35575820100859135 c 0.25662403941993983
  3%|▎         | 32/1000 [26:33<13:26:19, 49.98s/it]Epoch 32 Valid AUC:(0.8021629994211512, 0.0)
Epoch 32 Test AUC:(0.7432058921951743, 0.0)
Epoch 32 a 0.3104822945666745 b 0.3479815756291211 c 0.25175791987830726
  3%|▎         | 33/1000 [27:23<13:24:18, 49.90s/it]Epoch 33 Valid AUC:(0.8027685066297148, 0.0)
Epoch 33 Test AUC:(0.7454649380078281, 0.0)
Epoch 33 a 0.309422105970517 b 0.339594090068844 c 0.24713414406752443
  3%|▎         | 34/1000 [28:13<13:24:14, 49.95s/it]Epoch 34 Valid AUC:(0.8007819818689433, 0.0)
Epoch 34 Test AUC:(0.7454108021420512, 0.0)
Epoch 34 a 0.3090091615135761 b 0.33353717604153593 c 0.24280458751698614
  4%|▎         | 35/1000 [29:03<13:23:07, 49.93s/it]Epoch 35 Valid AUC:(0.8040242370618144, 0.0)
Epoch 35 Test AUC:(0.7514165612113939, 0.0)
Epoch 35 a 0.3073435840112583 b 0.3257924613338601 c 0.23756529573703436
  4%|▎         | 36/1000 [29:53<13:20:59, 49.85s/it]Epoch 36 Valid AUC:(0.8021253129364909, 0.0)
Epoch 36 Test AUC:(0.7508152135840543, 0.0)
Epoch 36 a 0.30598870747286067 b 0.3198094838701743 c 0.23429321766019587
  4%|▎         | 37/1000 [30:43<13:20:56, 49.90s/it]Epoch 37 Valid AUC:(0.803361400413058, 0.0)
Epoch 37 Test AUC:(0.7502187912858392, 0.0)
Epoch 37 a 0.3050880902250048 b 0.3162014895761517 c 0.2319182718483735
  4%|▍         | 38/1000 [31:33<13:19:34, 49.87s/it]Epoch 38 Valid AUC:(0.8045106023823292, 0.0)
Epoch 38 Test AUC:(0.7522317416606386, 0.0)
Epoch 38 a 0.3035479780413975 b 0.311130906014855 c 0.2279251881048713
  4%|▍         | 39/1000 [32:22<13:17:13, 49.77s/it]Epoch 39 Valid AUC:(0.8025338753898781, 0.0)
Epoch 39 Test AUC:(0.749739456716274, 0.0)
Epoch 39 a 0.30095369199392064 b 0.3071663496599831 c 0.22486910187982218
  4%|▍         | 40/1000 [33:12<13:17:34, 49.85s/it]Epoch 40 Valid AUC:(0.8041988488005419, 0.0)
Epoch 40 Test AUC:(0.7527795092319116, 0.0)
Epoch 40 a 0.29893261053312714 b 0.3053795689308427 c 0.22212817980130195
  4%|▍         | 41/1000 [34:02<13:16:07, 49.81s/it]Epoch 41 Valid AUC:(0.8005513517583017, 0.0)
Epoch 41 Test AUC:(0.7488925951135459, 0.0)
Epoch 41 a 0.29738615630138326 b 0.2991438421385149 c 0.21882363878025615
  4%|▍         | 42/1000 [34:52<13:16:22, 49.88s/it]Epoch 42 Valid AUC:(0.8023979241454803, 0.0)
Epoch 42 Test AUC:(0.7521711498513044, 0.0)
Epoch 42 a 0.29529143018381937 b 0.2955640826666619 c 0.21532568461458448
  4%|▍         | 43/1000 [35:42<13:17:07, 49.98s/it]Epoch 43 Valid AUC:(0.8021765368739658, 0.0)
Epoch 43 Test AUC:(0.7529347725367359, 0.0)
Epoch 43 a 0.2942721547495191 b 0.2897020630853277 c 0.2119182141973699
  4%|▍         | 44/1000 [36:32<13:14:46, 49.88s/it]  4%|▍         | 44/1000 [37:22<13:31:58, 50.96s/it]
[32m[I 2021-05-14 14:12:32,463][0m Trial 76 finished with value: 0.8045106023823292 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1344982458094159, 'gamma': 0.0016665284896439678}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 14:12:33.199338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7706184313428683, 0.0)
Epoch 0 Test AUC:(0.7168099760010346, 0.0)
Epoch 0 a 0.40886000258770344 b 0.5026872486190739 c 0.4113540076592149
  0%|          | 1/1000 [02:44<45:30:51, 164.02s/it]Epoch 1 Valid AUC:(0.7909625008225255, 0.0)
Epoch 1 Test AUC:(0.7243105852860521, 0.0)
Epoch 1 a 0.3844244746690782 b 0.49300316403174654 c 0.387822109185133
  0%|          | 2/1000 [05:36<46:46:10, 168.71s/it]Epoch 2 Valid AUC:(0.7822478568865242, 0.0)
Epoch 2 Test AUC:(0.7212205526510864, 0.0)
Epoch 2 a 0.37433758584802146 b 0.4974353216052835 c 0.37770807982809645
  0%|          | 3/1000 [08:28<47:11:28, 170.40s/it]Epoch 3 Valid AUC:(0.7890261708811176, 0.0)
Epoch 3 Test AUC:(0.7253653881277566, 0.0)
Epoch 3 a 0.36583210389298854 b 0.5029546060473431 c 0.3689835539350802
  0%|          | 4/1000 [11:21<47:23:36, 171.30s/it]Epoch 4 Valid AUC:(0.7921734998605525, 0.0)
Epoch 4 Test AUC:(0.7250000672315976, 0.0)
Epoch 4 a 0.3607437571369265 b 0.5072425547078844 c 0.36390439940493813
  0%|          | 5/1000 [14:13<47:29:45, 171.84s/it]Epoch 5 Valid AUC:(0.789122080075365, 0.0)
Epoch 5 Test AUC:(0.7229545207550226, 0.0)
Epoch 5 a 0.35693440289279216 b 0.5191393837430118 c 0.3594249250632306
  1%|          | 6/1000 [17:06<47:28:55, 171.97s/it]Epoch 6 Valid AUC:(0.7930608777779242, 0.0)
Epoch 6 Test AUC:(0.7234233718983611, 0.0)
Epoch 6 a 0.35374153172808 b 0.5581218540488685 c 0.35628581456858766
  1%|          | 7/1000 [19:59<47:32:12, 172.34s/it]Epoch 7 Valid AUC:(0.7968031472426002, 0.0)
Epoch 7 Test AUC:(0.7220736435980284, 0.0)
Epoch 7 a 0.3514140072691195 b 0.6236927484734806 c 0.35397799119780327
  1%|          | 8/1000 [22:51<47:30:50, 172.43s/it]Epoch 8 Valid AUC:(0.7967289725614914, 0.0)
Epoch 8 Test AUC:(0.7250807665260643, 0.0)
Epoch 8 a 0.347922064727308 b 0.7391682120949374 c 0.350800848946672
  1%|          | 9/1000 [25:44<47:30:15, 172.57s/it]Epoch 9 Valid AUC:(0.7905459822480484, 0.0)
Epoch 9 Test AUC:(0.723391224719813, 0.0)
Epoch 9 a 0.3443887906945968 b 0.9374979875566014 c 0.3481581348189761
  1%|          | 10/1000 [28:37<47:29:34, 172.70s/it]Epoch 10 Valid AUC:(0.79520207142944, 0.0)
Epoch 10 Test AUC:(0.7241954941968999, 0.0)
Epoch 10 a 0.34009461241220335 b 1.2131386748685975 c 0.34468727300010055
  1%|          | 11/1000 [31:29<47:23:50, 172.53s/it]Epoch 11 Valid AUC:(0.7949612757336687, 0.0)
Epoch 11 Test AUC:(0.7241671821053524, 0.0)
Epoch 11 a 0.3375660041548488 b 1.5642602980106903 c 0.3423509257201755
  1%|          | 12/1000 [34:22<47:23:26, 172.68s/it]Epoch 12 Valid AUC:(0.7933098987290363, 0.0)
Epoch 12 Test AUC:(0.7233431258025812, 0.0)
Epoch 12 a 0.33499190678034313 b 2.010404649423318 c 0.3400684268541106
  1%|▏         | 13/1000 [37:15<47:18:35, 172.56s/it]  1%|▏         | 13/1000 [40:07<50:46:40, 185.21s/it]
[32m[I 2021-05-14 14:52:59,913][0m Trial 77 finished with value: 0.7968031472426002 and parameters: {'rank': 60.0, 'lambda': 0.0001, 'batch_size': 128, 'learning_rate': 0.005, 'alpha': 0.12649769468139427, 'gamma': 0.002654436797657352}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 14:53:00.643693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7797772723886529, 0.0)
Epoch 0 Test AUC:(0.7201486607985218, 0.0)
Epoch 0 a 0.4135336339833511 b 0.5015190461991539 c 0.4144697141959154
  0%|          | 1/1000 [00:47<13:09:32, 47.42s/it]Epoch 1 Valid AUC:(0.7805649347845162, 0.0)
Epoch 1 Test AUC:(0.7220779874646868, 0.0)
Epoch 1 a 0.3853487784953664 b 0.48759997346751405 c 0.38616772424766954
  0%|          | 2/1000 [01:36<13:29:34, 48.67s/it]Epoch 2 Valid AUC:(0.775137379962792, 0.0)
Epoch 2 Test AUC:(0.7240751528437155, 0.0)
Epoch 2 a 0.3817440328343773 b 0.49260558592721493 c 0.3826674998885909
  0%|          | 3/1000 [02:27<13:39:27, 49.31s/it]Epoch 3 Valid AUC:(0.7818228810886139, 0.0)
Epoch 3 Test AUC:(0.7254020715686321, 0.0)
Epoch 3 a 0.37774199661114805 b 0.4964674365232648 c 0.37934792887277047
  0%|          | 4/1000 [03:16<13:41:23, 49.48s/it]Epoch 4 Valid AUC:(0.7833137515524432, 0.0)
Epoch 4 Test AUC:(0.7283088195384592, 0.0)
Epoch 4 a 0.37451143074083615 b 0.501517226698413 c 0.3763311243273123
  0%|          | 5/1000 [04:06<13:41:40, 49.55s/it]Epoch 5 Valid AUC:(0.7793853437135561, 0.0)
Epoch 5 Test AUC:(0.725154047898629, 0.0)
Epoch 5 a 0.37223065313199155 b 0.5044305177641587 c 0.37429357402521357
  1%|          | 6/1000 [04:56<13:42:00, 49.62s/it]Epoch 6 Valid AUC:(0.7864198555726158, 0.0)
Epoch 6 Test AUC:(0.7274951996318624, 0.0)
Epoch 6 a 0.3701672480859507 b 0.5048946157787407 c 0.37199318175104784
  1%|          | 7/1000 [05:45<13:42:05, 49.67s/it]Epoch 7 Valid AUC:(0.7868119252227965, 0.0)
Epoch 7 Test AUC:(0.7261788968724113, 0.0)
Epoch 7 a 0.36758260234021084 b 0.503312770809446 c 0.36900603129590304
  1%|          | 8/1000 [06:35<13:41:12, 49.67s/it]Epoch 8 Valid AUC:(0.7913227062590046, 0.0)
Epoch 8 Test AUC:(0.7270561655417485, 0.0)
Epoch 8 a 0.36397643402308766 b 0.5040994177401905 c 0.3649751921174992
  1%|          | 9/1000 [07:25<13:39:10, 49.60s/it]Epoch 9 Valid AUC:(0.7903479301976688, 0.0)
Epoch 9 Test AUC:(0.726916122872066, 0.0)
Epoch 9 a 0.3613789067182023 b 0.5058959142063225 c 0.36222804072397335
  1%|          | 10/1000 [08:14<13:39:33, 49.67s/it]Epoch 10 Valid AUC:(0.7915498004582274, 0.0)
Epoch 10 Test AUC:(0.7271325722750684, 0.0)
Epoch 10 a 0.35783743474565044 b 0.5086082717182651 c 0.35841519510002445
  1%|          | 11/1000 [09:04<13:37:53, 49.62s/it]Epoch 11 Valid AUC:(0.7924823455108396, 0.0)
Epoch 11 Test AUC:(0.7258571728348312, 0.0)
Epoch 11 a 0.3557896518131617 b 0.5108085864746355 c 0.35645511740410113
  1%|          | 12/1000 [09:54<13:37:15, 49.63s/it]Epoch 12 Valid AUC:(0.792319811492014, 0.0)
Epoch 12 Test AUC:(0.7242366540436723, 0.0)
Epoch 12 a 0.3541005482855937 b 0.5146807034610502 c 0.35458860310990087
  1%|▏         | 13/1000 [10:43<13:35:29, 49.57s/it]Epoch 13 Valid AUC:(0.7925077748527641, 0.0)
Epoch 13 Test AUC:(0.7234747201646681, 0.0)
Epoch 13 a 0.35228241959088286 b 0.5160295764205441 c 0.3526686347826146
  1%|▏         | 14/1000 [11:32<13:33:40, 49.51s/it]Epoch 14 Valid AUC:(0.7939115457834885, 0.0)
Epoch 14 Test AUC:(0.7246666369864282, 0.0)
Epoch 14 a 0.35055689432731335 b 0.5151552190363288 c 0.35065602026954745
  2%|▏         | 15/1000 [12:22<13:33:52, 49.58s/it]Epoch 15 Valid AUC:(0.7923170817017561, 0.0)
Epoch 15 Test AUC:(0.7227167710137403, 0.0)
Epoch 15 a 0.34904327646827316 b 0.5127399654935303 c 0.3483035526645016
  2%|▏         | 16/1000 [13:12<13:34:24, 49.66s/it]Epoch 16 Valid AUC:(0.7902713038316945, 0.0)
Epoch 16 Test AUC:(0.7219261188745543, 0.0)
Epoch 16 a 0.3476447571571204 b 0.5082055365655503 c 0.34623275034624323
  2%|▏         | 17/1000 [14:01<13:32:45, 49.61s/it]Epoch 17 Valid AUC:(0.7922515167534893, 0.0)
Epoch 17 Test AUC:(0.7237733909256514, 0.0)
Epoch 17 a 0.34645999449359577 b 0.5050196793357611 c 0.3432021523025674
  2%|▏         | 18/1000 [14:51<13:32:30, 49.64s/it]Epoch 18 Valid AUC:(0.7941521825618927, 0.0)
Epoch 18 Test AUC:(0.7236245878398438, 0.0)
Epoch 18 a 0.34496480868136137 b 0.49840277433395386 c 0.3382500344718726
  2%|▏         | 19/1000 [15:41<13:33:09, 49.73s/it]Epoch 19 Valid AUC:(0.7923161038473115, 0.0)
Epoch 19 Test AUC:(0.7230609711409105, 0.0)
Epoch 19 a 0.34370281920586554 b 0.4861920208518414 c 0.33241791912247715
  2%|▏         | 20/1000 [16:31<13:32:10, 49.72s/it]Epoch 20 Valid AUC:(0.7938435547821896, 0.0)
Epoch 20 Test AUC:(0.7261648733658762, 0.0)
Epoch 20 a 0.3421009610476388 b 0.4703337653302091 c 0.32617639230050793
  2%|▏         | 21/1000 [17:21<13:31:44, 49.75s/it]Epoch 21 Valid AUC:(0.7972881156281943, 0.0)
Epoch 21 Test AUC:(0.7303523308964027, 0.0)
Epoch 21 a 0.3388600645050916 b 0.45775663672798356 c 0.31968536787109836
  2%|▏         | 22/1000 [18:10<13:30:14, 49.71s/it]Epoch 22 Valid AUC:(0.7966833094502744, 0.0)
Epoch 22 Test AUC:(0.7323612495130732, 0.0)
Epoch 22 a 0.3350945643376057 b 0.4463702341320529 c 0.3141166725508884
  2%|▏         | 23/1000 [19:00<13:30:33, 49.78s/it]Epoch 23 Valid AUC:(0.7978780104870288, 0.0)
Epoch 23 Test AUC:(0.7319655087239272, 0.0)
Epoch 23 a 0.33193514056848566 b 0.44079998393413766 c 0.3094590064925207
  2%|▏         | 24/1000 [19:50<13:29:47, 49.78s/it]Epoch 24 Valid AUC:(0.7964323468877818, 0.0)
Epoch 24 Test AUC:(0.7335296384822532, 0.0)
Epoch 24 a 0.32821511280848464 b 0.4379343104434445 c 0.30480990380468503
  2%|▎         | 25/1000 [20:40<13:30:29, 49.88s/it]Epoch 25 Valid AUC:(0.7999632575357641, 0.0)
Epoch 25 Test AUC:(0.7382101077766762, 0.0)
Epoch 25 a 0.32495039557547156 b 0.43605492598334067 c 0.3004929756134808
  3%|▎         | 26/1000 [21:30<13:30:29, 49.93s/it]Epoch 26 Valid AUC:(0.7976552455044686, 0.0)
Epoch 26 Test AUC:(0.7399771166301562, 0.0)
Epoch 26 a 0.3222922881844058 b 0.4333577220228836 c 0.2968119382258632
  3%|▎         | 27/1000 [22:20<13:28:34, 49.86s/it]Epoch 27 Valid AUC:(0.7992971156620898, 0.0)
Epoch 27 Test AUC:(0.7385985204285657, 0.0)
Epoch 27 a 0.3198617047347293 b 0.43079056604287513 c 0.29232151014824026
  3%|▎         | 28/1000 [23:09<13:26:33, 49.79s/it]Epoch 28 Valid AUC:(0.7990918405610559, 0.0)
Epoch 28 Test AUC:(0.7410425696410007, 0.0)
Epoch 28 a 0.3181419474498127 b 0.42710141222961473 c 0.2895358674063289
  3%|▎         | 29/1000 [23:59<13:24:37, 49.72s/it]Epoch 29 Valid AUC:(0.8003185301259038, 0.0)
Epoch 29 Test AUC:(0.7425655352770948, 0.0)
Epoch 29 a 0.31618145875767684 b 0.42263890368118134 c 0.28540647392661517
  3%|▎         | 30/1000 [24:49<13:25:20, 49.82s/it]Epoch 30 Valid AUC:(0.8013986068852477, 0.0)
Epoch 30 Test AUC:(0.7391844379232574, 0.0)
Epoch 30 a 0.31438226173341394 b 0.4153328924711561 c 0.2812956917273926
  3%|▎         | 31/1000 [25:39<13:25:06, 49.85s/it]Epoch 31 Valid AUC:(0.802996653015699, 0.0)
Epoch 31 Test AUC:(0.740816308058883, 0.0)
Epoch 31 a 0.31277156667690165 b 0.4089351491908912 c 0.2772389616464945
  3%|▎         | 32/1000 [26:28<13:22:28, 49.74s/it]Epoch 32 Valid AUC:(0.7999222709525525, 0.0)
Epoch 32 Test AUC:(0.7389078071550145, 0.0)
Epoch 32 a 0.31165578787475523 b 0.4007358400514668 c 0.2734684319323457
  3%|▎         | 33/1000 [27:18<13:21:26, 49.73s/it]Epoch 33 Valid AUC:(0.8018014572845599, 0.0)
Epoch 33 Test AUC:(0.7412132288747985, 0.0)
Epoch 33 a 0.30980546529624065 b 0.3943155517640488 c 0.2699440635545873
  3%|▎         | 34/1000 [28:08<13:20:42, 49.73s/it]Epoch 34 Valid AUC:(0.8002555514296278, 0.0)
Epoch 34 Test AUC:(0.7421488789410067, 0.0)
Epoch 34 a 0.30870748483678945 b 0.38811482863886737 c 0.2662538442933104
  4%|▎         | 35/1000 [28:58<13:21:00, 49.80s/it]Epoch 35 Valid AUC:(0.8029200522815582, 0.0)
Epoch 35 Test AUC:(0.7477402006376429, 0.0)
Epoch 35 a 0.3060462888577574 b 0.38092310141989405 c 0.2612771650615113
  4%|▎         | 36/1000 [29:48<13:21:07, 49.86s/it]Epoch 36 Valid AUC:(0.7994966735826822, 0.0)
Epoch 36 Test AUC:(0.7455458810034754, 0.0)
Epoch 36 a 0.3039812743663788 b 0.376022176843294 c 0.2579251918754347
  4%|▎         | 37/1000 [30:38<13:20:16, 49.86s/it]  4%|▎         | 37/1000 [31:28<13:39:06, 51.03s/it]
[32m[I 2021-05-14 15:24:47,744][0m Trial 78 finished with value: 0.802996653015699 and parameters: {'rank': 45.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12073246898017614, 'gamma': 0.002429416415207505}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 15:24:48.400610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7472704801578544, 0.0)
Epoch 0 Test AUC:(0.7006894592856112, 0.0)
Epoch 0 a 0.4211607750512705 b 0.47128410550430266 c 0.42909609222076306
  0%|          | 1/1000 [00:50<14:07:35, 50.91s/it]Epoch 1 Valid AUC:(0.755432151891046, 0.0)
Epoch 1 Test AUC:(0.7040480121425097, 0.0)
Epoch 1 a 0.4019452613484212 b 0.4168490306352466 c 0.39986896011191353
  0%|          | 2/1000 [01:41<14:06:09, 50.87s/it]Epoch 2 Valid AUC:(0.7522127961781419, 0.0)
Epoch 2 Test AUC:(0.7069664064634957, 0.0)
Epoch 2 a 0.40065194519472797 b 0.39902265690701827 c 0.39096469988285654
  0%|          | 3/1000 [02:32<14:00:43, 50.60s/it]Epoch 3 Valid AUC:(0.7562730195651065, 0.0)
Epoch 3 Test AUC:(0.7024060433719951, 0.0)
Epoch 3 a 0.40025581392483933 b 0.3879673524761584 c 0.383021015216647
  0%|          | 4/1000 [03:21<13:55:46, 50.35s/it]Epoch 4 Valid AUC:(0.7538209784171145, 0.0)
Epoch 4 Test AUC:(0.7098290445196267, 0.0)
Epoch 4 a 0.40054436660628445 b 0.3837671862761499 c 0.38069530523998635
  0%|          | 5/1000 [04:12<13:54:21, 50.31s/it]Epoch 5 Valid AUC:(0.7519355289466139, 0.0)
Epoch 5 Test AUC:(0.7010272761520322, 0.0)
Epoch 5 a 0.4001958862516722 b 0.3819442498731901 c 0.3793601647948835
  1%|          | 6/1000 [05:02<13:53:18, 50.30s/it]Epoch 6 Valid AUC:(0.7615983674511149, 0.0)
Epoch 6 Test AUC:(0.7058869769761685, 0.0)
Epoch 6 a 0.4006952048547311 b 0.37662655804718526 c 0.37497327133443514
  1%|          | 7/1000 [05:52<13:50:51, 50.20s/it]Epoch 7 Valid AUC:(0.7626457495253548, 0.0)
Epoch 7 Test AUC:(0.7124435306419753, 0.0)
Epoch 7 a 0.40049186330925773 b 0.37510180941050203 c 0.37361267814693794
  1%|          | 8/1000 [06:42<13:49:03, 50.14s/it]Epoch 8 Valid AUC:(0.7547945600350134, 0.0)
Epoch 8 Test AUC:(0.702992379861699, 0.0)
Epoch 8 a 0.39976106695006314 b 0.3738156327419358 c 0.3722069051783809
  1%|          | 9/1000 [07:33<13:50:39, 50.29s/it]Epoch 9 Valid AUC:(0.7576788923061705, 0.0)
Epoch 9 Test AUC:(0.7079846156489703, 0.0)
Epoch 9 a 0.40081955081740134 b 0.37268310809279354 c 0.37147162264021827
  1%|          | 10/1000 [08:23<13:49:00, 50.24s/it]Epoch 10 Valid AUC:(0.7608397715543367, 0.0)
Epoch 10 Test AUC:(0.7023740458345228, 0.0)
Epoch 10 a 0.3999352439548408 b 0.372145966504901 c 0.37109376421157025
  1%|          | 11/1000 [09:14<13:50:57, 50.41s/it]Epoch 11 Valid AUC:(0.7595585092529791, 0.0)
Epoch 11 Test AUC:(0.7040997879547476, 0.0)
Epoch 11 a 0.3994559235496061 b 0.3704928561475435 c 0.3697017581170234
  1%|          | 12/1000 [10:04<13:50:10, 50.42s/it]Epoch 12 Valid AUC:(0.7470932142427773, 0.0)
Epoch 12 Test AUC:(0.7047697652549233, 0.0)
Epoch 12 a 0.40059513213409026 b 0.37160664922754527 c 0.3709170039390894
  1%|▏         | 13/1000 [10:55<13:49:56, 50.45s/it]  1%|▏         | 13/1000 [11:45<14:52:29, 54.25s/it]
[32m[I 2021-05-14 15:36:52,681][0m Trial 79 finished with value: 0.7626457495253548 and parameters: {'rank': 65.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.05, 'alpha': 0.1425753843398555, 'gamma': 0.002975172359051633}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 15:36:53.339377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7614714437384436, 0.0)
Epoch 0 Test AUC:(0.7135789301671231, 0.0)
Epoch 0 a 0.4641275541403404 b 0.5154108738515458 c 0.45334895851626483
  0%|          | 1/1000 [00:47<13:11:13, 47.52s/it]Epoch 1 Valid AUC:(0.7853052283834292, 0.0)
Epoch 1 Test AUC:(0.7267346638280524, 0.0)
Epoch 1 a 0.3753844102023833 b 0.510663412826162 c 0.37377862167550285
  0%|          | 2/1000 [01:37<13:33:27, 48.91s/it]Epoch 2 Valid AUC:(0.788036054167487, 0.0)
Epoch 2 Test AUC:(0.7287022986096304, 0.0)
Epoch 2 a 0.3675702952403178 b 0.5167827735724344 c 0.36734477315150516
  0%|          | 3/1000 [02:27<13:38:45, 49.27s/it]Epoch 3 Valid AUC:(0.790297658482805, 0.0)
Epoch 3 Test AUC:(0.7285972762271521, 0.0)
Epoch 3 a 0.365633136969457 b 0.514717240748511 c 0.365715823422975
  0%|          | 4/1000 [03:16<13:40:17, 49.41s/it]Epoch 4 Valid AUC:(0.7903019953890177, 0.0)
Epoch 4 Test AUC:(0.7295904782511254, 0.0)
Epoch 4 a 0.36508063489282633 b 0.5096740488794967 c 0.3652624307983598
  0%|          | 5/1000 [04:06<13:44:10, 49.70s/it]Epoch 5 Valid AUC:(0.7901808939473051, 0.0)
Epoch 5 Test AUC:(0.7285192063401607, 0.0)
Epoch 5 a 0.3645288036982538 b 0.505175544402489 c 0.36472243772186264
  1%|          | 6/1000 [04:56<13:43:52, 49.73s/it]Epoch 6 Valid AUC:(0.7893092334701793, 0.0)
Epoch 6 Test AUC:(0.7285279026243963, 0.0)
Epoch 6 a 0.36407161634452867 b 0.5020416254848542 c 0.36432157106082924
  1%|          | 7/1000 [05:46<13:45:36, 49.89s/it]Epoch 7 Valid AUC:(0.7904140065010121, 0.0)
Epoch 7 Test AUC:(0.7279897078065171, 0.0)
Epoch 7 a 0.3641873773794539 b 0.4988978192120251 c 0.364441329024927
  1%|          | 8/1000 [06:36<13:41:57, 49.72s/it]Epoch 8 Valid AUC:(0.7911331601325416, 0.0)
Epoch 8 Test AUC:(0.7293924004967759, 0.0)
Epoch 8 a 0.36379354700476113 b 0.49662780383942834 c 0.36406472457246764
  1%|          | 9/1000 [07:26<13:41:22, 49.73s/it]Epoch 9 Valid AUC:(0.7894054348673275, 0.0)
Epoch 9 Test AUC:(0.729950668596113, 0.0)
Epoch 9 a 0.36400055297663514 b 0.4951804687439556 c 0.36432166970231883
  1%|          | 10/1000 [08:15<13:40:19, 49.72s/it]Epoch 10 Valid AUC:(0.7904305954235941, 0.0)
Epoch 10 Test AUC:(0.7283693985214154, 0.0)
Epoch 10 a 0.3631880632948348 b 0.4937096438417492 c 0.36346843484901564
  1%|          | 11/1000 [09:05<13:39:33, 49.72s/it]Epoch 11 Valid AUC:(0.7906893128972845, 0.0)
Epoch 11 Test AUC:(0.7295410795942635, 0.0)
Epoch 11 a 0.3635586755616324 b 0.4924775992840588 c 0.36381067740365536
  1%|          | 12/1000 [09:55<13:38:58, 49.74s/it]Epoch 12 Valid AUC:(0.791282186175161, 0.0)
Epoch 12 Test AUC:(0.7301405631213442, 0.0)
Epoch 12 a 0.3638487259147153 b 0.4918888310191617 c 0.3641135869491508
  1%|▏         | 13/1000 [10:44<13:38:10, 49.74s/it]Epoch 13 Valid AUC:(0.7919376754588708, 0.0)
Epoch 13 Test AUC:(0.7297869441573153, 0.0)
Epoch 13 a 0.36371498160678856 b 0.4916408153127137 c 0.36397587707344914
  1%|▏         | 14/1000 [11:34<13:37:51, 49.77s/it]Epoch 14 Valid AUC:(0.7923286993302484, 0.0)
Epoch 14 Test AUC:(0.7297337403416679, 0.0)
Epoch 14 a 0.3634432394139963 b 0.49117403670815635 c 0.36368231118564875
  2%|▏         | 15/1000 [12:24<13:36:50, 49.76s/it]Epoch 15 Valid AUC:(0.7907702300321713, 0.0)
Epoch 15 Test AUC:(0.7291322259714152, 0.0)
Epoch 15 a 0.36356135339324386 b 0.4909034137514755 c 0.36378619446600946
  2%|▏         | 16/1000 [13:14<13:35:06, 49.70s/it]Epoch 16 Valid AUC:(0.7883877216402577, 0.0)
Epoch 16 Test AUC:(0.7284242825925713, 0.0)
Epoch 16 a 0.3632749876146105 b 0.49083565466360785 c 0.36347723343002963
  2%|▏         | 17/1000 [14:03<13:35:04, 49.75s/it]Epoch 17 Valid AUC:(0.7897437135519174, 0.0)
Epoch 17 Test AUC:(0.7286621776994702, 0.0)
Epoch 17 a 0.3632503359370548 b 0.4910592631674868 c 0.36341997987067914
  2%|▏         | 18/1000 [14:53<13:34:13, 49.75s/it]Epoch 18 Valid AUC:(0.7916854953842912, 0.0)
Epoch 18 Test AUC:(0.7281726760876669, 0.0)
Epoch 18 a 0.3632080915348391 b 0.4907375689843291 c 0.36338254863347563
  2%|▏         | 19/1000 [15:43<13:34:20, 49.81s/it]Epoch 19 Valid AUC:(0.7894474300631837, 0.0)
Epoch 19 Test AUC:(0.7287992189967174, 0.0)
Epoch 19 a 0.3631365937246403 b 0.49136578503029205 c 0.36326551371417054
  2%|▏         | 20/1000 [16:33<13:31:46, 49.70s/it]  2%|▏         | 20/1000 [17:22<14:11:26, 52.13s/it]
[32m[I 2021-05-14 15:54:34,798][0m Trial 80 finished with value: 0.7923286993302484 and parameters: {'rank': 55.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.0005, 'alpha': 0.1893479890774741, 'gamma': 0.00207404206869151}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 15:54:35.455962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807386801672745, 0.0)
Epoch 0 Test AUC:(0.7200577474317648, 0.0)
Epoch 0 a 0.41333798491499074 b 0.5012123424642283 c 0.41449039352971545
  0%|          | 1/1000 [00:47<13:12:54, 47.62s/it]Epoch 1 Valid AUC:(0.7797451275063755, 0.0)
Epoch 1 Test AUC:(0.7225550218371436, 0.0)
Epoch 1 a 0.3856722304159007 b 0.4865493939915893 c 0.3864719784355739
  0%|          | 2/1000 [01:37<13:35:37, 49.04s/it]Epoch 2 Valid AUC:(0.7760128711174206, 0.0)
Epoch 2 Test AUC:(0.724448755304557, 0.0)
Epoch 2 a 0.3813584826481894 b 0.49148083518688346 c 0.3825140215861246
  0%|          | 3/1000 [02:27<13:41:55, 49.46s/it]Epoch 3 Valid AUC:(0.7824997050288611, 0.0)
Epoch 3 Test AUC:(0.7258326830039065, 0.0)
Epoch 3 a 0.37638014986721324 b 0.49500991688887597 c 0.3786164093425336
  0%|          | 4/1000 [03:18<13:47:25, 49.84s/it]Epoch 4 Valid AUC:(0.784876783316867, 0.0)
Epoch 4 Test AUC:(0.7277598591140387, 0.0)
Epoch 4 a 0.37233519913924773 b 0.49935725906965 c 0.3749344549188671
  0%|          | 5/1000 [04:07<13:42:50, 49.62s/it]Epoch 5 Valid AUC:(0.7833920337348557, 0.0)
Epoch 5 Test AUC:(0.7263351093292023, 0.0)
Epoch 5 a 0.3696481351041698 b 0.5014535327792408 c 0.3724133493434975
  1%|          | 6/1000 [04:57<13:44:21, 49.76s/it]Epoch 6 Valid AUC:(0.7866389872427905, 0.0)
Epoch 6 Test AUC:(0.7271861779838908, 0.0)
Epoch 6 a 0.3677136606613635 b 0.5035064634183043 c 0.3705227679050185
  1%|          | 7/1000 [05:47<13:44:32, 49.82s/it]Epoch 7 Valid AUC:(0.789070708754848, 0.0)
Epoch 7 Test AUC:(0.7272427337596368, 0.0)
Epoch 7 a 0.3662526028257021 b 0.5021516973943537 c 0.3685313050655772
  1%|          | 8/1000 [06:37<13:43:45, 49.82s/it]Epoch 8 Valid AUC:(0.7916100057901286, 0.0)
Epoch 8 Test AUC:(0.727593855855429, 0.0)
Epoch 8 a 0.36374449615987015 b 0.5020444356579656 c 0.365476606297541
  1%|          | 9/1000 [07:27<13:44:55, 49.95s/it]Epoch 9 Valid AUC:(0.7907201800326664, 0.0)
Epoch 9 Test AUC:(0.7284904838045195, 0.0)
Epoch 9 a 0.36124961063175853 b 0.5034122309934206 c 0.36274570832310066
  1%|          | 10/1000 [08:16<13:42:45, 49.86s/it]Epoch 10 Valid AUC:(0.7922067558828082, 0.0)
Epoch 10 Test AUC:(0.7280433306171767, 0.0)
Epoch 10 a 0.3580586314201355 b 0.506398442525499 c 0.35898969105071943
  1%|          | 11/1000 [09:06<13:40:44, 49.79s/it]Epoch 11 Valid AUC:(0.7928037571674552, 0.0)
Epoch 11 Test AUC:(0.7271092581954537, 0.0)
Epoch 11 a 0.35657352047187224 b 0.5052936644981085 c 0.35692051544755515
  1%|          | 12/1000 [09:56<13:38:10, 49.69s/it]Epoch 12 Valid AUC:(0.7935268798883879, 0.0)
Epoch 12 Test AUC:(0.7252882331890576, 0.0)
Epoch 12 a 0.35540642626808444 b 0.5067024274131422 c 0.3545010536609281
  1%|▏         | 13/1000 [10:45<13:37:48, 49.71s/it]Epoch 13 Valid AUC:(0.7934024347740071, 0.0)
Epoch 13 Test AUC:(0.7241033623242396, 0.0)
Epoch 13 a 0.35411594865067864 b 0.5035366661831646 c 0.35113707466624394
  1%|▏         | 14/1000 [11:35<13:37:31, 49.75s/it]Epoch 14 Valid AUC:(0.7946242671064242, 0.0)
Epoch 14 Test AUC:(0.7256044760878029, 0.0)
Epoch 14 a 0.35284372864354785 b 0.49816068785051465 c 0.3466695416981066
  2%|▏         | 15/1000 [12:26<13:40:19, 49.97s/it]Epoch 15 Valid AUC:(0.7932368313431308, 0.0)
Epoch 15 Test AUC:(0.7227100029616534, 0.0)
Epoch 15 a 0.3516965988176449 b 0.49249990653224157 c 0.3413348638075938
  2%|▏         | 16/1000 [13:16<13:39:15, 49.96s/it]Epoch 16 Valid AUC:(0.7924899235623869, 0.0)
Epoch 16 Test AUC:(0.723360321699924, 0.0)
Epoch 16 a 0.3505784133430458 b 0.48654263180266444 c 0.3368134551364891
  2%|▏         | 17/1000 [14:06<13:38:52, 49.98s/it]Epoch 17 Valid AUC:(0.7938030833988295, 0.0)
Epoch 17 Test AUC:(0.7263853374251702, 0.0)
Epoch 17 a 0.34951646125292635 b 0.48147896669760076 c 0.3327012647925248
  2%|▏         | 18/1000 [14:56<13:38:10, 49.99s/it]2021-05-14 16:10:30.686037: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 116572345 get requests, put_count=116572345 evicted_count=75000 eviction_rate=0.000643377 and unsatisfied allocation rate=0.000643489
Epoch 18 Valid AUC:(0.7960623885386908, 0.0)
Epoch 18 Test AUC:(0.7258559757062245, 0.0)
Epoch 18 a 0.34744612563783733 b 0.4746313659957717 c 0.3275405179926567
  2%|▏         | 19/1000 [15:46<13:37:56, 50.03s/it]Epoch 19 Valid AUC:(0.7951882340841745, 0.0)
Epoch 19 Test AUC:(0.7269702245341683, 0.0)
Epoch 19 a 0.3450046118716119 b 0.4675363770553044 c 0.3224747185136231
  2%|▏         | 20/1000 [16:36<13:36:13, 49.97s/it]Epoch 20 Valid AUC:(0.7970237040427123, 0.0)
Epoch 20 Test AUC:(0.7313833621843465, 0.0)
Epoch 20 a 0.34143349492334024 b 0.46654575385558056 c 0.3177785649745757
  2%|▏         | 21/1000 [17:25<13:34:22, 49.91s/it]Epoch 21 Valid AUC:(0.8011459205819582, 0.0)
Epoch 21 Test AUC:(0.7364620990643674, 0.0)
Epoch 21 a 0.3371348076423169 b 0.46536160216964706 c 0.31189138266881944
  2%|▏         | 22/1000 [18:15<13:33:57, 49.94s/it]Epoch 22 Valid AUC:(0.7992139518970048, 0.0)
Epoch 22 Test AUC:(0.7369912213575918, 0.0)
Epoch 22 a 0.3326605260971806 b 0.46402069620443304 c 0.3064264234462734
  2%|▏         | 23/1000 [19:05<13:30:29, 49.77s/it]Epoch 23 Valid AUC:(0.8002858521014915, 0.0)
Epoch 23 Test AUC:(0.7368102625423175, 0.0)
Epoch 23 a 0.328540330321736 b 0.4630386164970321 c 0.3013897593652219
  2%|▏         | 24/1000 [19:55<13:29:47, 49.78s/it]Epoch 24 Valid AUC:(0.7993709955771143, 0.0)
Epoch 24 Test AUC:(0.7382241184568333, 0.0)
Epoch 24 a 0.3246889959278721 b 0.46118022780303264 c 0.296092497480947
  2%|▎         | 25/1000 [20:45<13:30:22, 49.87s/it]Epoch 25 Valid AUC:(0.8014582560063639, 0.0)
Epoch 25 Test AUC:(0.7410477771504397, 0.0)
Epoch 25 a 0.3214135978303445 b 0.4567701638464477 c 0.2917712953548796
  3%|▎         | 26/1000 [21:34<13:27:27, 49.74s/it]Epoch 26 Valid AUC:(0.7993736766668889, 0.0)
Epoch 26 Test AUC:(0.7417271091555845, 0.0)
Epoch 26 a 0.31901361494956604 b 0.4529173197880597 c 0.28698926945207587
  3%|▎         | 27/1000 [22:24<13:27:26, 49.79s/it]Epoch 27 Valid AUC:(0.8011725546200529, 0.0)
Epoch 27 Test AUC:(0.7407732969382295, 0.0)
Epoch 27 a 0.31662760072310925 b 0.44715296136781246 c 0.28174564991918366
  3%|▎         | 28/1000 [23:14<13:27:57, 49.87s/it]Epoch 28 Valid AUC:(0.7992914510269066, 0.0)
Epoch 28 Test AUC:(0.7423344467014167, 0.0)
Epoch 28 a 0.3149508111313795 b 0.43980047136725076 c 0.2779999008960647
  3%|▎         | 29/1000 [24:04<13:26:56, 49.86s/it]Epoch 29 Valid AUC:(0.8011013788634529, 0.0)
Epoch 29 Test AUC:(0.7441705256000416, 0.0)
Epoch 29 a 0.3133030991918844 b 0.432103177191506 c 0.2730579872726195
  3%|▎         | 30/1000 [24:54<13:29:00, 50.04s/it]Epoch 30 Valid AUC:(0.8019800227335907, 0.0)
Epoch 30 Test AUC:(0.7421632145560715, 0.0)
Epoch 30 a 0.3117766994345836 b 0.42459697448751577 c 0.26842258666722585
  3%|▎         | 31/1000 [25:44<13:24:56, 49.84s/it]Epoch 31 Valid AUC:(0.80316730079139, 0.0)
Epoch 31 Test AUC:(0.7436941624746964, 0.0)
Epoch 31 a 0.31009101531874966 b 0.41676642435417327 c 0.2636884395745199
  3%|▎         | 32/1000 [26:33<13:22:44, 49.76s/it]Epoch 32 Valid AUC:(0.8019647717927127, 0.0)
Epoch 32 Test AUC:(0.7423997970969622, 0.0)
Epoch 32 a 0.3085874980484216 b 0.4087186313011277 c 0.25926334034629034
  3%|▎         | 33/1000 [27:23<13:21:01, 49.70s/it]Epoch 33 Valid AUC:(0.8036376564687581, 0.0)
Epoch 33 Test AUC:(0.7463857394038544, 0.0)
Epoch 33 a 0.30558316790362 b 0.4041011738225488 c 0.25681965919567545
  3%|▎         | 34/1000 [28:12<13:20:01, 49.69s/it]Epoch 34 Valid AUC:(0.8022470615819972, 0.0)
Epoch 34 Test AUC:(0.7478003520746681, 0.0)
Epoch 34 a 0.30186253672154617 b 0.39674382154610555 c 0.25286731165899357
  4%|▎         | 35/1000 [29:02<13:20:00, 49.74s/it]Epoch 35 Valid AUC:(0.8057759370624069, 0.0)
Epoch 35 Test AUC:(0.755731089668058, 0.0)
Epoch 35 a 0.2969813957000882 b 0.3887385786539112 c 0.24763307569012555
  4%|▎         | 36/1000 [29:52<13:19:07, 49.74s/it]Epoch 36 Valid AUC:(0.8048809900646298, 0.0)
Epoch 36 Test AUC:(0.7548121267195347, 0.0)
Epoch 36 a 0.2939765530392917 b 0.38304420963859176 c 0.24379989118043566
  4%|▎         | 37/1000 [30:42<13:18:27, 49.75s/it]Epoch 37 Valid AUC:(0.8055492209327269, 0.0)
Epoch 37 Test AUC:(0.755668676513058, 0.0)
Epoch 37 a 0.29215034932437794 b 0.3735830346103645 c 0.23976862229691664
  4%|▍         | 38/1000 [31:32<13:17:56, 49.77s/it]Epoch 38 Valid AUC:(0.8074621784868413, 0.0)
Epoch 38 Test AUC:(0.7579260891002556, 0.0)
Epoch 38 a 0.2908337381883886 b 0.3674597391180349 c 0.23579964785268848
  4%|▍         | 39/1000 [32:21<13:16:26, 49.73s/it]Epoch 39 Valid AUC:(0.8054753282017856, 0.0)
Epoch 39 Test AUC:(0.7569627939141522, 0.0)
Epoch 39 a 0.2887259962213351 b 0.3597516246604728 c 0.2319304362629021
  4%|▍         | 40/1000 [33:11<13:15:22, 49.71s/it]Epoch 40 Valid AUC:(0.8077118671472137, 0.0)
Epoch 40 Test AUC:(0.7593324544100613, 0.0)
Epoch 40 a 0.287658816791876 b 0.3545220666967887 c 0.22853814644113152
  4%|▍         | 41/1000 [34:00<13:13:16, 49.63s/it]Epoch 41 Valid AUC:(0.8046689148381925, 0.0)
Epoch 41 Test AUC:(0.7559637259600062, 0.0)
Epoch 41 a 0.28644320431729436 b 0.34737379072417673 c 0.2255671982853945
  4%|▍         | 42/1000 [34:50<13:14:11, 49.74s/it]Epoch 42 Valid AUC:(0.8048885450475268, 0.0)
Epoch 42 Test AUC:(0.7598875714958873, 0.0)
Epoch 42 a 0.28481330058464344 b 0.3436023454431077 c 0.22162735777001985
  4%|▍         | 43/1000 [35:41<13:15:13, 49.86s/it]Epoch 43 Valid AUC:(0.8056430360061847, 0.0)
Epoch 43 Test AUC:(0.7593775305775612, 0.0)
Epoch 43 a 0.28380037112615 b 0.3371746137108601 c 0.2191187216482412
  4%|▍         | 44/1000 [36:30<13:13:50, 49.82s/it]Epoch 44 Valid AUC:(0.805884263598349, 0.0)
Epoch 44 Test AUC:(0.7589995286690903, 0.0)
Epoch 44 a 0.2827096629130768 b 0.33381504899779074 c 0.21818919953565963
  4%|▍         | 45/1000 [37:20<13:10:46, 49.68s/it]Epoch 45 Valid AUC:(0.8028092010100255, 0.0)
Epoch 45 Test AUC:(0.757602244434858, 0.0)
Epoch 45 a 0.2813245179187844 b 0.3296800352318186 c 0.21554355035485395
  5%|▍         | 46/1000 [38:09<13:09:54, 49.68s/it]  5%|▍         | 46/1000 [38:59<13:28:39, 50.86s/it]
[32m[I 2021-05-14 16:33:53,875][0m Trial 81 finished with value: 0.8077118671472137 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12909625472692032, 'gamma': 0.0023734290215861723}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 16:33:54.631712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.780712516473323, 0.0)
Epoch 0 Test AUC:(0.7200535361043449, 0.0)
Epoch 0 a 0.41334079604753304 b 0.5004224392250031 c 0.4144871104770983
  0%|          | 1/1000 [00:47<13:08:46, 47.37s/it]Epoch 1 Valid AUC:(0.7796100708129636, 0.0)
Epoch 1 Test AUC:(0.7225231311861541, 0.0)
Epoch 1 a 0.38568168380850515 b 0.48549416991066885 c 0.3864512279839583
  0%|          | 2/1000 [01:36<13:29:58, 48.70s/it]Epoch 2 Valid AUC:(0.7759946212520339, 0.0)
Epoch 2 Test AUC:(0.724456587946012, 0.0)
Epoch 2 a 0.3813664011912087 b 0.49034421892473157 c 0.3824790880473807
  0%|          | 3/1000 [02:27<13:39:08, 49.30s/it]Epoch 3 Valid AUC:(0.78239163993762, 0.0)
Epoch 3 Test AUC:(0.7258083214367609, 0.0)
Epoch 3 a 0.376379727657652 b 0.4938509276575246 c 0.37859474869081433
  0%|          | 4/1000 [03:16<13:40:40, 49.44s/it]Epoch 4 Valid AUC:(0.7850588936484584, 0.0)
Epoch 4 Test AUC:(0.7278516532254136, 0.0)
Epoch 4 a 0.37232775473498725 b 0.4982374030459575 c 0.3748854853257807
  0%|          | 5/1000 [04:06<13:41:47, 49.56s/it]Epoch 5 Valid AUC:(0.7835756102073178, 0.0)
Epoch 5 Test AUC:(0.7263464649491282, 0.0)
Epoch 5 a 0.3696333709617016 b 0.5002815318059634 c 0.3723743256308903
  1%|          | 6/1000 [04:56<13:43:28, 49.71s/it]Epoch 6 Valid AUC:(0.7867363856465588, 0.0)
Epoch 6 Test AUC:(0.7272966601279075, 0.0)
Epoch 6 a 0.3676776519004008 b 0.5020528023751449 c 0.370434251949341
  1%|          | 7/1000 [05:45<13:41:53, 49.66s/it]Epoch 7 Valid AUC:(0.7889167716529475, 0.0)
Epoch 7 Test AUC:(0.7272110355043162, 0.0)
Epoch 7 a 0.3661609147516055 b 0.5000983206199209 c 0.36836136988470974
  1%|          | 8/1000 [06:35<13:42:34, 49.75s/it]Epoch 8 Valid AUC:(0.7915787721195289, 0.0)
Epoch 8 Test AUC:(0.7274299860510147, 0.0)
Epoch 8 a 0.3635700106980575 b 0.49961510990227254 c 0.36521456616985004
  1%|          | 9/1000 [07:25<13:43:04, 49.83s/it]Epoch 9 Valid AUC:(0.7910953711205477, 0.0)
Epoch 9 Test AUC:(0.728572491389535, 0.0)
Epoch 9 a 0.3610962861980231 b 0.5006981048905393 c 0.362490195083906
  1%|          | 10/1000 [08:15<13:41:38, 49.80s/it]Epoch 10 Valid AUC:(0.7920233690859132, 0.0)
Epoch 10 Test AUC:(0.7279209541453612, 0.0)
Epoch 10 a 0.35790144545691355 b 0.5028500336276693 c 0.3586670162092512
  1%|          | 11/1000 [09:05<13:40:58, 49.81s/it]Epoch 11 Valid AUC:(0.792645681806051, 0.0)
Epoch 11 Test AUC:(0.7266818148755277, 0.0)
Epoch 11 a 0.35646673995004574 b 0.5006947390270425 c 0.35651076313715346
  1%|          | 12/1000 [09:55<13:40:09, 49.81s/it]Epoch 12 Valid AUC:(0.7929383114769323, 0.0)
Epoch 12 Test AUC:(0.7253591716099207, 0.0)
Epoch 12 a 0.35526524031426104 b 0.501466123211072 c 0.35388213635930116
  1%|▏         | 13/1000 [10:45<13:38:56, 49.78s/it]Epoch 13 Valid AUC:(0.7932829788959992, 0.0)
Epoch 13 Test AUC:(0.7239165546806299, 0.0)
Epoch 13 a 0.35391895314097643 b 0.49760883285006285 c 0.35005462337547627
  1%|▏         | 14/1000 [11:34<13:38:13, 49.79s/it]Epoch 14 Valid AUC:(0.7947607579009153, 0.0)
Epoch 14 Test AUC:(0.7252546109770477, 0.0)
Epoch 14 a 0.3525502522826435 b 0.49194686693444817 c 0.34513484460247357
  2%|▏         | 15/1000 [12:25<13:39:18, 49.91s/it]Epoch 15 Valid AUC:(0.7935641050000468, 0.0)
Epoch 15 Test AUC:(0.7226057031317983, 0.0)
Epoch 15 a 0.35124263323288807 b 0.48646815519937325 c 0.3399467091085445
  2%|▏         | 16/1000 [13:14<13:37:51, 49.87s/it]Epoch 16 Valid AUC:(0.7922933479056116, 0.0)
Epoch 16 Test AUC:(0.7230732844637218, 0.0)
Epoch 16 a 0.3499623418933669 b 0.47915571778113214 c 0.3353999143155288
  2%|▏         | 17/1000 [14:04<13:37:43, 49.91s/it]Epoch 17 Valid AUC:(0.7934719265191521, 0.0)
Epoch 17 Test AUC:(0.7252472315342795, 0.0)
Epoch 17 a 0.3487403519316698 b 0.4738428331236964 c 0.3313163768357674
  2%|▏         | 18/1000 [14:54<13:36:41, 49.90s/it]Epoch 18 Valid AUC:(0.795683482116557, 0.0)
Epoch 18 Test AUC:(0.7243158740292179, 0.0)
Epoch 18 a 0.3465833302954553 b 0.46644082791368724 c 0.32601175563676016
  2%|▏         | 19/1000 [15:44<13:33:45, 49.77s/it]Epoch 19 Valid AUC:(0.794657257839204, 0.0)
Epoch 19 Test AUC:(0.725473574350124, 0.0)
Epoch 19 a 0.34423272440610997 b 0.4587182939892084 c 0.3207025890139267
  2%|▏         | 20/1000 [16:34<13:34:31, 49.87s/it]Epoch 20 Valid AUC:(0.7957558933275273, 0.0)
Epoch 20 Test AUC:(0.728283910712522, 0.0)
Epoch 20 a 0.34075467759214895 b 0.45791151352091813 c 0.31605779045304544
  2%|▏         | 21/1000 [17:24<13:33:40, 49.87s/it]Epoch 21 Valid AUC:(0.8000177546583653, 0.0)
Epoch 21 Test AUC:(0.7336394365527803, 0.0)
Epoch 21 a 0.33634687555387943 b 0.4563547715214896 c 0.3102378560383795
  2%|▏         | 22/1000 [18:14<13:34:54, 49.99s/it]Epoch 22 Valid AUC:(0.7986456992767086, 0.0)
Epoch 22 Test AUC:(0.7352640213057424, 0.0)
Epoch 22 a 0.3322623081850094 b 0.4540623982907301 c 0.30507289289948447
  2%|▏         | 23/1000 [19:03<13:30:52, 49.80s/it]Epoch 23 Valid AUC:(0.7996918471781699, 0.0)
Epoch 23 Test AUC:(0.7347113497826414, 0.0)
Epoch 23 a 0.3288119826278456 b 0.4518357036818921 c 0.30029416285170396
  2%|▏         | 24/1000 [19:53<13:30:36, 49.83s/it]Epoch 24 Valid AUC:(0.7989120909213215, 0.0)
Epoch 24 Test AUC:(0.7367867346897373, 0.0)
Epoch 24 a 0.32564481223373104 b 0.4483223088550376 c 0.29546934690034127
  2%|▎         | 25/1000 [20:43<13:30:14, 49.86s/it]Epoch 25 Valid AUC:(0.8021241736014959, 0.0)
Epoch 25 Test AUC:(0.7404313884572492, 0.0)
Epoch 25 a 0.32277623886313717 b 0.4444413479544987 c 0.29132429451889674
  3%|▎         | 26/1000 [21:33<13:28:50, 49.83s/it]Epoch 26 Valid AUC:(0.8000647570328778, 0.0)
Epoch 26 Test AUC:(0.7411812270618668, 0.0)
Epoch 26 a 0.3205571647141301 b 0.4403903418983252 c 0.2869740116524265
  3%|▎         | 27/1000 [22:23<13:31:54, 50.07s/it]Epoch 27 Valid AUC:(0.8020653177856236, 0.0)
Epoch 27 Test AUC:(0.7405495065715926, 0.0)
Epoch 27 a 0.31824721117134785 b 0.4345344045992109 c 0.28190882441023707
  3%|▎         | 28/1000 [23:13<13:28:35, 49.91s/it]Epoch 28 Valid AUC:(0.8007181688564898, 0.0)
Epoch 28 Test AUC:(0.7429762829284172, 0.0)
Epoch 28 a 0.3165316044444769 b 0.4264257370945913 c 0.27785923633297205
  3%|▎         | 29/1000 [24:03<13:27:32, 49.90s/it]Epoch 29 Valid AUC:(0.8026840164172508, 0.0)
Epoch 29 Test AUC:(0.7446570985222178, 0.0)
Epoch 29 a 0.3148828248382814 b 0.4183317939160575 c 0.2723392350692864
  3%|▎         | 30/1000 [24:54<13:32:36, 50.26s/it]Epoch 30 Valid AUC:(0.8037678572113307, 0.0)
Epoch 30 Test AUC:(0.7437177416327883, 0.0)
Epoch 30 a 0.3130629277325252 b 0.40924693359215736 c 0.2673338951479261
  3%|▎         | 31/1000 [25:44<13:29:11, 50.10s/it]Epoch 31 Valid AUC:(0.8057648692367412, 0.0)
Epoch 31 Test AUC:(0.7453735329632505, 0.0)
Epoch 31 a 0.31071490493098974 b 0.40047960244194125 c 0.2624810965548099
  3%|▎         | 32/1000 [26:34<13:28:19, 50.10s/it]Epoch 32 Valid AUC:(0.8044503470683529, 0.0)
Epoch 32 Test AUC:(0.7443164684035711, 0.0)
Epoch 32 a 0.30820908857663154 b 0.39322018677320036 c 0.25848419994295724
  3%|▎         | 33/1000 [27:24<13:29:15, 50.21s/it]Epoch 33 Valid AUC:(0.8053303942813699, 0.0)
Epoch 33 Test AUC:(0.7470898476956979, 0.0)
Epoch 33 a 0.30500229815362206 b 0.38414372902520943 c 0.25397460483449324
  3%|▎         | 34/1000 [28:14<13:25:01, 50.00s/it]Epoch 34 Valid AUC:(0.8027982446828351, 0.0)
Epoch 34 Test AUC:(0.7470401967867366, 0.0)
Epoch 34 a 0.3022674972142732 b 0.3751865944991889 c 0.24938915882791793
  4%|▎         | 35/1000 [29:04<13:23:27, 49.96s/it]Epoch 35 Valid AUC:(0.8060239173610826, 0.0)
Epoch 35 Test AUC:(0.7547101655659219, 0.0)
Epoch 35 a 0.29892660851329866 b 0.364739285808214 c 0.24316743007248318
  4%|▎         | 36/1000 [29:54<13:25:55, 50.16s/it]Epoch 36 Valid AUC:(0.8045336774403551, 0.0)
Epoch 36 Test AUC:(0.7538552276205582, 0.0)
Epoch 36 a 0.2964686773552501 b 0.35814600325446255 c 0.23930913695627054
  4%|▎         | 37/1000 [30:44<13:23:44, 50.08s/it]Epoch 37 Valid AUC:(0.8057267559820547, 0.0)
Epoch 37 Test AUC:(0.7542595877356723, 0.0)
Epoch 37 a 0.2948948878277715 b 0.3497462347599582 c 0.23485556013987097
  4%|▍         | 38/1000 [31:34<13:21:36, 50.00s/it]Epoch 38 Valid AUC:(0.8072830068449504, 0.0)
Epoch 38 Test AUC:(0.7578388440775861, 0.0)
Epoch 38 a 0.29346816442622026 b 0.3422322808137122 c 0.23106753628258733
  4%|▍         | 39/1000 [32:24<13:19:09, 49.90s/it]Epoch 39 Valid AUC:(0.805517975727802, 0.0)
Epoch 39 Test AUC:(0.7568640265286436, 0.0)
Epoch 39 a 0.29122902048185795 b 0.33338379775974114 c 0.2264377234027659
  4%|▍         | 40/1000 [33:14<13:18:51, 49.93s/it]Epoch 40 Valid AUC:(0.8074215738179475, 0.0)
Epoch 40 Test AUC:(0.7582950740650429, 0.0)
Epoch 40 a 0.2897107799048395 b 0.3291711907991221 c 0.22330919165966256
  4%|▍         | 41/1000 [34:03<13:16:58, 49.86s/it]Epoch 41 Valid AUC:(0.8044765210150379, 0.0)
Epoch 41 Test AUC:(0.7554855201116986, 0.0)
Epoch 41 a 0.2883215398495826 b 0.3226366356105152 c 0.21976048512837776
  4%|▍         | 42/1000 [34:54<13:18:19, 50.00s/it]Epoch 42 Valid AUC:(0.8047149483294022, 0.0)
Epoch 42 Test AUC:(0.758851020589975, 0.0)
Epoch 42 a 0.28634461604613415 b 0.3186751944078526 c 0.21609902384895194
  4%|▍         | 43/1000 [35:44<13:17:59, 50.03s/it]Epoch 43 Valid AUC:(0.8049947236358292, 0.0)
Epoch 43 Test AUC:(0.7592745390382548, 0.0)
Epoch 43 a 0.28507441770982456 b 0.31154906584823155 c 0.21166214436832329
  4%|▍         | 44/1000 [36:34<13:16:20, 49.98s/it]Epoch 44 Valid AUC:(0.8050403726495378, 0.0)
Epoch 44 Test AUC:(0.7588922702213929, 0.0)
Epoch 44 a 0.2838034544672285 b 0.30853049526032306 c 0.21056117498179078
  4%|▍         | 45/1000 [37:24<13:16:14, 50.03s/it]Epoch 45 Valid AUC:(0.8019862781825341, 0.0)
Epoch 45 Test AUC:(0.7572395315688778, 0.0)
Epoch 45 a 0.28229997899210907 b 0.3043868638560086 c 0.20729292734288113
  5%|▍         | 46/1000 [38:14<13:15:36, 50.04s/it]  5%|▍         | 46/1000 [39:04<13:30:18, 50.96s/it]
[32m[I 2021-05-14 17:13:17,808][0m Trial 82 finished with value: 0.8074215738179475 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1337184673355722, 'gamma': 0.0021840839867918256}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 17:13:18.549569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807210659713564, 0.0)
Epoch 0 Test AUC:(0.7200549170777019, 0.0)
Epoch 0 a 0.4133408102591033 b 0.5005247318888574 c 0.41448742109285275
  0%|          | 1/1000 [00:47<13:07:34, 47.30s/it]Epoch 1 Valid AUC:(0.7796375737702108, 0.0)
Epoch 1 Test AUC:(0.722531446954511, 0.0)
Epoch 1 a 0.38567947879643505 b 0.4856234635385709 c 0.3864534649570703
  0%|          | 2/1000 [01:36<13:24:03, 48.34s/it]Epoch 2 Valid AUC:(0.7759957426447455, 0.0)
Epoch 2 Test AUC:(0.7244551043616316, 0.0)
Epoch 2 a 0.3813645576447308 b 0.49047748375706507 c 0.38248413111602275
  0%|          | 3/1000 [02:26<13:33:35, 48.96s/it]Epoch 3 Valid AUC:(0.7824778833674889, 0.0)
Epoch 3 Test AUC:(0.725819305091727, 0.0)
Epoch 3 a 0.37637712466165096 b 0.4939850367290873 c 0.3785984799775559
  0%|          | 4/1000 [03:15<13:38:52, 49.33s/it]Epoch 4 Valid AUC:(0.7849083027824093, 0.0)
Epoch 4 Test AUC:(0.7277997021193439, 0.0)
Epoch 4 a 0.3723326453140804 b 0.49836742800006445 c 0.3748996579790979
  0%|          | 5/1000 [04:05<13:39:18, 49.41s/it]Epoch 5 Valid AUC:(0.783478186171716, 0.0)
Epoch 5 Test AUC:(0.726310585294603, 0.0)
Epoch 5 a 0.3696441984992152 b 0.5003824439686788 c 0.37238030048683135
  1%|          | 6/1000 [04:54<13:37:24, 49.34s/it]Epoch 6 Valid AUC:(0.786808124021902, 0.0)
Epoch 6 Test AUC:(0.7273114190134439, 0.0)
Epoch 6 a 0.36768564623846134 b 0.5022253604602046 c 0.370458485794739
  1%|          | 7/1000 [05:44<13:38:55, 49.48s/it]Epoch 7 Valid AUC:(0.7888183159360511, 0.0)
Epoch 7 Test AUC:(0.7271954386287552, 0.0)
Epoch 7 a 0.3662023164736673 b 0.5003021317468562 c 0.36843116104722745
  1%|          | 8/1000 [06:34<13:40:43, 49.64s/it]Epoch 8 Valid AUC:(0.7915894670020185, 0.0)
Epoch 8 Test AUC:(0.7274999667689925, 0.0)
Epoch 8 a 0.36362947628531656 b 0.4998354417697285 c 0.36528027249533884
  1%|          | 9/1000 [07:24<13:41:28, 49.74s/it]Epoch 9 Valid AUC:(0.7909057147772011, 0.0)
Epoch 9 Test AUC:(0.728615040760583, 0.0)
Epoch 9 a 0.36113194998361214 b 0.5008675820630801 c 0.36254614135868835
  1%|          | 10/1000 [08:14<13:39:57, 49.69s/it]Epoch 10 Valid AUC:(0.7921803204914225, 0.0)
Epoch 10 Test AUC:(0.7279904260836811, 0.0)
Epoch 10 a 0.35790597768856486 b 0.5031889629675829 c 0.3587272041880149
  1%|          | 11/1000 [09:03<13:40:09, 49.76s/it]Epoch 11 Valid AUC:(0.7925447244222139, 0.0)
Epoch 11 Test AUC:(0.7268245553600345, 0.0)
Epoch 11 a 0.356443766137244 b 0.5009911394335135 c 0.3565867053311116
  1%|          | 12/1000 [09:53<13:39:10, 49.75s/it]Epoch 12 Valid AUC:(0.7932850576376886, 0.0)
Epoch 12 Test AUC:(0.7253296068087955, 0.0)
Epoch 12 a 0.35528447762341564 b 0.5019161607657879 c 0.3539730177319026
  1%|▏         | 13/1000 [10:43<13:39:23, 49.81s/it]Epoch 13 Valid AUC:(0.792732387890513, 0.0)
Epoch 13 Test AUC:(0.7240023759753493, 0.0)
Epoch 13 a 0.35395436789428203 b 0.4981332370932673 c 0.3502651232948725
  1%|▏         | 14/1000 [11:33<13:38:55, 49.83s/it]Epoch 14 Valid AUC:(0.7947176220884724, 0.0)
Epoch 14 Test AUC:(0.7252451964156482, 0.0)
Epoch 14 a 0.35257571324016485 b 0.4928523472976876 c 0.3454226542046852
  2%|▏         | 15/1000 [12:23<13:39:31, 49.92s/it]Epoch 15 Valid AUC:(0.7933386025376786, 0.0)
Epoch 15 Test AUC:(0.7227176859620326, 0.0)
Epoch 15 a 0.351353298910187 b 0.48743001106279477 c 0.3402820717041162
  2%|▏         | 16/1000 [13:13<13:39:30, 49.97s/it]Epoch 16 Valid AUC:(0.7919438360700305, 0.0)
Epoch 16 Test AUC:(0.7232354740126274, 0.0)
Epoch 16 a 0.35013751898493084 b 0.4799611884463481 c 0.3357433174817375
  2%|▏         | 17/1000 [14:03<13:37:40, 49.91s/it]Epoch 17 Valid AUC:(0.7934854960117584, 0.0)
Epoch 17 Test AUC:(0.7253339292981574, 0.0)
Epoch 17 a 0.3489720175563689 b 0.4745837562760597 c 0.3316528347416423
  2%|▏         | 18/1000 [14:53<13:39:08, 50.05s/it]Epoch 18 Valid AUC:(0.7958139840331723, 0.0)
Epoch 18 Test AUC:(0.7247897317354077, 0.0)
Epoch 18 a 0.3469731443724642 b 0.4671559640819158 c 0.3265425552664628
  2%|▏         | 19/1000 [15:43<13:36:53, 49.96s/it]Epoch 19 Valid AUC:(0.7946100401572909, 0.0)
Epoch 19 Test AUC:(0.7255880711504323, 0.0)
Epoch 19 a 0.3446789629142769 b 0.45906031341619896 c 0.3213178685133606
  2%|▏         | 20/1000 [16:33<13:34:34, 49.87s/it]Epoch 20 Valid AUC:(0.7962858814653199, 0.0)
Epoch 20 Test AUC:(0.72974412970779, 0.0)
Epoch 20 a 0.3411492982980471 b 0.4579323010305524 c 0.3166921166347066
  2%|▏         | 21/1000 [17:22<13:32:45, 49.81s/it]Epoch 21 Valid AUC:(0.8005295172810128, 0.0)
Epoch 21 Test AUC:(0.7351274973390717, 0.0)
Epoch 21 a 0.33664930982129193 b 0.4563681142071123 c 0.3107961473810361
  2%|▏         | 22/1000 [18:12<13:32:22, 49.84s/it]Epoch 22 Valid AUC:(0.7989155794138484, 0.0)
Epoch 22 Test AUC:(0.7367269167385382, 0.0)
Epoch 22 a 0.33215687644313757 b 0.4543263735305855 c 0.30551895262369927
  2%|▏         | 23/1000 [19:02<13:31:45, 49.85s/it]Epoch 23 Valid AUC:(0.8002309499959225, 0.0)
Epoch 23 Test AUC:(0.7359028005793367, 0.0)
Epoch 23 a 0.32826092377514904 b 0.45274293344745214 c 0.300577228188035
  2%|▏         | 24/1000 [19:52<13:32:17, 49.94s/it]Epoch 24 Valid AUC:(0.7993438847869183, 0.0)
Epoch 24 Test AUC:(0.7378528632231527, 0.0)
Epoch 24 a 0.3248864296576387 b 0.4496288084887883 c 0.2956511317424371
  2%|▎         | 25/1000 [20:43<13:33:28, 50.06s/it]Epoch 25 Valid AUC:(0.8018317310429984, 0.0)
Epoch 25 Test AUC:(0.7408879348286949, 0.0)
Epoch 25 a 0.32198088797525143 b 0.4457885502449703 c 0.2914363780551753
  3%|▎         | 26/1000 [21:32<13:31:16, 49.98s/it]Epoch 26 Valid AUC:(0.7992243263815768, 0.0)
Epoch 26 Test AUC:(0.7416485475907725, 0.0)
Epoch 26 a 0.3197623289806742 b 0.44152875595409385 c 0.2871650422902654
  3%|▎         | 27/1000 [22:22<13:29:59, 49.95s/it]Epoch 27 Valid AUC:(0.8017535065322112, 0.0)
Epoch 27 Test AUC:(0.7408525254746937, 0.0)
Epoch 27 a 0.3175008198025241 b 0.43510151365153504 c 0.2819350444275129
  3%|▎         | 28/1000 [23:12<13:28:01, 49.88s/it]Epoch 28 Valid AUC:(0.7997530688122657, 0.0)
Epoch 28 Test AUC:(0.7421548902367958, 0.0)
Epoch 28 a 0.31588504060173417 b 0.4268211175498348 c 0.2781545511433776
  3%|▎         | 29/1000 [24:02<13:27:50, 49.92s/it]Epoch 29 Valid AUC:(0.8021776492955357, 0.0)
Epoch 29 Test AUC:(0.7446538149694681, 0.0)
Epoch 29 a 0.3143199070598518 b 0.41800682741391587 c 0.27272890909936587
  3%|▎         | 30/1000 [24:52<13:27:34, 49.95s/it]Epoch 30 Valid AUC:(0.8031433965435534, 0.0)
Epoch 30 Test AUC:(0.7431167574194899, 0.0)
Epoch 30 a 0.3126566623538073 b 0.40968263185240134 c 0.2681560548738215
  3%|▎         | 31/1000 [25:42<13:25:52, 49.90s/it]Epoch 31 Valid AUC:(0.8048618905039655, 0.0)
Epoch 31 Test AUC:(0.7449061354760772, 0.0)
Epoch 31 a 0.3108086946984412 b 0.40072102697802264 c 0.26308067991460116
  3%|▎         | 32/1000 [26:32<13:23:43, 49.82s/it]Epoch 32 Valid AUC:(0.8044327751649598, 0.0)
Epoch 32 Test AUC:(0.7435650265017124, 0.0)
Epoch 32 a 0.3086859865087858 b 0.39469290061495915 c 0.2591421143329839
  3%|▎         | 33/1000 [27:21<13:22:11, 49.77s/it]Epoch 33 Valid AUC:(0.805049560380223, 0.0)
Epoch 33 Test AUC:(0.7471853187020788, 0.0)
Epoch 33 a 0.30505395481284237 b 0.38683257088574846 c 0.25531442919127656
  3%|▎         | 34/1000 [28:11<13:20:36, 49.73s/it]Epoch 34 Valid AUC:(0.8032312714396189, 0.0)
Epoch 34 Test AUC:(0.7478051277627168, 0.0)
Epoch 34 a 0.30158059008164667 b 0.3804221088497691 c 0.2511607608205116
  4%|▎         | 35/1000 [29:00<13:19:24, 49.70s/it]Epoch 35 Valid AUC:(0.8064801909091761, 0.0)
Epoch 35 Test AUC:(0.7553265286063564, 0.0)
Epoch 35 a 0.2975725104931135 b 0.3717881177272835 c 0.24507587638419398
  4%|▎         | 36/1000 [29:50<13:19:26, 49.76s/it]Epoch 36 Valid AUC:(0.8045947183700254, 0.0)
Epoch 36 Test AUC:(0.754543525263875, 0.0)
Epoch 36 a 0.2947438701057818 b 0.36535091617217724 c 0.24143109448119188
  4%|▎         | 37/1000 [30:40<13:20:03, 49.85s/it]Epoch 37 Valid AUC:(0.8059130340497581, 0.0)
Epoch 37 Test AUC:(0.7553219025593836, 0.0)
Epoch 37 a 0.29300547668511717 b 0.35783691497395936 c 0.23681394057254676
  4%|▍         | 38/1000 [31:30<13:18:55, 49.83s/it]Epoch 38 Valid AUC:(0.8069237638838158, 0.0)
Epoch 38 Test AUC:(0.7585217460912543, 0.0)
Epoch 38 a 0.29139368436945756 b 0.35053358927099276 c 0.2332738178296828
  4%|▍         | 39/1000 [32:20<13:18:53, 49.88s/it]Epoch 39 Valid AUC:(0.8050493014987056, 0.0)
Epoch 39 Test AUC:(0.7578117975219942, 0.0)
Epoch 39 a 0.28913948113769594 b 0.34360938029030197 c 0.22917032496670123
  4%|▍         | 40/1000 [33:10<13:17:14, 49.83s/it]Epoch 40 Valid AUC:(0.8072382139344776, 0.0)
Epoch 40 Test AUC:(0.7591628982447653, 0.0)
Epoch 40 a 0.2878349427905841 b 0.33921682594767516 c 0.22623883895351132
  4%|▍         | 41/1000 [34:00<13:16:27, 49.83s/it]Epoch 41 Valid AUC:(0.8035633472205239, 0.0)
Epoch 41 Test AUC:(0.755763980776526, 0.0)
Epoch 41 a 0.28654073499577865 b 0.3323796116850026 c 0.22269340474121047
  4%|▍         | 42/1000 [34:50<13:17:58, 49.98s/it]Epoch 42 Valid AUC:(0.8039948232513866, 0.0)
Epoch 42 Test AUC:(0.7588912270093214, 0.0)
Epoch 42 a 0.28470160630747104 b 0.328349554622677 c 0.21933391024649024
  4%|▍         | 43/1000 [35:40<13:16:37, 49.94s/it]Epoch 43 Valid AUC:(0.804740625018519, 0.0)
Epoch 43 Test AUC:(0.7599956251790162, 0.0)
Epoch 43 a 0.283594916254222 b 0.3209452564927414 c 0.21555415818269105
  4%|▍         | 44/1000 [36:30<13:15:42, 49.94s/it]Epoch 44 Valid AUC:(0.8044220328635784, 0.0)
Epoch 44 Test AUC:(0.7581356721156071, 0.0)
Epoch 44 a 0.2825003021080009 b 0.31814253791956837 c 0.214355359764646
  4%|▍         | 45/1000 [37:20<13:14:58, 49.95s/it]Epoch 45 Valid AUC:(0.801754572816481, 0.0)
Epoch 45 Test AUC:(0.7572312628305732, 0.0)
Epoch 45 a 0.2810170115299628 b 0.313537576248948 c 0.210635216213328
  5%|▍         | 46/1000 [38:10<13:15:16, 50.02s/it]  5%|▍         | 46/1000 [38:59<13:28:44, 50.86s/it]
[32m[I 2021-05-14 17:52:37,182][0m Trial 83 finished with value: 0.8072382139344776 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.13236778234233215, 'gamma': 0.002183560179820575}. Best is trial 64 with value: 0.8082948619164947.[0m
2021-05-14 17:52:37.933628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7810418086371199, 0.0)
Epoch 0 Test AUC:(0.7206822423958059, 0.0)
Epoch 0 a 0.4144454754933985 b 0.5003767290585478 c 0.41533978706154545
  0%|          | 1/1000 [00:46<13:02:03, 46.97s/it]Epoch 1 Valid AUC:(0.7814902619128405, 0.0)
Epoch 1 Test AUC:(0.7225365090983334, 0.0)
Epoch 1 a 0.3848771117102932 b 0.48567260504968207 c 0.3855583492658987
  0%|          | 2/1000 [01:36<13:23:49, 48.33s/it]Epoch 2 Valid AUC:(0.776301180542781, 0.0)
Epoch 2 Test AUC:(0.7247538435299639, 0.0)
Epoch 2 a 0.38093961940205073 b 0.49121583527482493 c 0.38172258289766986
  0%|          | 3/1000 [02:25<13:30:54, 48.80s/it]Epoch 3 Valid AUC:(0.7823509788786925, 0.0)
Epoch 3 Test AUC:(0.7250021622066593, 0.0)
Epoch 3 a 0.37732979013646395 b 0.49596022804018475 c 0.3787060731973207
  0%|          | 4/1000 [03:15<13:36:16, 49.17s/it]Epoch 4 Valid AUC:(0.7836460221352822, 0.0)
Epoch 4 Test AUC:(0.7276139034841312, 0.0)
Epoch 4 a 0.3744813633156974 b 0.5010053958571413 c 0.3759704275390272
  0%|          | 5/1000 [04:04<13:37:09, 49.28s/it]Epoch 5 Valid AUC:(0.7797621675492253, 0.0)
Epoch 5 Test AUC:(0.7253092941016162, 0.0)
Epoch 5 a 0.37203159118802015 b 0.5022327739228185 c 0.37354865694189937
  1%|          | 6/1000 [04:54<13:37:14, 49.33s/it]Epoch 6 Valid AUC:(0.7867963666999176, 0.0)
Epoch 6 Test AUC:(0.7275851253675191, 0.0)
Epoch 6 a 0.36991910633426794 b 0.5017964490942313 c 0.3711955649272297
  1%|          | 7/1000 [05:43<13:36:13, 49.32s/it]Epoch 7 Valid AUC:(0.7868293484615558, 0.0)
Epoch 7 Test AUC:(0.7256536866244552, 0.0)
Epoch 7 a 0.3671945568541406 b 0.49942774246156335 c 0.3680166170990443
  1%|          | 8/1000 [06:32<13:35:05, 49.30s/it]Epoch 8 Valid AUC:(0.7915221693418133, 0.0)
Epoch 8 Test AUC:(0.7269401851570598, 0.0)
Epoch 8 a 0.36404089968449155 b 0.5026923485804852 c 0.3642305790538519
  1%|          | 9/1000 [07:22<13:33:57, 49.28s/it]Epoch 9 Valid AUC:(0.790469990269951, 0.0)
Epoch 9 Test AUC:(0.7259409461845414, 0.0)
Epoch 9 a 0.3619737722264449 b 0.5029472121650305 c 0.3611257940950528
  1%|          | 10/1000 [08:11<13:33:03, 49.28s/it]Epoch 10 Valid AUC:(0.7919969183154275, 0.0)
Epoch 10 Test AUC:(0.7252730724103461, 0.0)
Epoch 10 a 0.35908486353799374 b 0.503888455435064 c 0.35666555909803455
  1%|          | 11/1000 [09:00<13:31:52, 49.25s/it]Epoch 11 Valid AUC:(0.7935419885725905, 0.0)
Epoch 11 Test AUC:(0.7256377220593935, 0.0)
Epoch 11 a 0.3577600928619354 b 0.5040026898954956 c 0.3532564194509441
  1%|          | 12/1000 [09:49<13:31:35, 49.29s/it]Epoch 12 Valid AUC:(0.7938933318026686, 0.0)
Epoch 12 Test AUC:(0.7234567162055159, 0.0)
Epoch 12 a 0.35647830744864234 b 0.5025070986637408 c 0.34827545447128877
  1%|▏         | 13/1000 [10:39<13:34:07, 49.49s/it]Epoch 13 Valid AUC:(0.7948714489734892, 0.0)
Epoch 13 Test AUC:(0.7224622101664531, 0.0)
Epoch 13 a 0.35485546815563257 b 0.49818239299584205 c 0.34192343041210826
  1%|▏         | 14/1000 [11:29<13:32:11, 49.42s/it]Epoch 14 Valid AUC:(0.7941781360748104, 0.0)
Epoch 14 Test AUC:(0.724683268523142, 0.0)
Epoch 14 a 0.35338768386984737 b 0.49202916895599674 c 0.33618982924781815
  2%|▏         | 15/1000 [12:18<13:32:31, 49.49s/it]Epoch 15 Valid AUC:(0.793795953904367, 0.0)
Epoch 15 Test AUC:(0.7241863660912741, 0.0)
Epoch 15 a 0.35185801539142847 b 0.48343693754322814 c 0.32981042339048633
  2%|▏         | 16/1000 [13:08<13:30:56, 49.45s/it]Epoch 16 Valid AUC:(0.7927607789907878, 0.0)
Epoch 16 Test AUC:(0.7246207356552814, 0.0)
Epoch 16 a 0.3497551651427923 b 0.47319607955349285 c 0.3234466541580991
  2%|▏         | 17/1000 [13:57<13:28:25, 49.34s/it]Epoch 17 Valid AUC:(0.7942140552445571, 0.0)
Epoch 17 Test AUC:(0.7307194517609311, 0.0)
Epoch 17 a 0.3469255097675132 b 0.4614316636407879 c 0.3176660068198229
  2%|▏         | 18/1000 [14:46<13:26:21, 49.27s/it]Epoch 18 Valid AUC:(0.7995557049766132, 0.0)
Epoch 18 Test AUC:(0.7359318266725888, 0.0)
Epoch 18 a 0.3412609370181738 b 0.4489893817325953 c 0.31102315394931157
  2%|▏         | 19/1000 [15:35<13:26:44, 49.34s/it]Epoch 19 Valid AUC:(0.799501414190271, 0.0)
Epoch 19 Test AUC:(0.7377199990496509, 0.0)
Epoch 19 a 0.3355506299966778 b 0.4396363789406821 c 0.30521412859380365
  2%|▏         | 20/1000 [16:24<13:24:15, 49.24s/it]Epoch 20 Valid AUC:(0.7996637534071627, 0.0)
Epoch 20 Test AUC:(0.7421487079226343, 0.0)
Epoch 20 a 0.3311156804412903 b 0.43103824720776057 c 0.29960027594921335
  2%|▏         | 21/1000 [17:14<13:24:31, 49.31s/it]Epoch 21 Valid AUC:(0.804897247054969, 0.0)
Epoch 21 Test AUC:(0.7475951898842428, 0.0)
Epoch 21 a 0.3268318749529495 b 0.42244148991957037 c 0.29197516563672654
  2%|▏         | 22/1000 [18:03<13:22:02, 49.21s/it]Epoch 22 Valid AUC:(0.80236250864126, 0.0)
Epoch 22 Test AUC:(0.7444487126354731, 0.0)
Epoch 22 a 0.32311043533041206 b 0.41303441666021673 c 0.2854789197744738
  2%|▏         | 23/1000 [18:52<13:20:05, 49.14s/it]Epoch 23 Valid AUC:(0.8029403091195008, 0.0)
Epoch 23 Test AUC:(0.745905075166444, 0.0)
Epoch 23 a 0.3205346827895589 b 0.40638834214066594 c 0.27969736451474236
  2%|▏         | 24/1000 [19:41<13:20:22, 49.20s/it]Epoch 24 Valid AUC:(0.8035405541126656, 0.0)
Epoch 24 Test AUC:(0.7472595278493137, 0.0)
Epoch 24 a 0.3181139364448831 b 0.3955708134702034 c 0.2735176794905538
  2%|▎         | 25/1000 [20:30<13:20:02, 49.23s/it]Epoch 25 Valid AUC:(0.8058863051738799, 0.0)
Epoch 25 Test AUC:(0.7494232736739589, 0.0)
Epoch 25 a 0.3154047255664764 b 0.3882033011203321 c 0.26781297032861884
  3%|▎         | 26/1000 [21:20<13:19:22, 49.24s/it]Epoch 26 Valid AUC:(0.803758165815119, 0.0)
Epoch 26 Test AUC:(0.7518155427986966, 0.0)
Epoch 26 a 0.313011871197334 b 0.37977655037068264 c 0.26265844666741983
  3%|▎         | 27/1000 [22:09<13:21:03, 49.40s/it]Epoch 27 Valid AUC:(0.8071662153960253, 0.0)
Epoch 27 Test AUC:(0.7499487661022295, 0.0)
Epoch 27 a 0.30965584744390107 b 0.3729096334465073 c 0.25724626058184163
  3%|▎         | 28/1000 [22:59<13:20:10, 49.39s/it]Epoch 28 Valid AUC:(0.8048566231622001, 0.0)
Epoch 28 Test AUC:(0.7517540830711226, 0.0)
Epoch 28 a 0.3065688037716407 b 0.36818130197419485 c 0.25291635854623207
  3%|▎         | 29/1000 [23:48<13:18:55, 49.37s/it]Epoch 29 Valid AUC:(0.8072066226998018, 0.0)
Epoch 29 Test AUC:(0.753619081176517, 0.0)
Epoch 29 a 0.3031480437373251 b 0.359958276182593 c 0.24748006163228686
  3%|▎         | 30/1000 [24:37<13:18:10, 49.37s/it]Epoch 30 Valid AUC:(0.8068660961034221, 0.0)
Epoch 30 Test AUC:(0.7535988924576575, 0.0)
Epoch 30 a 0.3000724745288461 b 0.35420990829736415 c 0.24340718013180093
  3%|▎         | 31/1000 [25:27<13:18:00, 49.41s/it]Epoch 31 Valid AUC:(0.8090983558142626, 0.0)
Epoch 31 Test AUC:(0.7554480499863102, 0.0)
Epoch 31 a 0.29721133515868386 b 0.3463013771793972 c 0.23700518063616224
  3%|▎         | 32/1000 [26:16<13:16:10, 49.35s/it]Epoch 32 Valid AUC:(0.8072408117207935, 0.0)
Epoch 32 Test AUC:(0.7538785374247136, 0.0)
Epoch 32 a 0.2953102394068985 b 0.3397630510075951 c 0.23288007740163708
  3%|▎         | 33/1000 [27:06<13:17:32, 49.49s/it]Epoch 33 Valid AUC:(0.8062081961457802, 0.0)
Epoch 33 Test AUC:(0.7547654729075495, 0.0)
Epoch 33 a 0.29295975338645147 b 0.3337970709416948 c 0.2283238241490224
  3%|▎         | 34/1000 [27:55<13:14:24, 49.34s/it]Epoch 34 Valid AUC:(0.8040717251595699, 0.0)
Epoch 34 Test AUC:(0.7554207853822935, 0.0)
Epoch 34 a 0.29126894423059774 b 0.3292510477110174 c 0.22488974916263366
  4%|▎         | 35/1000 [28:44<13:14:00, 49.37s/it]Epoch 35 Valid AUC:(0.807432933846514, 0.0)
Epoch 35 Test AUC:(0.7606983824257176, 0.0)
Epoch 35 a 0.28821394680971113 b 0.3252420719240753 c 0.22077274649315917
  4%|▎         | 36/1000 [29:34<13:13:36, 49.39s/it]Epoch 36 Valid AUC:(0.8057838739596218, 0.0)
Epoch 36 Test AUC:(0.7583832254850861, 0.0)
Epoch 36 a 0.286073470499434 b 0.32256406485674605 c 0.2176034592047064
  4%|▎         | 37/1000 [30:23<13:12:11, 49.36s/it]  4%|▎         | 37/1000 [31:12<13:32:21, 50.61s/it]
[32m[I 2021-05-14 18:24:09,741][0m Trial 84 finished with value: 0.8090983558142626 and parameters: {'rank': 40.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.1326847757910213, 'gamma': 0.0021839501337443993}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 18:24:10.477721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.48925274014039233, 0.0)
Epoch 0 Test AUC:(0.5037489600105559, 0.0)
Epoch 0 a 0.5223641768547611 b 0.5223638143697735 c 0.5223637367757993
  0%|          | 1/1000 [00:47<13:06:19, 47.23s/it]Epoch 1 Valid AUC:(0.48635859600340664, 0.0)
Epoch 1 Test AUC:(0.48921417267389006, 0.0)
Epoch 1 a 0.5036929712089254 b 0.5036926482404981 c 0.5036926498595378
  0%|          | 2/1000 [01:36<13:23:37, 48.31s/it]Epoch 2 Valid AUC:(0.4914389894286732, 0.0)
Epoch 2 Test AUC:(0.5014936124702049, 0.0)
Epoch 2 a 0.5030325207432031 b 0.5030323066701832 c 0.5030323078095074
  0%|          | 3/1000 [02:25<13:29:49, 48.74s/it]Epoch 3 Valid AUC:(0.4941538850282677, 0.0)
Epoch 3 Test AUC:(0.4993243812312655, 0.0)
Epoch 3 a 0.5027555001813401 b 0.5027553840302366 c 0.5027553844499876
  0%|          | 4/1000 [03:14<13:31:20, 48.88s/it]Epoch 4 Valid AUC:(0.5022091551762062, 0.0)
Epoch 4 Test AUC:(0.5059942516706112, 0.0)
Epoch 4 a 0.5029794878403185 b 0.5029794063486563 c 0.5029794062287275
  0%|          | 5/1000 [04:03<13:30:51, 48.90s/it]Epoch 5 Valid AUC:(0.495256070525518, 0.0)
Epoch 5 Test AUC:(0.5186718265132853, 0.0)
Epoch 5 a 0.5027145412366395 b 0.50271450849606 c 0.5027145065771982
  1%|          | 6/1000 [04:52<13:30:37, 48.93s/it]Epoch 6 Valid AUC:(0.49013225933764104, 0.0)
Epoch 6 Test AUC:(0.5017150470587621, 0.0)
Epoch 6 a 0.5029710046122492 b 0.5029709799668679 c 0.5029709818257653
  1%|          | 7/1000 [05:42<13:35:33, 49.28s/it]Epoch 7 Valid AUC:(0.4882039739471484, 0.0)
Epoch 7 Test AUC:(0.4896536599626909, 0.0)
Epoch 7 a 0.5026491614174795 b 0.5026491469660516 c 0.5026491465463006
  1%|          | 8/1000 [06:32<13:36:31, 49.39s/it]Epoch 8 Valid AUC:(0.4883459935281056, 0.0)
Epoch 8 Test AUC:(0.49628187887744346, 0.0)
Epoch 8 a 0.5026575538593998 b 0.5026575413268337 c 0.5026575409670471
  1%|          | 9/1000 [07:21<13:34:01, 49.29s/it]Epoch 9 Valid AUC:(0.491505557863218, 0.0)
Epoch 9 Test AUC:(0.49792994445293337, 0.0)
Epoch 9 a 0.5026582709140701 b 0.5026582686953861 c 0.5026582671363109
  1%|          | 10/1000 [08:10<13:32:58, 49.27s/it]  1%|          | 10/1000 [08:59<14:50:49, 53.99s/it]
[32m[I 2021-05-14 18:33:29,429][0m Trial 85 finished with value: 0.5022091551762062 and parameters: {'rank': 40.0, 'lambda': 1, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12515532112092048, 'gamma': 0.002177307937575875}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 18:33:30.085299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.5305121588395284, 0.0)
Epoch 0 Test AUC:(0.524764313274721, 0.0)
Epoch 0 a 0.6495356044059308 b 0.6495131002345556 c 0.6494264488728714
  0%|          | 1/1000 [00:47<13:16:13, 47.82s/it]Epoch 1 Valid AUC:(0.5382095650189697, 0.0)
Epoch 1 Test AUC:(0.532039631506884, 0.0)
Epoch 1 a 0.5356882534156623 b 0.5344297449353715 c 0.5342417265207955
  0%|          | 2/1000 [01:37<13:36:44, 49.10s/it]Epoch 2 Valid AUC:(0.5384898824386734, 0.0)
Epoch 2 Test AUC:(0.5384238884379776, 0.0)
Epoch 2 a 0.5110096183101416 b 0.5083440221411362 c 0.5082120489426541
  0%|          | 3/1000 [02:28<13:44:52, 49.64s/it]Epoch 3 Valid AUC:(0.5360022015079187, 0.0)
Epoch 3 Test AUC:(0.5410469725089976, 0.0)
Epoch 3 a 0.5071988115368234 b 0.5035145790644096 c 0.5034480421116174
  0%|          | 4/1000 [03:18<13:46:38, 49.80s/it]Epoch 4 Valid AUC:(0.5222285282797966, 0.0)
Epoch 4 Test AUC:(0.5267992352349118, 0.0)
Epoch 4 a 0.5052012281878373 b 0.5007268183188179 c 0.5006931047564301
  0%|          | 5/1000 [04:08<13:47:10, 49.88s/it]Epoch 5 Valid AUC:(0.5184292510544373, 0.0)
Epoch 5 Test AUC:(0.5152597662831284, 0.0)
Epoch 5 a 0.5040519563724817 b 0.49895852318472067 c 0.4989403625369312
  1%|          | 6/1000 [04:58<13:47:31, 49.95s/it]Epoch 6 Valid AUC:(0.5113883107315585, 0.0)
Epoch 6 Test AUC:(0.510346019377861, 0.0)
Epoch 6 a 0.5032790087957977 b 0.49763324395031994 c 0.49762367386693207
  1%|          | 7/1000 [05:48<13:47:04, 49.97s/it]Epoch 7 Valid AUC:(0.5119599864832064, 0.0)
Epoch 7 Test AUC:(0.5185885191886398, 0.0)
Epoch 7 a 0.5028391380305262 b 0.4967682533101057 c 0.4967626032814893
  1%|          | 8/1000 [06:38<13:46:27, 49.99s/it]  1%|          | 8/1000 [07:28<15:26:50, 56.06s/it]
[32m[I 2021-05-14 18:41:17,447][0m Trial 86 finished with value: 0.5384898824386734 and parameters: {'rank': 45.0, 'lambda': 0.1, 'batch_size': 512, 'learning_rate': 0.0001, 'alpha': 0.1314306029826169, 'gamma': 0.0019067204797303438}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 18:41:18.102696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7810147747424242, 0.0)
Epoch 0 Test AUC:(0.7206736358962159, 0.0)
Epoch 0 a 0.41444357983782976 b 0.5015255798636308 c 0.415352166238685
  0%|          | 1/1000 [00:46<13:01:51, 46.96s/it]Epoch 1 Valid AUC:(0.781580163005337, 0.0)
Epoch 1 Test AUC:(0.7225557486652262, 0.0)
Epoch 1 a 0.384871859005999 b 0.4872825641027639 c 0.38559161501391315
  0%|          | 2/1000 [01:36<13:26:20, 48.48s/it]Epoch 2 Valid AUC:(0.7762970807310273, 0.0)
Epoch 2 Test AUC:(0.7247423297180434, 0.0)
Epoch 2 a 0.3809336017315057 b 0.49305800263070965 c 0.38176668865579955
  0%|          | 3/1000 [02:26<13:33:24, 48.95s/it]Epoch 3 Valid AUC:(0.7822836402075539, 0.0)
Epoch 3 Test AUC:(0.7250049968361815, 0.0)
Epoch 3 a 0.37732590749949757 b 0.4979014888975462 c 0.3787342091681252
  0%|          | 4/1000 [03:15<13:33:54, 49.03s/it]Epoch 4 Valid AUC:(0.7835346761693648, 0.0)
Epoch 4 Test AUC:(0.7275763478495566, 0.0)
Epoch 4 a 0.3744738493526965 b 0.5030621914436639 c 0.3760033258250062
  0%|          | 5/1000 [04:04<13:34:44, 49.13s/it]Epoch 5 Valid AUC:(0.7794898498247285, 0.0)
Epoch 5 Test AUC:(0.7252575524930526, 0.0)
Epoch 5 a 0.37203169138858494 b 0.5049673599496454 c 0.37362292576843587
  1%|          | 6/1000 [04:54<13:37:12, 49.33s/it]Epoch 6 Valid AUC:(0.786707885610992, 0.0)
Epoch 6 Test AUC:(0.727574475198379, 0.0)
Epoch 6 a 0.36993201967456213 b 0.5057919385207731 c 0.3712834023853663
  1%|          | 7/1000 [05:43<13:35:45, 49.29s/it]Epoch 7 Valid AUC:(0.7866786550681731, 0.0)
Epoch 7 Test AUC:(0.7256315525716099, 0.0)
Epoch 7 a 0.367219867121046 b 0.5049643082997689 c 0.3681583999388175
  1%|          | 8/1000 [06:33<13:37:37, 49.45s/it]Epoch 8 Valid AUC:(0.7916639210701114, 0.0)
Epoch 8 Test AUC:(0.7269456791222725, 0.0)
Epoch 8 a 0.36406091839015126 b 0.5098101476308565 c 0.3644042081036558
  1%|          | 9/1000 [07:22<13:35:14, 49.36s/it]Epoch 9 Valid AUC:(0.7906083534698726, 0.0)
Epoch 9 Test AUC:(0.7260106575485827, 0.0)
Epoch 9 a 0.3619721230246891 b 0.5108745261816912 c 0.36136023049623195
  1%|          | 10/1000 [08:11<13:33:19, 49.29s/it]Epoch 10 Valid AUC:(0.7921493482655235, 0.0)
Epoch 10 Test AUC:(0.7253160236745693, 0.0)
Epoch 10 a 0.35908812242494503 b 0.5123754915457136 c 0.35701569848856934
  1%|          | 11/1000 [09:00<13:31:05, 49.21s/it]Epoch 11 Valid AUC:(0.7935169783111423, 0.0)
Epoch 11 Test AUC:(0.7257593332239928, 0.0)
Epoch 11 a 0.35773820026779557 b 0.5122612411947077 c 0.3537897276326684
  1%|          | 12/1000 [09:50<13:31:56, 49.31s/it]Epoch 12 Valid AUC:(0.7939708642539538, 0.0)
Epoch 12 Test AUC:(0.723659043766419, 0.0)
Epoch 12 a 0.35644569789140035 b 0.511561142127039 c 0.3490308071046288
  1%|▏         | 13/1000 [10:39<13:31:38, 49.34s/it]Epoch 13 Valid AUC:(0.7947307199553441, 0.0)
Epoch 13 Test AUC:(0.7222826537018323, 0.0)
Epoch 13 a 0.35483837955194697 b 0.5083130437963206 c 0.3427463877848696
  1%|▏         | 14/1000 [11:28<13:28:54, 49.22s/it]Epoch 14 Valid AUC:(0.7939667477815084, 0.0)
Epoch 14 Test AUC:(0.7244457667584997, 0.0)
Epoch 14 a 0.3534269689674109 b 0.5044935238313387 c 0.33696445840705086
  2%|▏         | 15/1000 [12:17<13:28:17, 49.24s/it]Epoch 15 Valid AUC:(0.7938749499333398, 0.0)
Epoch 15 Test AUC:(0.723951493734107, 0.0)
Epoch 15 a 0.3519395998186269 b 0.49836615507511545 c 0.33065987119012674
  2%|▏         | 16/1000 [13:06<13:26:38, 49.19s/it]Epoch 16 Valid AUC:(0.7927178443882371, 0.0)
Epoch 16 Test AUC:(0.724515837261123, 0.0)
Epoch 16 a 0.3499144189794299 b 0.4905815502887281 c 0.32433016715155283
  2%|▏         | 17/1000 [13:56<13:26:23, 49.22s/it]Epoch 17 Valid AUC:(0.7944453966385757, 0.0)
Epoch 17 Test AUC:(0.7307065142210606, 0.0)
Epoch 17 a 0.3472120743282364 b 0.4817374282079923 c 0.31852113457033093
  2%|▏         | 18/1000 [14:45<13:28:32, 49.40s/it]Epoch 18 Valid AUC:(0.7993309624981055, 0.0)
Epoch 18 Test AUC:(0.7350898348180144, 0.0)
Epoch 18 a 0.34166920760747654 b 0.4714138605585041 c 0.31191019387072483
  2%|▏         | 19/1000 [15:34<13:26:16, 49.31s/it]Epoch 19 Valid AUC:(0.7991484446203632, 0.0)
Epoch 19 Test AUC:(0.737313650845958, 0.0)
Epoch 19 a 0.33602237911291527 b 0.4637601574661746 c 0.30640099525931375
  2%|▏         | 20/1000 [16:24<13:24:12, 49.24s/it]Epoch 20 Valid AUC:(0.7993948395901425, 0.0)
Epoch 20 Test AUC:(0.7411770499381215, 0.0)
Epoch 20 a 0.3315178653603828 b 0.45848329248322806 c 0.3009200908048772
  2%|▏         | 21/1000 [17:13<13:26:39, 49.44s/it]Epoch 21 Valid AUC:(0.8046314410977495, 0.0)
Epoch 21 Test AUC:(0.7464985944277879, 0.0)
Epoch 21 a 0.32710017416798615 b 0.45255383513343167 c 0.2936077717264413
  2%|▏         | 22/1000 [18:03<13:24:33, 49.36s/it]Epoch 22 Valid AUC:(0.802379112942942, 0.0)
Epoch 22 Test AUC:(0.7439429514519158, 0.0)
Epoch 22 a 0.3231606356334878 b 0.44752931846699245 c 0.286896164958146
  2%|▏         | 23/1000 [18:52<13:22:19, 49.27s/it]Epoch 23 Valid AUC:(0.8027644119443278, 0.0)
Epoch 23 Test AUC:(0.7449846756635926, 0.0)
Epoch 23 a 0.32025909141995296 b 0.44327488007919646 c 0.28125478845966656
  2%|▏         | 24/1000 [19:41<13:22:43, 49.35s/it]Epoch 24 Valid AUC:(0.8034466339486908, 0.0)
Epoch 24 Test AUC:(0.7462336527652972, 0.0)
Epoch 24 a 0.31752515984493 b 0.43458900359314934 c 0.2750659454576446
  2%|▎         | 25/1000 [20:31<13:24:32, 49.51s/it]Epoch 25 Valid AUC:(0.8056367959363414, 0.0)
Epoch 25 Test AUC:(0.748956957877991, 0.0)
Epoch 25 a 0.3143167782357521 b 0.4302853409433269 c 0.2695779009784012
  3%|▎         | 26/1000 [21:20<13:22:08, 49.41s/it]Epoch 26 Valid AUC:(0.8038012324216117, 0.0)
Epoch 26 Test AUC:(0.7516160840709901, 0.0)
Epoch 26 a 0.3114055697946721 b 0.42423577297861187 c 0.2642704801300402
  3%|▎         | 27/1000 [22:10<13:21:46, 49.44s/it]Epoch 27 Valid AUC:(0.8068704496703264, 0.0)
Epoch 27 Test AUC:(0.7499741195759348, 0.0)
Epoch 27 a 0.3077654015850013 b 0.4188209973590475 c 0.25899720524758163
  3%|▎         | 28/1000 [23:00<13:22:58, 49.57s/it]Epoch 28 Valid AUC:(0.8050342030672364, 0.0)
Epoch 28 Test AUC:(0.75161670401259, 0.0)
Epoch 28 a 0.3048409577946308 b 0.4147813157656303 c 0.2546195654082346
  3%|▎         | 29/1000 [23:49<13:22:09, 49.57s/it]Epoch 29 Valid AUC:(0.806796258328526, 0.0)
Epoch 29 Test AUC:(0.7529633454313013, 0.0)
Epoch 29 a 0.301704787872207 b 0.407302366775766 c 0.24938686722720893
  3%|▎         | 30/1000 [24:39<13:22:54, 49.66s/it]Epoch 30 Valid AUC:(0.8066230973515692, 0.0)
Epoch 30 Test AUC:(0.7531192628813999, 0.0)
Epoch 30 a 0.29888844247195323 b 0.40306763389940475 c 0.24533514414634744
  3%|▎         | 31/1000 [25:28<13:20:01, 49.54s/it]Epoch 31 Valid AUC:(0.8088759278903117, 0.0)
Epoch 31 Test AUC:(0.7553001490224168, 0.0)
Epoch 31 a 0.2961869348642572 b 0.3952445136589304 c 0.23920121597092397
  3%|▎         | 32/1000 [26:18<13:21:46, 49.70s/it]Epoch 32 Valid AUC:(0.8070233973834573, 0.0)
Epoch 32 Test AUC:(0.7533122742164676, 0.0)
Epoch 32 a 0.2944720792818357 b 0.38829424233743604 c 0.23485960950793874
  3%|▎         | 33/1000 [27:09<13:22:48, 49.81s/it]Epoch 33 Valid AUC:(0.8057627353866099, 0.0)
Epoch 33 Test AUC:(0.753943926299393, 0.0)
Epoch 33 a 0.2924891003000904 b 0.3830692378927764 c 0.23093361864747175
  3%|▎         | 34/1000 [27:58<13:20:49, 49.74s/it]Epoch 34 Valid AUC:(0.8040743216642943, 0.0)
Epoch 34 Test AUC:(0.7543383074924787, 0.0)
Epoch 34 a 0.2913630282734961 b 0.3760518140236377 c 0.22730388475855592
  4%|▎         | 35/1000 [28:48<13:20:43, 49.79s/it]Epoch 35 Valid AUC:(0.8064691218019187, 0.0)
Epoch 35 Test AUC:(0.7598462748344169, 0.0)
Epoch 35 a 0.28888598531184784 b 0.37052375839749574 c 0.22297709229846355
  4%|▎         | 36/1000 [29:38<13:20:17, 49.81s/it]Epoch 36 Valid AUC:(0.8048294547003789, 0.0)
Epoch 36 Test AUC:(0.757454223758104, 0.0)
Epoch 36 a 0.28735241521772004 b 0.36688153514679767 c 0.21902663705934222
  4%|▎         | 37/1000 [30:28<13:19:51, 49.83s/it]  4%|▎         | 37/1000 [31:18<13:34:43, 50.76s/it]
[32m[I 2021-05-14 19:12:55,077][0m Trial 87 finished with value: 0.8088759278903117 and parameters: {'rank': 40.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.13325082119194567, 'gamma': 0.0027470722022156172}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 19:12:55.863736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7797002679531359, 0.0)
Epoch 0 Test AUC:(0.7213075967271684, 0.0)
Epoch 0 a 0.41524613881015204 b 0.5012959718584294 c 0.41582529375730626
  0%|          | 1/1000 [00:49<13:47:08, 49.68s/it]Epoch 1 Valid AUC:(0.7814318597804196, 0.0)
Epoch 1 Test AUC:(0.7226818319602631, 0.0)
Epoch 1 a 0.3847149984697461 b 0.487716286894781 c 0.3853474009324847
  0%|          | 2/1000 [01:39<13:47:38, 49.76s/it]Epoch 2 Valid AUC:(0.775568994405555, 0.0)
Epoch 2 Test AUC:(0.7238691783160214, 0.0)
Epoch 2 a 0.38130873591607245 b 0.4938912206372505 c 0.38186358194236064
  0%|          | 3/1000 [02:29<13:48:55, 49.88s/it]Epoch 3 Valid AUC:(0.7821131052119299, 0.0)
Epoch 3 Test AUC:(0.7251020369361291, 0.0)
Epoch 3 a 0.37760765109983246 b 0.4986207144601004 c 0.37889114256116224
  0%|          | 4/1000 [03:19<13:49:24, 49.96s/it]Epoch 4 Valid AUC:(0.7846269523998194, 0.0)
Epoch 4 Test AUC:(0.7276997803598217, 0.0)
Epoch 4 a 0.3740418024466071 b 0.5033264960681408 c 0.37542601970119976
  0%|          | 5/1000 [04:09<13:47:53, 49.92s/it]Epoch 5 Valid AUC:(0.7805458454765853, 0.0)
Epoch 5 Test AUC:(0.7254452793604138, 0.0)
Epoch 5 a 0.37146357835178645 b 0.5058478996067699 c 0.37301347187347333
  1%|          | 6/1000 [05:01<13:57:22, 50.55s/it]Epoch 6 Valid AUC:(0.7869942636777051, 0.0)
Epoch 6 Test AUC:(0.7277564045429167, 0.0)
Epoch 6 a 0.36943772531131386 b 0.507587687230446 c 0.3708364995312643
  1%|          | 7/1000 [05:51<13:53:31, 50.36s/it]Epoch 7 Valid AUC:(0.7868104911217173, 0.0)
Epoch 7 Test AUC:(0.7261140638074421, 0.0)
Epoch 7 a 0.36720075459787305 b 0.5078622848095309 c 0.3682447755840463
  1%|          | 8/1000 [06:42<13:55:23, 50.53s/it]Epoch 8 Valid AUC:(0.7918114835350433, 0.0)
Epoch 8 Test AUC:(0.7274011352515942, 0.0)
Epoch 8 a 0.36381787385499215 b 0.5124356666920891 c 0.36458404443153675
  1%|          | 9/1000 [07:32<13:55:54, 50.61s/it]Epoch 9 Valid AUC:(0.7903706079622769, 0.0)
Epoch 9 Test AUC:(0.7264595679497017, 0.0)
Epoch 9 a 0.36140345033985266 b 0.5165878744192527 c 0.3616816976540525
  1%|          | 10/1000 [08:23<13:52:50, 50.48s/it]Epoch 10 Valid AUC:(0.792056084276484, 0.0)
Epoch 10 Test AUC:(0.7255400107123343, 0.0)
Epoch 10 a 0.35841085895206365 b 0.5218678329672132 c 0.3579940782106618
  1%|          | 11/1000 [09:12<13:48:29, 50.26s/it]Epoch 11 Valid AUC:(0.7928921741767972, 0.0)
Epoch 11 Test AUC:(0.7252730809612646, 0.0)
Epoch 11 a 0.35689372609798575 b 0.5225873473184689 c 0.3556930813151346
  1%|          | 12/1000 [10:02<13:46:29, 50.19s/it]Epoch 12 Valid AUC:(0.7934277782492896, 0.0)
Epoch 12 Test AUC:(0.7239142886871958, 0.0)
Epoch 12 a 0.3555621163586016 b 0.5226236529633312 c 0.35300430781404735
  1%|▏         | 13/1000 [10:52<13:44:37, 50.13s/it]Epoch 13 Valid AUC:(0.7950175747741585, 0.0)
Epoch 13 Test AUC:(0.7233606851139653, 0.0)
Epoch 13 a 0.35367410877340993 b 0.5209107732389054 c 0.34890885750052913
  1%|▏         | 14/1000 [11:42<13:43:16, 50.10s/it]Epoch 14 Valid AUC:(0.7947412584836498, 0.0)
Epoch 14 Test AUC:(0.7244627189546619, 0.0)
Epoch 14 a 0.35207459192640583 b 0.5212150234091929 c 0.3436180020362079
  2%|▏         | 15/1000 [12:33<13:42:41, 50.11s/it]Epoch 15 Valid AUC:(0.7939823204018956, 0.0)
Epoch 15 Test AUC:(0.7231113617043322, 0.0)
Epoch 15 a 0.35067400833970347 b 0.5196809547408006 c 0.33720885268159556
  2%|▏         | 16/1000 [13:23<13:42:12, 50.13s/it]Epoch 16 Valid AUC:(0.7926646378284481, 0.0)
Epoch 16 Test AUC:(0.723112092807874, 0.0)
Epoch 16 a 0.34909901700509144 b 0.516234161208573 c 0.33125848495504506
  2%|▏         | 17/1000 [14:12<13:39:31, 50.02s/it]Epoch 17 Valid AUC:(0.7936857805948279, 0.0)
Epoch 17 Test AUC:(0.7259880916743472, 0.0)
Epoch 17 a 0.3474279944925481 b 0.5126142734493049 c 0.3253206689832676
  2%|▏         | 18/1000 [15:02<13:38:37, 50.02s/it]Epoch 18 Valid AUC:(0.7972814962072166, 0.0)
Epoch 18 Test AUC:(0.7299782624104966, 0.0)
Epoch 18 a 0.3437622174530682 b 0.5082917772308442 c 0.318707291209242
  2%|▏         | 19/1000 [15:53<13:39:01, 50.09s/it]Epoch 19 Valid AUC:(0.7968194593413812, 0.0)
Epoch 19 Test AUC:(0.7320050780998366, 0.0)
Epoch 19 a 0.3382979830505862 b 0.504584140221118 c 0.3130986335531807
  2%|▏         | 20/1000 [16:43<13:41:13, 50.28s/it]Epoch 20 Valid AUC:(0.7990506091938352, 0.0)
Epoch 20 Test AUC:(0.7369252681222835, 0.0)
Epoch 20 a 0.33364234184115465 b 0.5028830462658189 c 0.30787703838626623
  2%|▏         | 21/1000 [17:33<13:38:51, 50.19s/it]Epoch 21 Valid AUC:(0.8023407664385713, 0.0)
Epoch 21 Test AUC:(0.7412731195088058, 0.0)
Epoch 21 a 0.3289331893326051 b 0.5009693861367477 c 0.30193456347799397
  2%|▏         | 22/1000 [18:24<13:38:21, 50.21s/it]Epoch 22 Valid AUC:(0.8019305276632792, 0.0)
Epoch 22 Test AUC:(0.7413988992462318, 0.0)
Epoch 22 a 0.3246779967121915 b 0.49843966301298237 c 0.2966956897100932
  2%|▏         | 23/1000 [19:14<13:37:36, 50.21s/it]Epoch 23 Valid AUC:(0.803180137213561, 0.0)
Epoch 23 Test AUC:(0.7428268342482538, 0.0)
Epoch 23 a 0.32157497092991527 b 0.4951857435151605 c 0.2920198079565881
  2%|▏         | 24/1000 [20:04<13:37:29, 50.26s/it]Epoch 24 Valid AUC:(0.8026580975073083, 0.0)
Epoch 24 Test AUC:(0.7431908340274862, 0.0)
Epoch 24 a 0.3190970224154068 b 0.49069204818554807 c 0.2865420273791856
  2%|▎         | 25/1000 [20:54<13:33:37, 50.07s/it]Epoch 25 Valid AUC:(0.804764648454381, 0.0)
Epoch 25 Test AUC:(0.7473677568262742, 0.0)
Epoch 25 a 0.31670962576894934 b 0.4847953894608457 c 0.2820054042327332
  3%|▎         | 26/1000 [21:45<13:36:41, 50.31s/it]Epoch 26 Valid AUC:(0.8029481729659905, 0.0)
Epoch 26 Test AUC:(0.7481254237968875, 0.0)
Epoch 26 a 0.3151888249505694 b 0.4780599151698636 c 0.27684363413984386
  3%|▎         | 27/1000 [22:35<13:35:05, 50.26s/it]Epoch 27 Valid AUC:(0.8043564550993948, 0.0)
Epoch 27 Test AUC:(0.7468902906324272, 0.0)
Epoch 27 a 0.31358050892290695 b 0.4727099868253443 c 0.27181521789648644
  3%|▎         | 28/1000 [23:25<13:32:35, 50.16s/it]Epoch 28 Valid AUC:(0.8030079079537487, 0.0)
Epoch 28 Test AUC:(0.7481805515692241, 0.0)
Epoch 28 a 0.3124078167995936 b 0.4658987159340434 c 0.26825205585966166
  3%|▎         | 29/1000 [24:16<13:34:27, 50.33s/it]Epoch 29 Valid AUC:(0.8051383772461662, 0.0)
Epoch 29 Test AUC:(0.7499482402207345, 0.0)
Epoch 29 a 0.3108455902134149 b 0.4601773785753269 c 0.26252679463843226
  3%|▎         | 30/1000 [25:06<13:32:32, 50.26s/it]Epoch 30 Valid AUC:(0.8048611830653635, 0.0)
Epoch 30 Test AUC:(0.7502268761793934, 0.0)
Epoch 30 a 0.308671278852812 b 0.455290251034846 c 0.2585832102737676
  3%|▎         | 31/1000 [25:56<13:30:46, 50.20s/it]Epoch 31 Valid AUC:(0.8068496135529488, 0.0)
Epoch 31 Test AUC:(0.7507625185480648, 0.0)
Epoch 31 a 0.30575863408370757 b 0.4523450636887694 c 0.2545067316869375
  3%|▎         | 32/1000 [26:46<13:30:17, 50.23s/it]Epoch 32 Valid AUC:(0.8039252930584915, 0.0)
Epoch 32 Test AUC:(0.7482754197358426, 0.0)
Epoch 32 a 0.30322036365987787 b 0.44755172267766063 c 0.2501046141568324
  3%|▎         | 33/1000 [27:36<13:27:19, 50.09s/it]Epoch 33 Valid AUC:(0.80363885475697, 0.0)
Epoch 33 Test AUC:(0.7514512522882312, 0.0)
Epoch 33 a 0.3007820452482887 b 0.4423027780334235 c 0.24529471822547722
  3%|▎         | 34/1000 [28:25<13:23:30, 49.91s/it]Epoch 34 Valid AUC:(0.8014669759560894, 0.0)
Epoch 34 Test AUC:(0.7521499906031818, 0.0)
Epoch 34 a 0.2988373897145212 b 0.4395770006616351 c 0.24218964525751424
  4%|▎         | 35/1000 [29:15<13:21:08, 49.81s/it]Epoch 35 Valid AUC:(0.8054859564415083, 0.0)
Epoch 35 Test AUC:(0.7581094763764178, 0.0)
Epoch 35 a 0.29604920454068445 b 0.43379691453047203 c 0.23809211372849448
  4%|▎         | 36/1000 [30:05<13:22:51, 49.97s/it]Epoch 36 Valid AUC:(0.8042111008169112, 0.0)
Epoch 36 Test AUC:(0.7557922629398582, 0.0)
Epoch 36 a 0.2939613073824397 b 0.4280111605612565 c 0.23438603315554873
  4%|▎         | 37/1000 [30:56<13:24:41, 50.14s/it]  4%|▎         | 37/1000 [31:45<13:46:41, 51.51s/it]
[32m[I 2021-05-14 19:45:01,897][0m Trial 88 finished with value: 0.8068496135529488 and parameters: {'rank': 35.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.13827889525163906, 'gamma': 0.003170674164446572}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 19:45:02.563429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.779421689653329, 0.0)
Epoch 0 Test AUC:(0.7229632042128803, 0.0)
Epoch 0 a 0.4246171376175084 b 0.5145018107634435 c 0.4216929902013399
  0%|          | 1/1000 [01:31<25:18:51, 91.22s/it]Epoch 1 Valid AUC:(0.7854103637561118, 0.0)
Epoch 1 Test AUC:(0.7262506433550839, 0.0)
Epoch 1 a 0.37393767720976584 b 0.5096528487546104 c 0.37402347671673813
  0%|          | 2/1000 [03:02<25:17:14, 91.22s/it]Epoch 2 Valid AUC:(0.7860030076290794, 0.0)
Epoch 2 Test AUC:(0.7285809824517235, 0.0)
Epoch 2 a 0.3702052252093551 b 0.5044130214623043 c 0.37058755095815754
  0%|          | 3/1000 [04:32<25:08:49, 90.80s/it]Epoch 3 Valid AUC:(0.7875079909803834, 0.0)
Epoch 3 Test AUC:(0.7275023610262058, 0.0)
Epoch 3 a 0.36906688227140205 b 0.4993298812891156 c 0.3694331917904272
  0%|          | 4/1000 [06:04<25:11:10, 91.03s/it]Epoch 4 Valid AUC:(0.7875262485353202, 0.0)
Epoch 4 Test AUC:(0.7290291831265971, 0.0)
Epoch 4 a 0.3686434521941352 b 0.4963331723537004 c 0.3690965027516517
  0%|          | 5/1000 [07:35<25:12:18, 91.19s/it]Epoch 5 Valid AUC:(0.7824319703458963, 0.0)
Epoch 5 Test AUC:(0.7262426610725531, 0.0)
Epoch 5 a 0.3680763819387981 b 0.4937586853621711 c 0.36845788140771857
  1%|          | 6/1000 [09:05<25:04:52, 90.84s/it]Epoch 6 Valid AUC:(0.7865842466177719, 0.0)
Epoch 6 Test AUC:(0.7277437748361164, 0.0)
Epoch 6 a 0.3674961688892702 b 0.4922856494214693 c 0.3679148854024453
  1%|          | 7/1000 [10:36<25:05:27, 90.96s/it]Epoch 7 Valid AUC:(0.7895159362643341, 0.0)
Epoch 7 Test AUC:(0.7273160792640911, 0.0)
Epoch 7 a 0.3674274520195226 b 0.49158108174441084 c 0.36781374564473057
  1%|          | 8/1000 [12:09<25:13:23, 91.54s/it]Epoch 8 Valid AUC:(0.7905610512029091, 0.0)
Epoch 8 Test AUC:(0.7287271091000035, 0.0)
Epoch 8 a 0.3667392485458366 b 0.4906814742076325 c 0.36709576776209973
  1%|          | 9/1000 [13:42<25:16:00, 91.79s/it]Epoch 9 Valid AUC:(0.7884135316149082, 0.0)
Epoch 9 Test AUC:(0.728391053722818, 0.0)
Epoch 9 a 0.3666418550659713 b 0.49023478902441636 c 0.36704384734932805
  1%|          | 10/1000 [15:13<25:10:37, 91.55s/it]Epoch 10 Valid AUC:(0.7922705765848116, 0.0)
Epoch 10 Test AUC:(0.7282478343868685, 0.0)
Epoch 10 a 0.3654571070637501 b 0.4899781800251851 c 0.365754218498466
  1%|          | 11/1000 [16:44<25:07:05, 91.43s/it]Epoch 11 Valid AUC:(0.7938722137351235, 0.0)
Epoch 11 Test AUC:(0.7292538371360144, 0.0)
Epoch 11 a 0.36535192597320143 b 0.4899020851018203 c 0.365718650356145
  1%|          | 12/1000 [18:15<25:04:02, 91.34s/it]Epoch 12 Valid AUC:(0.7914289553348488, 0.0)
Epoch 12 Test AUC:(0.7292831112059066, 0.0)
Epoch 12 a 0.36524040547295117 b 0.49061545285900354 c 0.365688723997331
  1%|▏         | 13/1000 [19:46<25:01:41, 91.29s/it]Epoch 13 Valid AUC:(0.7919145299133031, 0.0)
Epoch 13 Test AUC:(0.7291848654264337, 0.0)
Epoch 13 a 0.3647246359879342 b 0.4907860546344723 c 0.36513168603121876
  1%|▏         | 14/1000 [21:17<24:59:52, 91.27s/it]Epoch 14 Valid AUC:(0.7896337388890873, 0.0)
Epoch 14 Test AUC:(0.7285068117836224, 0.0)
Epoch 14 a 0.3640888278153341 b 0.49122899180087043 c 0.3645595894972803
  2%|▏         | 15/1000 [22:49<24:59:12, 91.32s/it]Epoch 15 Valid AUC:(0.7903006420282137, 0.0)
Epoch 15 Test AUC:(0.7288517857689276, 0.0)
Epoch 15 a 0.36380234000908296 b 0.4914185429362944 c 0.3643146108993342
  2%|▏         | 16/1000 [24:20<24:57:22, 91.30s/it]Epoch 16 Valid AUC:(0.7861792316101284, 0.0)
Epoch 16 Test AUC:(0.7271816973025345, 0.0)
Epoch 16 a 0.3633986646140845 b 0.49136230754300625 c 0.3639698451613516
  2%|▏         | 17/1000 [25:51<24:55:34, 91.29s/it]  2%|▏         | 17/1000 [27:22<26:23:20, 96.64s/it]
[32m[I 2021-05-14 20:12:44,379][0m Trial 89 finished with value: 0.7938722137351235 and parameters: {'rank': 40.0, 'lambda': 0.0001, 'batch_size': 256, 'learning_rate': 0.001, 'alpha': 0.1339980305333668, 'gamma': 0.0022840568193662892}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 20:12:45.045583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.49556160454292875, 0.0)
Epoch 0 Test AUC:(0.49933742993307806, 0.0)
Epoch 0 a 0.5071078185704153 b 0.43549750778276913 c 0.435121457041869
  0%|          | 1/1000 [00:50<13:56:34, 50.24s/it]Epoch 1 Valid AUC:(0.5069878004058564, 0.0)
Epoch 1 Test AUC:(0.5038590488123161, 0.0)
Epoch 1 a 0.5015345534208555 b 0.3816943718513972 c 0.38169435853929345
  0%|          | 2/1000 [01:40<13:59:07, 50.45s/it]Epoch 2 Valid AUC:(0.4989874567137287, 0.0)
Epoch 2 Test AUC:(0.49972926295241527, 0.0)
Epoch 2 a 0.501518614874999 b 0.37288969773162056 c 0.3728896744054568
  0%|          | 3/1000 [02:31<13:58:30, 50.46s/it]Epoch 3 Valid AUC:(0.4985274447627326, 0.0)
Epoch 3 Test AUC:(0.5018725336024273, 0.0)
Epoch 3 a 0.5015344113651176 b 0.3690929397850689 c 0.3690929222154905
  0%|          | 4/1000 [03:24<14:17:27, 51.65s/it]Epoch 4 Valid AUC:(0.49552761801342093, 0.0)
Epoch 4 Test AUC:(0.5003269294092895, 0.0)
Epoch 4 a 0.5015671012746976 b 0.36791486057717077 c 0.3679147692513418
  0%|          | 5/1000 [04:15<14:13:52, 51.49s/it]Epoch 5 Valid AUC:(0.5043465783850276, 0.0)
Epoch 5 Test AUC:(0.5044470912102845, 0.0)
Epoch 5 a 0.5015118336773494 b 0.3660940858919616 c 0.366093975437479
  1%|          | 6/1000 [05:06<14:08:30, 51.22s/it]Epoch 6 Valid AUC:(0.49532384493782466, 0.0)
Epoch 6 Test AUC:(0.49865087240170025, 0.0)
Epoch 6 a 0.5016313531629036 b 0.3653633008060801 c 0.3653631793181421
  1%|          | 7/1000 [05:57<14:03:33, 50.97s/it]  1%|          | 7/1000 [06:48<16:05:23, 58.33s/it]
[32m[I 2021-05-14 20:19:52,212][0m Trial 90 finished with value: 0.5069878004058564 and parameters: {'rank': 45.0, 'lambda': 0.01, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.11732311632337523, 'gamma': 0.002711121040023162}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 20:19:52.976052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807369692423946, 0.0)
Epoch 0 Test AUC:(0.7200576875753344, 0.0)
Epoch 0 a 0.4133364487461881 b 0.501700271423194 c 0.4144953735757402
  0%|          | 1/1000 [00:50<14:04:10, 50.70s/it]Epoch 1 Valid AUC:(0.7797947725229124, 0.0)
Epoch 1 Test AUC:(0.7225620848959229, 0.0)
Epoch 1 a 0.3856698092320555 b 0.48722304796548915 c 0.3864872905929803
  0%|          | 2/1000 [01:41<14:03:17, 50.70s/it]Epoch 2 Valid AUC:(0.7760115113486583, 0.0)
Epoch 2 Test AUC:(0.7244369977914559, 0.0)
Epoch 2 a 0.3813566439588305 b 0.49223002509571895 c 0.382535408260357
  0%|          | 3/1000 [02:32<14:01:54, 50.67s/it]Epoch 3 Valid AUC:(0.7825049211069597, 0.0)
Epoch 3 Test AUC:(0.7258451758960087, 0.0)
Epoch 3 a 0.37638398231395054 b 0.49574426230290525 c 0.37862495853147754
  0%|          | 4/1000 [03:22<13:58:19, 50.50s/it]Epoch 4 Valid AUC:(0.7850193527006509, 0.0)
Epoch 4 Test AUC:(0.7277818734540233, 0.0)
Epoch 4 a 0.37233754836577526 b 0.5000600026287063 c 0.3749535649834984
  0%|          | 5/1000 [04:13<13:59:22, 50.62s/it]Epoch 5 Valid AUC:(0.7833861986479802, 0.0)
Epoch 5 Test AUC:(0.7262731493728891, 0.0)
Epoch 5 a 0.369649482984658 b 0.5022232206894358 c 0.3724392415052448
  1%|          | 6/1000 [05:03<13:59:08, 50.65s/it]Epoch 6 Valid AUC:(0.7865252857113827, 0.0)
Epoch 6 Test AUC:(0.7270454939953119, 0.0)
Epoch 6 a 0.3677118312664915 b 0.5044739850210233 c 0.3705485219686804
  1%|          | 7/1000 [05:55<14:01:24, 50.84s/it]Epoch 7 Valid AUC:(0.7890272948370126, 0.0)
Epoch 7 Test AUC:(0.7272538414029229, 0.0)
Epoch 7 a 0.3662823142420118 b 0.5034587843797097 c 0.36858127198708607
  1%|          | 8/1000 [06:45<13:59:04, 50.75s/it]Epoch 8 Valid AUC:(0.7915695254356269, 0.0)
Epoch 8 Test AUC:(0.7276193589702101, 0.0)
Epoch 8 a 0.3638075045056986 b 0.503689805026985 c 0.3655711382447594
  1%|          | 9/1000 [07:35<13:55:01, 50.56s/it]Epoch 9 Valid AUC:(0.7908872265357636, 0.0)
Epoch 9 Test AUC:(0.7285429736184622, 0.0)
Epoch 9 a 0.3612796641451492 b 0.5052519847809429 c 0.3628158663480095
  1%|          | 10/1000 [08:26<13:53:02, 50.49s/it]Epoch 10 Valid AUC:(0.7921390199182516, 0.0)
Epoch 10 Test AUC:(0.7280731305685639, 0.0)
Epoch 10 a 0.3580516590558787 b 0.5085958832466386 c 0.3590611062898962
  1%|          | 11/1000 [09:16<13:53:08, 50.54s/it]Epoch 11 Valid AUC:(0.7925898825863127, 0.0)
Epoch 11 Test AUC:(0.7268578996671893, 0.0)
Epoch 11 a 0.35653468384829085 b 0.5084041577709513 c 0.35706720253831187
  1%|          | 12/1000 [10:07<13:52:45, 50.57s/it]Epoch 12 Valid AUC:(0.7933074790839626, 0.0)
Epoch 12 Test AUC:(0.7254248597667518, 0.0)
Epoch 12 a 0.3553606696891593 b 0.5101843346772299 c 0.35472421758851297
  1%|▏         | 13/1000 [10:58<13:54:40, 50.74s/it]Epoch 13 Valid AUC:(0.7936770324500857, 0.0)
Epoch 13 Test AUC:(0.7242726790638141, 0.0)
Epoch 13 a 0.35403192810849166 b 0.507418950258846 c 0.3514956075780588
  1%|▏         | 14/1000 [11:48<13:50:46, 50.55s/it]Epoch 14 Valid AUC:(0.7949098608390349, 0.0)
Epoch 14 Test AUC:(0.7256502919097634, 0.0)
Epoch 14 a 0.3526893207125021 b 0.5020346296145403 c 0.34719821438942877
  2%|▏         | 15/1000 [12:38<13:49:01, 50.50s/it]Epoch 15 Valid AUC:(0.7934503368258723, 0.0)
Epoch 15 Test AUC:(0.7227947810443014, 0.0)
Epoch 15 a 0.35149517475479325 b 0.49703362698046494 c 0.34186202851339603
  2%|▏         | 16/1000 [13:29<13:49:02, 50.55s/it]Epoch 16 Valid AUC:(0.7920856711017872, 0.0)
Epoch 16 Test AUC:(0.7232591814344986, 0.0)
Epoch 16 a 0.3503505703309172 b 0.4918455402975831 c 0.33735218901989206
  2%|▏         | 17/1000 [14:19<13:46:39, 50.46s/it]Epoch 17 Valid AUC:(0.793709165798038, 0.0)
Epoch 17 Test AUC:(0.7257588458216314, 0.0)
Epoch 17 a 0.3492264040039339 b 0.487280741963588 c 0.33323924222462614
  2%|▏         | 18/1000 [15:10<13:44:21, 50.37s/it]Epoch 18 Valid AUC:(0.796375476257407, 0.0)
Epoch 18 Test AUC:(0.7260535147527011, 0.0)
Epoch 18 a 0.34703311707891926 b 0.48068276329539433 c 0.32806532033972097
  2%|▏         | 19/1000 [16:00<13:43:55, 50.39s/it]Epoch 19 Valid AUC:(0.7950048049947543, 0.0)
Epoch 19 Test AUC:(0.7272297064351207, 0.0)
Epoch 19 a 0.34450091898321383 b 0.47440280946687435 c 0.32322532688108246
  2%|▏         | 20/1000 [16:50<13:42:23, 50.35s/it]Epoch 20 Valid AUC:(0.7970021527971825, 0.0)
Epoch 20 Test AUC:(0.7314329275841215, 0.0)
Epoch 20 a 0.3407941078036364 b 0.47394759110521745 c 0.31857202944141516
  2%|▏         | 21/1000 [17:41<13:41:56, 50.37s/it]Epoch 21 Valid AUC:(0.8010161645516952, 0.0)
Epoch 21 Test AUC:(0.7365528285863743, 0.0)
Epoch 21 a 0.3365348674641768 b 0.4731680288521097 c 0.3127761308695949
  2%|▏         | 22/1000 [18:32<13:45:17, 50.63s/it]Epoch 22 Valid AUC:(0.7992907294907962, 0.0)
Epoch 22 Test AUC:(0.7367161083774038, 0.0)
Epoch 22 a 0.33241853657622694 b 0.47250100904307374 c 0.3075179681931463
  2%|▏         | 23/1000 [19:23<13:44:49, 50.65s/it]Epoch 23 Valid AUC:(0.8003485796058001, 0.0)
Epoch 23 Test AUC:(0.7369011930109118, 0.0)
Epoch 23 a 0.3291037795649208 b 0.47106166396822247 c 0.3027593608593317
  2%|▏         | 24/1000 [20:13<13:41:52, 50.53s/it]Epoch 24 Valid AUC:(0.7994523266661107, 0.0)
Epoch 24 Test AUC:(0.7386930679357359, 0.0)
Epoch 24 a 0.32602970257131625 b 0.46940483689548024 c 0.2978253323187531
  2%|▎         | 25/1000 [21:03<13:38:34, 50.37s/it]Epoch 25 Valid AUC:(0.801817574581407, 0.0)
Epoch 25 Test AUC:(0.7419947956629518, 0.0)
Epoch 25 a 0.32341438064153044 b 0.46476905710500493 c 0.29380058627613115
  3%|▎         | 26/1000 [21:53<13:36:24, 50.29s/it]Epoch 26 Valid AUC:(0.8003440440528784, 0.0)
Epoch 26 Test AUC:(0.7420682737066449, 0.0)
Epoch 26 a 0.3213937160234816 b 0.4611988426813897 c 0.289427830299861
  3%|▎         | 27/1000 [22:43<13:35:47, 50.31s/it]Epoch 27 Valid AUC:(0.8017338123130119, 0.0)
Epoch 27 Test AUC:(0.7419604380719408, 0.0)
Epoch 27 a 0.3191426204483754 b 0.45564681915210287 c 0.2841514569652872
  3%|▎         | 28/1000 [23:34<13:36:23, 50.39s/it]Epoch 28 Valid AUC:(0.8006356907429485, 0.0)
Epoch 28 Test AUC:(0.7431205668537347, 0.0)
Epoch 28 a 0.31756407256337477 b 0.4488925341988953 c 0.28060762997964017
  3%|▎         | 29/1000 [24:24<13:34:53, 50.35s/it]Epoch 29 Valid AUC:(0.8024294295135141, 0.0)
Epoch 29 Test AUC:(0.7454273909241721, 0.0)
Epoch 29 a 0.3158700407390863 b 0.4411979747610073 c 0.2754323000999044
  3%|▎         | 30/1000 [25:15<13:34:25, 50.38s/it]Epoch 30 Valid AUC:(0.8032560663936664, 0.0)
Epoch 30 Test AUC:(0.7436311464799338, 0.0)
Epoch 30 a 0.31424561292832526 b 0.4347467682730984 c 0.2709378987790593
  3%|▎         | 31/1000 [26:05<13:34:40, 50.44s/it]Epoch 31 Valid AUC:(0.8042304374720344, 0.0)
Epoch 31 Test AUC:(0.7447786968604392, 0.0)
Epoch 31 a 0.31251580470524565 b 0.42715033127268554 c 0.26604016958707777
  3%|▎         | 32/1000 [26:55<13:32:24, 50.36s/it]Epoch 32 Valid AUC:(0.8023075898749993, 0.0)
Epoch 32 Test AUC:(0.7431715859096749, 0.0)
Epoch 32 a 0.31128812465869204 b 0.41855376635039115 c 0.2615844956646023
  3%|▎         | 33/1000 [27:46<13:32:46, 50.43s/it]Epoch 33 Valid AUC:(0.8028140864374731, 0.0)
Epoch 33 Test AUC:(0.7454397427261172, 0.0)
Epoch 33 a 0.3099155231740633 b 0.4121093683439481 c 0.25808310361815173
  3%|▎         | 34/1000 [28:36<13:32:20, 50.46s/it]Epoch 34 Valid AUC:(0.8015519582997548, 0.0)
Epoch 34 Test AUC:(0.7457606073963762, 0.0)
Epoch 34 a 0.30894317785259223 b 0.4042170009982418 c 0.25362822401451635
  4%|▎         | 35/1000 [29:27<13:30:21, 50.38s/it]Epoch 35 Valid AUC:(0.8050341723090363, 0.0)
Epoch 35 Test AUC:(0.7525688017707618, 0.0)
Epoch 35 a 0.3056790025781098 b 0.3981573467163493 c 0.24907383733472113
  4%|▎         | 36/1000 [30:17<13:29:28, 50.38s/it]Epoch 36 Valid AUC:(0.8040165398222417, 0.0)
Epoch 36 Test AUC:(0.7526274140424357, 0.0)
Epoch 36 a 0.30167417962786175 b 0.39452232429439155 c 0.24640873053544005
  4%|▎         | 37/1000 [31:07<13:26:37, 50.26s/it]Epoch 37 Valid AUC:(0.8050538396148106, 0.0)
Epoch 37 Test AUC:(0.753914211857192, 0.0)
Epoch 37 a 0.2980441937384231 b 0.38674912006562384 c 0.24246426304461252
  4%|▍         | 38/1000 [31:58<13:27:02, 50.33s/it]Epoch 38 Valid AUC:(0.8070100662669016, 0.0)
Epoch 38 Test AUC:(0.7567431379166676, 0.0)
Epoch 38 a 0.29495124153088276 b 0.381368401604639 c 0.23875390562852863
  4%|▍         | 39/1000 [32:48<13:27:17, 50.40s/it]Epoch 39 Valid AUC:(0.80513625493036, 0.0)
Epoch 39 Test AUC:(0.756055148106421, 0.0)
Epoch 39 a 0.29170583653258125 b 0.37455638151773263 c 0.23472413975348175
  4%|▍         | 40/1000 [33:38<13:25:24, 50.34s/it]Epoch 40 Valid AUC:(0.80768270965512, 0.0)
Epoch 40 Test AUC:(0.7586346011151878, 0.0)
Epoch 40 a 0.2898303104238491 b 0.36930715486077476 c 0.23119624354829732
  4%|▍         | 41/1000 [34:30<13:28:52, 50.61s/it]Epoch 41 Valid AUC:(0.8042048325520511, 0.0)
Epoch 41 Test AUC:(0.755622826487423, 0.0)
Epoch 41 a 0.2880543427508122 b 0.36295861539466523 c 0.22824523332613095
  4%|▍         | 42/1000 [35:20<13:27:56, 50.60s/it]Epoch 42 Valid AUC:(0.8049772350358947, 0.0)
Epoch 42 Test AUC:(0.7599262729535569, 0.0)
Epoch 42 a 0.28608468648653396 b 0.35931836791201616 c 0.22445813073238857
  4%|▍         | 43/1000 [36:10<13:25:21, 50.49s/it]2021-05-14 20:57:04.108763: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 130696653 get requests, put_count=130696653 evicted_count=85000 eviction_rate=0.000650361 and unsatisfied allocation rate=0.00065046
Epoch 43 Valid AUC:(0.8056742017524259, 0.0)
Epoch 43 Test AUC:(0.7592801527163282, 0.0)
Epoch 43 a 0.2849290710639666 b 0.35162401151369277 c 0.221616924708518
  4%|▍         | 44/1000 [37:01<13:24:07, 50.47s/it]Epoch 44 Valid AUC:(0.8056512228137753, 0.0)
Epoch 44 Test AUC:(0.7588691912920403, 0.0)
Epoch 44 a 0.28374977041058375 b 0.3474056805883135 c 0.22063960152972392
  4%|▍         | 45/1000 [37:51<13:23:37, 50.49s/it]Epoch 45 Valid AUC:(0.803008851205218, 0.0)
Epoch 45 Test AUC:(0.7575029554433136, 0.0)
Epoch 45 a 0.2823899879122164 b 0.34361225384581734 c 0.21765558061825196
  5%|▍         | 46/1000 [38:42<13:22:12, 50.45s/it]  5%|▍         | 46/1000 [39:32<13:40:02, 51.57s/it]
[32m[I 2021-05-14 20:59:44,551][0m Trial 91 finished with value: 0.80768270965512 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12874831363329123, 'gamma': 0.002576855077135807}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 20:59:45.217502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7793968229301479, 0.0)
Epoch 0 Test AUC:(0.7201475106999675, 0.0)
Epoch 0 a 0.4129874146200522 b 0.5016847074751403 c 0.41422023289880044
  0%|          | 1/1000 [00:49<13:46:01, 49.61s/it]Epoch 1 Valid AUC:(0.7797005947590119, 0.0)
Epoch 1 Test AUC:(0.722263696315254, 0.0)
Epoch 1 a 0.38594781422998825 b 0.4876402850961781 c 0.3869902892731565
  0%|          | 2/1000 [01:40<13:56:02, 50.26s/it]Epoch 2 Valid AUC:(0.775260416607927, 0.0)
Epoch 2 Test AUC:(0.7245687033154848, 0.0)
Epoch 2 a 0.3817306153131443 b 0.49310496503438506 c 0.3828645988369372
  0%|          | 3/1000 [02:30<13:56:14, 50.33s/it]Epoch 3 Valid AUC:(0.7820905004980471, 0.0)
Epoch 3 Test AUC:(0.7252236566516469, 0.0)
Epoch 3 a 0.3776145417925338 b 0.49845203691325196 c 0.37970349396498393
  0%|          | 4/1000 [03:21<13:58:02, 50.48s/it]Epoch 4 Valid AUC:(0.7841631635981705, 0.0)
Epoch 4 Test AUC:(0.728088851432445, 0.0)
Epoch 4 a 0.3741558900541463 b 0.5031693225775207 c 0.3765573303104646
  0%|          | 5/1000 [04:11<13:56:26, 50.44s/it]Epoch 5 Valid AUC:(0.7803458274645834, 0.0)
Epoch 5 Test AUC:(0.7254010411829386, 0.0)
Epoch 5 a 0.3708728125517517 b 0.5032180240696345 c 0.37314614623605125
  1%|          | 6/1000 [05:02<13:55:39, 50.44s/it]Epoch 6 Valid AUC:(0.7872034066224004, 0.0)
Epoch 6 Test AUC:(0.7265246062367177, 0.0)
Epoch 6 a 0.36769203682780505 b 0.5050788163779008 c 0.36971270624300845
  1%|          | 7/1000 [05:52<13:53:10, 50.34s/it]Epoch 7 Valid AUC:(0.7893022487955755, 0.0)
Epoch 7 Test AUC:(0.7256622503694521, 0.0)
Epoch 7 a 0.36413398349069254 b 0.5074273313674889 c 0.3657825033309714
  1%|          | 8/1000 [06:42<13:51:51, 50.31s/it]Epoch 8 Valid AUC:(0.792810275342691, 0.0)
Epoch 8 Test AUC:(0.7267550449425808, 0.0)
Epoch 8 a 0.3612672585836599 b 0.5105741145145485 c 0.3624156989322102
  1%|          | 9/1000 [07:33<13:53:19, 50.45s/it]Epoch 9 Valid AUC:(0.7908845864569225, 0.0)
Epoch 9 Test AUC:(0.724911287319036, 0.0)
Epoch 9 a 0.3595594046581199 b 0.5121214393998536 c 0.360418818966004
  1%|          | 10/1000 [08:24<13:53:49, 50.53s/it]Epoch 10 Valid AUC:(0.7933913041503495, 0.0)
Epoch 10 Test AUC:(0.7255033657505926, 0.0)
Epoch 10 a 0.35690642038821213 b 0.5145132003775544 c 0.3572335233031144
  1%|          | 11/1000 [09:14<13:52:08, 50.48s/it]Epoch 11 Valid AUC:(0.7928114800388611, 0.0)
Epoch 11 Test AUC:(0.7246288376506729, 0.0)
Epoch 11 a 0.3556103881456003 b 0.5151762092257409 c 0.35541541667531434
  1%|          | 12/1000 [10:04<13:48:15, 50.30s/it]Epoch 12 Valid AUC:(0.794052506769726, 0.0)
Epoch 12 Test AUC:(0.7246347164072234, 0.0)
Epoch 12 a 0.3544706109783779 b 0.5161095835433399 c 0.35291189111214527
  1%|▏         | 13/1000 [10:55<13:49:11, 50.41s/it]Epoch 13 Valid AUC:(0.7949156626045268, 0.0)
Epoch 13 Test AUC:(0.7239512671347637, 0.0)
Epoch 13 a 0.3528625987904892 b 0.5130436880967507 c 0.34889455850215506
  1%|▏         | 14/1000 [11:45<13:48:31, 50.42s/it]Epoch 14 Valid AUC:(0.7952166508162827, 0.0)
Epoch 14 Test AUC:(0.7234520431284905, 0.0)
Epoch 14 a 0.3513214586965995 b 0.511748948267528 c 0.34418757370779934
  2%|▏         | 15/1000 [12:36<13:48:31, 50.47s/it]Epoch 15 Valid AUC:(0.7931801580778733, 0.0)
Epoch 15 Test AUC:(0.7220951491583552, 0.0)
Epoch 15 a 0.35005839010119677 b 0.5095770141968066 c 0.3392212465255553
  2%|▏         | 16/1000 [13:26<13:46:58, 50.43s/it]Epoch 16 Valid AUC:(0.7917185232832296, 0.0)
Epoch 16 Test AUC:(0.7216657733308213, 0.0)
Epoch 16 a 0.34871303669403736 b 0.5062881276401235 c 0.33419913185434325
  2%|▏         | 17/1000 [14:16<13:46:45, 50.46s/it]Epoch 17 Valid AUC:(0.7922034019574068, 0.0)
Epoch 17 Test AUC:(0.7234641683310923, 0.0)
Epoch 17 a 0.3475563641884917 b 0.504197001277321 c 0.3293894733221718
  2%|▏         | 18/1000 [15:07<13:44:53, 50.40s/it]Epoch 18 Valid AUC:(0.7950399270144821, 0.0)
Epoch 18 Test AUC:(0.72244662611727, 0.0)
Epoch 18 a 0.34571815862262273 b 0.4985492304417209 c 0.3238069892409342
  2%|▏         | 19/1000 [15:57<13:44:54, 50.45s/it]Epoch 19 Valid AUC:(0.7934000561398667, 0.0)
Epoch 19 Test AUC:(0.7220836438973532, 0.0)
Epoch 19 a 0.3437884962654689 b 0.4920538343654072 c 0.3188783623562972
  2%|▏         | 20/1000 [16:48<13:44:12, 50.46s/it]  2%|▏         | 20/1000 [17:39<14:24:58, 52.96s/it]
[32m[I 2021-05-14 21:17:43,998][0m Trial 92 finished with value: 0.7952166508162827 and parameters: {'rank': 55.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12447299650457849, 'gamma': 0.0025742402577441153}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 21:17:44.670075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7807291464068383, 0.0)
Epoch 0 Test AUC:(0.7200576790244158, 0.0)
Epoch 0 a 0.41333664638895384 b 0.5021463910218935 c 0.4145035962583553
  0%|          | 1/1000 [00:50<13:53:25, 50.06s/it]Epoch 1 Valid AUC:(0.7798212361093149, 0.0)
Epoch 1 Test AUC:(0.7225644449494617, 0.0)
Epoch 1 a 0.38566877106785535 b 0.4878405067522521 c 0.38650271998085006
  0%|          | 2/1000 [01:39<13:47:56, 49.78s/it]Epoch 2 Valid AUC:(0.7760133683749887, 0.0)
Epoch 2 Test AUC:(0.7244395887197974, 0.0)
Epoch 2 a 0.3813544559166945 b 0.49293567327186616 c 0.3825525386592512
  0%|          | 3/1000 [02:29<13:48:14, 49.84s/it]Epoch 3 Valid AUC:(0.7823582109004887, 0.0)
Epoch 3 Test AUC:(0.7258061195752166, 0.0)
Epoch 3 a 0.37638217804417523 b 0.496476800628831 c 0.37864587808278966
  0%|          | 4/1000 [03:19<13:49:08, 49.95s/it]Epoch 4 Valid AUC:(0.7848934029976491, 0.0)
Epoch 4 Test AUC:(0.7277620096700714, 0.0)
Epoch 4 a 0.3723386946458452 b 0.5007418061286151 c 0.37495595318690633
  0%|          | 5/1000 [04:09<13:48:29, 49.96s/it]Epoch 5 Valid AUC:(0.7833421939163848, 0.0)
Epoch 5 Test AUC:(0.7263124750476179, 0.0)
Epoch 5 a 0.3696459649314343 b 0.5029414498230341 c 0.3724440164129499
  1%|          | 6/1000 [04:59<13:49:03, 50.04s/it]Epoch 6 Valid AUC:(0.7866232633945861, 0.0)
Epoch 6 Test AUC:(0.7271278094133976, 0.0)
Epoch 6 a 0.36772750021226447 b 0.5052422576507093 c 0.3705591576200136
  1%|          | 7/1000 [05:49<13:48:42, 50.07s/it]Epoch 7 Valid AUC:(0.7889525780426273, 0.0)
Epoch 7 Test AUC:(0.7272820808116621, 0.0)
Epoch 7 a 0.3662727885323031 b 0.5046001609782098 c 0.3686060698579255
  1%|          | 8/1000 [06:39<13:46:45, 50.01s/it]Epoch 8 Valid AUC:(0.791485287696722, 0.0)
Epoch 8 Test AUC:(0.7275411907476547, 0.0)
Epoch 8 a 0.36379651818237074 b 0.5051815130221292 c 0.3655842146883068
  1%|          | 9/1000 [07:29<13:45:38, 49.99s/it]Epoch 9 Valid AUC:(0.7907980546689276, 0.0)
Epoch 9 Test AUC:(0.7285052170373001, 0.0)
Epoch 9 a 0.3612846173271087 b 0.5070972548763997 c 0.3628392380248133
  1%|          | 10/1000 [08:19<13:45:38, 50.04s/it]Epoch 10 Valid AUC:(0.7920669508922574, 0.0)
Epoch 10 Test AUC:(0.7280533950483913, 0.0)
Epoch 10 a 0.3580642849866533 b 0.5108282167307088 c 0.35907947261568524
  1%|          | 11/1000 [09:10<13:44:56, 50.05s/it]Epoch 11 Valid AUC:(0.7927288391631776, 0.0)
Epoch 11 Test AUC:(0.726808398399304, 0.0)
Epoch 11 a 0.35655527569398554 b 0.5112072292348029 c 0.3571063073827947
  1%|          | 12/1000 [10:00<13:43:52, 50.03s/it]Epoch 12 Valid AUC:(0.7933051978507892, 0.0)
Epoch 12 Test AUC:(0.7254016354717826, 0.0)
Epoch 12 a 0.3554127278102476 b 0.5132795692209746 c 0.3548519752275056
  1%|▏         | 13/1000 [10:49<13:42:11, 49.98s/it]Epoch 13 Valid AUC:(0.7933743384398165, 0.0)
Epoch 13 Test AUC:(0.724058431522356, 0.0)
Epoch 13 a 0.3540578808942791 b 0.5108091689091573 c 0.3517483905167647
  1%|▏         | 14/1000 [11:40<13:42:06, 50.03s/it]Epoch 14 Valid AUC:(0.7951719053247017, 0.0)
Epoch 14 Test AUC:(0.7258852155724421, 0.0)
Epoch 14 a 0.3527763388166485 b 0.5059305162017255 c 0.3475778890807384
  2%|▏         | 15/1000 [12:30<13:41:45, 50.06s/it]Epoch 15 Valid AUC:(0.7933352383595438, 0.0)
Epoch 15 Test AUC:(0.7228014251080683, 0.0)
Epoch 15 a 0.35163088067916315 b 0.500795823707427 c 0.3422803748661364
  2%|▏         | 16/1000 [13:20<13:40:05, 50.01s/it]Epoch 16 Valid AUC:(0.792376984578023, 0.0)
Epoch 16 Test AUC:(0.7231476646293291, 0.0)
Epoch 16 a 0.3505121653588485 b 0.49590531597195014 c 0.3376682984756992
  2%|▏         | 17/1000 [14:10<13:39:46, 50.04s/it]Epoch 17 Valid AUC:(0.7940008483726749, 0.0)
Epoch 17 Test AUC:(0.7261404134631666, 0.0)
Epoch 17 a 0.3494815597951532 b 0.49189497335575955 c 0.3335397236304024
  2%|▏         | 18/1000 [15:00<13:38:49, 50.03s/it]Epoch 18 Valid AUC:(0.796325485211119, 0.0)
Epoch 18 Test AUC:(0.7258328753995753, 0.0)
Epoch 18 a 0.34725307824626056 b 0.4861536028999198 c 0.32841429707989606
  2%|▏         | 19/1000 [15:50<13:37:31, 50.00s/it]Epoch 19 Valid AUC:(0.7953400693757354, 0.0)
Epoch 19 Test AUC:(0.7270645539929137, 0.0)
Epoch 19 a 0.3446509029184069 b 0.4803160128579053 c 0.32352917175177837
  2%|▏         | 20/1000 [16:39<13:35:39, 49.94s/it]Epoch 20 Valid AUC:(0.797273655429377, 0.0)
Epoch 20 Test AUC:(0.7315517468737917, 0.0)
Epoch 20 a 0.34090127779444457 b 0.48061044349277043 c 0.31888573114540975
  2%|▏         | 21/1000 [17:30<13:36:15, 50.03s/it]Epoch 21 Valid AUC:(0.8014973791552867, 0.0)
Epoch 21 Test AUC:(0.7366136555459704, 0.0)
Epoch 21 a 0.3365281034163546 b 0.48053462290667914 c 0.31298709773201816
  2%|▏         | 22/1000 [18:20<13:35:38, 50.04s/it]Epoch 22 Valid AUC:(0.7990010333832485, 0.0)
Epoch 22 Test AUC:(0.7368819705458564, 0.0)
Epoch 22 a 0.33234420964415645 b 0.48100919748695803 c 0.3078390677090382
  2%|▏         | 23/1000 [19:10<13:35:22, 50.07s/it]Epoch 23 Valid AUC:(0.8004867800435794, 0.0)
Epoch 23 Test AUC:(0.7370983600924285, 0.0)
Epoch 23 a 0.32901402552362896 b 0.48070721589103793 c 0.3031120738632962
  2%|▏         | 24/1000 [20:00<13:35:46, 50.15s/it]Epoch 24 Valid AUC:(0.7995808126390284, 0.0)
Epoch 24 Test AUC:(0.7386324461981866, 0.0)
Epoch 24 a 0.32599569680225443 b 0.47989205131588325 c 0.2980151872639685
  2%|▎         | 25/1000 [20:50<13:33:24, 50.06s/it]Epoch 25 Valid AUC:(0.8021495811563619, 0.0)
Epoch 25 Test AUC:(0.7421921166610036, 0.0)
Epoch 25 a 0.3232904299643918 b 0.4754532378923965 c 0.29389900910542527
  3%|▎         | 26/1000 [21:40<13:32:37, 50.06s/it]Epoch 26 Valid AUC:(0.800497673572778, 0.0)
Epoch 26 Test AUC:(0.7419317540154333, 0.0)
Epoch 26 a 0.32120070371109716 b 0.47228925622684853 c 0.2894287525827976
  3%|▎         | 27/1000 [22:30<13:32:11, 50.08s/it]Epoch 27 Valid AUC:(0.801808790552098, 0.0)
Epoch 27 Test AUC:(0.7415620849771566, 0.0)
Epoch 27 a 0.31895352669165167 b 0.4678982980174558 c 0.2840817565889186
  3%|▎         | 28/1000 [23:20<13:29:20, 49.96s/it]Epoch 28 Valid AUC:(0.8002064767213842, 0.0)
Epoch 28 Test AUC:(0.7429465684862162, 0.0)
Epoch 28 a 0.317433986325619 b 0.4614854194148925 c 0.28036884966510645
  3%|▎         | 29/1000 [24:10<13:29:55, 50.05s/it]Epoch 29 Valid AUC:(0.8022059096734601, 0.0)
Epoch 29 Test AUC:(0.7451140425113794, 0.0)
Epoch 29 a 0.3157389163970947 b 0.45378851686684896 c 0.27505851403568354
  3%|▎         | 30/1000 [25:00<13:29:01, 50.04s/it]Epoch 30 Valid AUC:(0.8029519741668849, 0.0)
Epoch 30 Test AUC:(0.742985453788636, 0.0)
Epoch 30 a 0.3140837506389234 b 0.4477255045168357 c 0.2705026083069308
  3%|▎         | 31/1000 [25:50<13:26:15, 49.92s/it]Epoch 31 Valid AUC:(0.803871135557683, 0.0)
Epoch 31 Test AUC:(0.7443418218772765, 0.0)
Epoch 31 a 0.312293010158558 b 0.44023378508191713 c 0.2653715808686596
  3%|▎         | 32/1000 [26:40<13:25:15, 49.91s/it]Epoch 32 Valid AUC:(0.8020163802076888, 0.0)
Epoch 32 Test AUC:(0.7425775065631613, 0.0)
Epoch 32 a 0.3109928875022251 b 0.43253331980714854 c 0.2611944101885771
  3%|▎         | 33/1000 [27:30<13:25:38, 49.99s/it]Epoch 33 Valid AUC:(0.8025643093472755, 0.0)
Epoch 33 Test AUC:(0.7448572071197394, 0.0)
Epoch 33 a 0.30925984647672183 b 0.42593118446453715 c 0.25724372294707076
  3%|▎         | 34/1000 [28:20<13:24:50, 49.99s/it]Epoch 34 Valid AUC:(0.8017917274405981, 0.0)
Epoch 34 Test AUC:(0.7460318297085925, 0.0)
Epoch 34 a 0.3073892510632874 b 0.4196131448270809 c 0.25351279437302104
  4%|▎         | 35/1000 [29:10<13:23:43, 49.97s/it]Epoch 35 Valid AUC:(0.8053402561292737, 0.0)
Epoch 35 Test AUC:(0.7535696012859282, 0.0)
Epoch 35 a 0.30298317138337993 b 0.4121608358753519 c 0.2493628202909435
  4%|▎         | 36/1000 [30:01<13:27:09, 50.24s/it]Epoch 36 Valid AUC:(0.8041728388975908, 0.0)
Epoch 36 Test AUC:(0.7532291849402469, 0.0)
Epoch 36 a 0.2990203973213192 b 0.40644590625580646 c 0.24570146559829442
  4%|▎         | 37/1000 [30:50<13:24:06, 50.10s/it]Epoch 37 Valid AUC:(0.8049960616175331, 0.0)
Epoch 37 Test AUC:(0.7541656815473985, 0.0)
Epoch 37 a 0.29625818852927366 b 0.3980199244900249 c 0.24197966900749707
  4%|▍         | 38/1000 [31:40<13:22:26, 50.05s/it]Epoch 38 Valid AUC:(0.8076579813438393, 0.0)
Epoch 38 Test AUC:(0.7572731024753759, 0.0)
Epoch 38 a 0.29417211926679016 b 0.39197002576150647 c 0.23807062382549346
  4%|▍         | 39/1000 [32:30<13:21:36, 50.05s/it]Epoch 39 Valid AUC:(0.8051887079142469, 0.0)
Epoch 39 Test AUC:(0.7566517585248458, 0.0)
Epoch 39 a 0.29160134800123255 b 0.38446627314421733 c 0.23411347037949554
  4%|▍         | 40/1000 [33:21<13:21:13, 50.08s/it]Epoch 40 Valid AUC:(0.8079849974008295, 0.0)
Epoch 40 Test AUC:(0.7587458784946359, 0.0)
Epoch 40 a 0.2901147379421852 b 0.37843532695376897 c 0.23046930739937174
  4%|▍         | 41/1000 [34:11<13:22:43, 50.22s/it]Epoch 41 Valid AUC:(0.8045019772703873, 0.0)
Epoch 41 Test AUC:(0.7556217789998921, 0.0)
Epoch 41 a 0.2885877902598928 b 0.37187001900653727 c 0.2276847447667803
  4%|▍         | 42/1000 [35:01<13:19:56, 50.10s/it]Epoch 42 Valid AUC:(0.8051688688751888, 0.0)
Epoch 42 Test AUC:(0.7599323783094508, 0.0)
Epoch 42 a 0.2866642239767781 b 0.3687104506032088 c 0.22394422943923076
  4%|▍         | 43/1000 [35:51<13:18:57, 50.09s/it]Epoch 43 Valid AUC:(0.8057336009631664, 0.0)
Epoch 43 Test AUC:(0.759904737465015, 0.0)
Epoch 43 a 0.2853908489647526 b 0.3607852476943187 c 0.22072643668239025
  4%|▍         | 44/1000 [36:41<13:19:12, 50.16s/it]Epoch 44 Valid AUC:(0.8054788090047624, 0.0)
Epoch 44 Test AUC:(0.7592492924510322, 0.0)
Epoch 44 a 0.2840917246862197 b 0.3569409706343108 c 0.21977605168488423
  4%|▍         | 45/1000 [37:32<13:20:25, 50.29s/it]Epoch 45 Valid AUC:(0.8030819942050321, 0.0)
Epoch 45 Test AUC:(0.7572497242638716, 0.0)
Epoch 45 a 0.28258787098544946 b 0.35319269111218826 c 0.21727550263615922
  5%|▍         | 46/1000 [38:22<13:20:06, 50.32s/it]  5%|▍         | 46/1000 [39:12<13:33:06, 51.14s/it]
[32m[I 2021-05-14 21:57:16,011][0m Trial 93 finished with value: 0.8079849974008295 and parameters: {'rank': 50.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12949353386795742, 'gamma': 0.002802775024775253}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 21:57:16.754545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7799050944970852, 0.0)
Epoch 0 Test AUC:(0.7213108289744063, 0.0)
Epoch 0 a 0.415223831382076 b 0.5028718913225101 c 0.41583596202929013
  0%|          | 1/1000 [00:49<13:41:57, 49.37s/it]Epoch 1 Valid AUC:(0.7814984525652062, 0.0)
Epoch 1 Test AUC:(0.7227605944716626, 0.0)
Epoch 1 a 0.38468246278868357 b 0.48978757852279925 c 0.3853831188659553
  0%|          | 2/1000 [01:38<13:41:14, 49.37s/it]Epoch 2 Valid AUC:(0.7752833993913526, 0.0)
Epoch 2 Test AUC:(0.7236482952617149, 0.0)
Epoch 2 a 0.3812908173446924 b 0.49630072748876913 c 0.381920921250848
  0%|          | 3/1000 [02:28<13:46:05, 49.71s/it]Epoch 3 Valid AUC:(0.7821986629902552, 0.0)
Epoch 3 Test AUC:(0.7252722258694028, 0.0)
Epoch 3 a 0.3776347136473512 b 0.5010168446261638 c 0.3789661328197725
  0%|          | 4/1000 [03:18<13:46:26, 49.79s/it]Epoch 4 Valid AUC:(0.7843927415220506, 0.0)
Epoch 4 Test AUC:(0.7276961162911935, 0.0)
Epoch 4 a 0.37407847081631485 b 0.5055657521459898 c 0.375528045583299
  0%|          | 5/1000 [04:08<13:43:27, 49.66s/it]Epoch 5 Valid AUC:(0.7804949688504531, 0.0)
Epoch 5 Test AUC:(0.7255922354477998, 0.0)
Epoch 5 a 0.37152198214885934 b 0.5084200523628796 c 0.3731586005486233
  1%|          | 6/1000 [04:57<13:42:27, 49.65s/it]Epoch 6 Valid AUC:(0.7868923797030902, 0.0)
Epoch 6 Test AUC:(0.7276209708183698, 0.0)
Epoch 6 a 0.369508100107642 b 0.510946839448192 c 0.3710202379245873
  1%|          | 7/1000 [05:47<13:42:27, 49.70s/it]Epoch 7 Valid AUC:(0.7864534268664225, 0.0)
Epoch 7 Test AUC:(0.725894745571243, 0.0)
Epoch 7 a 0.3674302734359649 b 0.5122658377681939 c 0.3686521511442465
  1%|          | 8/1000 [06:37<13:41:38, 49.70s/it]Epoch 8 Valid AUC:(0.7920240803692903, 0.0)
Epoch 8 Test AUC:(0.7273088366360209, 0.0)
Epoch 8 a 0.36408955236555823 b 0.5175500022213704 c 0.36506617908746425
  1%|          | 9/1000 [07:27<13:41:04, 49.71s/it]Epoch 9 Valid AUC:(0.7904728917934928, 0.0)
Epoch 9 Test AUC:(0.7263847602381635, 0.0)
Epoch 9 a 0.36156220623185215 b 0.5228649704029382 c 0.36209033576535504
  1%|          | 10/1000 [08:17<13:42:06, 49.82s/it]Epoch 10 Valid AUC:(0.792085022616402, 0.0)
Epoch 10 Test AUC:(0.7255487112720291, 0.0)
Epoch 10 a 0.35843606997783517 b 0.5297440461949323 c 0.35843798386259096
  1%|          | 11/1000 [09:06<13:39:07, 49.69s/it]Epoch 11 Valid AUC:(0.7928551348959305, 0.0)
Epoch 11 Test AUC:(0.7249158577850379, 0.0)
Epoch 11 a 0.35680929312043985 b 0.5317242996433611 c 0.35626717694328586
  1%|          | 12/1000 [09:56<13:38:39, 49.72s/it]Epoch 12 Valid AUC:(0.7937674256737834, 0.0)
Epoch 12 Test AUC:(0.7237500469178216, 0.0)
Epoch 12 a 0.3553016818984893 b 0.532655702210528 c 0.3537703531848593
  1%|▏         | 13/1000 [10:46<13:38:09, 49.74s/it]Epoch 13 Valid AUC:(0.7949010870624592, 0.0)
Epoch 13 Test AUC:(0.7229922431325103, 0.0)
Epoch 13 a 0.35334388099206043 b 0.5318019920791419 c 0.3509337930852019
  1%|▏         | 14/1000 [11:35<13:36:02, 49.66s/it]Epoch 14 Valid AUC:(0.7946776697497387, 0.0)
Epoch 14 Test AUC:(0.7238217036158487, 0.0)
Epoch 14 a 0.35173033006954 b 0.5305531939990084 c 0.3469127709237143
  2%|▏         | 15/1000 [12:25<13:36:50, 49.76s/it]Epoch 15 Valid AUC:(0.7941209514544764, 0.0)
Epoch 15 Test AUC:(0.7228338031614191, 0.0)
Epoch 15 a 0.3503619457034758 b 0.5299857940592276 c 0.34124353635958743
  2%|▏         | 16/1000 [13:15<13:35:10, 49.71s/it]Epoch 16 Valid AUC:(0.7921979577559908, 0.0)
Epoch 16 Test AUC:(0.722929547797196, 0.0)
Epoch 16 a 0.34884089171526655 b 0.529573337293007 c 0.3353549153272295
  2%|▏         | 17/1000 [14:04<13:32:06, 49.57s/it]Epoch 17 Valid AUC:(0.7942009035508353, 0.0)
Epoch 17 Test AUC:(0.7258266717081173, 0.0)
Epoch 17 a 0.34693957916207957 b 0.5277647797010794 c 0.32847228022648295
  2%|▏         | 18/1000 [14:54<13:32:06, 49.62s/it]Epoch 18 Valid AUC:(0.7978887784202436, 0.0)
Epoch 18 Test AUC:(0.730003329428428, 0.0)
Epoch 18 a 0.3421385186898636 b 0.526351131004107 c 0.32195636180325055
  2%|▏         | 19/1000 [15:43<13:32:27, 49.69s/it]Epoch 19 Valid AUC:(0.7976570217905238, 0.0)
Epoch 19 Test AUC:(0.7318865580923181, 0.0)
Epoch 19 a 0.33683690176883213 b 0.5266251856652304 c 0.31558025075156443
  2%|▏         | 20/1000 [16:33<13:32:53, 49.77s/it]Epoch 20 Valid AUC:(0.7991471015122925, 0.0)
Epoch 20 Test AUC:(0.7355083509789021, 0.0)
Epoch 20 a 0.3325836873750092 b 0.5300698345096059 c 0.3103335783395249
  2%|▏         | 21/1000 [17:23<13:32:53, 49.82s/it]Epoch 21 Valid AUC:(0.802460370981213, 0.0)
Epoch 21 Test AUC:(0.7397380543228658, 0.0)
Epoch 21 a 0.32829859630922437 b 0.5325002180378682 c 0.3045996142105317
  2%|▏         | 22/1000 [18:13<13:33:19, 49.90s/it]Epoch 22 Valid AUC:(0.8011209487682602, 0.0)
Epoch 22 Test AUC:(0.7398283862271569, 0.0)
Epoch 22 a 0.3245637689078118 b 0.5366204920668957 c 0.2998682102806851
  2%|▏         | 23/1000 [19:03<13:31:16, 49.82s/it]Epoch 23 Valid AUC:(0.80250377849109, 0.0)
Epoch 23 Test AUC:(0.7405435380303965, 0.0)
Epoch 23 a 0.321926381986146 b 0.538382682102307 c 0.29550759800123255
  2%|▏         | 24/1000 [19:53<13:30:43, 49.84s/it]Epoch 24 Valid AUC:(0.8015163659358839, 0.0)
Epoch 24 Test AUC:(0.7406639905455229, 0.0)
Epoch 24 a 0.3196192995403374 b 0.5409631505458647 c 0.2905611675869771
  2%|▎         | 25/1000 [20:43<13:30:20, 49.87s/it]Epoch 25 Valid AUC:(0.8035705882134618, 0.0)
Epoch 25 Test AUC:(0.7442054475516815, 0.0)
Epoch 25 a 0.31718176513370616 b 0.5402526525064734 c 0.28659444273837376
  3%|▎         | 26/1000 [21:33<13:29:39, 49.88s/it]Epoch 26 Valid AUC:(0.8018155945222762, 0.0)
Epoch 26 Test AUC:(0.7447351171036974, 0.0)
Epoch 26 a 0.3155668042075466 b 0.5414324069406905 c 0.2818015766155792
  3%|▎         | 27/1000 [22:23<13:29:28, 49.92s/it]Epoch 27 Valid AUC:(0.8027118448987822, 0.0)
Epoch 27 Test AUC:(0.743523798247591, 0.0)
Epoch 27 a 0.31356833506398035 b 0.539613018153419 c 0.2769350229014813
  3%|▎         | 28/1000 [23:25<14:26:53, 53.51s/it]Epoch 28 Valid AUC:(0.8015317129961372, 0.0)
Epoch 28 Test AUC:(0.7452587924617615, 0.0)
Epoch 28 a 0.31190166506968753 b 0.538113017197346 c 0.2732089447603379
  3%|▎         | 29/1000 [24:18<14:24:36, 53.43s/it]Epoch 29 Valid AUC:(0.8037600202782662, 0.0)
Epoch 29 Test AUC:(0.7466416641226615, 0.0)
Epoch 29 a 0.3100388341506482 b 0.5381191792022774 c 0.26896942933080664
  3%|▎         | 30/1000 [25:08<14:05:07, 52.28s/it]Epoch 30 Valid AUC:(0.8041134319973003, 0.0)
Epoch 30 Test AUC:(0.7456375810547454, 0.0)
Epoch 30 a 0.3075906937151128 b 0.5366289335597209 c 0.2646873628109753
  3%|▎         | 31/1000 [25:58<13:54:29, 51.67s/it]Epoch 31 Valid AUC:(0.8054541204228235, 0.0)
Epoch 31 Test AUC:(0.7473351265208241, 0.0)
Epoch 31 a 0.30461628258348233 b 0.5347326786465328 c 0.26026726854399174
  3%|▎         | 32/1000 [26:50<13:54:37, 51.73s/it]Epoch 32 Valid AUC:(0.8028685540834658, 0.0)
Epoch 32 Test AUC:(0.7434494864893326, 0.0)
Epoch 32 a 0.3022804060872172 b 0.5322443499891331 c 0.2565035544770584
  3%|▎         | 33/1000 [27:41<13:51:10, 51.57s/it]Epoch 33 Valid AUC:(0.8035621002318286, 0.0)
Epoch 33 Test AUC:(0.7468948311702138, 0.0)
Epoch 33 a 0.29978783005919735 b 0.5300206170835245 c 0.2516747697498237
  3%|▎         | 34/1000 [28:32<13:46:33, 51.34s/it]Epoch 34 Valid AUC:(0.8009349193293408, 0.0)
Epoch 34 Test AUC:(0.7481206181806237, 0.0)
Epoch 34 a 0.297916910897798 b 0.5285504913066235 c 0.24833897940469699
  4%|▎         | 35/1000 [29:22<13:42:54, 51.17s/it]Epoch 35 Valid AUC:(0.8050118251950793, 0.0)
Epoch 35 Test AUC:(0.754243144319168, 0.0)
Epoch 35 a 0.2952039523923421 b 0.5259676989415282 c 0.24335729044447962
  4%|▎         | 36/1000 [30:13<13:39:14, 50.99s/it]Epoch 36 Valid AUC:(0.8034352418803324, 0.0)
Epoch 36 Test AUC:(0.7517345527729968, 0.0)
Epoch 36 a 0.2931473320818523 b 0.5229614007640893 c 0.23948766282146847
  4%|▎         | 37/1000 [31:04<13:36:54, 50.90s/it]  4%|▎         | 37/1000 [31:54<13:50:40, 51.76s/it]
[32m[I 2021-05-14 22:29:30,588][0m Trial 94 finished with value: 0.8054541204228235 and parameters: {'rank': 35.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12828774887104422, 'gamma': 0.003560367666022497}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 22:29:31.248710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7797553494815388, 0.0)
Epoch 0 Test AUC:(0.7201596658307844, 0.0)
Epoch 0 a 0.41352258745573417 b 0.5016072222764343 c 0.41446767312660066
  0%|          | 1/1000 [00:51<14:11:02, 51.11s/it]Epoch 1 Valid AUC:(0.7805592342647661, 0.0)
Epoch 1 Test AUC:(0.7221531072847546, 0.0)
Epoch 1 a 0.3853486658221999 b 0.48780238004757365 c 0.38617230265193303
  0%|          | 2/1000 [01:41<14:00:35, 50.54s/it]Epoch 2 Valid AUC:(0.7751248152380552, 0.0)
Epoch 2 Test AUC:(0.7240226844070694, 0.0)
Epoch 2 a 0.38171157714586623 b 0.49292988640441743 c 0.3826512194255468
  0%|          | 3/1000 [02:32<14:06:17, 50.93s/it]Epoch 3 Valid AUC:(0.78174182041546, 0.0)
Epoch 3 Test AUC:(0.725460200713404, 0.0)
Epoch 3 a 0.37766896323179094 b 0.4968399913378165 c 0.37926238613349333
  0%|          | 4/1000 [03:23<14:03:47, 50.83s/it]Epoch 4 Valid AUC:(0.7834009523312901, 0.0)
Epoch 4 Test AUC:(0.7281678319922692, 0.0)
Epoch 4 a 0.374418736703439 b 0.5019352868409224 c 0.3762427114504924
  0%|          | 5/1000 [04:14<14:02:53, 50.83s/it]Epoch 5 Valid AUC:(0.7799276953661931, 0.0)
Epoch 5 Test AUC:(0.7253353915052413, 0.0)
Epoch 5 a 0.3721029459830501 b 0.5049826257545463 c 0.3741970589343211
  1%|          | 6/1000 [05:04<14:01:47, 50.81s/it]Epoch 6 Valid AUC:(0.7864185009302203, 0.0)
Epoch 6 Test AUC:(0.7273959747722077, 0.0)
Epoch 6 a 0.3700809882920033 b 0.5054107932017843 c 0.3718284590983055
  1%|          | 7/1000 [05:54<13:56:40, 50.55s/it]Epoch 7 Valid AUC:(0.7872823616404399, 0.0)
Epoch 7 Test AUC:(0.7259732772078398, 0.0)
Epoch 7 a 0.36751297008343625 b 0.5045369479138127 c 0.3688330014106973
  1%|          | 8/1000 [06:45<13:54:14, 50.46s/it]Epoch 8 Valid AUC:(0.7909996003382007, 0.0)
Epoch 8 Test AUC:(0.7269598308925869, 0.0)
Epoch 8 a 0.364160013570632 b 0.5063260698342468 c 0.36497852799878033
  1%|          | 9/1000 [07:35<13:53:33, 50.47s/it]Epoch 9 Valid AUC:(0.7899812655391708, 0.0)
Epoch 9 Test AUC:(0.7269114497950406, 0.0)
Epoch 9 a 0.36192438534088056 b 0.5089058723128298 c 0.3624768711671503
  1%|          | 10/1000 [08:26<13:52:32, 50.46s/it]Epoch 10 Valid AUC:(0.7908391732560813, 0.0)
Epoch 10 Test AUC:(0.7262241782619582, 0.0)
Epoch 10 a 0.35868616123314595 b 0.5120282720032352 c 0.3588803914830958
  1%|          | 11/1000 [09:16<13:52:00, 50.48s/it]Epoch 11 Valid AUC:(0.7921448473155771, 0.0)
Epoch 11 Test AUC:(0.7255874982388849, 0.0)
Epoch 11 a 0.3569292274399303 b 0.5141598019801396 c 0.3571239565939491
  1%|          | 12/1000 [10:07<13:51:16, 50.48s/it]Epoch 12 Valid AUC:(0.7922867797483008, 0.0)
Epoch 12 Test AUC:(0.7237766744784011, 0.0)
Epoch 12 a 0.35557810809290863 b 0.5181350528714163 c 0.35548227077998384
  1%|▏         | 13/1000 [10:57<13:50:01, 50.46s/it]Epoch 13 Valid AUC:(0.7917102147244303, 0.0)
Epoch 13 Test AUC:(0.7231415250697606, 0.0)
Epoch 13 a 0.3539311279593339 b 0.5191244778019082 c 0.35342434618314744
  1%|▏         | 14/1000 [11:48<13:50:13, 50.52s/it]Epoch 14 Valid AUC:(0.792668110941875, 0.0)
Epoch 14 Test AUC:(0.7245869638021957, 0.0)
Epoch 14 a 0.35223661294165753 b 0.5169162664495004 c 0.3511336916529197
  2%|▏         | 15/1000 [12:38<13:48:54, 50.49s/it]Epoch 15 Valid AUC:(0.7916298486739617, 0.0)
Epoch 15 Test AUC:(0.7224067788365055, 0.0)
Epoch 15 a 0.35065111781749686 b 0.51059693649741 c 0.34775258339866544
  2%|▏         | 16/1000 [13:28<13:47:06, 50.43s/it]Epoch 16 Valid AUC:(0.7897335569379293, 0.0)
Epoch 16 Test AUC:(0.7218649413272947, 0.0)
Epoch 16 a 0.34900256091919946 b 0.5029243531241503 c 0.34357162446563155
  2%|▏         | 17/1000 [14:19<13:46:15, 50.43s/it]Epoch 17 Valid AUC:(0.791644308872779, 0.0)
Epoch 17 Test AUC:(0.7236355073629203, 0.0)
Epoch 17 a 0.34756668826463955 b 0.4958813628800198 c 0.3387321182779623
  2%|▏         | 18/1000 [15:10<13:47:47, 50.58s/it]Epoch 18 Valid AUC:(0.7935346027597938, 0.0)
Epoch 18 Test AUC:(0.7233597616147545, 0.0)
Epoch 18 a 0.3457462927345299 b 0.48541002967947683 c 0.33338680317704106
  2%|▏         | 19/1000 [16:00<13:46:21, 50.54s/it]Epoch 19 Valid AUC:(0.7921742303678048, 0.0)
Epoch 19 Test AUC:(0.7235293177800504, 0.0)
Epoch 19 a 0.34409035715298875 b 0.47239515826975553 c 0.3277970921225711
  2%|▏         | 20/1000 [16:51<13:46:02, 50.57s/it]Epoch 20 Valid AUC:(0.7941388822035371, 0.0)
Epoch 20 Test AUC:(0.7268700975525992, 0.0)
Epoch 20 a 0.3418263643680204 b 0.46044483163227257 c 0.3223383715694819
  2%|▏         | 21/1000 [17:42<13:45:55, 50.62s/it]Epoch 21 Valid AUC:(0.7977252601390151, 0.0)
Epoch 21 Test AUC:(0.7315039557896301, 0.0)
Epoch 21 a 0.3382330870844229 b 0.45177007566995064 c 0.31621182756404764
  2%|▏         | 22/1000 [18:32<13:45:39, 50.65s/it]Epoch 22 Valid AUC:(0.7960687131935843, 0.0)
Epoch 22 Test AUC:(0.7330977957146977, 0.0)
Epoch 22 a 0.3348441480151125 b 0.44428302770409306 c 0.3108061780512213
  2%|▏         | 23/1000 [19:23<13:43:42, 50.59s/it]Epoch 23 Valid AUC:(0.7983254026048463, 0.0)
Epoch 23 Test AUC:(0.7335145803145651, 0.0)
Epoch 23 a 0.3321623620492832 b 0.43990119728044247 c 0.3059308690204467
  2%|▏         | 24/1000 [20:13<13:42:41, 50.58s/it]Epoch 24 Valid AUC:(0.796930318302464, 0.0)
Epoch 24 Test AUC:(0.7348245596696975, 0.0)
Epoch 24 a 0.32874100368987147 b 0.4371032613503861 c 0.3010525311862439
  2%|▎         | 25/1000 [21:04<13:41:19, 50.54s/it]Epoch 25 Valid AUC:(0.8002994164677312, 0.0)
Epoch 25 Test AUC:(0.7384886197470152, 0.0)
Epoch 25 a 0.32531236588834994 b 0.4350972086251142 c 0.29686061726129753
  3%|▎         | 26/1000 [21:54<13:40:19, 50.53s/it]Epoch 26 Valid AUC:(0.7980474945774831, 0.0)
Epoch 26 Test AUC:(0.7399210867359053, 0.0)
Epoch 26 a 0.3223713545852024 b 0.4325634169146808 c 0.29268282918742966
  3%|▎         | 27/1000 [22:45<13:39:13, 50.52s/it]Epoch 27 Valid AUC:(0.8000809883913836, 0.0)
Epoch 27 Test AUC:(0.7399493047673479, 0.0)
Epoch 27 a 0.31980004492899783 b 0.4291623071045943 c 0.287388670342549
  3%|▎         | 28/1000 [23:35<13:38:23, 50.52s/it]Epoch 28 Valid AUC:(0.7992997019140807, 0.0)
Epoch 28 Test AUC:(0.7413396029010685, 0.0)
Epoch 28 a 0.31799780201144384 b 0.425601875877956 c 0.28439186786262083
  3%|▎         | 29/1000 [24:26<13:36:57, 50.48s/it]Epoch 29 Valid AUC:(0.8006120107736543, 0.0)
Epoch 29 Test AUC:(0.7431670239945917, 0.0)
Epoch 29 a 0.3161860628267169 b 0.41907171266419546 c 0.2796698441387902
  3%|▎         | 30/1000 [25:16<13:36:17, 50.49s/it]Epoch 30 Valid AUC:(0.801634269806379, 0.0)
Epoch 30 Test AUC:(0.7403589750029244, 0.0)
Epoch 30 a 0.3145493671927654 b 0.4142560199712604 c 0.27544864877248915
  3%|▎         | 31/1000 [26:07<13:36:28, 50.56s/it]Epoch 31 Valid AUC:(0.8034692771103237, 0.0)
Epoch 31 Test AUC:(0.7424284041952021, 0.0)
Epoch 31 a 0.31310121022479637 b 0.407606687224367 c 0.27086065829519773
  3%|▎         | 32/1000 [26:58<13:35:46, 50.56s/it]Epoch 32 Valid AUC:(0.800811757088222, 0.0)
Epoch 32 Test AUC:(0.7402210401346814, 0.0)
Epoch 32 a 0.3122988578899046 b 0.4005607520070834 c 0.2670829806109549
  3%|▎         | 33/1000 [27:48<13:34:57, 50.57s/it]Epoch 33 Valid AUC:(0.8020128648017368, 0.0)
Epoch 33 Test AUC:(0.7428364882353746, 0.0)
Epoch 33 a 0.31110194121568013 b 0.39306232878859615 c 0.2627525569447569
  3%|▎         | 34/1000 [28:39<13:33:38, 50.54s/it]Epoch 34 Valid AUC:(0.8009143831044141, 0.0)
Epoch 34 Test AUC:(0.743938504974234, 0.0)
Epoch 34 a 0.310589122220544 b 0.38801688687422387 c 0.25888453355017804
  4%|▎         | 35/1000 [29:29<13:32:23, 50.51s/it]Epoch 35 Valid AUC:(0.8040427932276103, 0.0)
Epoch 35 Test AUC:(0.7493328263322666, 0.0)
Epoch 35 a 0.3086926330263226 b 0.3804480571981887 c 0.25405561465252813
  4%|▎         | 36/1000 [30:20<13:32:29, 50.57s/it]Epoch 36 Valid AUC:(0.801397116394135, 0.0)
Epoch 36 Test AUC:(0.7478155085779202, 0.0)
Epoch 36 a 0.30713553303923885 b 0.3745693594996838 c 0.2507701176752747
  4%|▎         | 37/1000 [31:10<13:32:19, 50.61s/it]Epoch 37 Valid AUC:(0.8027368551602304, 0.0)
Epoch 37 Test AUC:(0.7474710177195171, 0.0)
Epoch 37 a 0.305920604189157 b 0.36888253880698435 c 0.24789576286401308
  4%|▍         | 38/1000 [32:01<13:30:48, 50.57s/it]Epoch 38 Valid AUC:(0.804013879237934, 0.0)
Epoch 38 Test AUC:(0.749687005381465, 0.0)
Epoch 38 a 0.3044116229598431 b 0.3647728748844423 c 0.24438556932827357
  4%|▍         | 39/1000 [32:52<13:32:49, 50.75s/it]Epoch 39 Valid AUC:(0.8010243385433692, 0.0)
Epoch 39 Test AUC:(0.7489965871103308, 0.0)
Epoch 39 a 0.302132782262096 b 0.3588364635794695 c 0.24074125137007693
  4%|▍         | 40/1000 [33:43<13:31:18, 50.71s/it]Epoch 40 Valid AUC:(0.803251810227729, 0.0)
Epoch 40 Test AUC:(0.7511485625954969, 0.0)
Epoch 40 a 0.300428919209321 b 0.3566284609032829 c 0.2385628440490431
  4%|▍         | 41/1000 [34:33<13:28:37, 50.59s/it]  4%|▍         | 41/1000 [35:24<13:48:03, 51.81s/it]
[32m[I 2021-05-14 23:05:14,198][0m Trial 95 finished with value: 0.8040427932276103 and parameters: {'rank': 45.0, 'lambda': 0.0001, 'batch_size': 512, 'learning_rate': 0.005, 'alpha': 0.12976879152398632, 'gamma': 0.0027980726547706582}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 23:05:15.007235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7733399040709155, 0.0)
Epoch 0 Test AUC:(0.7193085501460434, 0.0)
Epoch 0 a 0.42031439069298004 b 0.5053054848986287 c 0.4211229058282991
  0%|          | 1/1000 [00:30<8:23:47, 30.26s/it]Epoch 1 Valid AUC:(0.7763482713471187, 0.0)
Epoch 1 Test AUC:(0.7206194273476308, 0.0)
Epoch 1 a 0.385848177657012 b 0.487018407713021 c 0.3860556483268738
  0%|          | 2/1000 [01:00<8:19:30, 30.03s/it]Epoch 2 Valid AUC:(0.7757143563775887, 0.0)
Epoch 2 Test AUC:(0.7240861792532747, 0.0)
Epoch 2 a 0.3818752846169856 b 0.49618510120818693 c 0.38221566667479856
  0%|          | 3/1000 [01:30<8:18:07, 29.98s/it]Epoch 3 Valid AUC:(0.7791492629935401, 0.0)
Epoch 3 Test AUC:(0.7246212914649917, 0.0)
Epoch 3 a 0.378359226930526 b 0.5037392303347588 c 0.3789785906912819
  0%|          | 4/1000 [01:59<8:17:16, 29.96s/it]Epoch 4 Valid AUC:(0.7798063991225465, 0.0)
Epoch 4 Test AUC:(0.7273585516768717, 0.0)
Epoch 4 a 0.3760841405920444 b 0.5113442508924392 c 0.3771526412137093
  0%|          | 5/1000 [02:30<8:18:08, 30.04s/it]Epoch 5 Valid AUC:(0.784805813896526, 0.0)
Epoch 5 Test AUC:(0.7261278008582035, 0.0)
Epoch 5 a 0.37403412247377055 b 0.5163670515100802 c 0.3753230490030781
  1%|          | 6/1000 [02:59<8:15:34, 29.91s/it]Epoch 6 Valid AUC:(0.7839954942415216, 0.0)
Epoch 6 Test AUC:(0.7268337433220906, 0.0)
Epoch 6 a 0.3721154225209067 b 0.5210301043285478 c 0.3735027862412314
  1%|          | 7/1000 [03:29<8:14:31, 29.88s/it]Epoch 7 Valid AUC:(0.7865785153398218, 0.0)
Epoch 7 Test AUC:(0.7282350037334807, 0.0)
Epoch 7 a 0.3712530501427189 b 0.5244139625180152 c 0.3729278162842797
  1%|          | 8/1000 [03:59<8:15:04, 29.94s/it]Epoch 8 Valid AUC:(0.7894115929153038, 0.0)
Epoch 8 Test AUC:(0.7286451656468776, 0.0)
Epoch 8 a 0.37027053150438494 b 0.5263007738657536 c 0.3719343400049594
  1%|          | 9/1000 [04:29<8:15:24, 29.99s/it]Epoch 9 Valid AUC:(0.7868465371690394, 0.0)
Epoch 9 Test AUC:(0.7306265759583509, 0.0)
Epoch 9 a 0.36929753182395814 b 0.5272476631066492 c 0.37086105863413504
  1%|          | 10/1000 [04:59<8:14:07, 29.95s/it]Epoch 10 Valid AUC:(0.7891916820373936, 0.0)
Epoch 10 Test AUC:(0.7292805031757278, 0.0)
Epoch 10 a 0.3673969772794554 b 0.529000619486455 c 0.3688457022991873
  1%|          | 11/1000 [05:29<8:13:53, 29.96s/it]Epoch 11 Valid AUC:(0.7881600379088665, 0.0)
Epoch 11 Test AUC:(0.7285967546211163, 0.0)
Epoch 11 a 0.3668486145475218 b 0.5294737926413936 c 0.3676228054588841
  1%|          | 12/1000 [05:59<8:13:37, 29.98s/it]Epoch 12 Valid AUC:(0.788316536912516, 0.0)
Epoch 12 Test AUC:(0.7284135511897045, 0.0)
Epoch 12 a 0.36527473455475223 b 0.5315368475933229 c 0.3655570813965413
  1%|▏         | 13/1000 [06:29<8:13:16, 29.99s/it]Epoch 13 Valid AUC:(0.789548129847095, 0.0)
Epoch 13 Test AUC:(0.7281612050303395, 0.0)
Epoch 13 a 0.36243088879892904 b 0.5339352338304443 c 0.3625196157203567
  1%|▏         | 14/1000 [06:59<8:12:13, 29.95s/it]Epoch 14 Valid AUC:(0.7925316893533341, 0.0)
Epoch 14 Test AUC:(0.727563850681995, 0.0)
Epoch 14 a 0.35951468480690835 b 0.540377373296407 c 0.35916105165116247
  2%|▏         | 15/1000 [07:29<8:13:52, 30.08s/it]Epoch 15 Valid AUC:(0.790711242212357, 0.0)
Epoch 15 Test AUC:(0.72417394588198, 0.0)
Epoch 15 a 0.3574937986991098 b 0.5444197202882459 c 0.35606602615406435
  2%|▏         | 16/1000 [07:59<8:12:36, 30.04s/it]Epoch 16 Valid AUC:(0.7919721835961885, 0.0)
Epoch 16 Test AUC:(0.723861037841496, 0.0)
Epoch 16 a 0.3558570835138521 b 0.5471797575873714 c 0.35360499038811655
  2%|▏         | 17/1000 [08:29<8:11:51, 30.02s/it]Epoch 17 Valid AUC:(0.7907833214910845, 0.0)
Epoch 17 Test AUC:(0.7227640105636509, 0.0)
Epoch 17 a 0.3543594459131841 b 0.5517005093636052 c 0.3505301200334103
  2%|▏         | 18/1000 [08:59<8:11:36, 30.04s/it]Epoch 18 Valid AUC:(0.7927892328890543, 0.0)
Epoch 18 Test AUC:(0.7216739950390734, 0.0)
Epoch 18 a 0.35305780460757596 b 0.5548295169588058 c 0.34663044889607736
  2%|▏         | 19/1000 [09:30<8:11:35, 30.07s/it]Epoch 19 Valid AUC:(0.7935878311066413, 0.0)
Epoch 19 Test AUC:(0.7215146230178527, 0.0)
Epoch 19 a 0.3518534327947324 b 0.5531173921640842 c 0.341795374669375
  2%|▏         | 20/1000 [10:00<8:12:12, 30.13s/it]Epoch 20 Valid AUC:(0.7911569656978196, 0.0)
Epoch 20 Test AUC:(0.7230380076489592, 0.0)
Epoch 20 a 0.35088257828066427 b 0.5533105281572188 c 0.3374966356542803
  2%|▏         | 21/1000 [10:30<8:10:25, 30.06s/it]Epoch 21 Valid AUC:(0.796148553791468, 0.0)
Epoch 21 Test AUC:(0.7252034038008979, 0.0)
Epoch 21 a 0.3496533691162063 b 0.5539795488359467 c 0.3329273539204751
  2%|▏         | 22/1000 [11:00<8:09:30, 30.03s/it]Epoch 22 Valid AUC:(0.7953728268588314, 0.0)
Epoch 22 Test AUC:(0.7248965925653893, 0.0)
Epoch 22 a 0.3485633220163084 b 0.5558773942532078 c 0.32916501657136027
  2%|▏         | 23/1000 [11:30<8:10:02, 30.09s/it]Epoch 23 Valid AUC:(0.7962630537544864, 0.0)
Epoch 23 Test AUC:(0.7237758621411323, 0.0)
Epoch 23 a 0.3472396579961623 b 0.5589295938130348 c 0.32527087592790205
  2%|▏         | 24/1000 [12:00<8:10:32, 30.16s/it]Epoch 24 Valid AUC:(0.7965383985985087, 0.0)
Epoch 24 Test AUC:(0.7248431835276951, 0.0)
Epoch 24 a 0.3459692614213113 b 0.5590402504369136 c 0.3209269817077344
  2%|▎         | 25/1000 [12:30<8:08:56, 30.09s/it]Epoch 25 Valid AUC:(0.7956544399677137, 0.0)
Epoch 25 Test AUC:(0.7298083898612117, 0.0)
Epoch 25 a 0.3443684556311177 b 0.5543072358254464 c 0.3156852314789449
  3%|▎         | 26/1000 [13:00<8:05:24, 29.90s/it]Epoch 26 Valid AUC:(0.7959916574944005, 0.0)
Epoch 26 Test AUC:(0.7326603649218247, 0.0)
Epoch 26 a 0.3421049788594246 b 0.5481937921816303 c 0.3102198749059631
  3%|▎         | 27/1000 [13:30<8:06:22, 29.99s/it]Epoch 27 Valid AUC:(0.7992611875212013, 0.0)
Epoch 27 Test AUC:(0.7348411313499811, 0.0)
Epoch 27 a 0.3387527773457189 b 0.5410046059518091 c 0.30425377646761553
  3%|▎         | 28/1000 [14:00<8:07:22, 30.08s/it]Epoch 28 Valid AUC:(0.8019687024343659, 0.0)
Epoch 28 Test AUC:(0.7373080072396695, 0.0)
Epoch 28 a 0.3346478656655358 b 0.5381660993781782 c 0.30136106343519303
  3%|▎         | 29/1000 [14:30<8:06:38, 30.07s/it]Epoch 29 Valid AUC:(0.800940346870065, 0.0)
Epoch 29 Test AUC:(0.7401363432857604, 0.0)
Epoch 29 a 0.32944309483132056 b 0.5398425958569972 c 0.29673645332936316
  3%|▎         | 30/1000 [15:00<8:06:37, 30.10s/it]Epoch 30 Valid AUC:(0.8055631287655342, 0.0)
Epoch 30 Test AUC:(0.7427620054587439, 0.0)
Epoch 30 a 0.3246855374065138 b 0.5462962006849628 c 0.2922836793286185
  3%|▎         | 31/1000 [15:30<8:06:13, 30.11s/it]Epoch 31 Valid AUC:(0.8075747278673373, 0.0)
Epoch 31 Test AUC:(0.7448415161840736, 0.0)
Epoch 31 a 0.321058283289594 b 0.5456504843408062 c 0.28781149524354166
  3%|▎         | 32/1000 [16:01<8:05:31, 30.09s/it]Epoch 32 Valid AUC:(0.803320139569229, 0.0)
Epoch 32 Test AUC:(0.7484578407582008, 0.0)
Epoch 32 a 0.31903189252461156 b 0.5439249414109415 c 0.2839388429157196
  3%|▎         | 33/1000 [16:30<8:04:14, 30.05s/it]Epoch 33 Valid AUC:(0.8036372694280737, 0.0)
Epoch 33 Test AUC:(0.7457292298005038, 0.0)
Epoch 33 a 0.31696005862566734 b 0.5456269737933913 c 0.27861445811727353
  3%|▎         | 34/1000 [17:00<8:02:22, 29.96s/it]Epoch 34 Valid AUC:(0.805232037247032, 0.0)
Epoch 34 Test AUC:(0.7485922398215946, 0.0)
Epoch 34 a 0.3151824522402979 b 0.542913474623234 c 0.27370826491425115
  4%|▎         | 35/1000 [17:30<8:00:31, 29.88s/it]Epoch 35 Valid AUC:(0.8056358180818969, 0.0)
Epoch 35 Test AUC:(0.7520299485321491, 0.0)
Epoch 35 a 0.3129123813442646 b 0.5411707536587792 c 0.26801872001059596
  4%|▎         | 36/1000 [18:00<8:00:27, 29.90s/it]Epoch 36 Valid AUC:(0.8072745086105838, 0.0)
Epoch 36 Test AUC:(0.7507017001393872, 0.0)
Epoch 36 a 0.31185388288670973 b 0.5401023694824788 c 0.2637102073959766
  4%|▎         | 37/1000 [18:30<8:01:04, 29.97s/it]  4%|▎         | 37/1000 [19:01<8:15:08, 30.85s/it]
[32m[I 2021-05-14 23:24:35,404][0m Trial 96 finished with value: 0.8075747278673373 and parameters: {'rank': 55.0, 'lambda': 0.0001, 'batch_size': 1024, 'learning_rate': 0.005, 'alpha': 0.12075065181071207, 'gamma': 0.0027219743574177077}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 23:24:36.064226: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7532041932018513, 0.0)
Epoch 0 Test AUC:(0.7076091277105734, 0.0)
Epoch 0 a 0.43840652139436814 b 0.4994673959670528 c 0.43035734793351543
  0%|          | 1/1000 [00:28<7:50:48, 28.28s/it]Epoch 1 Valid AUC:(0.7709363442542236, 0.0)
Epoch 1 Test AUC:(0.720309435170396, 0.0)
Epoch 1 a 0.39290804211651126 b 0.482227832319275 c 0.38776206801975927
  0%|          | 2/1000 [00:57<7:59:08, 28.81s/it]Epoch 2 Valid AUC:(0.7705923906817171, 0.0)
Epoch 2 Test AUC:(0.7237508549796311, 0.0)
Epoch 2 a 0.3848399974165424 b 0.49227239672214756 c 0.3820488448104551
  0%|          | 3/1000 [01:26<8:00:59, 28.95s/it]Epoch 3 Valid AUC:(0.7785441018147277, 0.0)
Epoch 3 Test AUC:(0.7251855238300655, 0.0)
Epoch 3 a 0.3817620200495566 b 0.49802096921109384 c 0.3800126335793926
  0%|          | 4/1000 [01:55<8:02:22, 29.06s/it]Epoch 4 Valid AUC:(0.7770949151199786, 0.0)
Epoch 4 Test AUC:(0.7281951735545534, 0.0)
Epoch 4 a 0.3798720572263964 b 0.5025992483621643 c 0.3779802052003722
  0%|          | 5/1000 [02:24<8:01:25, 29.03s/it]Epoch 5 Valid AUC:(0.7804634109371608, 0.0)
Epoch 5 Test AUC:(0.7256925334477412, 0.0)
Epoch 5 a 0.37856552173053065 b 0.5063386481375464 c 0.37717879371296975
  1%|          | 6/1000 [02:53<8:01:39, 29.07s/it]Epoch 6 Valid AUC:(0.7791581200735744, 0.0)
Epoch 6 Test AUC:(0.7271857418870412, 0.0)
Epoch 6 a 0.37699477314468355 b 0.5101445102162899 c 0.37539022343774
  1%|          | 7/1000 [03:23<8:01:43, 29.11s/it]Epoch 7 Valid AUC:(0.7804627778308756, 0.0)
Epoch 7 Test AUC:(0.7283921610667791, 0.0)
Epoch 7 a 0.37701931740007094 b 0.5116602788048406 c 0.37549608765590575
  1%|          | 8/1000 [03:52<8:01:43, 29.14s/it]Epoch 8 Valid AUC:(0.782977383721034, 0.0)
Epoch 8 Test AUC:(0.72981013424861, 0.0)
Epoch 8 a 0.3766771779666024 b 0.5134486571675346 c 0.37516897376025876
  1%|          | 9/1000 [04:21<8:01:43, 29.17s/it]Epoch 9 Valid AUC:(0.7789801467198953, 0.0)
Epoch 9 Test AUC:(0.7303655719938843, 0.0)
Epoch 9 a 0.37651688942024786 b 0.5154441012249839 c 0.37491984256813604
  1%|          | 10/1000 [04:50<8:00:20, 29.11s/it]Epoch 10 Valid AUC:(0.7836646628861285, 0.0)
Epoch 10 Test AUC:(0.7291383398782278, 0.0)
Epoch 10 a 0.3756662578352036 b 0.5153040872706521 c 0.3739597370787974
  1%|          | 11/1000 [05:19<7:57:39, 28.98s/it]Epoch 11 Valid AUC:(0.7813805217812861, 0.0)
Epoch 11 Test AUC:(0.7284510726206046, 0.0)
Epoch 11 a 0.3760245176813295 b 0.5171174063317238 c 0.37432837450215894
  1%|          | 12/1000 [05:47<7:55:51, 28.90s/it]Epoch 12 Valid AUC:(0.7807061149229293, 0.0)
Epoch 12 Test AUC:(0.7318727227059926, 0.0)
Epoch 12 a 0.37635957822203636 b 0.5170246578993336 c 0.3746835418766545
  1%|▏         | 13/1000 [06:16<7:54:12, 28.83s/it]Epoch 13 Valid AUC:(0.7819098114516183, 0.0)
Epoch 13 Test AUC:(0.7294005281449232, 0.0)
Epoch 13 a 0.3762456456259374 b 0.5161008434670586 c 0.37408443672522423
  1%|▏         | 14/1000 [06:45<7:53:52, 28.84s/it]Epoch 14 Valid AUC:(0.783296441093751, 0.0)
Epoch 14 Test AUC:(0.7283868252935608, 0.0)
Epoch 14 a 0.3757477218825971 b 0.5163172774257199 c 0.37346364089077516
  2%|▏         | 15/1000 [07:14<7:55:14, 28.95s/it]Epoch 15 Valid AUC:(0.7804901116180222, 0.0)
Epoch 15 Test AUC:(0.726055366026582, 0.0)
Epoch 15 a 0.3759219702934065 b 0.5160004572281914 c 0.3735754560799368
  2%|▏         | 16/1000 [07:43<7:54:18, 28.92s/it]  2%|▏         | 16/1000 [08:12<8:24:58, 30.79s/it]
[32m[I 2021-05-14 23:33:07,654][0m Trial 97 finished with value: 0.7836646628861285 and parameters: {'rank': 40.0, 'lambda': 0.001, 'batch_size': 1024, 'learning_rate': 0.005, 'alpha': 0.12254049725464249, 'gamma': 0.0031032658960103514}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 23:33:08.392866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7595095204113774, 0.0)
Epoch 0 Test AUC:(0.7069597752261068, 0.0)
Epoch 0 a 0.4232769863259408 b 0.4987474109136289 c 0.4336941034322785
  0%|          | 1/1000 [00:29<8:17:12, 29.86s/it]Epoch 1 Valid AUC:(0.7532310399841632, 0.0)
Epoch 1 Test AUC:(0.7076066308423365, 0.0)
Epoch 1 a 0.4005315583800116 b 0.46965827384302694 c 0.4061601057408317
  0%|          | 2/1000 [00:59<8:14:02, 29.70s/it]Epoch 2 Valid AUC:(0.7569638987212032, 0.0)
Epoch 2 Test AUC:(0.7128041656347311, 0.0)
Epoch 2 a 0.39719626547828796 b 0.4283767579303634 c 0.3912122795178044
  0%|          | 3/1000 [01:29<8:15:12, 29.80s/it]Epoch 3 Valid AUC:(0.7573765161306356, 0.0)
Epoch 3 Test AUC:(0.7114895303044106, 0.0)
Epoch 3 a 0.3964263710283464 b 0.3984560751386227 c 0.3787585183257057
  0%|          | 4/1000 [01:59<8:15:07, 29.83s/it]Epoch 4 Valid AUC:(0.7584818325563367, 0.0)
Epoch 4 Test AUC:(0.7122156101816455, 0.0)
Epoch 4 a 0.39676185601180597 b 0.3823944648667689 c 0.37155886511168174
  0%|          | 5/1000 [02:28<8:13:02, 29.73s/it]Epoch 5 Valid AUC:(0.7513306484363772, 0.0)
Epoch 5 Test AUC:(0.7031211353188045, 0.0)
Epoch 5 a 0.3962307128935091 b 0.373182519068641 c 0.36638659166712917
  1%|          | 6/1000 [02:58<8:14:04, 29.82s/it]  1%|          | 6/1000 [03:28<9:36:14, 34.78s/it]
[32m[I 2021-05-14 23:36:55,901][0m Trial 98 finished with value: 0.7595095204113774 and parameters: {'rank': 55.0, 'lambda': 0.0001, 'batch_size': 1024, 'learning_rate': 0.05, 'alpha': 0.11942348085075459, 'gamma': 0.0029483776705040115}. Best is trial 84 with value: 0.8090983558142626.[0m
2021-05-14 23:36:56.569285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:b1:00.0)
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0 Valid AUC:(0.7856196771524994, 0.0)
Epoch 0 Test AUC:(0.7238483867573993, 0.0)
Epoch 0 a 0.4181254352292707 b 0.5405357906654957 c 0.41918694780718896
  0%|          | 1/1000 [00:29<8:11:20, 29.51s/it]Epoch 1 Valid AUC:(0.7816793505110772, 0.0)
Epoch 1 Test AUC:(0.7243416593243135, 0.0)
Epoch 1 a 0.376792193660813 b 0.5131113588088944 c 0.3777468241751194
  0%|          | 2/1000 [00:58<8:09:06, 29.40s/it]Epoch 2 Valid AUC:(0.7826953258998419, 0.0)
Epoch 2 Test AUC:(0.7252237293344552, 0.0)
Epoch 2 a 0.37381806717284266 b 0.5032785455546072 c 0.3747839534715299
  0%|          | 3/1000 [01:28<8:09:40, 29.47s/it]Epoch 3 Valid AUC:(0.785319274628137, 0.0)
Epoch 3 Test AUC:(0.7254466304055557, 0.0)
Epoch 3 a 0.3725738358353415 b 0.49779919462819255 c 0.37373739468955225
  0%|          | 4/1000 [01:57<8:09:08, 29.47s/it]Epoch 4 Valid AUC:(0.7897025078165302, 0.0)
Epoch 4 Test AUC:(0.728620124281702, 0.0)
Epoch 4 a 0.37188312555513076 b 0.49596029580120116 c 0.3730877717175791
  0%|          | 5/1000 [02:27<8:08:41, 29.47s/it]Epoch 5 Valid AUC:(0.779072115019756, 0.0)
Epoch 5 Test AUC:(0.7237858196858641, 0.0)
Epoch 5 a 0.37040586505205403 b 0.49621058772167853 c 0.37148382646902917
  1%|          | 6/1000 [02:56<8:07:59, 29.46s/it]Epoch 6 Valid AUC:(0.7907957362695959, 0.0)
Epoch 6 Test AUC:(0.7275396088277102, 0.0)
Epoch 6 a 0.36791674011657316 b 0.4979379211942996 c 0.3685960972741727
  1%|          | 7/1000 [03:26<8:07:02, 29.43s/it]Epoch 7 Valid AUC:(0.7909950981066626, 0.0)
Epoch 7 Test AUC:(0.7271923047170813, 0.0)
Epoch 7 a 0.3642558117787684 b 0.5022012268102938 c 0.36476829107249936
  1%|          | 8/1000 [03:55<8:06:26, 29.42s/it]Epoch 8 Valid AUC:(0.793493780220316, 0.0)
Epoch 8 Test AUC:(0.7236853121884166, 0.0)
Epoch 8 a 0.35906737453995213 b 0.5092317236046637 c 0.3597538295772768
  1%|          | 9/1000 [04:25<8:06:59, 29.48s/it]Epoch 9 Valid AUC:(0.7907662865746014, 0.0)
Epoch 9 Test AUC:(0.7222131988653495, 0.0)
Epoch 9 a 0.35505553887736413 b 0.5176079084555949 c 0.35580816167977547
  1%|          | 10/1000 [04:54<8:06:49, 29.50s/it]Epoch 10 Valid AUC:(0.7960820904474402, 0.0)
Epoch 10 Test AUC:(0.7228989055803248, 0.0)
Epoch 10 a 0.35068252886975965 b 0.5263690762221813 c 0.35138723025879554
  1%|          | 11/1000 [05:24<8:05:22, 29.45s/it]Epoch 11 Valid AUC:(0.7922049167987611, 0.0)
Epoch 11 Test AUC:(0.7191349194680257, 0.0)
Epoch 11 a 0.3486410863697529 b 0.5361934294623714 c 0.34924905963482394
  1%|          | 12/1000 [05:53<8:06:29, 29.54s/it]Epoch 12 Valid AUC:(0.790449038809323, 0.0)
Epoch 12 Test AUC:(0.718991670203861, 0.0)
Epoch 12 a 0.3464641503749355 b 0.5463282655804388 c 0.3472191041275378
  1%|▏         | 13/1000 [06:23<8:06:18, 29.56s/it]Epoch 13 Valid AUC:(0.790854440857651, 0.0)
Epoch 13 Test AUC:(0.7214150689478311, 0.0)
Epoch 13 a 0.34371872654845637 b 0.5583669451936599 c 0.34439618789380594
  1%|▏         | 14/1000 [06:52<8:05:43, 29.56s/it]Epoch 14 Valid AUC:(0.7955944166218297, 0.0)
Epoch 14 Test AUC:(0.7203982492866321, 0.0)
Epoch 14 a 0.34077971104171967 b 0.5754366084452598 c 0.3413237334499436
  2%|▏         | 15/1000 [07:22<8:06:52, 29.66s/it]2021-05-14 23:44:58.402647: I tensorflow/core/common_runtime/gpu/pool_allocator.cc:247] PoolAllocator: After 138480543 get requests, put_count=138480543 evicted_count=95000 eviction_rate=0.000686017 and unsatisfied allocation rate=0.000686111
Epoch 15 Valid AUC:(0.795046370857401, 0.0)
Epoch 15 Test AUC:(0.7210983129939686, 0.0)
Epoch 15 a 0.33745929983354384 b 0.6007753459195937 c 0.3377311544552926
  2%|▏         | 16/1000 [07:52<8:04:23, 29.54s/it]  2%|▏         | 16/1000 [08:21<8:34:27, 31.37s/it]
[32m[I 2021-05-14 23:45:37,364][0m Trial 99 finished with value: 0.7960820904474402 and parameters: {'rank': 50.0, 'lambda': 1e-05, 'batch_size': 1024, 'learning_rate': 0.005, 'alpha': 0.12558265651303283, 'gamma': 0.002747890845948546}. Best is trial 84 with value: 0.8090983558142626.[0m
